<!DOCTYPE html>
<html lang="ru"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Знакомимся с SELINUX и пытаемся понять, почему Дэн Уолш плачет | DefconRU</title>

    <!-- <link href="css/jasny-bootstrap.min.css" rel="stylesheet" type="text/css"/> -->
    <!-- Bootstrap -->
      <link href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/jasny-bootstrap.css" rel="stylesheet">
    <!-- <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css"/> -->
    <!-- LESS -->
    <!-- <link href="https://defcon.ru/wp-content/themes/defconru/css/jasny-bootstrap.min.css" rel="stylesheet" type="text/css"/> -->
    <!-- <link rel="stylesheet/less" type="text/css" href="css/styles.less" /> -->
    <!-- <script src="js/less.js" type="text/javascript"></script> -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="pingback" href="https://defcon.ru/xmlrpc.php">
    <link rel="apple-touch-icon" sizes="57x57" href="https://defcon.ru/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://defcon.ru/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://defcon.ru/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://defcon.ru/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://defcon.ru/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://defcon.ru/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://defcon.ru/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://defcon.ru/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://defcon.ru/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="https://defcon.ru/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://defcon.ru/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="https://defcon.ru/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="https://defcon.ru/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="https://defcon.ru/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="https://defcon.ru/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
	    <link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="DefconRU » Лента" href="https://defcon.ru/feed/">
<link rel="alternate" type="application/rss+xml" title="DefconRU » Лента комментариев" href="https://defcon.ru/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="DefconRU » Лента комментариев к «Знакомимся с SELINUX и пытаемся понять, почему Дэн Уолш плачет»" href="https://defcon.ru/os-security/1264/feed/">
		<script type="text/javascript" async="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/watch.js"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/defcon.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		

<link rel="stylesheet" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/jquery.css" type="text/css" media="all">
<!--[if IE 6]>
<link rel="stylesheet" href="https://defcon.ru/wp-content/plugins/wp-lightbox/js/lightbox/themes/default/jquery.lightbox.ie6.css" type="text/css" media="all"/>
<![endif]-->

<style type="text/css">
.jquery-lightbox-overlay
{
  background: #000000;
}
</style>

<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/crayon.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="simple-favorites-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/favorites.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-ulike-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/wp-ulike.css" type="text/css" media="all">
<style id="wp-ulike-inline-css" type="text/css">

		.wpulike-default .counter a{
			border-color:#ffffff; 	
		}
		.wpulike-heart .counter{
			border-color:#ffffff; 
		}
		
</style>
<link rel="stylesheet" id="wpum-frontend-css-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/wp_user_manager_frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="twentyfourteen-lato-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/css.css" type="text/css" media="all">
<link rel="stylesheet" id="genericons-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="twentyfourteen-style-css" href="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentyfourteen-ie-css'  href='https://defcon.ru/wp-content/themes/defconru/css/ie.css?ver=20131205' type='text/css' media='all' />
<![endif]-->
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/jquery-3.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var ulike_obj = {"ajaxurl":"https:\/\/defcon.ru\/wp-admin\/admin-ajax.php","button_text_u":"-","button_text":"+","button_type":"image"};
/* ]]> */
</script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/wp-ulike-scripts.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/defcon.ru\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/crayon.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var favorites_data = {"ajaxurl":"https:\/\/defcon.ru\/wp-admin\/admin-ajax.php","favorite":"<i class=\"sf-icon-star-empty\"><\/i>","favorited":"<i class=\"sf-icon-star-full\"><\/i>","includecount":"1","indicate_loading":"","loading_text":"Loading","loading_image":"","loading_image_active":"","loading_image_preload":"","cache_enabled":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/favorites.js"></script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/jquery-migrate-3.js"></script>
<link rel="https://api.w.org/" href="https://defcon.ru/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://defcon.ru/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://defcon.ru/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Перевод OWASP Testing Guide. Часть 1.5." href="https://defcon.ru/web-security/1253/">
<link rel="next" title="NetRipper – новый взгляд на сбор данных" href="https://defcon.ru/network-security/1327/">
<meta name="generator" content="WordPress 4.8">
<link rel="canonical" href="https://defcon.ru/os-security/1264/">
<link rel="shortlink" href="https://defcon.ru/?p=1264">
<link rel="alternate" type="application/json+oembed" href="https://defcon.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdefcon.ru%2Fos-security%2F1264%2F">
<link rel="alternate" type="text/xml+oembed" href="https://defcon.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdefcon.ru%2Fos-security%2F1264%2F&amp;format=xml">
	<style type="text/css" id="twentyfourteen-header-css">
			.site-title,
		.site-description {
			clip: rect(1px 1px 1px 1px); /* IE7 */
			clip: rect(1px, 1px, 1px, 1px);
			position: absolute;
		}
		</style>
	</head>
<body>
<div class="container row">
    <nav id="myNavmenu" class="col-xs-12 col-sm-4 navmenu navmenu-default navmenu-fixed-left" role="navigation">
        <div class="row_margin-null">
            <header class="logo">
                <a href="https://defcon.ru/"><img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/logo.png" alt="DefconRU"></a>
            </header>
            <figure class="search">
                <form name="search" action="https://defcon.ru/" method="get" class="search-form">
    <div class="input-group">
        <span class="input-group-addon"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></span>
        <input name="s" id="s" class="form-control search__input-seachText" placeholder="Введите текст для поиска" type="text">
    </div>
</form>            </figure>

            <figure class="categoriesPortals">
                <div class="categoriesPortals-menu-title">
                    <div class="menu-item_borderBottom_color">Разделы</div>
                </div>
                <ul class="categoriesPortals-menu">
                    <li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/cryptography/">Cryptography</a></div><span class="badge badge_customer categoriesPortals-menu-count">2</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/hardware-security/">Hardware security</a></div><span class="badge badge_customer categoriesPortals-menu-count">1</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/infosec-news/">Infosec news</a></div><span class="badge badge_customer categoriesPortals-menu-count">14</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/legislation/">Legislation</a></div><span class="badge badge_customer categoriesPortals-menu-count">2</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/malware-analysis/">Malware analysis</a></div><span class="badge badge_customer categoriesPortals-menu-count">4</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/mobile-security/">Mobile security</a></div><span class="badge badge_customer categoriesPortals-menu-count">14</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/network-security/">Network security</a></div><span class="badge badge_customer categoriesPortals-menu-count">24</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/os-security/">OS security</a></div><span class="badge badge_customer categoriesPortals-menu-count">10</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/penetration-testing/">Penetration testing</a></div><span class="badge badge_customer categoriesPortals-menu-count">30</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/web-security/">Web security</a></div><span class="badge badge_customer categoriesPortals-menu-count">52</span></li><li class="categoriesPortals-menu-item"><div class="categoriesPortals-menu-item-title"><a href="https://defcon.ru/category/wireless-security/">Wireless security</a></div><span class="badge badge_customer categoriesPortals-menu-count">8</span></li>                                        <!-- <li class="categoriesPortals-menu-item popular-menu-item_margin-top_big">
                        <div class="categoriesPortals-menu-item-title"><a href="">Первая категория</a></div>
                        <span class="badge badge_customer categoriesPortals-menu-count hidden">122</span>
                    </li> -->
                </ul>
            </figure>
 		

            <figure class="search">
               <p>&nbsp;</p>
            </figure>

<header class="logo">
<a href="https://2017.pentestit.ru/" target="blank"><img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/pttconru.jpg" title="Pentestit Security Conference 2017" alt="Pentestit Security Conference 2017"></a>
           </header>
            <figure class="search">
               <p>&nbsp;</p>
            </figure>
		<header class="logo">
<a href="https://www.pentestit.ru/labs/corp-lab" target="blank"><img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/learn.jpg" title="Корпоративные лаборатории Pentestit" alt="Корпоративные лаборатории Pentestit"></a>
           </header>
            <figure class="search">
               <p>&nbsp;</p>
            </figure>

	<header class="logo">
<a href="https://lab.pentestit.ru/" target="blank"><img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/TL11_ru.jpg" title="Penetration test lab v.11" alt="Penetration test lab v.11"></a>
           </header>
            <figure class="search">
               <p>&nbsp;</p>
            </figure>


            <figure class="topExpert hidden-xs">
                <div class="topExpert-menu-title">
                    <div class="menu-item_borderBottom_color">Топ 10 авторов</div>
                </div>

                <ul class="topExpert-menu ">
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/abychutkin" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/owasp.jpg" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">1</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">abychutkin</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/luka" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/5Jknm6gA.jpg" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">2</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">Luka Safonov</span>
                                             <!-- <span class="topExpert-menu-item-info-job">infromation security, penetration testing</span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/div" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/69f4d447fc2762f4b09f958fece2f6a1.jpg" srcset="https://secure.gravatar.com/avatar/69f4d447fc2762f4b09f958fece2f6a1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">3</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">div</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/lexadin" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/a3736dcf188409787fc87f6d97b0718f.jpg" srcset="https://secure.gravatar.com/avatar/a3736dcf188409787fc87f6d97b0718f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">4</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">lexadin</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/romanovroman" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/BODMyVzwJ1Y.jpg" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">5</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">Romanov Roman</span>
                                             <!-- <span class="topExpert-menu-item-info-job">CEO, Pentestit</span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/antgorka" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/5d6fd273fcd167bd5079436c2e451345.jpg" srcset="https://secure.gravatar.com/avatar/5d6fd273fcd167bd5079436c2e451345?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">6</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">antgorka</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/unknd" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/5c5754556da1be6398f5f6f78bd2d545.jpg" srcset="https://secure.gravatar.com/avatar/5c5754556da1be6398f5f6f78bd2d545?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">7</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">unknd</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/akhudyshkin" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/KeePass_Icone_Lollipop_1280x1280.png" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">8</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">akhudyshkin</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/sinister" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/white_hat1.png" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">9</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">sinister</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                            <li class="topExpert-menu-item clearfix">
                            <a href="https://defcon.ru/profile/st0l0s" title="Профиль">
                                <div class="authors-top10">
                                    <div class="profile-info">
                                        <div class="topExpert-menu-item-img">
                                           <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/78026ddc0fa98db66ee2f219fd1656a2.jpg" srcset="https://secure.gravatar.com/avatar/78026ddc0fa98db66ee2f219fd1656a2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 gravatar" width="40" height="40">                                            <div class="topExpert-menu-item-number">10</div>
                                        </div>
                                        <div class="topExpert-menu-item-info">
                                            <span class="topExpert-menu-item-info-name">st0l0s</span>
                                             <!-- <span class="topExpert-menu-item-info-job"></span> -->
                                        </div>
                                    </div>
                                    <div class="topExpert-menu-more">
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </div>
                                </div>
                            </a>
                        </li>
                                    </ul>

                <!-- <button type="button" class="top-50-btn">Смотреть ТОП 50</button> -->
            </figure>


            <figure class="popular hidden-xs">
                <div class="popular-menu-title">
                    <div class="menu-item_borderBottom_color">Последние</div>
                </div>
                <ul class="popular-menu">
                        <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/wireless-security/4716/">Введение в Osmocom</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/network-security/4672/">DeathStar: Автоматизация тестирования на проникновение Active Directory</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/web-security/4665/">Перевод OWASP Testing Guide. Часть 3.5.</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/network-security/4631/">Обзор платформы Exploit Pack</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/penetration-testing/4501/">The Bug Hunters Methodology. Часть 2, 3.</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/infosec-news/4556/">Kali Linux 2017.1</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/web-security/4544/">Использование SQLMap</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/network-security/4520/">Port Scan Attack Detector (PSAD)</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/web-security/4460/">BeEF - The Browser Exploitation Framework Project</a> </li> <li class="popular-menu-item row_margin-null popular-menu-item_margin-top_big"><a href="https://defcon.ru/web-security/4422/">The Bug Hunters Methodology. Введение. Часть 1.</a> </li>                 </ul>
            </figure>
        </div>

            <figure class="search">
               <p>&nbsp;</p>
            </figure>
		<header class="hidden-xs">
<a href="https://itunes.apple.com/us/app/defconru-soobsestvo-specialistov/id1110648768" target="blank"><img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/apple.png" title="" alt=""></a>
<br>
<a href="https://play.google.com/store/apps/details?id=co.givemeapp.defconru" target="blank"><img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/google.png" title="" alt=""></a>
           </header>
            <figure class="search">
               <p>&nbsp;</p>
            </figure>



    </nav>

    <div class="wrapper-content col-sm-7 col-xs-12">

        <div class="row_margin-null row_margin-null_border-bottom topics_padding_margin hidden-xs">
			<!-- Navigation -->
			<nav id="navigationh">
					<ul id="menu-pentestith" class="ptmenuheader"><li id="menu-item-1613" class="topics-menu-title menu-item menu-item-type-post_type menu-item-object-page menu-item-1613"><a title="DefconRU правила" href="https://defcon.ru/rules/">Правила</a></li>
<li id="menu-item-1617" class="topics-menu-title menu-item menu-item-type-custom menu-item-object-custom menu-item-1617"><a title="DefconRU опубликовать" href="https://defcon.ru/wp-admin/post-new.php">Опубликовать</a></li>
</ul>			</nav>
			<!-- /Navigation -->

<!--
            <ul class="topics-menu">
                <li class="topics-menu__item topics-menu__item-all topics-menu__item_current">
                    <a href="https://defcon.ru/">Все  <span class="badge topic-menu__badge hidden">135</span> </a>
                </li>

                </li>
              

 		<li class="topics-menu__item topics-menu__item-all topics-menu__item_current">
                        <a href="/rules" target="_blank"><strong>Правила</strong></a>
                </li>
                <li class="topics-menu__item topics-menu__item-all">
                                <li class="topics-menu__item topics-menu__item-best">
                    <a href="">Лучшие <span class="badge topic-menu__badge hidden">155</span></a>
                </li>
                <li class="topics-menu__item topics-menu__item-new">
                    <a href="">Новые <span class="badge topic-menu__badge hidden">654</span></a>
                </li>
            </ul>
-->
                        <div class="topics-menu__item-author">
                                        <div class="topics-menu__item-author__more">
                            <a href="https://defcon.ru/login/" title="Войти на сайт">Войти на сайт <span class="glyphicon glyphicon-log-in"></span></a>
                        </div>
                        
            </div>

        </div>


        <!-- <div class="sorting-types">
            <p class="sorting-types-item">Сортировать по:</p>
            <ul class="sorting-types-menu">
                <li class="sorting-types-menu-item sorting-types-menu-item_current">
                    <a href="">дате </a><span class="glyphicon glyphicon-chevron-down glyphicon_top_up hidden" aria-hidden="true"></span>
                </li>
                <li class="sorting-types-menu-item"><a href="">обсуждаемости</a><span class="glyphicon glyphicon-chevron-down glyphicon_top_up hidden" aria-hidden="true"></span></li>
                <li class="sorting-types-menu-item"><a href="">актуальности</a><span class="glyphicon glyphicon-chevron-down glyphicon_top_up hidden" aria-hidden="true"></span></li>
            </ul>
        </div>
        -->

	<!-- <div id="primary" class="content-area">
		<div id="content" class="site-content" role="main"> -->
			                    <style>
                        .article-info__read-more {
                            display: none;
                        }
                        .article-info-menu {
                            float: left;
                            width: 100%;
                        }
                        .article-title > a {
                            color: #598fc6;
                            border-left: none;
                            padding-left: 12px;
                        }
                        .comment-list {
                            list-style: none;
                            padding-left: 0px;
                            margin-left: 0px;
                            margin-top: 22px;
                        }
                        .comment-list .children {
                            list-style: none;
                        }
                        .comments-title {
                            font-size: 18px;
                            color: #598fc6;
                            border-bottom: 1px solid #f7f9f8;
                            padding-bottom: 10px;
                        }
                        .comment-author.vcard {
                            float: left;
                        }
                        .comment_author_name {
                            color: #598fc6;
                        }
                        .says {
                            color: #767a7c;
                            padding-right: 5px;
                        }
                        .comment-meta.commentmetadata > a {
                            color: #598fc6;

                        }
                        .comment-meta.commentmetadata {
                            padding-top: 2px;
                        }
                        .comment-body {
                            padding-bottom: 20px;
                        }
                    </style>
                    <article id="post-1264" class="article">
    <div style="margin-bottom: 20px;" class="article-title"> <span class="entry-date"><time class="entry-date" datetime="22.08.2015 @ 15:16">22.08.2015 @ 15:16</time></span> <a href="https://defcon.ru/os-security/1264/">Знакомимся с SELINUX и пытаемся понять, почему Дэн Уолш плачет</a> <!-- <br /> -->
<div class="titlebreak"></div>
<span class="tag-links"><a href="https://defcon.ru/tag/avc/" rel="tag">avc</a>, <a href="https://defcon.ru/tag/centos/" rel="tag">centos</a>, <a href="https://defcon.ru/tag/dan-walsh/" rel="tag">dan walsh</a>, <a href="https://defcon.ru/tag/mcs/" rel="tag">mcs</a>, <a href="https://defcon.ru/tag/mls/" rel="tag">mls</a>, <a href="https://defcon.ru/tag/nsa/" rel="tag">nsa</a>, <a href="https://defcon.ru/tag/security-enhanced/" rel="tag">security enhanced</a>, <a href="https://defcon.ru/tag/selinux/" rel="tag">selinux</a>, <a href="https://defcon.ru/tag/targerted-policy/" rel="tag">targerted policy</a>, <a href="https://defcon.ru/tag/type-enforcement/" rel="tag">type enforcement</a>, <a href="https://defcon.ru/tag/zabbix/" rel="tag">zabbix</a>, <a href="https://defcon.ru/tag/%d0%bf%d0%bb%d0%b0%d0%ba%d1%81%d0%b0/" rel="tag">плакса</a></span></div>
    <br>

	<div class="post-thumbnail">
	<img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/se_logo-e1440245747445.png" class="attachment-twentyfourteen-full-width size-twentyfourteen-full-width wp-post-image" alt="" width="300" height="100">	</div>

	    <div class="article-text">
                    <div class="entry-content">
                <p>&nbsp;</p>
<p style="text-align: justify;">
</p><p style="text-align: right;"><em>“Каждый раз, выполняя команду setenforce 0, Вы заставляете <a href="http://danwalsh.livejournal.com/">Дэна Уолша</a> плакать.</em></p>
<p style="text-align: right;"><em> Дэн отличный парень и, конечно же, не заслуживает этого.”</em></p>
<p style="text-align: right;"><a href="http://stopdisablingselinux.com/">http://stopdisablingselinux.com/</a></p>
<p style="text-align: justify;"><a href="http://www.haifux.org/lectures/200/selinux.pdf">Есть мнение</a>,
 что SELinux это машина, главная и единственная задача которой на всякое
 действие пользователя отвечать «Permission denied». Для многих 
системных администраторов знакомство с ней начинается с получения 
первого подобного «непонятного» сообщения об отказе в доступе и 
заканчивается через 5 минут строкой SELINUX=disabled в 
/etc/selinux/config.</p>
<p style="text-align: justify;"><span id="more-1264"></span></p>
<p style="text-align: justify;">Как и любой другой серьезный инструмент 
Security Enhanced Linux наскоком не освоишь. Для того, чтобы научиться с
 ним эффективно работать, необходимо много практиковаться и вдумчиво 
читать документацию. Наверно, в этом и заключается главная причина, 
почему каждое второе руководство в сети по настройке какого-либо сервиса
 начинается со слов «Отключаем SELinux….». Однако, если на его изучение 
потратить <del>лучшие годы своей жизни</del> немного времени, станет понятно, что&nbsp;<del>нет так страшен черт, как его малют</del>
 SELinux прозрачный и интуитивно понятный механизм разграничения 
доступа. Поэтому, прежде чем бездумно отключать SELinux, давайте 
разберемся, откуда он вообще взялся, что за люди за ним стоят, как он 
работает и какой профит от него можно получить. А в качестве бонуса 
рассмотрим пару примеров и посмотрим, что можно сделать, когда «<a href="http://bash.im/quote/268537">ваша программа опять не работае</a>т» из-за этого SELinux’а.</p>
<p style="text-align: justify;">Не обещаю, что после прочтения статьи Вы
 станете мастером кунг-фу по написанию политик SELinux, и постигните 
дзен, настраивая MLS. Однако я надеюсь, что мне удастся Вас 
заинтересовать и эта статья – лишь первый шаг на пути познания этого, 
без преувеличения, мощного инструмента.</p>
<p style="text-align: justify;">О целевых политиках, контекстах 
безопасности, MLS, IAD, TE, NSA и куче других пока что не совсем 
понятных терминах далее в этой статье. Букв получилось много.</p>
<h2 style="text-align: justify;"></h2>
<h1><span style="color: #000000;">Прежде чем изучать устройство SELinux, давайте окунемся в историю и посмотрим, с чего все началось.</span></h1>
<p style="text-align: justify;">Наверняка многие из уважаемых читателей в курсе, что SELinux <a href="https://www.nsa.gov/research/selinux/background.shtml">начинался как проект</a> одной очень могущественной конторы с распиаренным в последние годы СМИ названием <a href="https://www.nsa.gov/">National Security Agency</a>
 (NSA, Агентство национальной Безопасности). Работы над технологией, 
которая сегодня известна как Security Enhanced Linux (SELinux или Linux с
 улучшенной безопасностью), начались в начале девяностых годов прошлого 
века в одном из подразделений NSA, которое носит название <a href="https://www.nsa.gov/ia/ia_at_nsa/index.shtml">Information Assurance Directorate</a>
 (IAD). Если коротко, основная задача IAD – обеспечение безопасности 
правительственных информационных систем и других, обрабатывающих 
секретную информацию или любую другую критичную для военной и 
разведывательной деятельности. Чтобы эффективно защищать информацию в 
системах такого уровня, жизненно важно всегда быть хотя бы на полшажочка
 впереди вероятного противника, постоянно совершенствовать технологии 
защиты и вести активную научно-исследовательскую деятельность. Для этих 
целей в составе IAD существует <a href="https://www.nsa.gov/research/ia_research/">Trusted Systems Research Group</a>&nbsp; – главный научный центр NSA, в компетенции которого исследование<a href="https://www.nsa.gov/research/ia_research/research_areas/index.shtml"> разнообразных проблем, связанных с ИБ</a>, в том числе и разработка архитектур защищенных информационных систем. Именно специалисты этого центра совестно с <a href="https://en.wikipedia.org/wiki/Secure_Computing_Corporation">Secure Computing Corporation</a>, <a href="https://en.wikipedia.org/wiki/Trusted_Information_Systems">NAI Labs</a> (обе компании — военные подрядчики, купленные в 2002-2003 годах компанией McAfee, ныне подразделение Intel Security Group) и <a href="https://en.wikipedia.org/wiki/Mitre_Corporation">MITRE Corporation</a>
 (не путать с Mitre Sports International, производителем футбольных 
товаров :) ) приступили к реализации нескольких научно-исследовательских
 проектов, призванных заполнить дыры безопасности существующего 
программного и аппаратного обеспечения. Основная идея всех этих проектов
 заключалась в создании сильного и гибкого механизма разграничения 
доступа к информации на уровне ядра ОС.</p>
<p style="text-align: justify;">Первым результатом труда исследователей стала полуисследовательская-полувоенная ОС<a href="https://www.usenix.org/conference/usenix-mach-symposium/distributed-trusted-mach-architecture"> Distributed Trusted Mach</a> (DTMach), отпрыск проектов <a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=113334">Trusted Mach</a> (TMatch) и <a href="http://cryptosmith.com/mls/lock/">LOgical Coprocessing Kernel</a> (LOCK). Эти системы разрабатывались в конце 80-ых годов и были призваны обеспечить соответствие требованиям, изложенным в<a href="http://csrc.nist.gov/publications/secpubs/rainbow/std001.txt"> Trusted Computer System Evaluation Criteria</a>, более известного во всем мире как «<a href="https://ru.wikipedia.org/wiki/%D0%9A%D1%80%D0%B8%D1%82%D0%B5%D1%80%D0%B8%D0%B8_%D0%BE%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F_%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D1%8B%D1%85_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC">Оранжевая книга</a>».</p>
<p style="text-align: justify;">За проектом DTMach NSA приступило к реализации масштабной программы под названием «<a href="https://www.cs.utah.edu/flux/fluke/html/dtos/HTML/summary.html">Synergy</a>».</p>
<p style="text-align: justify;">В рамках этой программы для новой 
архитектуры безопасности были составлены формальные спецификации 
системы, проведен анализ применяемых и потенциально применимых политик 
безопасности, а также была исследована возможность использования нового 
механизма разграничения доступа с различными ОС на базе микроядерной 
архитектуры. Практический результат исследований вылился в проект <a href="http://www.cs.utah.edu/flux/fluke/html/dtos/HTML/dtos.html">Distributed Trusted Operating System</a>
 (DTOS). Прототип этой ОС был предоставлен различным правительственным 
организациям и университетам для тестирования и проведения новых 
исследований.</p>
<p style="text-align: justify;">После закрытия программы «Synergy», NSA, SCC и <a href="http://www.utah.edu/">Университет штата Юта</a> приступили к переносу архитектуры безопасности DTOS в исследовательскую ОС <a href="https://www.cs.utah.edu/flux/fluke/html/">Fluke</a>.
 Новый проект получил название Flux. Оригинальная архитектура системы 
безопасности, реализуемая в DTOS, была доработана, что позволило 
обеспечить улучшенную поддержку динамических политик безопасности. Новая
 архитектура получила название <a href="http://www.cs.utah.edu/flux/fluke/html/flask.html">Flux Advanced Security Kernel</a> (<strong>FLASK</strong>).</p>
<p style="text-align: justify;">Работы по внедрению FLASK в ядро Linux 
начались в начале двухтысячных. К этому моменту все наработки по 
проекту, в т.ч. исходные коды под лицензией GPL, стали доступны 
opensource-сообществу, а к разработке системы подключились такие 
компании, как RedHat, Tresys Technology, HP, IBM <a href="https://www.nsa.gov/research/selinux/contrib.shtml">и другие</a>.</p>
<p style="text-align: justify;">Первая реализация архитектуры FLASK для 
ядра Linux, получившая название Security Enhanced Linux, предназначалась
 для версии 2.4.x и была выпущена в виде наборов исправлений (патчей). В
 2001 году на конференции «Linux Kernel Summit» NSA выступило с 
предложением включить SELinux в ядро 2.5.x в том виде, в котором она 
была реализована на тот момент. Однако Линус Торвальдс, поддерживаемый 
opensource-сообществом, высказался против такой «захардкоженной» 
реализации SELinux в ядре, поскольку она исключала возможность 
использования других схожих по функциональности с SELinux проектов, 
разработка которых велась параллельно. Вместо принятия подхода «в лоб», 
было решено использовать некий универсальный интерфейс, который 
позволяет реализовывать модели безопасности в виде загружаемых модулей.</p>
<p style="text-align: justify;">К концу 2003 года такой фреймворк был разработан.<a href="https://www.nsa.gov/research/_files/selinux/papers/module/x45.shtml"> Linux Security Modules</a>
 (такое название он получил) был включен в mainstream-ветку Linux и стал
 неотъемлемым компонентом ядра начиная с версии 2.6.x, привнеся вместе с
 собой возможность использования SELinux, как подключаемого модуля 
безопасности. К слову, благодаря LSM, не потерялись и альтернативные 
разработки — <a href="https://ru.wikipedia.org/wiki/AppArmor">AppArmor</a>, <a href="https://ru.wikipedia.org/wiki/TOMOYO_Linux">Tomoyo</a> и <a href="https://en.wikipedia.org/wiki/Smack_%28software%29">Smack</a>.</p>
<p style="text-align: justify;">На данный момент поддержка SELinux 
включена в десятки дистрибутивов. И да, эта разработка не обошла 
стороной и последние версии Android (&gt;=4.3), так что с уверенностью 
можно сказать, что SELinux обрел заслуженную популярность и оставлять 
без внимания такую фичу специалисту по ИБ – непозволительная роскошь.</p>
<p style="text-align: justify;">Так что, ребята, серьезно! Прекращайте отключать SELinux!</p>
<h1 style="text-align: justify;"><span style="color: #000000;">Почему вдруг дядьки из NSA решили, что «теплых ламповых» юниксовых триплетов недостаточно, чтобы считать систему «безопасной»?</span></h1>
<p style="text-align: justify;">Как известно, «традиционная» модель разграничения доступа в Linux основана на <a href="https://ru.wikipedia.org/wiki/%D0%98%D0%B7%D0%B1%D0%B8%D1%80%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BE%D0%BC">DAC</a>
 (discretional access control, избирательное (дискреционное или 
матричное) управление доступом) и в очень редких случаях на ACL (access 
control lists). В ней, фактически, реализованы только два уровня доступа
 – суперпользователь (root) и пользователь. Эта модель предполагает, что
 любая программа, запускаемая пользователем, наследует все его 
разрешения. Из-за такого поведения процесс получает огромный довесок в 
виде «лишних» прав. Из-за этой особенности многие системные службы и 
программы выполняются с явно завышенными полномочиями, и ошибка в любой 
из этих программ может быть использована для получения 
несанкционированного доступа к системе. Соблюсти принцип минимизации 
привилегий с таким подходом очень проблематично.</p>
<p style="text-align: justify;">SELinux как раз тот механизм, который 
призван гибко ограничивать права пользователей и процессов на уровне 
ядра ОС, наделяя их только жизненно-необходимыми полномочиями. И если 
при традиционной модели каждый пользователь, как правило, имеет полную 
свободу действий над своими файлами, и, в общем-то, ничто, кроме 
здравого смысла, не помешает ему выполнить что-то типа chmod 777 id_rsa,
 то при использовании SELinux можно сделать так, чтобы такой трюк не 
сработал.</p>
<p style="text-align: justify;">Стоит упомянуть, что SELinux <strong>дополняет</strong> существующие механизмы (политики SELinux всегда проверяются только после проверки традиционных DAC-прав).</p>
<p style="text-align: justify;">При грамотной настройке SELinux способен:</p>
<ul>
<li style="text-align: justify;">снизить риски, возникающие вследствие допущенных ошибок в коде или ошибок конфигурации,</li>
<li style="text-align: justify;">эффективно ограничить скомпрометированный процесс, не предоставив злоумышленнику необходимых прав для, допустим, <a href="https://www.offensive-security.com/metasploit-unleashed/pivoting/">pivoting’а</a>.</li>
<li style="text-align: justify;">как минимум запротоколировать несанкционированный доступ, а то и вовсе <a href="http://www.networkworld.com/article/2283723/lan-wan/a-seatbelt-for-server-software--selinux-blocks-real-world-exploits.html">защитить систему от реальных эксплойтов</a>, используемых «on-the-wild».</li>
</ul>
<p style="text-align: justify;">Необходимо понимать, что Security 
Enhanced Linux это не all-in-one решение и он не заменит сильные пароли,
 межсетевые экраны, антивирусы и не избавит от необходимости регулярно 
обновлять ПО.</p>
<h1 style="text-align: justify;"><span style="color: #000000;">Интересно. И как же эта штука работает?</span></h1>
<p style="text-align: justify;">Для того, чтобы лучше понять, <a href="http://www.ibm.com/developerworks/library/l-secure-linux-ru/">как SELinux работает</a> и что происходит, когда процесс или пользователь обращается к файлу, давайте внимательно взглянем на схему:</p>
<p style="text-align: justify;"><a href="https://defcon.ru/wp-content/uploads/2015/08/selinux_arch.png" class="lightbox"><img class="alignleft wp-image-1281 size-full" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/selinux_arch.png" alt="Архитектура FLASK в Linux" srcset="https://defcon.ru/wp-content/uploads/2015/08/selinux_arch.png 550w, https://defcon.ru/wp-content/uploads/2015/08/selinux_arch-300x164.png 300w" sizes="(max-width: 550px) 100vw, 550px" width="550" height="300"></a></p>
<p style="text-align: justify;">Первым делом проверяются «традиционные» 
DAC-права, и если с ними все в порядке, то в бой вступают хуки LSM. 
Перехватчик событий LSM отлавливает <strong>все </strong>обращения субъектов к объектам системы и вместе с контекстом безопасности передает их SELinux.</p>
<p style="text-align: justify;">Решение о предоставлении или запрете 
доступа принимает Policy Enforcement Server (сервер реализации политики 
безопасности). Для этого он сначала обращается к подсистеме Access 
Vector Cache (AVC), которая кэширует наиболее часто используемые 
политики.</p>
<p style="text-align: justify;">Если необходимое решение отсутствует в 
кэше, то запрос необходимой политики перенаправляется дальше — в базу 
данных политик безопасности.</p>
<p style="text-align: justify;">Найденная политика безопасности 
кэшируется в AVC и передается Policy Enforcement Server. Если 
запрашиваемое действие удовлетворяет требованиям найденной политики, то 
доступ разрешается. В противном случае сервер реализации политики 
запрещает доступ, а вся информация записывается в log-файл SELinux (если
 в политиках явно не указано «dontaudit»).</p>
<p style="text-align: justify;">Помимо принятия решений о предоставлении
 или запрете доступа, Policy Enforcement Server отвечает также за 
управление метками безопасности (назначение и удаление).</p>
<p style="text-align: justify;">Ничего сложного. И даже не верится, что к реализации этой архитектуры шли пару десятилетий :).</p>
<h1 style="text-align: justify;"><span style="color: #000000;">Метки, метки и… RBAC.</span></h1>
<p style="text-align: justify;">В теории компьютерной безопасности есть такое понятие как Mandatory Access Control (MAC) — <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D0%BD%D0%B4%D0%B0%D1%82%D0%BD%D0%BE%D0%B5_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BE%D0%BC">принудительное (мандатное) управление доступом</a>.
 Если не сильно углубляться в теорию и постараться избежать научных и 
околонаучных терминов, то MAC можно охарактеризовать тем, что всем 
субъектам и объектам системы сопоставлены метки безопасности. На 
основании этих меток субъекты системы получают (или не получают) доступ к
 объектам. Метка субъекта описывает его благонадежность, а метка объекта
 — степень закрытости содержащейся в нем информации. <strong>Субъект</strong> – то, что выполняет какие-либо действия над чем-либо (например, пользователи или процессы). <strong>Объект</strong> – то, над чем выполняются действия (файлы, порты, сокеты, fifo и т.д.).</p>
<p style="text-align: justify;">SELinux — это как раз реализация MAC. Несмотря на то, что для него характерны некоторые черты RBAC (Role-based access control, <a href="https://ru.wikipedia.org/wiki/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BE%D0%BC_%D0%BD%D0%B0_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%B5_%D1%80%D0%BE%D0%BB%D0%B5%D0%B9">Управление доступом на основе ролей</a>), ключевое понятие – <strong>метки</strong>. И всё в SELinux крутится вокруг <strong>меток</strong>.</p>
<p style="text-align: justify;">В Security Enhanced Linux механизм мандатного управления доступом <a href="http://selinuxproject.org/page/NB_MAC">реализован в виде двух форм</a>, если можно так выразиться:</p>
<ul>
<li style="text-align: justify;"><a href="http://selinuxproject.org/page/NB_MLS">MLS </a>(Multi-Level Security, многоуровневая система безопасности) / MCS (Multi Categories Security, мультикатегорийная безопасность)</li>
<li style="text-align: justify;"><a href="http://www.cs.utah.edu/flux/fluke/html/te.html">TE </a>(Type Enforcement, принудительная типизация доступа)</li>
</ul>
<h2 style="text-align: justify;"><em>MLS (Multi-Level Security) / MCS (Multi-Category Security)</em></h2>
<p style="text-align: justify;">В этом режиме SELinux базируется на <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D0%B5%D0%BB%D1%8C_%D0%91%D0%B5%D0%BB%D0%BB%D0%B0_%E2%80%94_%D0%9B%D0%B0%D0%BF%D0%B0%D0%B4%D1%83%D0%BB%D1%8B">формальной модели Белла-Лападулы</a>.
 Эта модель основана на двух принципах и ее можно описать следующим 
словосочетанием: «нет записи вниз, нет чтения вверх» («no write down, no
 read up»). Субъект с уровнем допуска «Секретно» может получить доступ к
 объекту с таким же уровнем секретности или ниже. Попытка получения 
доступа к объекту с меткой «Совершенно секретно» будет отвергнута 
системой (принцип «no read up»). Субъект также не сможет записать в 
объект (или создать объект), имеющий уровень допуска ниже своего 
собственного. Этот принцип носит название «no write down» и его цель 
состоит в том, чтобы субъект, являясь владельцем какого-либо секрета, 
случайно (или преднамеренно) не записал его в объект с меткой, допустим,
 «Для служебного пользования». Эти два принципа реализуют так называемый
 вертикальный уровень контроля. Кроме того, каждый уровень секретности 
может быть разбит еще и на категории – горизонтальный уровень. Т.е. 
совершенно не обязательно, что субъект, имеющий допуск к одной категории
 на уровне «Секретно», получит допуск ко всем остальным. Если в системе 
существует только один вертикальный уровень контроля, то в таком случае 
говорят о мультикатегорийной безопасности (MCS).</p>
<p><a href="https://defcon.ru/wp-content/uploads/2015/08/mls_mcs.png" class="lightbox"><img class="alignleft wp-image-1294 size-full" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/mls_mcs.png" alt="Многоуровневая система безопасности и мультикатегорийная безопасность в SELinux" srcset="https://defcon.ru/wp-content/uploads/2015/08/mls_mcs.png 550w, https://defcon.ru/wp-content/uploads/2015/08/mls_mcs-300x164.png 300w" sizes="(max-width: 550px) 100vw, 550px" width="550" height="300"></a></p>
<p style="text-align: justify;">Как можно понять из описания, политика, 
основанная на MLS, мягко говоря, неприменима к большинству «гражданских»
 систем. Зачем MLS может понадобиться домашнему пользователю, я вообще 
ума не приложу. Она требует серьезной проработки на бумаге, а все 
административные решения о предоставлении или запрете доступа принимает,
 как правило, одно ответственное лицо – офицер по безопасности (security
 officer). Несложно догадаться, что основные потребители всего этого 
добра не веб-серверы в облаках, а военные, государственные и прочие 
режимные объекты (то есть не зря АНБ и компания корячились над 
технологией столько лет). И именно поэтому MLS в SELinux максимально 
точно соответствует «эталонному» определению MAC в <a href="http://csrc.nist.gov/publications/secpubs/rainbow/std001.txt">TCSEC</a>.</p>
<p style="text-align: justify;">Нет, я не говорю, что MLS не заслуживает
 внимания обычных пользователей, просто на первых порах достаточно 
знаний о том, что MLS вообще существует, а знакомство с SELinux лучше 
начать всё-таки, с основанных на Type Enforcement политиках, которые 
можно и нужно применять на боевых VPSках в мирное время.</p>
<h2><em>Type Enforcement (TE)</em></h2>
<p style="text-align: justify;">Как говорит нам Wikipedia — <a href="https://en.wikipedia.org/wiki/Type_enforcement">TE является первым шагом на пути к MLS</a>. В TE каждый субъект и объект системы, так же, как и в MLS ассоциируется с меткой. Такая метка получила общепринятое название <strong>контекст безопасности (</strong><strong>context</strong><strong>)</strong>
 – строка переменной длины, которая хранится в расширенных атрибутах 
файловой системы. В контексте безопасности для нас первостепенный 
интерес представляют два поля – <strong>домен (</strong><strong>domain</strong><strong>) </strong>для субъектов и <strong>тип (</strong><strong>type</strong><strong>) </strong>для объектов. <strong>Домен</strong> – это перечень того, что процессы могут делать или какие действия процесс может выполнять над различными объектами. <strong>Тип</strong> – атрибут объекта, он определяет, кто может получить к нему доступ.</p>
<p style="text-align: justify;">Вместо использования уровней секретности
 и категорий, как это сделано в MLS, в TE решение о предоставлении или 
запрете доступа принимается на основании правил (политик), которые 
определены для каждой пары домен-тип или домен-домен. По своей сути 
домен и тип равнозначные понятия и единственное отличие в них в том, что
 наименование <strong>домен</strong> используется для субъектов, а <strong>тип — </strong>для объектов.</p>
<p style="text-align: justify;"><em>Небольшое лирическое отступление. Если отталкиваться от «эталонного» определения </em><em>MAC</em><em> из Оранжевой книги, </em><em>Type</em> <em>Enforcement</em><em> это скорее </em><em>fine</em><em>—</em><em>grained</em><em> (гибкий) </em><em>DAC</em><em>. В </em><em>Type Enforcement</em> базу данных<em> политик безопасности можно сравнить с классической матрицей, используемой в «традиционном» </em><em>DAC</em><em>. И главное преимущество </em><em>TE</em> <em>над классическим </em><em>DAC</em><em> не в том, что </em><em>TE</em> <em>– это «почти что» </em><em>MAC</em><em>, а в том, что </em><em>TE</em> <em>использует гораздо большее количество критериев при управлении доступом. Однако, так как&nbsp;</em><a href="http://selinuxproject.org/page/Main_Page"><em>SELinux Wiki</em></a><em> считает принудительную типизацию доступа <a href="http://selinuxproject.org/page/NB_MAC">одной из форм </a></em><a href="http://selinuxproject.org/page/NB_MAC"><em>MAC</em></a><em>, поэтому и мы можем себе позволить считать также. :)<br>
</em></p>
<h1><span style="color: #000000;">Потихоньку приступаем к знакомству на практике</span></h1>
<p style="text-align: justify;">RedHat, Centos, Fedora, Hardered Gentoo,
 Hardered Ubuntu, ArchLinux, SUSELinux – все эти дистрибутивы могут 
предложить поддержку SELinux из коробки. Какой из дистрибутивов выбрать –
 решать Вам. Я же для экспериментов решил использовать Centos 7.1. 
Минимальная установка, kernel 3.10.0-229.11.1.el7.x86_64, targeted 
policy. Думаю, что для человека, интересующегося SELinux’ом не составит 
особого труда раскатать тот дистрибутив, который ему милее и роднее. 
Рекомендую дополнительно установить пакеты:</p>
<ul>
<li style="text-align: justify;"><em>policycoreutils-python</em> – базовый набор утилит для работы с SELinux</li>
<li style="text-align: justify;"><em>setroubleshoot</em> — инструмент, 
который анализирует сообщения об отказах AVC, сравнивает их со 
значениями в своей базе данных, а затем в удобочитаемом виде выводит 
сообщения об отказе с пояснениями и предлагает возможные варианты 
решения проблемы.</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9077906465064" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# yum install policycoreutils-python setroubleshoot</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9077906465064-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9077906465064-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># yum install policycoreutils-python setroubleshoot</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p style="text-align: justify;">Для начала поближе познакомимся с 
контекстом безопасности и выполним команду ls –Z или ls —context в 
домашнем каталоге пользователя root:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d908f562968874" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# ls --context /root/ 

-rw-r--r--. root root system_u:object_r:admin_home_t:s0 install.log</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d908f562968874-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d908f562968874-2">2</div><div class="crayon-num" data-line="crayon-59464d41d908f562968874-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d908f562968874-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># ls --context /root/ </span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d908f562968874-2">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d908f562968874-3"><span class="crayon-o">-</span><span class="crayon-v">rw</span><span class="crayon-o">-</span><span class="crayon-v">r</span><span class="crayon-o">--</span><span class="crayon-v">r</span><span class="crayon-o">--</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">root </span><span class="crayon-e">root </span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">admin_home_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">install</span><span class="crayon-sy">.</span><span class="crayon-v">log</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p style="text-align: justify;">В этом выводе нас будет интересовать строка <strong>system</strong><strong>_</strong><strong>u</strong><strong>:</strong><strong>object</strong><strong>_</strong><strong>r</strong><strong>:</strong><strong>admin</strong><strong>_</strong><strong>home</strong><strong>_</strong><strong>t</strong><strong>:</strong><strong>s</strong><strong>0. </strong>Эта строка — <strong>контекст безопасности</strong>, в данном случае, для файла install.log. Контекст предоставляет нам информацию о пользователе (<strong>system</strong><strong>_</strong><strong>u</strong>), его роли (<strong>object</strong><strong>_</strong><strong>r</strong>), о типе или домене (<strong>admin</strong><strong>_</strong><strong>home</strong><strong>_</strong><strong>t</strong>) и <strong>уровне</strong> (s0). Для вывода контекста безопасности исполняемых процессов используют утилиту <strong>ps</strong> c параметрами <strong>–eZ</strong>.</p>
<p style="text-align: justify;">Рассмотрим каждую составляющую контекста безопасности подробнее.</p>
<p style="text-align: justify;"><strong>Пользователь</strong> – 
идентификатор, на основании которого SELinux разрешает или запрещает 
вхождение в какие-либо роли. Для получения информации о пользователях 
SELinux, и тем, как они соотносятся с пользователями Linux, 
воспользуемся утилитой semanage из пакета policycoreutils-python:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9096169531614" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; z-index: 4; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# semanage login -l</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9096169531614-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9096169531614-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># semanage login -l</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;">В Centos7.1 по умолчанию все пользователи никак не ограничены:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d909a810265625" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; z-index: 4; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# id -Z
unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d909a810265625-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d909a810265625-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d909a810265625-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># id -Z</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d909a810265625-2"><span class="crayon-v">unconfined_u</span><span class="crayon-o">:</span><span class="crayon-v">unconfined_r</span><span class="crayon-o">:</span><span class="crayon-v">unconfined_t</span><span class="crayon-o">:</span><span class="crayon-v">s0</span><span class="crayon-o">-</span><span class="crayon-v">s0</span><span class="crayon-o">:</span><span class="crayon-v">c0</span><span class="crayon-sy">.</span><span class="crayon-v">c1023</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p style="text-align: justify;">Этот контекст безопасности показывает, 
что текущий пользователь (в данном случае root) соотнесен с 
неограниченным SELinux-пользователем unconfined_u, которому 
соответствуют неограниченные роль unconfined_r и&nbsp; домен 
unconfined_t. И хотя пользователь работает неограниченно, приложение, 
которое он запускает, остаётся ограниченным рамками домена, в котором 
оно выполняется. Еще одной особенностью является то, что при выполнении 
команд su или sudo контекст SELinux-пользователя не меняется.</p>
<p style="text-align: justify;"><strong>Роль</strong> – это атрибут 
RBAC, «промежуточное звено» между пользователем SELinux и доменами. Он 
определяет, в какие домены может входить пользователь. Иными словами: 
роль – это список доменов, которые пользователь имеет право запускать.</p>
<p style="text-align: justify;"><strong>Домен (тип)</strong> – их мы уже описали ранее.</p>
<p style="text-align: justify;"><strong>Уровень</strong> – этот атрибут используется в политиках MLS и MCS, поэтому на первых порах, мы будем делать вид, что его не существует.&nbsp; <strong><br>
</strong></p>
<p>Убедимся в том, что SELinux в вашей системе выполняется:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d909e060276413" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; z-index: 4; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# getenforce</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d909e060276413-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d909e060276413-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># getenforce</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;">В результате команда вернет текущий режим работы:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90a3470513443" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; z-index: 4; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Enforcing</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90a3470513443-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90a3470513443-1"><span class="crayon-v">Enforcing</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p style="text-align: justify;">Всего их три:</p>
<ul>
<li style="text-align: justify;"><strong>Enforcing:</strong> SELinux 
разрешает или запрещает доступ на основании правил политики SELinux. Это
 как раз тот режим, который можно назвать ON/Enabled. В этот режим мы 
переводим систему командой <strong>setenforce 1 </strong>(В этот момент Дэн Уолш торжествует).</li>
<li style="text-align: justify;"><strong>Permissive:</strong> Политики 
SELinux не применяются. Однако система регистрирует все отказы к 
предоставлению доступа, как это было бы в режиме Enforcing. Режим 
используется для отладки. Команда — setenforce 0.</li>
<li style="text-align: justify;"><strong>Disabled:</strong> SELinux 
отключен. Используются только традиционные правила дискреционной модели 
разграничения доступа. Отдельной команды для перевода в этот режим не 
существует. Отключить SELinux можно строкой SELINUX=disabled в 
/etc/selinux/config или в параметры загрузки ядра дописать selinux=0.</li>
</ul>
<p style="text-align: justify;">Более подробную информацию о SELinux предоставляет утилита sestatus:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90a7816870369" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# sestatus

SELinux status:                 enabled   
SELinuxfs mount:               /selinux
Current mode:                   enforcing
Mode from config file:         enforcing
Policy version:                 24
Policy from config file:       targeted</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90a7816870369-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90a7816870369-2">2</div><div class="crayon-num" data-line="crayon-59464d41d90a7816870369-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90a7816870369-4">4</div><div class="crayon-num" data-line="crayon-59464d41d90a7816870369-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90a7816870369-6">6</div><div class="crayon-num" data-line="crayon-59464d41d90a7816870369-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90a7816870369-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90a7816870369-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># sestatus</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90a7816870369-2">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90a7816870369-3"><span class="crayon-e">SELinux </span><span class="crayon-v">status</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">enabled&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90a7816870369-4"><span class="crayon-e">SELinuxfs </span><span class="crayon-v">mount</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">/</span><span class="crayon-e">selinux</span></div><div class="crayon-line" id="crayon-59464d41d90a7816870369-5"><span class="crayon-e">Current </span><span class="crayon-v">mode</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">enforcing</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90a7816870369-6"><span class="crayon-e">Mode </span><span class="crayon-e">from </span><span class="crayon-e">config </span><span class="crayon-v">file</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">enforcing</span></div><div class="crayon-line" id="crayon-59464d41d90a7816870369-7"><span class="crayon-e">Policy </span><span class="crayon-v">version</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">24</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90a7816870369-8"><span class="crayon-e">Policy </span><span class="crayon-e">from </span><span class="crayon-e">config </span><span class="crayon-v">file</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">targeted</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p style="text-align: justify;">В выводе утилиты мы видим, что SELinux 
включен, домашний каталог (точка монтирования) SELinux — /selinux 
Текущий режим – enforcing, режим из конфигурационного файла (применяемый
 при загрузке) также enforcing. В двух последних строчках информация о 
применяемых политиках (версия и наименование).</p>
<p style="text-align: justify;">SELinux позволяет использовать различные
 динамически подгружаемые политики. Как правило, наименование политики 
отражает ее функциональность. В различных дистрибутивах можно встретить 
политики под названиями mls, refpolicy, minimum, targeted (как в нашем 
случае) , strict и другие. Каждая политика основана на одном из режимов 
MAC (MLS, TE) и RBAC или является комбинацией их свойств.</p>
<p style="text-align: justify;">Написание политик для всех сервисов 
системы – задача достаточно объемная и едва ли под силу одному отдельно 
взятому администратору. Поэтому дистрибутивы, поддерживающие SELinux, 
поставляются с предопределенной политикой. Всю рутинную работу 
мэинтейнеры и сообщество сделали за нас, нам остается только довериться 
им и начать использовать SELinux. Если пользователя по какой-либо 
причине не устраивают имеющиеся политики, или дистрибутив не 
поддерживает SELinux, всегда можно воспользоваться <a href="https://github.com/TresysTechnology/refpolicy/wiki">базовыми политиками (reference policy) от Tresys Technology</a>
 и доработать их напильником под свои нужды. Но это уже несколько иной 
уровень мастерства, для начала будем использовать то, что дают.</p>
<p style="text-align: justify;">Для адаптации политик SELinux под конкретную систему можно пойти двумя путями:</p>
<ul>
<li style="text-align: justify;">написать свою, дополненную политику или
 изменить имеющуюся с последующей сборкой и перекомпиляций. Этот вариант
 мы не будем рассматривать, т.к. написание политик – достаточно обширная
 тема и требует отдельной статьи.</li>
<li style="text-align: justify;">использовать изменяемые логические значения –переключатели (booleans)</li>
</ul>
<p style="text-align: justify;">SELinux booleans позволяют изменять 
части политик «на лету», не обладая при этом глубокими познаниями в 
написании политик. Для вывода всех доступных переключателей выполним 
команду:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90ac425641762" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# getsebool –a</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90ac425641762-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90ac425641762-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># getsebool –a</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;">Для вывода списка booleans с описанием того, за что отвечает каждое значение, воспользуемся командой</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90b2662001816" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# semanage boolean –l</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90b2662001816-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90b2662001816-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># semanage boolean –l</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;">По умолчанию, в RHEL-based дистрибутивах используется основанная на TE и RBAC политика <strong>targeted</strong>
 (целевая). Название «целевая» эта политика получила потому, что 
ограничивает только потенциально уязвимые сервисы, при этом доверенные 
выполняются в неограниченном домене unconfined_t и не управляются 
политиками SELinux. Обычно говорят, что процесс выполняется в 
определенном домене или ограничен определенным доменом. Вообще в 
политике targeted центральными понятиями являются домен или тип. 
Пользователи и роли могут использоваться в различных политиках, однако в
 политике targerted&nbsp; при принятии решений о предоставлении или 
отказе&nbsp;SELinux <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/4/html/SELinux_Guide/rhlcommon-section-0047.html"><em>почти</em> не использует ни пользователей, ни ролей</a>. Такой подход, конечно, не удовлетворяет требованиям «Оранжевой книги», однако является отличным вариантом «<a href="http://www.youtube.com/watch?v=MxjenQ31b70" class="lightbox">for mere mortals</a>».</p>
<h1><span style="color: #000000;">Что делать, когда пришла беда и «программа не работает»?</span></h1>
<p style="text-align: justify;">При решении типовых проблем с targeted 
policy в абсолютном большинстве случаев&nbsp; проблема обычно решается 
изменением контекста (типа), конфигурированием переключателей и портов 
служб.</p>
<p style="text-align: justify;">Итак, для теста будем использовать 
Centos 7.1 и Zabbix. Я позволю себе не описывать заурядный процесс 
установки и настройки всего этого дела.</p>
<p style="text-align: justify;">Несмотря на то, что разработчики RHEL 
предусмотрели кучу вариантов использования их системы с различными 
сервисами, из коробки Zabbix-сервер как положено не заработал (и это 
правильное поведение).</p>
<p style="text-align: justify;"><a href="https://defcon.ru/wp-content/uploads/2015/08/selinux_zbx_not_running.png" class="lightbox"><img class="alignleft size-medium wp-image-1300" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/selinux_zbx_not_running-300x79.png" alt="selinux_zbx_not_running" srcset="https://defcon.ru/wp-content/uploads/2015/08/selinux_zbx_not_running-300x79.png 300w, https://defcon.ru/wp-content/uploads/2015/08/selinux_zbx_not_running.png 598w" sizes="(max-width: 300px) 100vw, 300px" width="300" height="79"></a></p>
<p>&nbsp;Неопытный админ «решил» бы эту проблему так:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90b7136202231" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# setenforce 0.</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90b7136202231-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90b7136202231-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># setenforce 0.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;">Немного более опытный, воспользуется другим не менее <strong>не</strong>правильным вариантом и запустит zabbix и httpd в разрешающих доменах (permissive domains):</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90bc977724118" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# semanage permissive -a httpd_t zabbix_t</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90bc977724118-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90bc977724118-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># semanage permissive -a httpd_t zabbix_t</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;">Когда процесс запущен в разрешающем 
домене, SELinux не блокирует доступ, но система регистрирует все отказы к
 предоставлению доступа, как это было бы в режиме Enforcing. Иными 
словами permissive domain это setenforce 0 для отдельно взятого домена. 
Если выбирать из двух зол – выключать SELinux полностью, или выключить 
его только для пары доменов, то второй вариант, конечно, 
предпочтительнее. Однако и в этом случае кое-кто плачет крокодильими 
слезами.</p>
<p style="text-align: justify;">Но мы-то с вами знаем, что Дэн отличный 
парень и&nbsp; не будем его расстраивать. Что же делать? Как обычно, 
первым делом смотрим /var/log/audit/audit.log:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90c0896884862" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]#
 grep "AVC" /var/log/audit/audit.log
type=AVC msg=audit(1439892147.926:266): avc: denied { name_connect } for
 pid=2620 comm="httpd" dest=10051 scontext=system_u:system_r:httpd_t:s0 
tcontext=system_u:object_r:zabbix_port_t:s0 tclass=tcp_socket</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90c0896884862-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90c0896884862-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90c0896884862-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># grep "AVC" /var/log/audit/audit.log</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90c0896884862-2"><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-e">AVC </span><span class="crayon-v">msg</span><span class="crayon-o">=</span><span class="crayon-e">audit</span><span class="crayon-sy">(</span><span class="crayon-cn">1439892147.926</span><span class="crayon-o">:</span><span class="crayon-cn">266</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">avc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">denied</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">_</span>connect<span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">pid</span><span class="crayon-o">=</span><span class="crayon-cn">2620</span><span class="crayon-h"> </span><span class="crayon-v">comm</span><span class="crayon-o">=</span><span class="crayon-s">"httpd"</span><span class="crayon-h"> </span><span class="crayon-v">dest</span><span class="crayon-o">=</span><span class="crayon-cn">10051</span><span class="crayon-h"> </span><span class="crayon-v">scontext</span><span class="crayon-o">=</span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">system_r</span><span class="crayon-o">:</span><span class="crayon-v">httpd_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">tcontext</span><span class="crayon-o">=</span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">zabbix_port_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">tclass</span><span class="crayon-o">=</span><span class="crayon-v">tcp_socket</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>По логам видно, что проблема есть, однако новичку по такому сообщению
 тяжеловато понять, в чем именно она заключается. Т.к. у нас установлен 
setroubleshootd, более подробные сообщения о запрете доступа логируются 
также в /var/log/messages:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90c3580356791" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]#
 grep "SELinux is preventing" /var/log/messages
Aug 18 09:04:47 Centos7.1-playmachine setroubleshoot: SELinux is 
preventing /usr/sbin/httpd from name_connect access on the tcp_socket 
port 10051. For complete SELinux messages. run sealert -l 
8c42f4b4-28e6-452c-b782-5e3fbd233f87</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90c3580356791-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90c3580356791-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90c3580356791-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># grep "SELinux is preventing" /var/log/messages</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90c3580356791-2"><span class="crayon-i">Aug</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-cn">09</span><span class="crayon-o">:</span><span class="crayon-cn">04</span><span class="crayon-o">:</span><span class="crayon-cn">47</span><span class="crayon-h"> </span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-e">playmachine </span><span class="crayon-v">setroubleshoot</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">SELinux </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">preventing</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">sbin</span><span class="crayon-o">/</span><span class="crayon-e">httpd </span><span class="crayon-e">from </span><span class="crayon-e">name_connect </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">tcp_socket </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">10051.</span><span class="crayon-h"> </span><span class="crayon-st">For</span><span class="crayon-h"> </span><span class="crayon-e">complete </span><span class="crayon-e">SELinux </span><span class="crayon-v">messages</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">run </span><span class="crayon-v">sealert</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-cn">8c42f4b4</span><span class="crayon-o">-</span><span class="crayon-cn">28e6</span><span class="crayon-o">-</span><span class="crayon-cn">452c</span><span class="crayon-o">-</span><span class="crayon-v">b782</span><span class="crayon-o">-</span><span class="crayon-cn">5e3fbd233f87</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<p style="text-align: justify;">Чтобы облегчить себе жизнь, 
рекомендуется воспользоваться утилитой sealert. Она используется для 
анализа логов и вывода сообщений об ошибках доступа в удобочитаемом 
виде.</p>
<p>Скормим ей наш audit.log для генерации отчета:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90c8718524480" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# sealert -a /var/log/audit/audit.log</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90c8718524480-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90c8718524480-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># sealert -a /var/log/audit/audit.log</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>[spoiler title=’Отчет sealert’ style=’default’ collapse_link=’true’]</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90cc416027780" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">found 1 alerts in /var/log/audit/audit.log
--------------------------------------------------------------------------------
SELinux is preventing /usr/sbin/httpd from name_connect access on the tcp_socket port 10051.
***** Plugin catchall_boolean (47.5 confidence) suggests   ******************
If you want to allow httpd to can connect zabbix
Then you must tell SELinux about this by enabling the 'httpd_can_connect_zabbix' boolean.

Do

setsebool -P httpd_can_connect_zabbix 1


***** Plugin catchall_boolean (47.5 confidence) suggests   ******************


If you want to allow httpd to can network connect

Then you must tell SELinux about this by enabling the 'httpd_can_network_connect' boolean.


Do

setsebool -P httpd_can_network_connect 1


***** Plugin catchall (6.38 confidence) suggests   **************************


If you believe that httpd should be allowed name_connect access on the port 10051 tcp_socket by default.

Then you should report this as a bug.

You can generate a local policy module to allow this access.

Do

allow this access for now by executing:

# grep httpd /var/log/audit/audit.log | audit2allow -M mypol

# semodule -i mypol.pp</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-2">2</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-4">4</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-6">6</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-8">8</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-10">10</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-12">12</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-14">14</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-16">16</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-18">18</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-20">20</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-22">22</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-24">24</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-26">26</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-28">28</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-30">30</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-32">32</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-34">34</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-36">36</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-38">38</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90cc416027780-40">40</div><div class="crayon-num" data-line="crayon-59464d41d90cc416027780-41">41</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90cc416027780-1"><span class="crayon-i">found</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-e">alerts </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">log</span><span class="crayon-o">/</span><span class="crayon-v">audit</span><span class="crayon-o">/</span><span class="crayon-v">audit</span><span class="crayon-sy">.</span><span class="crayon-v">log</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-2"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">--</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-3"><span class="crayon-e">SELinux </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">preventing</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">sbin</span><span class="crayon-o">/</span><span class="crayon-e">httpd </span><span class="crayon-e">from </span><span class="crayon-e">name_connect </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">tcp_socket </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">10051.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-4"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall_boolean</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">47.5</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-5"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">want </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-e">httpd </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">can </span><span class="crayon-e">connect </span><span class="crayon-e">zabbix</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-6"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">must </span><span class="crayon-e">tell </span><span class="crayon-e">SELinux </span><span class="crayon-e">about </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">by </span><span class="crayon-e">enabling </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-s">'httpd_can_connect_zabbix'</span><span class="crayon-h"> </span><span class="crayon-t">boolean</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-8"><span class="crayon-st">Do</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-10"><span class="crayon-v">setsebool</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">P</span><span class="crayon-h"> </span><span class="crayon-v">httpd_can_connect</span><span class="crayon-sy">_</span>zabbix<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-12">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-13"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall_boolean</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">47.5</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-14">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-16"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">want </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-e">httpd </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">can </span><span class="crayon-e">network </span><span class="crayon-e">connect</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-18"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">must </span><span class="crayon-e">tell </span><span class="crayon-e">SELinux </span><span class="crayon-e">about </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">by </span><span class="crayon-e">enabling </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-s">'httpd_can_network_connect'</span><span class="crayon-h"> </span><span class="crayon-t">boolean</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-20">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-21"><span class="crayon-st">Do</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-22">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-23"><span class="crayon-v">setsebool</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">P</span><span class="crayon-h"> </span><span class="crayon-v">httpd_can_network</span><span class="crayon-sy">_</span>connect<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-24">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-26"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">6.38</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-59464d41d90cc416027780-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-28">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-29"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">believe </span><span class="crayon-e">that </span><span class="crayon-e">httpd </span><span class="crayon-e">should </span><span class="crayon-e">be </span><span class="crayon-e">allowed </span><span class="crayon-e">name_connect </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">10051</span><span class="crayon-h"> </span><span class="crayon-e">tcp_socket </span><span class="crayon-e">by </span><span class="crayon-st">default</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-30">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-31"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">should </span><span class="crayon-e">report </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">bug</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-32">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-33"><span class="crayon-e">You </span><span class="crayon-e">can </span><span class="crayon-i">generate</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">local </span><span class="crayon-e">policy </span><span class="crayon-e">module </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-v">access</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-34">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-35"><span class="crayon-st">Do</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-36">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-37"><span class="crayon-e">allow </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">access </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">now </span><span class="crayon-e">by </span><span class="crayon-v">executing</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-38">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-39"><span class="crayon-p"># grep httpd /var/log/audit/audit.log | audit2allow -M mypol</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90cc416027780-40">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90cc416027780-41"><span class="crayon-p"># semodule -i mypol.pp</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0053 seconds] -->
<p>[/spoiler]</p>
<p>Или скопируем предложенную команду из /var/log/messages:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90d0369028042" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# sealert -l 8c42f4b4-28e6-452c-b782-5e3fbd233f87</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90d0369028042-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90d0369028042-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># sealert -l 8c42f4b4-28e6-452c-b782-5e3fbd233f87</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>[spoiler title=’Отчет sealert’ style=’default’ collapse_link=’true’]</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90d3008441600" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -8.15303px; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: auto;" wrap="soft">SELinux
 is preventing /usr/sbin/httpd from name_connect access on the 
tcp_socket port 10051.


***** Plugin catchall_boolean (47.5 confidence) suggests   
******************


If you want to allow httpd to can connect zabbix

Then you must tell SELinux about this by enabling the 
'httpd_can_connect_zabbix' boolean.

You can read 'None' man page for more details.

Do

setsebool -P httpd_can_connect_zabbix 1


***** Plugin catchall_boolean (47.5 confidence) suggests   
******************


If you want to allow httpd to can network connect

Then you must tell SELinux about this by enabling the 
'httpd_can_network_connect' boolean.

You can read 'None' man page for more details.

Do

setsebool -P httpd_can_network_connect 1


***** Plugin catchall (6.38 confidence) suggests   
**************************


If you believe that httpd should be allowed name_connect access on the 
port 10051 tcp_socket by default.

Then you should report this as a bug.

You can generate a local policy module to allow this access.

Do

allow this access for now by executing:

# grep httpd /var/log/audit/audit.log | audit2allow -M mypol

# semodule -i mypol.pp



Additional Information:

Source Context               system_u:system_r:httpd_t:s0

Target Context               system_u:object_r:zabbix_port_t:s0

Target Objects                port 10051 [ tcp_socket ]

Source                       httpd

Source Path                   /usr/sbin/httpd

Port                         10051

Host                         Centos7-Clear

Source RPM Packages           httpd-2.4.6-31.el7.centos.x86_64

Target RPM Packages

Policy RPM                   selinux-policy-3.13.1-23.el7_1.13.noarch

Selinux Enabled               True

Policy Type                   targeted

Enforcing Mode               Enforcing

Host Name                     Centos7-Clear

Platform                     Linux 
Centos7.1-playmachine3.10.0-229.11.1.el7.x86_64 #1

                             SMP Thu Aug 6 01:06:18 UTC 2015 x86_64 
x86_64

Alert Count                   1811

First Seen                   2015-08-18 05:48:31 EDT

Last Seen                    2015-08-18 09:04:47 EDT

Local ID                     8c42f4b4-28e6-452c-b782-5e3fbd233f87


Raw Audit Messages

type=AVC msg=audit(1439903087.58:2815): avc: denied { name_connect } for
 pid=18145 comm="httpd" dest=10051 scontext=system_u:system_r:httpd_t:s0
 tcontext=system_u:object_r:zabbix_port_t:s0 tclass=tcp_socket



type=SYSCALL msg=audit(1439903087.58:2815): arch=x86_64 syscall=connect 
success=no exit=EACCES a0=c a1=7f2705707170 a2=10 a3=1 items=0 ppid=1072
 pid=18145 auid=4294967295 uid=48 gid=48 euid=48 suid=48 fsuid=48 
egid=48 sgid=48 fsgid=48 tty=(none) ses=4294967295 comm=httpd 
exe=/usr/sbin/httpd subj=system_u:system_r:httpd_t:s0 key=(null)


Hash: httpd,httpd_t,zabbix_port_t,tcp_socket,name_connect</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: auto;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-2">2</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-4">4</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-6">6</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-8">8</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-10">10</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-12">12</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-14">14</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-16">16</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-18">18</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-20">20</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-22">22</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-24">24</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-26">26</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-28">28</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-30">30</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-32">32</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-34">34</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-36">36</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-38">38</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-40">40</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-42">42</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-44">44</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-46">46</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-48">48</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-50">50</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-52">52</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-54">54</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-56">56</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-58">58</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-60">60</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-62">62</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-64">64</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-66">66</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-68">68</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-70">70</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-72">72</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-74">74</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-76">76</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-78">78</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-80">80</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-82">82</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-84">84</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-86">86</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-88">88</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-90">90</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-92">92</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-94">94</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-96">96</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-98">98</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-100">100</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90d3008441600-102">102</div><div class="crayon-num" data-line="crayon-59464d41d90d3008441600-103">103</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90d3008441600-1"><span class="crayon-e">SELinux </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">preventing</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">sbin</span><span class="crayon-o">/</span><span class="crayon-e">httpd </span><span class="crayon-e">from </span><span class="crayon-e">name_connect </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">tcp_socket </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">10051.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-2">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-4"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall_boolean</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">47.5</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-59464d41d90d3008441600-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-6">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-7"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">want </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-e">httpd </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">can </span><span class="crayon-e">connect </span><span class="crayon-e">zabbix</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-8">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-9"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">must </span><span class="crayon-e">tell </span><span class="crayon-e">SELinux </span><span class="crayon-e">about </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">by </span><span class="crayon-e">enabling </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-s">'httpd_can_connect_zabbix'</span><span class="crayon-h"> </span><span class="crayon-t">boolean</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-10">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-11"><span class="crayon-e">You </span><span class="crayon-e">can </span><span class="crayon-i">read</span><span class="crayon-h"> </span><span class="crayon-s">'None'</span><span class="crayon-h"> </span><span class="crayon-e">man </span><span class="crayon-e">page </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">more </span><span class="crayon-v">details</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-12">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-13"><span class="crayon-st">Do</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-14">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-15"><span class="crayon-v">setsebool</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">P</span><span class="crayon-h"> </span><span class="crayon-v">httpd_can_connect</span><span class="crayon-sy">_</span>zabbix<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-16">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-18"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall_boolean</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">47.5</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-59464d41d90d3008441600-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-20">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-21"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">want </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-e">httpd </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">can </span><span class="crayon-e">network </span><span class="crayon-e">connect</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-22">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-23"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">must </span><span class="crayon-e">tell </span><span class="crayon-e">SELinux </span><span class="crayon-e">about </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">by </span><span class="crayon-e">enabling </span><span class="crayon-i">the</span><span class="crayon-h"> </span><span class="crayon-s">'httpd_can_network_connect'</span><span class="crayon-h"> </span><span class="crayon-t">boolean</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-24">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-25"><span class="crayon-e">You </span><span class="crayon-e">can </span><span class="crayon-i">read</span><span class="crayon-h"> </span><span class="crayon-s">'None'</span><span class="crayon-h"> </span><span class="crayon-e">man </span><span class="crayon-e">page </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">more </span><span class="crayon-v">details</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-26">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-27"><span class="crayon-st">Do</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-28">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-29"><span class="crayon-v">setsebool</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">P</span><span class="crayon-h"> </span><span class="crayon-v">httpd_can_network</span><span class="crayon-sy">_</span>connect<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-30">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-32"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">6.38</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-59464d41d90d3008441600-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-34">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-35"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">believe </span><span class="crayon-e">that </span><span class="crayon-e">httpd </span><span class="crayon-e">should </span><span class="crayon-e">be </span><span class="crayon-e">allowed </span><span class="crayon-e">name_connect </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">10051</span><span class="crayon-h"> </span><span class="crayon-e">tcp_socket </span><span class="crayon-e">by </span><span class="crayon-st">default</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-36">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-37"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">should </span><span class="crayon-e">report </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">bug</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-38">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-39"><span class="crayon-e">You </span><span class="crayon-e">can </span><span class="crayon-i">generate</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">local </span><span class="crayon-e">policy </span><span class="crayon-e">module </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-v">access</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-40">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-41"><span class="crayon-st">Do</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-42">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-43"><span class="crayon-e">allow </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">access </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">now </span><span class="crayon-e">by </span><span class="crayon-v">executing</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-44">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-45"><span class="crayon-p"># grep httpd /var/log/audit/audit.log | audit2allow -M mypol</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-46">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-47"><span class="crayon-p"># semodule -i mypol.pp</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-48">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-50">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-51"><span class="crayon-e">Additional </span><span class="crayon-v">Information</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-52">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-53"><span class="crayon-e">Source </span><span class="crayon-e">Context&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">system_r</span><span class="crayon-o">:</span><span class="crayon-v">httpd_t</span><span class="crayon-o">:</span><span class="crayon-e">s0</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-54">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-55"><span class="crayon-e">Target </span><span class="crayon-e">Context&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">zabbix_port_t</span><span class="crayon-o">:</span><span class="crayon-e">s0</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-56">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-57"><span class="crayon-e">Target </span><span class="crayon-e">Objects&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">10051</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-v">tcp</span><span class="crayon-sy">_</span>socket<span class="crayon-h"> </span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-58">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-59"><span class="crayon-e">Source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">httpd</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-60">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-61"><span class="crayon-e">Source </span><span class="crayon-v">Path</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">sbin</span><span class="crayon-o">/</span><span class="crayon-e">httpd</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-62">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-63"><span class="crayon-i">Port</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">10051</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-64">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-65"><span class="crayon-e">Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">Centos7</span><span class="crayon-o">-</span><span class="crayon-e">Clear</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-66">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-67"><span class="crayon-e">Source </span><span class="crayon-e">RPM </span><span class="crayon-e">Packages&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">httpd</span><span class="crayon-o">-</span><span class="crayon-cn">2.4.6</span><span class="crayon-o">-</span><span class="crayon-cn">31.el7.centos.x86_64</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-68">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-69"><span class="crayon-e">Target </span><span class="crayon-e">RPM </span><span class="crayon-e">Packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-70">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-71"><span class="crayon-e">Policy </span><span class="crayon-e">RPM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">selinux</span><span class="crayon-o">-</span><span class="crayon-v">policy</span><span class="crayon-o">-</span><span class="crayon-cn">3.13.1</span><span class="crayon-o">-</span><span class="crayon-cn">23.el7_1.13.noarch</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-72">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-73"><span class="crayon-e">Selinux </span><span class="crayon-e">Enabled&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">True</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-74">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-75"><span class="crayon-e">Policy </span><span class="crayon-e">Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">targeted</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-76">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-77"><span class="crayon-e">Enforcing </span><span class="crayon-e">Mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">Enforcing</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-78">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-79"><span class="crayon-e">Host </span><span class="crayon-e">Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">Centos7</span><span class="crayon-o">-</span><span class="crayon-e">Clear</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-80">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-81"><span class="crayon-e">Platform&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">Linux </span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine3</span><span class="crayon-sy">.</span><span class="crayon-cn">10.0</span><span class="crayon-o">-</span><span class="crayon-cn">229.11.1.el7.x86_64</span><span class="crayon-h"> </span><span class="crayon-p">#1</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-82">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">SMP </span><span class="crayon-e">Thu </span><span class="crayon-i">Aug</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-cn">01</span><span class="crayon-o">:</span><span class="crayon-cn">06</span><span class="crayon-o">:</span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-i">UTC</span><span class="crayon-h"> </span><span class="crayon-cn">2015</span><span class="crayon-h"> </span><span class="crayon-e">x86_64 </span><span class="crayon-e">x86_64</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-84">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-85"><span class="crayon-e">Alert </span><span class="crayon-i">Count</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">1811</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-86">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-87"><span class="crayon-e">First </span><span class="crayon-i">Seen</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">2015</span><span class="crayon-o">-</span><span class="crayon-cn">08</span><span class="crayon-o">-</span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-cn">05</span><span class="crayon-o">:</span><span class="crayon-cn">48</span><span class="crayon-o">:</span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-e">EDT</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-88">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-89"><span class="crayon-e">Last </span><span class="crayon-i">Seen</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">2015</span><span class="crayon-o">-</span><span class="crayon-cn">08</span><span class="crayon-o">-</span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-cn">09</span><span class="crayon-o">:</span><span class="crayon-cn">04</span><span class="crayon-o">:</span><span class="crayon-cn">47</span><span class="crayon-h"> </span><span class="crayon-e">EDT</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-90">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-91"><span class="crayon-e">Local </span><span class="crayon-i">ID</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">8c42f4b4</span><span class="crayon-o">-</span><span class="crayon-cn">28e6</span><span class="crayon-o">-</span><span class="crayon-cn">452c</span><span class="crayon-o">-</span><span class="crayon-v">b782</span><span class="crayon-o">-</span><span class="crayon-cn">5e3fbd233f87</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-92">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-93">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-94"><span class="crayon-e">Raw </span><span class="crayon-e">Audit </span><span class="crayon-e">Messages</span></div><div class="crayon-line" id="crayon-59464d41d90d3008441600-95">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-96"><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-e">AVC </span><span class="crayon-v">msg</span><span class="crayon-o">=</span><span class="crayon-e">audit</span><span class="crayon-sy">(</span><span class="crayon-cn">1439903087.58</span><span class="crayon-o">:</span><span class="crayon-cn">2815</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">avc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">denied</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">_</span>connect<span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">pid</span><span class="crayon-o">=</span><span class="crayon-cn">18145</span><span class="crayon-h"> </span><span class="crayon-v">comm</span><span class="crayon-o">=</span><span class="crayon-s">"httpd"</span><span class="crayon-h"> </span><span class="crayon-v">dest</span><span class="crayon-o">=</span><span class="crayon-cn">10051</span><span class="crayon-h"> </span><span class="crayon-v">scontext</span><span class="crayon-o">=</span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">system_r</span><span class="crayon-o">:</span><span class="crayon-v">httpd_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">tcontext</span><span class="crayon-o">=</span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">zabbix_port_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">tclass</span><span class="crayon-o">=</span><span class="crayon-e">tcp_socket</span></div><div class="crayon-line" id="crayon-59464d41d90d3008441600-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-98">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-99">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-100"><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-e">SYSCALL </span><span class="crayon-v">msg</span><span class="crayon-o">=</span><span class="crayon-e">audit</span><span class="crayon-sy">(</span><span class="crayon-cn">1439903087.58</span><span class="crayon-o">:</span><span class="crayon-cn">2815</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">arch</span><span class="crayon-o">=</span><span class="crayon-e">x86_64 </span><span class="crayon-v">syscall</span><span class="crayon-o">=</span><span class="crayon-e">connect </span><span class="crayon-v">success</span><span class="crayon-o">=</span><span class="crayon-e">no </span><span class="crayon-v">exit</span><span class="crayon-o">=</span><span class="crayon-e">EACCES </span><span class="crayon-v">a0</span><span class="crayon-o">=</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-v">a1</span><span class="crayon-o">=</span><span class="crayon-cn">7f2705707170</span><span class="crayon-h"> </span><span class="crayon-v">a2</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-v">a3</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-v">items</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-v">ppid</span><span class="crayon-o">=</span><span class="crayon-cn">1072</span><span class="crayon-h"> </span><span class="crayon-v">pid</span><span class="crayon-o">=</span><span class="crayon-cn">18145</span><span class="crayon-h"> </span><span class="crayon-v">auid</span><span class="crayon-o">=</span><span class="crayon-cn">4294967295</span><span class="crayon-h"> </span><span class="crayon-v">uid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">gid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">euid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">suid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">fsuid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">egid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">sgid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">fsgid</span><span class="crayon-o">=</span><span class="crayon-cn">48</span><span class="crayon-h"> </span><span class="crayon-v">tty</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">none</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">ses</span><span class="crayon-o">=</span><span class="crayon-cn">4294967295</span><span class="crayon-h"> </span><span class="crayon-v">comm</span><span class="crayon-o">=</span><span class="crayon-e">httpd </span><span class="crayon-v">exe</span><span class="crayon-o">=</span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">sbin</span><span class="crayon-o">/</span><span class="crayon-e">httpd </span><span class="crayon-v">subj</span><span class="crayon-o">=</span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">system_r</span><span class="crayon-o">:</span><span class="crayon-v">httpd_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-t">null</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-59464d41d90d3008441600-101">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90d3008441600-102">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90d3008441600-103"><span class="crayon-v">Hash</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">httpd</span><span class="crayon-sy">,</span><span class="crayon-v">httpd_t</span><span class="crayon-sy">,</span><span class="crayon-v">zabbix_port_t</span><span class="crayon-sy">,</span><span class="crayon-v">tcp_socket</span><span class="crayon-sy">,</span><span class="crayon-v">name_connect</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0117 seconds] -->
<p>[/spoiler]</p>
<p style="text-align: justify;">Неважно, какой вариант вы выберите, в 
обоих случаях sealert описывает каждую проблему доступа в достаточно 
подробном виде и предлагает возможные варианты решения. Нам он предложил
 3 варианта:</p>
<ol>
<li>Разрешить подключаться httpd к zabbix’у по 10051 порту. Для этого 
необходимо изменить значение переключателя httpd_can_connect_zabbix, 
выполнив команду setsebool -P httpd_can_connect_zabbix 1</li>
<li>Разрешить httpd подключаться по всем портам. Для этого необходимо 
изменить значение переключателя httpd_can_network_connect, выполнив 
команду setsebool -P httpd_can_network_connect 1</li>
<li>Sealert предлагает воспользоваться утилитой audit2allow, которая 
автоматически создаст модуль локальной политики для разрешения действия.</li>
</ol>
<p style="text-align: justify;">Мы, очевидно, руководствуюсь принципом 
минимизации привилегий, выберем первый вариант. Изменяет значения 
переключателей утилита setsebool. Ключ –P позволяет сохранить изменения 
после перезагрузки (persistent):</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90d8320307317" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# setsebool -P httpd_can_connect_zabbix 1</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90d8320307317-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90d8320307317-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># setsebool -P httpd_can_connect_zabbix 1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Проверяем:</p>
<p><strong><a href="https://defcon.ru/wp-content/uploads/2015/08/selinux_zbx_runing1.png" class="lightbox"><img class="alignleft size-medium wp-image-1304" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/selinux_zbx_runing1-300x45.png" alt="selinux_zbx_runing" srcset="https://defcon.ru/wp-content/uploads/2015/08/selinux_zbx_runing1-300x45.png 300w, https://defcon.ru/wp-content/uploads/2015/08/selinux_zbx_runing1.png 603w" sizes="(max-width: 300px) 100vw, 300px" width="300" height="45"></a></strong></p>
<p><strong>&nbsp;</strong></p>
<p>Bingo! Проблема решена.</p>
<p style="text-align: justify;">Дополнительно хотелось бы обратить 
внимание на третий вариант. Конечно, audit2allow штука удобная, но я бы 
не рекомендовал ее использовать никогда. Ни новичкам, ни профессионалам.
 Проблема в том, что вы не можете досконально знать, что делает ПО, в 
том числе свое же собственное (ведь от ошибок никто не застрахован, 
верно?). Другая проблема — представьте, что случится, если в логе AVC 
был вполне честный отказ для обычного пользователя из домена httpd_t, 
которому внезапно потребовалось записать в /etc/shadow? Всё верно, и для
 этого действия AVC создаст разрешающую политику. Поэтому постарайтесь 
не использовать audit2allow вообще. А если уж решились, действуйте 
крайне аккуратно.</p>
<p style="text-align: justify;">Рассмотрим еще одну проблемку. Вы решили
 изменить директорию по умолчанию для БД Zabbix’а. Перенесли необходимые
 файлы, настроили традиционные 9 бит прав, но… MySQL не стартует:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90de202028738" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachinetestdb]# systemctl start mariadb
Job for mariadb.service failed. See 'systemctl status mariadb.service' and 'journalctl -xn' for details.</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90de202028738-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90de202028738-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90de202028738-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachinetestdb</span><span class="crayon-sy">]</span><span class="crayon-p"># systemctl start mariadb</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90de202028738-2"><span class="crayon-e">Job </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mariadb</span><span class="crayon-sy">.</span><span class="crayon-e">service </span><span class="crayon-v">failed</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">See</span><span class="crayon-h"> </span><span class="crayon-s">'systemctl status mariadb.service'</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-s">'journalctl -xn'</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">details</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p style="text-align: justify;">Опять же первым делом анализируем логи. Для помощи в этом нелегком деле используем утилиту sealert:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90e3461413202" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]#
 grep "SELinux is preventing" /var/log/messages
Aug 20 06:56:40 Centos7.1-playmachinesetroubleshoot: SELinux is 
preventing /usr/libexec/mysqld from 'read, write' accesses on the file 
ibdata1. For complete SELinux messages. run sealert -l 
d830f96b-03f7-4bf2-837e-80b613714738</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90e3461413202-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90e3461413202-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90e3461413202-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># grep "SELinux is preventing" /var/log/messages</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90e3461413202-2"><span class="crayon-i">Aug</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">06</span><span class="crayon-o">:</span><span class="crayon-cn">56</span><span class="crayon-o">:</span><span class="crayon-cn">40</span><span class="crayon-h"> </span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachinesetroubleshoot</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">SELinux </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">preventing</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">libexec</span><span class="crayon-o">/</span><span class="crayon-e">mysqld </span><span class="crayon-i">from</span><span class="crayon-h"> </span><span class="crayon-s">'read, write'</span><span class="crayon-h"> </span><span class="crayon-e">accesses </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">file </span><span class="crayon-v">ibdata1</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-st">For</span><span class="crayon-h"> </span><span class="crayon-e">complete </span><span class="crayon-e">SELinux </span><span class="crayon-v">messages</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">run </span><span class="crayon-v">sealert</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-v">d830f96b</span><span class="crayon-o">-</span><span class="crayon-cn">03f7</span><span class="crayon-o">-</span><span class="crayon-cn">4bf2</span><span class="crayon-o">-</span><span class="crayon-cn">837e</span><span class="crayon-o">-</span><span class="crayon-cn">80b613714738</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90e7872308268" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachinetestdb]# sealert -l d830f96b-03f7-4bf2-837e-80b613714738</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90e7872308268-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90e7872308268-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachinetestdb</span><span class="crayon-sy">]</span><span class="crayon-p"># sealert -l d830f96b-03f7-4bf2-837e-80b613714738</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>[spoiler title=’Отчет sealert’ style=’default’ collapse_link=’true’]</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90ea828687052" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">SELinux
 is preventing /usr/libexec/mysqld from 'read, write' accesses on the 
file ibdata1.


***** Plugin catchall_labels (83.8 confidence) suggests   
*******************


If you want to allow mysqld to have read write access on the ibdata1 
file

Then you need to change the label on ibdata1

Do

# semanage fcontext -a -t FILE_TYPE 'ibdata1'

where FILE_TYPE is one of the following: afs_cache_t, faillog_t, 
hugetlbfs_t, initrc_tmp_t, krb5_host_rcache_t, lastlog_t, mysqld_db_t, 
mysqld_log_t, mysqld_tmp_t, mysqld_var_run_t, puppet_tmp_t, security_t, 
user_cron_spool_t.

Then execute:

restorecon -v 'ibdata1'



***** Plugin catchall (17.1 confidence) suggests   
**************************


If you believe that mysqld should be allowed read write access on the 
ibdata1 file by default.

Then you should report this as a bug.

You can generate a local policy module to allow this access.

Do

allow this access for now by executing:

# grep mysqld /var/log/audit/audit.log | audit2allow -M mypol

# semodule -i mypol.pp



Additional Information:

Source Context               system_u:system_r:mysqld_t:s0

Target Context               unconfined_u:object_r:default_t:s0

Target Objects               ibdata1 [ file ]

Source                       mysqld

Source Path                   /usr/libexec/mysqld

Port                          &lt;Unknown&gt;

Host                         Centos7-Clear

Source RPM Packages           mariadb-server-5.5.41-2.el7_0.x86_64

Target RPM Packages

Policy RPM                   selinux-policy-3.13.1-23.el7_1.13.noarch

Selinux Enabled               True

Policy Type                   targeted

Enforcing Mode               Enforcing

Host Name                     Centos7-Clear

Platform                     Linux 
Centos7.1-playmachine3.10.0-229.11.1.el7.x86_64 #1

                             SMP Thu Aug 6 01:06:18 UTC 2015 x86_64 
x86_64

Alert Count                   1

First Seen                   2015-08-20 06:56:30 EDT

Last Seen                     2015-08-20 06:56:30 EDT

Local ID                     d830f96b-03f7-4bf2-837e-80b613714738


Raw Audit Messages

type=AVC msg=audit(1440068190.836:153): avc: denied { read write } for 
pid=3782 comm="mysqld" name="ibdata1" dev="dm-1" ino=100804624 
scontext=system_u:system_r:mysqld_t:s0 
tcontext=unconfined_u:object_r:default_t:s0 tclass=file



type=SYSCALL msg=audit(1440068190.836:153): arch=x86_64 syscall=open 
success=no exit=EACCES a0=7fff51966f80 a1=2 a2=1b0 a3=7fcbea197620 
items=0 ppid=3625 pid=3782 auid=4294967295 uid=27 gid=27 euid=27 suid=27
 fsuid=27 egid=27 sgid=27 fsgid=27 tty=(none) ses=4294967295 comm=mysqld
 exe=/usr/libexec/mysqld subj=system_u:system_r:mysqld_t:s0 key=(null)


Hash: mysqld,mysqld_t,default_t,file,read,write</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-2">2</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-4">4</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-6">6</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-8">8</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-10">10</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-12">12</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-14">14</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-16">16</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-18">18</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-20">20</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-22">22</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-24">24</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-26">26</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-28">28</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-30">30</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-32">32</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-34">34</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-36">36</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-38">38</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-40">40</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-42">42</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-44">44</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-46">46</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-48">48</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-50">50</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-52">52</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-54">54</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-56">56</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-58">58</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-60">60</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-62">62</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-64">64</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-66">66</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-68">68</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-70">70</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-72">72</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-74">74</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-76">76</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-78">78</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-80">80</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-82">82</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-84">84</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-86">86</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-88">88</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-90">90</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-92">92</div><div class="crayon-num" data-line="crayon-59464d41d90ea828687052-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ea828687052-94">94</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90ea828687052-1"><span class="crayon-e">SELinux </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">preventing</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">libexec</span><span class="crayon-o">/</span><span class="crayon-e">mysqld </span><span class="crayon-i">from</span><span class="crayon-h"> </span><span class="crayon-s">'read, write'</span><span class="crayon-h"> </span><span class="crayon-e">accesses </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">file </span><span class="crayon-v">ibdata1</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-2">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-4"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall_labels</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">83.8</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-6">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-7"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">want </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-e">mysqld </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">have </span><span class="crayon-e">read </span><span class="crayon-e">write </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">ibdata1 </span><span class="crayon-e">file</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-8">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-9"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">need </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">change </span><span class="crayon-e">the </span><span class="crayon-e">label </span><span class="crayon-e">on </span><span class="crayon-e">ibdata1</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-10">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-11"><span class="crayon-st">Do</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-12">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-13"><span class="crayon-p"># semanage fcontext -a -t FILE_TYPE 'ibdata1'</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-14">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-15"><span class="crayon-e">where </span><span class="crayon-e">FILE_TYPE </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">one </span><span class="crayon-e">of </span><span class="crayon-e">the </span><span class="crayon-v">following</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">afs_cache_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">faillog_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">hugetlbfs_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">initrc_tmp_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">krb5_host_rcache_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lastlog_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mysqld_db_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mysqld_log_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mysqld_tmp_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mysqld_var_run_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">puppet_tmp_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">security_t</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">user_cron_spool_t</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-16">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-17"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-v">execute</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-18">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-19"><span class="crayon-v">restorecon</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-s">'ibdata1'</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-20">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-22">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-23"><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">Plugin </span><span class="crayon-e">catchall</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">17.1</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e ">suggests&nbsp;&nbsp; *</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-o">*</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-24">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-26"><span class="crayon-st">If</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">believe </span><span class="crayon-e">that </span><span class="crayon-e">mysqld </span><span class="crayon-e">should </span><span class="crayon-e">be </span><span class="crayon-e">allowed </span><span class="crayon-e">read </span><span class="crayon-e">write </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">ibdata1 </span><span class="crayon-e">file </span><span class="crayon-e">by </span><span class="crayon-st">default</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-28"><span class="crayon-st">Then</span><span class="crayon-h"> </span><span class="crayon-e">you </span><span class="crayon-e">should </span><span class="crayon-e">report </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-v">bug</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-30"><span class="crayon-e">You </span><span class="crayon-e">can </span><span class="crayon-i">generate</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">local </span><span class="crayon-e">policy </span><span class="crayon-e">module </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">allow </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-v">access</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-32"><span class="crayon-st">Do</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-34"><span class="crayon-e">allow </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-e">access </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">now </span><span class="crayon-e">by </span><span class="crayon-v">executing</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-36"><span class="crayon-p"># grep mysqld /var/log/audit/audit.log | audit2allow -M mypol</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-38"><span class="crayon-p"># semodule -i mypol.pp</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-40">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-42"><span class="crayon-e">Additional </span><span class="crayon-v">Information</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-44"><span class="crayon-e">Source </span><span class="crayon-e">Context&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">system_r</span><span class="crayon-o">:</span><span class="crayon-v">mysqld_t</span><span class="crayon-o">:</span><span class="crayon-e">s0</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-46"><span class="crayon-e">Target </span><span class="crayon-e">Context&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">unconfined_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">default_t</span><span class="crayon-o">:</span><span class="crayon-e">s0</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-48"><span class="crayon-e">Target </span><span class="crayon-e">Objects&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">ibdata1</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-i">file</span><span class="crayon-h"> </span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-50"><span class="crayon-e">Source&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">mysqld</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-52"><span class="crayon-e">Source </span><span class="crayon-v">Path</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">libexec</span><span class="crayon-o">/</span><span class="crayon-e">mysqld</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-54"><span class="crayon-v">Port</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">&lt;</span><span class="crayon-v">Unknown</span><span class="crayon-o">&gt;</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-56"><span class="crayon-e">Host&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">Centos7</span><span class="crayon-o">-</span><span class="crayon-e">Clear</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-57">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-58"><span class="crayon-e">Source </span><span class="crayon-e">RPM </span><span class="crayon-e">Packages&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">mariadb</span><span class="crayon-o">-</span><span class="crayon-v">server</span><span class="crayon-o">-</span><span class="crayon-cn">5.5.41</span><span class="crayon-o">-</span><span class="crayon-cn">2.el7_0.x86_64</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-60"><span class="crayon-e">Target </span><span class="crayon-e">RPM </span><span class="crayon-e">Packages</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-61">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-62"><span class="crayon-e">Policy </span><span class="crayon-e">RPM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">selinux</span><span class="crayon-o">-</span><span class="crayon-v">policy</span><span class="crayon-o">-</span><span class="crayon-cn">3.13.1</span><span class="crayon-o">-</span><span class="crayon-cn">23.el7_1.13.noarch</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-63">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-64"><span class="crayon-e">Selinux </span><span class="crayon-e">Enabled&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-65">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-66"><span class="crayon-e">Policy </span><span class="crayon-e">Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">targeted</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-67">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-68"><span class="crayon-e">Enforcing </span><span class="crayon-e">Mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">Enforcing</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-69">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-70"><span class="crayon-e">Host </span><span class="crayon-e">Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">Centos7</span><span class="crayon-o">-</span><span class="crayon-e">Clear</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-72"><span class="crayon-e">Platform&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">Linux </span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine3</span><span class="crayon-sy">.</span><span class="crayon-cn">10.0</span><span class="crayon-o">-</span><span class="crayon-cn">229.11.1.el7.x86_64</span><span class="crayon-h"> </span><span class="crayon-p">#1</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-73">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">SMP </span><span class="crayon-e">Thu </span><span class="crayon-i">Aug</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-cn">01</span><span class="crayon-o">:</span><span class="crayon-cn">06</span><span class="crayon-o">:</span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-i">UTC</span><span class="crayon-h"> </span><span class="crayon-cn">2015</span><span class="crayon-h"> </span><span class="crayon-e">x86_64 </span><span class="crayon-e">x86_64</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-75">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-76"><span class="crayon-e">Alert </span><span class="crayon-i">Count</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-77">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-78"><span class="crayon-e">First </span><span class="crayon-i">Seen</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">2015</span><span class="crayon-o">-</span><span class="crayon-cn">08</span><span class="crayon-o">-</span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">06</span><span class="crayon-o">:</span><span class="crayon-cn">56</span><span class="crayon-o">:</span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-e">EDT</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-79">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-80"><span class="crayon-e">Last </span><span class="crayon-i">Seen</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">2015</span><span class="crayon-o">-</span><span class="crayon-cn">08</span><span class="crayon-o">-</span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-cn">06</span><span class="crayon-o">:</span><span class="crayon-cn">56</span><span class="crayon-o">:</span><span class="crayon-cn">30</span><span class="crayon-h"> </span><span class="crayon-e">EDT</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-81">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-82"><span class="crayon-e">Local </span><span class="crayon-e">ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">d830f96b</span><span class="crayon-o">-</span><span class="crayon-cn">03f7</span><span class="crayon-o">-</span><span class="crayon-cn">4bf2</span><span class="crayon-o">-</span><span class="crayon-cn">837e</span><span class="crayon-o">-</span><span class="crayon-cn">80b613714738</span></div><div class="crayon-line" id="crayon-59464d41d90ea828687052-83">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-84">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-85"><span class="crayon-e">Raw </span><span class="crayon-e">Audit </span><span class="crayon-e">Messages</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-86">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-87"><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-e">AVC </span><span class="crayon-v">msg</span><span class="crayon-o">=</span><span class="crayon-e">audit</span><span class="crayon-sy">(</span><span class="crayon-cn">1440068190.836</span><span class="crayon-o">:</span><span class="crayon-cn">153</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">avc</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">denied</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-e">read </span><span class="crayon-i">write</span><span class="crayon-h"> </span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">pid</span><span class="crayon-o">=</span><span class="crayon-cn">3782</span><span class="crayon-h"> </span><span class="crayon-v">comm</span><span class="crayon-o">=</span><span class="crayon-s">"mysqld"</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-o">=</span><span class="crayon-s">"ibdata1"</span><span class="crayon-h"> </span><span class="crayon-v">dev</span><span class="crayon-o">=</span><span class="crayon-s">"dm-1"</span><span class="crayon-h"> </span><span class="crayon-v">ino</span><span class="crayon-o">=</span><span class="crayon-cn">100804624</span><span class="crayon-h"> </span><span class="crayon-v">scontext</span><span class="crayon-o">=</span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">system_r</span><span class="crayon-o">:</span><span class="crayon-v">mysqld_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">tcontext</span><span class="crayon-o">=</span><span class="crayon-v">unconfined_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">default_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">tclass</span><span class="crayon-o">=</span><span class="crayon-e">file</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-88">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-90">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-91"><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-e">SYSCALL </span><span class="crayon-v">msg</span><span class="crayon-o">=</span><span class="crayon-e">audit</span><span class="crayon-sy">(</span><span class="crayon-cn">1440068190.836</span><span class="crayon-o">:</span><span class="crayon-cn">153</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">arch</span><span class="crayon-o">=</span><span class="crayon-e">x86_64 </span><span class="crayon-v">syscall</span><span class="crayon-o">=</span><span class="crayon-e">open </span><span class="crayon-v">success</span><span class="crayon-o">=</span><span class="crayon-e">no </span><span class="crayon-v">exit</span><span class="crayon-o">=</span><span class="crayon-e">EACCES </span><span class="crayon-v">a0</span><span class="crayon-o">=</span><span class="crayon-cn">7fff51966f80</span><span class="crayon-h"> </span><span class="crayon-v">a1</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-v">a2</span><span class="crayon-o">=</span><span class="crayon-cn">1b0</span><span class="crayon-h"> </span><span class="crayon-v">a3</span><span class="crayon-o">=</span><span class="crayon-cn">7fcbea197620</span><span class="crayon-h"> </span><span class="crayon-v">items</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-v">ppid</span><span class="crayon-o">=</span><span class="crayon-cn">3625</span><span class="crayon-h"> </span><span class="crayon-v">pid</span><span class="crayon-o">=</span><span class="crayon-cn">3782</span><span class="crayon-h"> </span><span class="crayon-v">auid</span><span class="crayon-o">=</span><span class="crayon-cn">4294967295</span><span class="crayon-h"> </span><span class="crayon-v">uid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">gid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">euid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">suid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">fsuid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">egid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">sgid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">fsgid</span><span class="crayon-o">=</span><span class="crayon-cn">27</span><span class="crayon-h"> </span><span class="crayon-v">tty</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">none</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">ses</span><span class="crayon-o">=</span><span class="crayon-cn">4294967295</span><span class="crayon-h"> </span><span class="crayon-v">comm</span><span class="crayon-o">=</span><span class="crayon-e">mysqld </span><span class="crayon-v">exe</span><span class="crayon-o">=</span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">libexec</span><span class="crayon-o">/</span><span class="crayon-e">mysqld </span><span class="crayon-v">subj</span><span class="crayon-o">=</span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">system_r</span><span class="crayon-o">:</span><span class="crayon-v">mysqld_t</span><span class="crayon-o">:</span><span class="crayon-e">s0 </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-t">null</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-92">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d90ea828687052-93">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ea828687052-94"><span class="crayon-v">Hash</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">mysqld</span><span class="crayon-sy">,</span><span class="crayon-v">mysqld_t</span><span class="crayon-sy">,</span><span class="crayon-v">default_t</span><span class="crayon-sy">,</span><span class="crayon-v">file</span><span class="crayon-sy">,</span><span class="crayon-v">read</span><span class="crayon-sy">,</span><span class="crayon-v">write</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0100 seconds] -->
<p>[/spoiler]</p>
<p style="text-align: justify;">Мы видим, что SELinux запретил доступ на чтение и запись к файлу ibdata, т.к. его контекст безопасности имеет неверный тип:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90ef587339387" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachinetestdb]# ls -lZ /testdb/ibdata1
-rw-r-----. mysql mysql unconfined_u:object_r:default_t:s0 /testdb/ibdata1</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90ef587339387-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90ef587339387-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90ef587339387-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachinetestdb</span><span class="crayon-sy">]</span><span class="crayon-p"># ls -lZ /testdb/ibdata1</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90ef587339387-2"><span class="crayon-o">-</span><span class="crayon-v">rw</span><span class="crayon-o">-</span><span class="crayon-v">r</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">-</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">mysql </span><span class="crayon-e">mysql </span><span class="crayon-v">unconfined_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">default_t</span><span class="crayon-o">:</span><span class="crayon-v">s0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">testdb</span><span class="crayon-o">/</span><span class="crayon-v">ibdata1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p style="text-align: justify;">MySQL не может получить доступ к файлам,
 имеющих тип default_t. Для решения проблемы необходимо изменить тип. 
Чтобы понять, какой тип нам нужен, воспользуемся возможностями утилиты 
semanage и выведем список всех контекстов, доступных для MySQL и выберем
 нужный:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90f6459733987" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine]# semanage fcontext -l |grep mysql</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90f6459733987-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90f6459733987-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-sy">]</span><span class="crayon-p"># semanage fcontext -l |grep mysql</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p style="text-align: justify;">или можно поступить еще проще – посмотреть, какой контекст был у этого файла изначально:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90fa828452735" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine]# ls -Z /var/lib/mysql/ibdata1
-rw-rw----. mysql mysql system_u:object_r:mysqld_db_t:s0 /var/lib/mysql/ibdata1</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90fa828452735-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d90fa828452735-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90fa828452735-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-sy">]</span><span class="crayon-p"># ls -Z /var/lib/mysql/ibdata1</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d90fa828452735-2"><span class="crayon-o">-</span><span class="crayon-v">rw</span><span class="crayon-o">-</span><span class="crayon-v">rw</span><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">mysql </span><span class="crayon-e">mysql </span><span class="crayon-v">system_u</span><span class="crayon-o">:</span><span class="crayon-v">object_r</span><span class="crayon-o">:</span><span class="crayon-v">mysqld_db_t</span><span class="crayon-o">:</span><span class="crayon-v">s0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">lib</span><span class="crayon-o">/</span><span class="crayon-v">mysql</span><span class="crayon-o">/</span><span class="crayon-v">ibdata1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p style="text-align: justify;">Мы выяснили, что нужен тип <strong>mysqld</strong><strong>_</strong><strong>db</strong><strong>_</strong><strong>t</strong>.
 Для изменения контекста скопированных файлов опять прибегнем к помощи 
утилиты semanage. Параметры –a (add) –t (type), как не сложно 
догадаться, изменяют тип:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d90fd705991017" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine]# semanage fcontext -a -t mysqld_db_t '/testdb(/.*)?'</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d90fd705991017-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d90fd705991017-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-sy">]</span><span class="crayon-p"># semanage fcontext -a -t mysqld_db_t '/testdb(/.*)?'</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;">Чтобы новый тип применился, необходимо выполнить команду restorecon:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9100402841712" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine]# restorecon -R -v /testdb</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9100402841712-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9100402841712-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-sy">]</span><span class="crayon-p"># restorecon -R -v /testdb</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p style="text-align: justify;">Убеждаемся что новый тип применен:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9103103748414" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine]# ls -Z /testdb/</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9103103748414-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9103103748414-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-sy">]</span><span class="crayon-p"># ls -Z /testdb/</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p style="text-align: justify;">И старутуем MariaDB:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9106275704603" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachinetestdb]# systemctl start mariadb</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9106275704603-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9106275704603-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachinetestdb</span><span class="crayon-sy">]</span><span class="crayon-p"># systemctl start mariadb</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>И опять бинго:</p>
<p><a href="https://defcon.ru/wp-content/uploads/2015/08/selinux_mysql_started.png" class="lightbox"><img class="alignleft size-medium wp-image-1305" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/selinux_mysql_started-300x32.png" alt="selinux_mysql_started" srcset="https://defcon.ru/wp-content/uploads/2015/08/selinux_mysql_started-300x32.png 300w, https://defcon.ru/wp-content/uploads/2015/08/selinux_mysql_started.png 610w" sizes="(max-width: 300px) 100vw, 300px" width="300" height="32"></a></p>
<p style="text-align: justify;"><strong>&nbsp;</strong></p>
<p style="text-align: justify;">Заключительный пример. Мы изменили порт httpd со стандартного 80 на 1111:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9109975062060" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachinetestdb]# systemctl start httpd
Job for httpd.service failed. See 'systemctl status httpd.service' and 'journalctl -xn' for details.</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9109975062060-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d9109975062060-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9109975062060-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachinetestdb</span><span class="crayon-sy">]</span><span class="crayon-p"># systemctl start httpd</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d9109975062060-2"><span class="crayon-e">Job </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">httpd</span><span class="crayon-sy">.</span><span class="crayon-e">service </span><span class="crayon-v">failed</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-i">See</span><span class="crayon-h"> </span><span class="crayon-s">'systemctl status httpd.service'</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-s">'journalctl -xn'</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">details</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p style="text-align: justify;">Естественно, SELinux такую самодеятельность не оценил. Алгоритм всё тот же: логи, sealert и спасительная команда:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d910e896422961" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]#
 grep "SELinux is preventing" /var/log/messages

Aug 21 07:01:01 Centos7.1-playmachinesetroubleshoot: SELinux is 
preventing /usr/sbin/httpd from name_bind access on the tcp_socket port 
1111. For complete SELinux messages. run sealert -l 
6841e508-4442-4fa8-b5d1-0b4d9826b3c1</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d910e896422961-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-59464d41d910e896422961-2">2</div><div class="crayon-num" data-line="crayon-59464d41d910e896422961-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d910e896422961-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># grep "SELinux is preventing" /var/log/messages</span></div><div class="crayon-line crayon-striped-line" id="crayon-59464d41d910e896422961-2">&nbsp;</div><div class="crayon-line" id="crayon-59464d41d910e896422961-3"><span class="crayon-i">Aug</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-h"> </span><span class="crayon-cn">07</span><span class="crayon-o">:</span><span class="crayon-cn">01</span><span class="crayon-o">:</span><span class="crayon-cn">01</span><span class="crayon-h"> </span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachinesetroubleshoot</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">SELinux </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">preventing</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">usr</span><span class="crayon-o">/</span><span class="crayon-v">sbin</span><span class="crayon-o">/</span><span class="crayon-e">httpd </span><span class="crayon-e">from </span><span class="crayon-e">name_bind </span><span class="crayon-e">access </span><span class="crayon-e">on </span><span class="crayon-e">the </span><span class="crayon-e">tcp_socket </span><span class="crayon-i">port</span><span class="crayon-h"> </span><span class="crayon-cn">1111.</span><span class="crayon-h"> </span><span class="crayon-st">For</span><span class="crayon-h"> </span><span class="crayon-e">complete </span><span class="crayon-e">SELinux </span><span class="crayon-v">messages</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-e">run </span><span class="crayon-v">sealert</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-cn">6841e508</span><span class="crayon-o">-</span><span class="crayon-cn">4442</span><span class="crayon-o">-</span><span class="crayon-cn">4fa8</span><span class="crayon-o">-</span><span class="crayon-v">b5d1</span><span class="crayon-o">-</span><span class="crayon-cn">0b4d9826b3c1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9112148177922" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]#sealert -l 6841e508-4442-4fa8-b5d1-0b4d9826b3c1</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9112148177922-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9112148177922-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p">#sealert -l 6841e508-4442-4fa8-b5d1-0b4d9826b3c1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d9117693328985" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]# semanage port -a -t http_port_t -p tcp 1111</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d9117693328985-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d9117693328985-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p"># semanage port -a -t http_port_t -p tcp 1111</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-59464d41d911c017034777" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="max-width: 500px; margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://defcon.ru/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">[root@Centos7.1-playmachine~]#systemctl start httpd</textarea></div>
			<div class="crayon-main" style="max-width: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-59464d41d911c017034777-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-59464d41d911c017034777-1"><span class="crayon-sy">[</span><span class="crayon-v">root</span><span class="crayon-sy">@</span><span class="crayon-v">Centos7</span><span class="crayon-sy">.</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">playmachine</span><span class="crayon-o">~</span><span class="crayon-sy">]</span><span class="crayon-p">#systemctl start httpd</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p style="text-align: justify;"><strong>&nbsp;</strong></p>
<p style="text-align: justify;">Бинго! Ничего сложного. Если иметь общие
 представления о том, как SELinux работает, решение подобных проблем не 
должно вызвать никаких затруднений.</p>
<p style="text-align: justify;">Хорошо, а что же делать, если я столкнулся с проблемой, которая не входит в абсолютное большинство случаев?</p>
<ul>
<li style="text-align: justify;">Вариант раз. Setenforce 0 и присоединиться к плачущему Дэну.</li>
<li style="text-align: justify;">Вариант два. Погуглить. Наверняка Вы не одиноки, и кто-то уже написал рабочую политику за Вас или уже сообщил <a href="https://bugzilla.redhat.com/index.cgi">нужным людям</a>, что политика не работает. Если же не смогли ничего найти, то это отличный шанс <a href="http://www.lurking-grue.org/writingselinuxpolicyHOWTO.html">научиться писать политики самостоятельно</a> ;).</li>
</ul>
<h1 style="text-align: justify;"><span style="color: #000000;"><strong>Заключение</strong></span></h1>
<p style="text-align: justify;">Надеюсь, мне удалось рассказать про 
«непростой» SELinux простыми словами. Материал получился больше 
обзорно-теоретический, чем практический. Я постарался не превращать его в
 чтиво, изобилующее научными и полунаучными терминами, а также старался 
избежать перепечатывания <a href="https://docs.fedoraproject.org/ru-RU/Fedora/13/html/Security-Enhanced_Linux/index.html">всем известного руководства</a>.
 Конечно, очень многое осталось за рамками этой статьи и у большинства 
интересующихся еще остались вопросы или наверняка появились новые.</p>
<p style="text-align: justify;">Однако, я надеюсь, что теперь читатель 
относится к SELinux,&nbsp;не как к «вундервафле» от вероятного 
противника и начнет-таки его использовать. Ведь SELinux уже совсем не 
тот, что был еще 5-10 лет назад — большинство проблем теперь решаются 
копипастом пары команд.</p>
<p style="text-align: justify;">Ну что, не будете больше расстраивать Дэна Уолша?</p>
<p style="text-align: justify;"><em>Вопросы, пожелания, предложения и замечания прошу оставлять в комментариях. Буду рад любому фидбэку.</em></p>
<p style="text-align: justify;"><strong>&nbsp;</strong></p>
<p>&nbsp;</p>
<p><strong>&nbsp;</strong></p>
            </div><!-- .entry-content -->
        	
    </div>
    <div class="article-info">
        <ul class="article-info-menu" style="
                            ">
            <li class="article-info-menu__item">
                <a href="https://defcon.ru/profile/d1sen/">
                    <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/photo_2016-12-08_16-16-35.jpg" class="avatar avatar-25 gravatar" width="25" height="25">                    <span class="article-info-menu__name">d1sen</span></a>
            </li>
            <li class="article-info-menu__item">
                <a href="https://defcon.ru/os-security/1264/"><span class="glyphicon glyphicon-eye-open"></span>
                    <span class="article-info-menu__item-views">14385</span></a>
            </li>
            <li class="article-info-menu__item">
                <a href="https://defcon.ru/os-security/1264/#comments"><span class="glyphicon glyphicon-comment"></span>
                    <span class="article-info-menu__item-comment">3</span></a>
            </li>
            <li class="article-info-menu__item"><!-- Избранное -->
                <button class="simplefavorite-button has-count" data-postid="1264" data-siteid="1" data-favoritecount="12"><i class="sf-icon-star-empty"></i> <span class="simplefavorite-button-count">12</span></button>            </li><!-- Избранное End -->
	<li class="article-info-menu__item" style="padding-top: 0;">
		<div class="wpulike wpulike-default"><div class="counter"><a title="" class="image-unlike user-tooltip" data-original-title="Необходимо авторизоваться"></a><span class="count-box">9</span></div></div>	</li>
            <li class="article-info-menu__item">
               <a href="https://defcon.ru/category/os-security/"><span class="article-info-menu__item-name-category">OS security</span></a>
            </li>
                    </ul>
                    <button type="button" class="article-info__read-more" onclick="location.href = 'https://defcon.ru/os-security/1264/';">Читать дальше &gt;&gt;</button>
        
    </div>
</article>
<div id="comments" class="comments-area">

	
	<h2 class="comments-title">
		        КОММЕНТАРИИ
	</h2>

	
	<ol class="comment-list">
		    <li class="comment byuser comment-author-romanov-roman even thread-even depth-1" id="comment-113">
            <div id="div-comment-113" class="comment-body">
        <div class="comment-author vcard">
        <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/BODMyVzwJ1Y.jpg" class="avatar avatar-24 gravatar" width="24" height="24">        <span class="comment_author_name"><a href="https://www.pentestit.ru/" rel="external nofollow" class="url">Romanov Roman</a></span> <span class="says">написал </span>    </div>
    
    <div class="comment-meta commentmetadata"><a href="https://defcon.ru/os-security/1264/#comment-113">
            22.08.2015 <span class="says">в</span>19:07</a>
            </div>
    <br>
    <p>Спасибо, очень познавательно!</p>

    <div class="reply">
        <a rel="nofollow" class="comment-reply-login" href="https://defcon.ru/wp-login.php?redirect_to=https%3A%2F%2Fdefcon.ru%2Fos-security%2F1264%2F">Войдите, чтобы ответить</a>    </div>
            </div>
    </li><!-- #comment-## -->
    <li class="comment byuser comment-author-john odd alt thread-odd thread-alt depth-1" id="comment-118">
            <div id="div-comment-118" class="comment-body">
        <div class="comment-author vcard">
        <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/4764052d579dad5d5451d1ab39d4e3eb.jpg" srcset="https://secure.gravatar.com/avatar/4764052d579dad5d5451d1ab39d4e3eb?s=48&amp;d=mm&amp;r=g 2x" class="avatar avatar-24 gravatar" width="24" height="24">        <span class="comment_author_name">John</span> <span class="says">написал </span>    </div>
    
    <div class="comment-meta commentmetadata"><a href="https://defcon.ru/os-security/1264/#comment-118">
            24.08.2015 <span class="says">в</span>11:48</a>
            </div>
    <br>
    <p>Круто!:) Ждем ещё:)</p>

    <div class="reply">
        <a rel="nofollow" class="comment-reply-login" href="https://defcon.ru/wp-login.php?redirect_to=https%3A%2F%2Fdefcon.ru%2Fos-security%2F1264%2F">Войдите, чтобы ответить</a>    </div>
            </div>
    </li><!-- #comment-## -->
    <li class="comment byuser comment-author-alektronik even thread-even depth-1" id="comment-208">
            <div id="div-comment-208" class="comment-body">
        <div class="comment-author vcard">
        <img alt="" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/b7c4e20a3c79aa5271b251e9e76fd957.jpg" srcset="https://secure.gravatar.com/avatar/b7c4e20a3c79aa5271b251e9e76fd957?s=48&amp;d=mm&amp;r=g 2x" class="avatar avatar-24 gravatar" width="24" height="24">        <span class="comment_author_name">AlektroNik</span> <span class="says">написал </span>    </div>
    
    <div class="comment-meta commentmetadata"><a href="https://defcon.ru/os-security/1264/#comment-208">
            01.09.2016 <span class="says">в</span>22:17</a>
            </div>
    <br>
    <p>Отличная стать, причтно чтать. Эду статью с примерами посложнее про MLS и MCS.</p>

    <div class="reply">
        <a rel="nofollow" class="comment-reply-login" href="https://defcon.ru/wp-login.php?redirect_to=https%3A%2F%2Fdefcon.ru%2Fos-security%2F1264%2F">Войдите, чтобы ответить</a>    </div>
            </div>
    </li><!-- #comment-## -->
	</ol><!-- .comment-list -->

	
	
	    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Оставить комментарий <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://defcon.ru/os-security/1264/#respond" style="display:none;">Отменить ответ</a></small></h3><p class="must-log-in">Для отправки комментария вам необходимо <a href="https://defcon.ru/wp-login.php?redirect_to=https%3A%2F%2Fdefcon.ru%2Fos-security%2F1264%2F">авторизоваться</a>.</p>	</div><!-- #respond -->
		
</div><!-- #comments -->
		<!-- </div>
	</div>  -->

</div>
</div>

<footer class="wrapper-footer">
    <div class="row_margin-null">
        <div class="footer__about-us">
            <img class="footer__about-us-img" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/logo_footer.png" alt="" width="200" height="">
        </div>

         <div class="footer__projects hidden-xs">
            <!-- Navigation -->
        <nav id="navigation">
				<ul id="menu-pentestitf" class="ptmenufooter"><li id="menu-item-1615" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1615"><a href="https://defcon.ru/about/">О сообществе</a></li>
<li id="menu-item-3320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3320"><a href="https://defcon.ru/owasp/">OWASP</a></li>
<li id="menu-item-4715" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4715"><a href="https://defcon.ru/feed">RSS</a></li>
<li id="menu-item-2791" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2791"><a title="Защита сайта" target="_blank" href="https://waf.pentestit.ru/"><img src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/Nemesida-WAF-white.png"></a></li>
</ul>        </nav>
        <!-- /Navigation -->
        </div>

        <div class="footer__social hidden-xs">
            <ul class="footer__social-menu">
		<li class="footer__projects-menu__item"><a target="_blank" href="https://vk.com/defconru"><div class="footer-icon-vk-off"></div></a></li>		
		<li class="footer__projects-menu__item"><a target="_blank" href="https://www.facebook.com/defconru"><div class="footer-icon-fb-off"></div></a></li>
                <li class="footer__projects-menu__item"><a target="_blank" href="https://twitter.com/defcon_ru"><div class="footer-icon-tw-off"></div></a></li>
            </ul>
        </div>

    </div>
</footer>



<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/jquery.js"></script>
<script type="text/javascript">
  jQuery(document).ready(function($){
    
    $.lightbox().overlay.options.style.opacity = 0.6;
    $.extend(true, $.lightbox().options, {
      emergefrom : "top",
      animation  : {
        move: {
          duration: 800
        }
      }
    });

    

    $(".lbe-lightbox,.lightbox, .evolution").lightbox({
      
      modal       : 0,
      autoresize  : 1
    });
  });
</script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/wp-ulike-plugins.js"></script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/bootstrap.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpum_frontend_js = {"ajax":"https:\/\/defcon.ru\/wp-admin\/admin-ajax.php","checking_credentials":"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430 \u0443\u0447\u0435\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 ...","pwd_meter":"","disable_ajax":""};
/* ]]> */
</script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/wp_user_manager.js"></script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/hideShowPassword.js"></script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/comment-reply.js"></script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/functions.js"></script>
<script type="text/javascript" src="%D0%97%D0%BD%D0%B0%D0%BA%D0%BE%D0%BC%D0%B8%D0%BC%D1%81%D1%8F%20%D1%81%20SELINUX%20%D0%B8%20%D0%BF%D1%8B%D1%82%D0%B0%D0%B5%D0%BC%D1%81%D1%8F%20%D0%BF%D0%BE%D0%BD%D1%8F%D1%82%D1%8C,%20%D0%BF%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%94%D1%8D%D0%BD%20%D0%A3%D0%BE%D0%BB%D1%88%20%D0%BF%D0%BB%D0%B0%D1%87%D0%B5%D1%82%20_%20DefconRU_files/wp-embed.js"></script>

<script type="text/javascript">
$('code').each(function(){if($(this).html().substring(0,4) == '<br>'){$(this).find('br').first().remove()}});
</script>

<script type="text/javascript">
    var yaParams = {/*Здесь параметры визита*/};
</script>

<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter29846554 = new Ya.Metrika({id:29846554,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    trackHash:true,params:window.yaParams||{ }});
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>


<div id="1497779524221" class="jquery-lightbox-overlay" style="position: fixed; top: 0px; left: 0px; opacity: 0.6; display: none; z-index: 99998;"></div><div class="jquery-lightbox-move" style="position: absolute; z-index: 99999; top: -999px;"><div class="jquery-lightbox jquery-lightbox-mode-image"><div class="jquery-lightbox-border-top-left"></div><div class="jquery-lightbox-border-top-middle"></div><div class="jquery-lightbox-border-top-right"></div><a class="jquery-lightbox-button-close" href="#close"><span>Close</span></a><div class="jquery-lightbox-navigator"><a class="jquery-lightbox-button-left" href="#"><span>Previous</span></a><a class="jquery-lightbox-button-right" href="#"><span>Next</span></a></div><div class="jquery-lightbox-buttons"><div class="jquery-lightbox-buttons-init"></div><a class="jquery-lightbox-button-left" href="#"><span>Previous</span></a><a class="jquery-lightbox-button-max" href="#"><span>Maximize</span></a><div class="jquery-lightbox-buttons-custom"></div><a class="jquery-lightbox-button-right" href="#"><span>Next</span></a><div class="jquery-lightbox-buttons-end"></div></div><div class="jquery-lightbox-background"></div><div class="jquery-lightbox-html"></div><div class="jquery-lightbox-border-bottom-left"></div><div class="jquery-lightbox-border-bottom-middle"></div><div class="jquery-lightbox-border-bottom-right"></div></div></div></body></html>