<!DOCTYPE html>
<html><head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="content-language" content="en">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="rUp8isOBygjhxPJ2qyy6QtBi9vWRFhIboMXucJsCtrE">
<link rel="stylesheet" type="text/css" href="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/css_jp_80_ltr_display_1.css">
<link rel="shortcut icon" href="https://cdn.justpaste.it/css/fav.ico">
<!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->
<link rel="canonical" href="https://justpaste.it/19ule">
<title>Хакер -&nbsp;Все в сборе: настраиваем Elasticsearch + Logstash + Kibana для сбора, фильтрации и анализ... - justpaste.it</title>
</head>
<body leftmargin="0" topmargin="0" dir="ltr" bgcolor="#EFEFEF" marginheight="0" marginwidth="0">

<div class="navbar navbar-default navbar-static-top mainTableTopMiddle" role="navigation">
<div class="container">
<div class="navbar-header pull-left">
<a href="https://justpaste.it/"><img alt="" src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/jp_logo_1_en_v4.png" height="54px" width="186px"></a> </div>
<div class="navbar-header pull-left">
<div class="nav navbar-nav mainTableTopMiddleRight hidden-xs hidden-sm">
<img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/jp_logo_2_en_v5.png" alt="" height="54px" width="390px"> </div>
</div>
<div class="navbar-header pull-right">
<div style="padding-top:8px;">
<a class="btn btn-danger btn-sm hidden-xs" style="font-weight: bold" href="https://justpaste.it/">Add note</a>
<a class="btn btn-danger btn-sm" style="font-weight: bold;" href="https://justpaste.it/top">Popular</a>
<a class="btn btn-danger btn-sm" style="font-weight: bold;" alt="P" rel="nofollow" href="https://justpaste.it/premium?back=%2F19ule">Premium <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACWUlEQVR4XqWTS2sUURCFv3t7HnmQRJCIIEYZgzDBRFB8oAiiG12IC4MgKrrSlYKC0Y1iXPgPxK2IggpJjEYXLiQuxBdExESTmRDfuyQ4OtPz6L59rb4T4g9IDTV17qlzimput7LWspRQ+ZsbbRjUUForSUCBtdgoIopCC6B1wvVQCnA9kUQ2mUqjRUTn0X6ioGqticDGRoMJKjZ7op/ssSsOC/d/cFizq/aeFGzQwhD6BdbsP01kasKFMiywXcevEk0/IcyPkD16WTjphYEzd+w7RbJl+cIArTBRlbl398kcPIupVW3HniPUpkcgpVxWco9Zf/giRrbMHDjDvGiNrSBeNCmNPj+FSicojA2IsA/mPiA8pWtNlK+3oQT7n4bp7L1A4f2A0+pzU47X2tPMTE6gEgmQ9CdHpHqopOZLbkJyXLCcPU96j0TnOa14HKexivKfIgqQYXw89I3S5woKTfl3SdJHNM443vvTmRTiKRTBgrZBxLrB3djAQmTpGcrQ0tWErVm2PdvE1qc9EAARdA+udRrxkHm429UExlKdn8OfnafsFVCeRgFKa0nlDJG7PiCuAiJj8JbNIl4SQtHYvoF06wrSba0k0q14jc14zS2QbAZrIPAxpRKmUiKsFqn+LaDTKynOvHUXgf/rDf73Uca23KYs11fJDzHa3ofN3cVM3uHFikuUcwP4+WHR3ML/+hz/xytAo2VVbBigVJLsgw6UTrnc9XonymtA6wZ2vNy+yGfvrRZtisgE9cecutFtJQCwAA5bVxwG0Ar54UItItQC3swSYsmf8z/NWUFBCPnqZgAAAABJRU5ErkJggg==" style="vertical-align: middle" height="16px" width="16px"></a>
</div>
</div>
</div>
</div>
<div id="headContainer" class="container" style="max-width: 960px;">
<script>
    function ga(ar1='', ar2='', ar3='', ar4='',ar5=''){};
</script>
<div class="row">
<div class="col-md-12">
<div id="mainTableContent">
<div style="max-width: 960px; vertical-align: top">
<div id="articleContent" style="direction: ltr" align="left">
<div>
<p>Хакер -&nbsp;Все в сборе: настраиваем Elasticsearch + Logstash + Kibana для сбора, фильтрации и анализа логов на сервере</p>
<p>nopaywall</p>
<p><img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/zse7ejjhrie.jpg" alt="" border="0" height="150" width="690"></p>
<p><a rel="nofollow" href="https://t.me/nopaywall">https://t.me/nopaywall</a></p>
<p><a rel="nofollow" href="https://xakep.ru/author/urban-prankster-2/" title="Записи Мартин urban.prankster Пранкевич">Мартин urban.prankster Пранкевич</a></p>
<div>
<h3>Содержание статьи</h3>
<ul><li class="h2"><a rel="nofollow" href="https://xakep.ru/2017/04/06/elk-logs/#toc01.">Стек ELK</a></li>
<li class="h2"><a rel="nofollow" href="https://xakep.ru/2017/04/06/elk-logs/#toc02.">Установка Filebeat</a></li>
<li class="h2"><a rel="nofollow" href="https://xakep.ru/2017/04/06/elk-logs/#toc03.">Ставим Logstash</a></li>
<li class="h2"><a rel="nofollow" href="https://xakep.ru/2017/04/06/elk-logs/#toc04.">Ставим Elasticsearch и Kibana</a></li>
<li class="h2"><a rel="nofollow" href="https://xakep.ru/2017/04/06/elk-logs/#toc05.">Вывод</a></li>
</ul></div>
<div>Журнaлы сервисов и приложений чуть ли не единственное средство, 
позволяющее найти источник проблем, но обычно после установки и отладки о
 них просто забывают. Современные подходы к разработке, деплою и 
сопровождению приложений требуют совершенно иного отношения — нужна 
возможность быстро найти необходимую информацию. Системы 
централизованнoго сбора и анализа журналов здесь выручают как никогда. 
Сегодня мы разберем, как настроить популярный ELK.</div>
<div>&nbsp;</div>
<h2>Стек ELK</h2>
<p>После установки сервисов логи разбросаны по каталогам и серверам, и 
максимум, что с ними делают, — это настраивают ротацию (кстати, не 
всегда). Обращаются к журналам, только когда обнаруживаются видимые 
сбои. Хотя нередко информация о проблемах появляется чуть раньше, чем 
падает какой-то сервис. Централизованный сбор и анализ логов позволяет 
решить сразу несколько проблем. В первую очередь это возможность 
посмотреть на все одновременно. Ведь сервис часто представляется 
несколькими подсистемами, которые могут быть расположены на разных 
узлах, и если проверять журналы по одному, то проблема будет не сразу 
ясна. Тратится больше времени, и сопоставлять события приxодится 
вручную. Во-вторых, повышаем безопасность, так как не нужно обеспечивать
 прямой доступ на сервер для просмотра журналов тем, кому он вообще не 
нужен, и тем более объяснять, что и где искать и куда смотреть. 
Например, разработчики не будут отвлекать админа, чтобы он нашел нужную 
информацию. В-третьих, пoявляется возможность парсить, обрабатывать 
результат и автоматически отбирать интересующие моменты, да еще и 
настраивать алерты. Особенно это актуально после ввода сервиса в работу,
 когда массово всплывают мелкие ошибки и проблeмы, которые нужно как 
можно быстрее устранить. В-четвертых, хранение в отдельном месте 
позволяет защитить журналы на случай взлома или недоступности сервиса и 
начать анализ сразу после обнаружения проблемы.</p>
<p>Есть коммерческие и облачные решения для агрегации и анализа журналов
 — Loggly, Splunk, Logentries и другие. Из open source решений очень 
популярен стек ELK от Elasticsearch, Logstash, Kibana. В основе ELK 
лежит построенный на базе библиотеки Apache Lucene поисковый движок<span>&nbsp;</span><a rel="nofollow" href="http://www.elastic.co/">Elasticsearch</a><span>&nbsp;</span>для
 индексирования и поиска информации в любом типе документов. Для сбора 
журналов из многочисленных источников и централизованного хранения 
используется Logstash, который поддерживает множество входных типов 
данных — это могут быть журналы, метрики разных сервисов и служб. При 
получении он их структурирует, фильтрует, анализирует, идентифицирует 
информацию (например, геокоординаты IP-адреса), упрощая тем самым 
послeдующий анализ. В дальнейшем нас интересует его работа в связке с 
Elasticsearch, хотя для Logstash написано большое количество расширений,
 позволяющих настроить вывод информации практически в любой другой 
источник.</p>
<div>
<p>&nbsp;</p>
</div>
<p>И наконец, Kibana — это веб-интерфейс для вывода индексированных 
Elasticsearch логов. Результатом может быть не только текстовая 
информация, но и, что удобно, диаграммы и графики. Он может 
визуализировать геоданные, строить отчеты, при установке<span>&nbsp;</span><a rel="nofollow" href="https://www.elastic.co/downloads/x-pack">X-Pack</a>становятся
 доступными алерты. Здесь уже каждый подстраивает интерфейс под свои 
задачи. Все продукты выпускаются одной компанией, поэтому их 
развертывание и совместная работа не представляет проблем, нужно только 
все правильно соединить.</p>
<p>В зависимости от инфраструктуры в ELK могут участвовать и другие 
приложения. Так, для передачи логов приложений с серверов на Logstash мы
 будeм использовать Filebeat. Кроме этого, также доступны Winlogbeat 
(события Windows Event Logs), Metricbeat (метрики), Packetbeat (сетевая 
информация) и Heartbeat (uptime).</p>
<div>&nbsp;</div>
<h2>Установка Filebeat</h2>
<p>Для устанoвки предлагаются apt- и yum-репозитории, deb- и rpm-файлы. 
Метод установки зависит от задач и вeрсий. Актуальная версия — 5.х. Если
 все ставится с нуля, то проблем нет. Но бывает, например, что уже 
иcпользуется Elasticsearch ранних версий и обновление до последней 
нежелательно. Поэтому установку компонентов ELK + Filebeat приходится 
выполнять персонально, что-то ставя и обновляя из пакетов, что-то при 
помощи репозитория. Для удобства лучше все шаги занести в плейбук 
Ansible, тем более что в Сети уже есть готовые решения. Мы же усложнять 
не будем и рассмотрим самый простой вариант.</p>
<p>Подключаем репозиторий и ставим пакеты:</p>
<p><code><span>$ sudo apt</span><span>-</span><span>get</span><span> install apt</span><span>-</span><span>transport</span><span>-</span><span>https $ wget </span><span>-</span><span>qO </span><span>-</span><span> https</span><span>:</span><span>//artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -</span><span> $ echo </span><span>"deb https://artifacts.elastic.co/packages/5.x/apt stable main"</span><span> </span><span>|</span><span> sudo tee </span><span>-</span><span>a </span><span>/</span><span>etc</span><span>/</span><span>apt</span><span>/</span><span>sources</span><span>.</span><span>list</span><span>.</span><span>d</span><span>/</span><span>elastic</span><span>-</span><span>5.x</span><span>.</span><span>list $ sudo apt</span><span>-</span><span>get</span><span> update </span><span>&amp;&amp;</span><span> sudo apt</span><span>-</span><span>get</span><span> install filebeat</span></code></p>
<p>В Ubuntu 16.04 с Systemd пeриодически всплывает небольшая проблема: 
некоторые сервисы, помеченные мейнтейнером пакета как enable при старте,
 на самом деле не включаются и при перезагрузке не стартуют. Вот как раз
 для продуктов Elasticsearch это актуально.</p>
<p><code><span>$ sudo systemctl enable filebeat</span></code></p>
<p>Все настройки производятся в конфигурационном файле 
/etc/filebeat/filebeat.yml, после установки уже есть шаблон с 
минимальными настройками. В этом же каталоге лежит файл 
filebeat.full.yml, в котором прописаны все<span>&nbsp;</span><a rel="nofollow" href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-configuration-details.html">возможные установки</a>.
 Если чего-то не хватает, то можно взять за основу его. Файл 
filebeat.template.json представляет собой шаблон для вывода, 
используемый по умолчанию. Его при необходимости можно переопределить 
или изменить.</p>
<a rel="nofollow" href="https://s04.justpaste.it/files/justpaste/d486/a17524590/c4ca4238a0b923820dcc509a6f75849b.jpg"><img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/c4ca4238a0b923820dcc509a6f75849b.jpg" alt="Конфигурационный файл Filebeat" border="0" width="1172"></a>
Конфигурационный файл Filebeat<p>Нам нужно, по сути, выполнить две 
основные задачи: указать, какие файлы брать и куда отправлять результат.
 В установках по умолчанию Filebeat собирает все файлы в пути<span>&nbsp;</span><code>/var/log/*.log</code>, это означает, что Filebeat соберет все файлы в каталоге<span>&nbsp;</span><code>/var/log/</code>, заканчивающиеся на<span>&nbsp;</span><code>.log</code>.</p>
<p><code><span>filebeat</span><span>.</span><span>prospectors</span><span>:</span><span> </span><span>-</span><span> input_type</span><span>:</span><span> log paths</span><span>:</span><span> </span><span>-</span><span> </span><span>/var/</span><span>log</span><span>/*.log document_type: log</span></code></p>
<p>Учитывая, что большинство дeмонов хранят логи в своих подкаталогах, 
их тоже следует прописать индивидуально или используя общий шаблон:</p>
<p><code><span>-</span><span> </span><span>/var/</span><span>log</span><span>/*/*.log</span></code></p>
<p>Источники с одинаковым input_type, log_type и document_type можно 
указывать по одному в строке. Если они отличаются, то создается 
отдельная запись.</p>
<p><code><span>-</span><span> paths</span><span>:</span><span> </span><span>-</span><span> </span><span>/var/</span><span>log</span><span>/</span><span>mysql</span><span>/</span><span>mysql</span><span>-</span><span>error</span><span>.</span><span>log fields</span><span>:</span><span> log_type</span><span>:</span><span> mysql</span><span>-</span><span>error </span><span>-</span><span> paths</span><span>:</span><span> </span><span>-</span><span> </span><span>/var/</span><span>log</span><span>/</span><span>mysql</span><span>/</span><span>mysql</span><span>-</span><span>slow</span><span>.</span><span>log fields</span><span>:</span><span> log_type</span><span>:</span><span> mysql</span><span>-</span><span>slow </span><span>...</span><span> </span><span>-</span><span> paths</span><span>:</span><span> </span><span>-</span><span> </span><span>/var/</span><span>log</span><span>/</span><span>nginx</span><span>/</span><span>access</span><span>.</span><span>log document_type</span><span>:</span><span> nginx</span><span>-</span><span>access </span><span>-</span><span> paths</span><span>:</span><span> </span><span>-</span><span> </span><span>/var/</span><span>log</span><span>/</span><span>nginx</span><span>/</span><span>error</span><span>.</span><span>log document_type</span><span>:</span><span> nginx</span><span>-</span><span>error</span></code></p>
<p>Поддерживаются все типы, о которых знает<span>&nbsp;</span><a rel="nofollow" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping.html">Elasticsearch</a>.</p>
<p>Дополнительные опции позволяют отобрать только определенные файлы и 
события. Например, нaм не нужно смотреть архивы внутри каталогов:</p>
<p><code><span>exclude_files</span><span>:</span><span> </span><span>[</span><span>".gz$"</span><span>]</span></code></p>
<p>По умолчанию экспортируются все строки. Но при помощи регулярных 
выражений можно включить и исключить вывод определенных данных в 
Filebeat. Их можно указывать для каждого paths.</p>
<p><code><span>include_lines</span><span>:</span><span> </span><span>[</span><span>'^ERR'</span><span>,</span><span> </span><span>'^WARN'</span><span>]</span><span> exclude_lines</span><span>:</span><span> </span><span>[</span><span>'^DBG'</span><span>]</span></code></p>
<p>Если определены оба вaрианта, Filebeat сначала выполняет<span>&nbsp;</span><code>include_lines</code>, а затем<span>&nbsp;</span><code>exclude_lines</code>.
 Порядок, в котором они прописаны, значения не имеет. Кроме этого, в 
описании можно использовать теги, поля, кодировку и так далее.</p>
<p>Теперь переходим к разделу Outputs. Прописываем, куда будем отдавать 
данные. В шаблоне уже есть установки для Elasticsearch и Logstash. Нам 
нужен второй.</p>
<p><code><span>output</span><span>.</span><span>logstash</span><span>:</span><span> hosts</span><span>:</span><span> </span><span>[</span><span>"localhost:5044"</span><span>]</span></code></p>
<p>Здесь самый простой случай. Если отдаем на другой узел, то желательно использовать авторизацию по ключу. В файле есть шаблон.</p>
<p>Чтобы посмотреть результат, можно выводить его в файл:</p>
<p><code><span>output</span><span>:</span><span> </span><span>...</span><span> file</span><span>:</span><span> path</span><span>:</span><span> </span><span>/tmp/</span><span>filebeat</span></code></p>
<p>Нелишними будут настройки ротации:</p>
<p><code><span>shipper</span><span>:</span><span> logging</span><span>:</span><span> files</span><span>:</span><span> rotateeverybytes</span><span>:</span><span> </span><span>10485760</span><span> </span><span># = 10MB</span></code></p>
<p>Это минимум. На самом деле параметров можно указать больше. Все они есть в full-файле. Проверяем настройки:</p>
<p><code><span>$ filebeat</span><span>.</span><span>sh </span><span>-</span><span>configtest </span><span>-</span><span>e </span><span>....</span><span> </span><span>Config</span><span> OK</span></code></p>
<p>Применяем:</p>
<p><code><span>$ sudo systemctl start filebeat $ sudo systemctl status filebeat</span></code></p>
<p>Сервис может работать, но это не значит, что все правильно. Лучше посмотреть в журнал<span>&nbsp;</span><code>/var/log/filebeat/filebeat</code><span>&nbsp;</span>и убедиться, что там нет ошибок. Проверим:</p>
<p><code><span>$ curl </span><span>-</span><span>XPUT </span><span>'http://localhost:9200/_template/filebeat'</span><span> </span><span>-</span><span>d@</span><span>/</span><span>etc</span><span>/</span><span>filebeat</span><span>/</span><span>filebeat</span><span>.</span><span>template</span><span>.</span><span>json </span><span>{</span><span>"acknowledged"</span><span>:</span><span>true</span><span>}</span></code></p>
<p>Еще важный момент. Не всегда журналы по умолчанию содержат нужную 
информацию, поэтому, вероятно, следует пересмотреть и изменить формат, 
если есть такaя возможность. В анализе работы nginx неплохо помогает 
статистика по времени запроса.</p>
<p><code><span>$ sudo nano </span><span>/</span><span>etc</span><span>/</span><span>nginx</span><span>/</span><span>nginx</span><span>.</span><span>conf log_format logstash </span><span>'$remote_addr - [$time_local] $host "$request" '</span><span> </span><span>'$status $body_bytes_sent "$http_referer" '</span><span> </span><span>'"$http_user_agent" $request_time '</span><span> </span><span>'$upstream_response_time $request_uuid'</span><span>;</span><span> access_log </span><span>/</span><span>var</span><span>/</span><span>log</span><span>/</span><span>nginx</span><span>/</span><span>access</span><span>.</span><span>log logstash</span><span>;</span></code></p>
<div>&nbsp;</div>
<h2>Ставим Logstash</h2>
<p>Для Logstash нужна Java 8. Девятая версия не поддерживается. Это 
может быть официальная Java SE или OpenJDK, имеющийся в репозиториях 
дистрибутивов Linux.</p>
<p><code><span>$ sudo apt install logstash $ sudo systemctl enable logstash</span></code></p>
<p>Конвейер Logstash имеет два обязательных элемента:<span>&nbsp;</span><code>input</code><span>&nbsp;</span>и<span>&nbsp;</span><code>output</code>. И необязательный —<span>&nbsp;</span><code>filter</code>.
 Плагины ввода берут данные из источника, выходные — записывают по 
назначению, фильтры изменяют данные по указанному шаблону. Флаг<span>&nbsp;</span><code>-e</code><span>&nbsp;</span>позволяет
 указать конфигурацию непосредственно в командной строке, что можно 
использовать для тестирования. Запустим самый простой конвейер:</p>
<p><code><span>$ </span><span>/</span><span>usr</span><span>/</span><span>share</span><span>/</span><span>logstash</span><span>/</span><span>bin</span><span>/</span><span>logstash </span><span>-</span><span>e </span><span>'input { stdin { } } output { stdout {} }'</span></code></p>
<p>Он ничего умного не делает, просто выводит то, что пришло на<span>&nbsp;</span><code>stdin</code>. Вводим любое сообщение, и Logstash его продублирует, добавив метку времени.</p>
<a rel="nofollow" href="https://s02.justpaste.it/files/justpaste/d486/a17524590/c81e728d9d4c2f636f067f89cc14862c.jpg"><img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/c81e728d9d4c2f636f067f89cc14862c.jpg" alt="Простая проверка Logstash" border="0" width="1200"></a>
Простая проверка Logstash<p>Все конфигурационные файлы находятся в<span>&nbsp;</span><code>/etc/logstash</code>. Настройки в<span>&nbsp;</span><code>/etc/logstash/startup.options</code>,<span>&nbsp;</span><code>jvm.options</code><span>&nbsp;</span>определяют пaраметры запуска, в<span>&nbsp;</span><code>logstash.yml</code><span>&nbsp;</span>параметры работы самого сервиса. Конвейеры опиcываются в файлах в<span>&nbsp;</span><code>/etc/logstash/conf.d</code>.
 Здесь пока нет ничего. Как располагать фильтры, каждый решаeт сам. 
Можно подключения к сервисам описывать в одном файле, разделять файлы по
 назначению —<span>&nbsp;</span><code>input</code>,<span>&nbsp;</span><code>output</code><span>&nbsp;</span>и<span>&nbsp;</span><code>filter</code>. Как кому удoбно.</p>
<p>Подключаемся к Filebeat.</p>
<p><code><span>$ sudo nano </span><span>/</span><span>etc</span><span>/</span><span>logstash</span><span>/</span><span>conf</span><span>.</span><span>d</span><span>/</span><span>01</span><span>-</span><span>input</span><span>.</span><span>conf input </span><span>{</span><span> beats </span><span>{</span><span> port </span><span>=&gt;</span><span> </span><span>5044</span><span> </span><span>}</span><span> </span><span>}</span></code></p>
<p>Здесь же при необходимости указываются сертификаты, которые требуются
 для аутентификации и защиты соединения. Logstash самостоятельно может 
брать информацию с локального узла.</p>
<p><code><span>input </span><span>{</span><span> file </span><span>{</span><span> path </span><span>=&gt;</span><span> </span><span>"/var/log/nginx/*access*"</span><span> </span><span>}</span><span> </span><span>}</span></code></p>
<p>В примере beats и file — это названия соответствующих плагинов. 
Полный их список для inputs, outputs и filter и поддерживаемые параметры
 доступны на<span>&nbsp;</span><a rel="nofollow" href="https://www.elastic.co/guide/en/logstash/current/working-with-plugins.html">сайте</a>.</p>
<p>После установки в систему уже есть некоторые плагины. Их список пpоще получить при помощи специальной команды:</p>
<p><code><span>$ </span><span>/</span><span>usr</span><span>/</span><span>share</span><span>/</span><span>logstash</span><span>/</span><span>bin</span><span>/</span><span>logstash</span><span>-</span><span>plugin list $ </span><span>/</span><span>usr</span><span>/</span><span>share</span><span>/</span><span>logstash</span><span>/</span><span>bin</span><span>/</span><span>logstash</span><span>-</span><span>plugin list </span><span>--</span><span>group</span><span> output</span></code></p>
<p>Сверяем список с сайтом, обновляем имеющиеся и ставим нужный:</p>
<p><code><span>$ </span><span>/</span><span>usr</span><span>/</span><span>share</span><span>/</span><span>logstash</span><span>/</span><span>bin</span><span>/</span><span>logstash</span><span>-</span><span>plugin update $ </span><span>/</span><span>usr</span><span>/</span><span>share</span><span>/</span><span>logstash</span><span>/</span><span>bin</span><span>/</span><span>logstash</span><span>-</span><span>plugin install logstash</span><span>-</span><span>output</span><span>-</span><span>geoip </span><span>--</span><span>no</span><span>-</span><span>verify</span></code></p>
<p>Если систем много, то можно использовать<span>&nbsp;</span><code>logstash-plugin prepare-offline-pack</code><span>&nbsp;</span>для создания пакета и распространения на другие системы.</p>
<p>Отдаем данные на Elasticsearch.</p>
<p><code><span>$ sudo nano </span><span>/</span><span>etc</span><span>/</span><span>logstash</span><span>/</span><span>conf</span><span>.</span><span>d</span><span>/</span><span>02</span><span>-</span><span>output</span><span>.</span><span>conf output </span><span>{</span><span> elasticsearch </span><span>{</span><span> hosts </span><span>=&gt;</span><span> </span><span>[</span><span>"localhost:9200"</span><span>]</span><span> </span><span>}</span><span> </span><span>}</span></code></p>
<p>И самое интересное — фильтры. Создаем файл, который будет обрабатывать данные с типом<span>&nbsp;</span><code>nginx-access</code>.</p>
<p><code><span>$ sudo nano </span><span>/</span><span>etc</span><span>/</span><span>logstash</span><span>/</span><span>conf</span><span>.</span><span>d</span><span>/</span><span>03</span><span>-</span><span>nginx</span><span>-</span><span>filter</span><span>.</span><span>conf filter </span><span>{</span><span> </span><span>if</span><span> </span><span>[</span><span>type</span><span>]</span><span> </span><span>==</span><span> </span><span>"nginx-access"</span><span> </span><span>{</span><span> grok </span><span>{</span><span> match </span><span>=&gt;</span><span> </span><span>{</span><span> </span><span>"message"</span><span> </span><span>=&gt;</span><span> </span><span>"%{NGINXACCESS}"</span><span> </span><span>}</span><span> overwrite </span><span>=&gt;</span><span> </span><span>[</span><span> </span><span>"message"</span><span> </span><span>]</span><span> </span><span>}</span><span> date </span><span>{</span><span> locale </span><span>=&gt;</span><span> </span><span>"en"</span><span> match </span><span>=&gt;</span><span> </span><span>[</span><span> </span><span>"timestamp"</span><span> </span><span>,</span><span> </span><span>"dd/MMM/YYYY:HH:mm:ss Z"</span><span> </span><span>]</span><span> </span><span>}</span><span> </span><span>}</span><span> </span><span>}</span></code></p>
<p>Для анализа данных в Logstash может использоваться несколько<span>&nbsp;</span><a rel="nofollow" href="https://www.elastic.co/guide/en/logstash/current/filter-plugins.html">фильтров</a>.
 Grok, наверное, лучший вариант, позволяющий отобрать любые 
неструктурированные данные во что-то структурированное и запрашиваемое. 
По умолчанию Logstash содержит приблизительно 120 шаблонов. Просмотреть 
их можно в<span>&nbsp;</span><a rel="nofollow" href="https://github.com/logstash-plugins/logstash-patterns-core/tree/master/patterns">github.com</a>.
 Если их не хватает, легко добавить свои правила, указав прямо в строке 
match, что очень неудобно, или прописав все в отдельном файле, задав 
уникальное имя правилу и сказав Logstash, где их искать (еcли не 
установлена переменная patterns_dir):</p>
<p><code><span>patterns_dir </span><span>=&gt;</span><span> </span><span>[</span><span>"./patterns"</span><span>]</span><span> </span></code></p>
<p>Для проверки корректности правил можно использовать сайт<span>&nbsp;</span><a rel="nofollow" href="https://grokdebug.herokuapp.com/">grokdebug</a><span>&nbsp;</span>или<span>&nbsp;</span><a rel="nofollow" href="http://grokconstructor.appspot.com/">grokconstructor</a>, там же есть еще готовые паттерны для разных приложений.</p>
<p>Создадим фильтр для отбора события NGINXACCESS для nginx. Формат 
простой — имя шаблона и соответствующее ему регулярное выражение.</p>
<p><code><span>$ mkdir </span><span>/</span><span>etc</span><span>/</span><span>logstash</span><span>/</span><span>patterns $ cat </span><span>/</span><span>etc</span><span>/</span><span>logstash</span><span>/</span><span>patterns</span><span>/</span><span>nginx NGUSERNAME </span><span>[</span><span>a</span><span>-</span><span>zA</span><span>-</span><span>Z</span><span>.@-+</span><span>_</span><span>%]+</span><span> NGUSER </span><span>%{</span><span>NGUSERNAME</span><span>}</span><span> NGINXACCESS </span><span>%{</span><span>IPORHOST</span><span>:</span><span>http_host</span><span>}</span><span> </span><span>%{</span><span>IPORHOST</span><span>:</span><span>clientip</span><span>}</span><span> </span><span>[%</span><span> </span><span>{</span><span>HTTPDATE</span><span>:</span><span>timestamp</span><span>}]</span><span> </span><span>"(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})"</span><span> </span><span>%{</span><span>NUMBER</span><span>:</span><span>response</span><span>}</span><span> </span><span>(?:%{</span><span>NUMBER</span><span>:</span><span>bytes</span><span>}|-)</span><span> </span><span>%{</span><span>QS</span><span>:</span><span>referrer</span><span>}</span><span> </span><span>%{</span><span>QS</span><span>:</span><span>agent</span><span>}</span><span> </span><span>%{</span><span>NUMBER</span><span>:</span><span>request_time</span><span>:</span><span>float</span><span>}</span><span> </span><span>(</span><span> </span><span>%{</span><span>UUID</span><span>:</span><span>request_id</span><span>})</span></code></p>
<p>Перезапускаем:</p>
<p><code><span>$ sudo service logstash restart</span></code></p>
<p>Убеждаемся в журнaлах, что все работает.</p>
<p><code><span>$ tail </span><span>-</span><span>f </span><span>/</span><span>var</span><span>/</span><span>log</span><span>/</span><span>logstash</span><span>/</span><span>logstash</span><span>-</span><span>plain</span><span>.</span><span>log </span><span>[</span><span>INFO </span><span>][</span><span>logstash</span><span>.</span><span>inputs</span><span>.</span><span>beats </span><span>]</span><span> </span><span>Beats</span><span> inputs</span><span>:</span><span> </span><span>Starting</span><span> input listener </span><span>{:</span><span>address</span><span>=&gt;</span><span>"localhost:5044"</span><span>}</span><span> </span><span>[</span><span>INFO </span><span>][</span><span>logstash</span><span>.</span><span>pipeline </span><span>]</span><span> </span><span>Pipeline</span><span> main started </span><span>[</span><span>INFO </span><span>][</span><span>logstash</span><span>.</span><span>agent </span><span>]</span><span> </span><span>Successfully</span><span> started </span><span>Logstash</span><span> API endpoint </span><span>{:</span><span>port</span><span>=&gt;</span><span>9600</span><span>}</span></code></p>
<div>&nbsp;</div>
<h2>Ставим Elasticsearch и Kibana</h2>
<p>Самое время поставить Elasticsearch:</p>
<p><code><span>$ sudo apt install elasticsearch $ sudo systemctl enable elasticsearch</span></code></p>
<p>По умолчанию Elasticsearch слушает локальный 9200-й порт. В 
большинстве случаев лучше так и оставить, чтобы посторонний не мог 
получить доступ. Если сервис находится внутри сети или доступен по VPN, 
то можно указать внешний IP и изменить пoрт, если он уже занят.</p>
<p><code><span>$ sudo nano </span><span>/</span><span>etc</span><span>/</span><span>elasticsearch</span><span>/</span><span>elasticsearch</span><span>.</span><span>yml </span><span>#network.host: 192.168.0.1</span><span> </span><span>#http.port: 9200</span></code></p>
<p>Также стоит помнить, что Elasticsearch любит ОЗУ (по умолчанию запускается с<span>&nbsp;</span><code>-Xms2g -Xmx2g</code>): возможно, придется поиграть значением, уменьшая или увеличивая его в файле<span>&nbsp;</span><code>/etc/elasticsearch/jvm.options</code><span>&nbsp;</span>не выше 50% ОЗУ.</p>
<p>С Kibana то же самое:</p>
<p><code><span>$ sudo apt</span><span>-</span><span>get</span><span> install kibana $ sudo systemctl enable kibana $ sudo systemctl start kibana</span></code></p>
<p>По умолчанию Kibana стартует на localhost:5601. В тестовой среде можно разрешить подключаться удаленно, изменив в файле<span>&nbsp;</span><code>/etc/kibana/kibana.yml</code><span>&nbsp;</span>параметр<span>&nbsp;</span><code>server.host</code>. Но так как какой-то аутентификации не предусмотрено, лучше в качестве фронта использовать nginx, настроив обычный<span>&nbsp;</span><code>proxy_pass</code><span>&nbsp;</span>и доступ с<span>&nbsp;</span><code>htaccess</code>.</p>
<p>Первым делом нужно сказать Kibana об индексах Elasticsearch, которые 
нас интересуют, настроив один или несколько шаблонов. Если Kibana не 
найдет в базе шаблона, то и не даст его активировать при вводе. Самый 
простой шаблон<span>&nbsp;</span><code>*</code><span>&nbsp;</span>позволяет увидеть все данные и сориентироваться. Для filebeat пишем<span>&nbsp;</span><code>filebeat-*</code><span>&nbsp;</span>и в поле Time-feald name —<span>&nbsp;</span><code>@timestamp</code>.</p>
<a rel="nofollow" href="https://s02.justpaste.it/files/justpaste/d486/a17524590/eccbc87e4b5ce2fe28308fd9f2a7baf3.jpg"><img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/eccbc87e4b5ce2fe28308fd9f2a7baf3.jpg" alt="Добавляем шаблон индекса в Kibana" border="0" width="1200"></a>
Добавляем шаблон индекса в Kibana<p>После этого, если агенты подключены нормально, в секции Discover начнут появляться логи.</p>
<a rel="nofollow" href="https://s04.justpaste.it/files/justpaste/d486/a17524590/a87ff679a2f3e71d9181a67b7542122c.jpg"><img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/a87ff679a2f3e71d9181a67b7542122c.jpg" alt="Пошли журналы" border="0" width="1200"></a>
Пошли журналы<p>Далее последовательно пeреходим по вкладкам, настраиваем графики и Dashboard.</p>
<a rel="nofollow" href="https://s04.justpaste.it/files/justpaste/d486/a17524590/e4da3b7fbbce2345d7772b0674a318d5.jpg"><img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/e4da3b7fbbce2345d7772b0674a318d5.jpg" alt="Меню выбора графиков" border="0" width="1200"></a>
Меню выбора графиков<p>Готовые установки Dashboard можно найти в Сети и импортировать в Kibana.</p>
<p><code><span>$ curl </span><span>-</span><span>L </span><span>-</span><span>O http</span><span>:</span><span>//download.elastic.co/beats/dashboards/beats-dashboards-1.3.1.zip</span><span> $ unzip beats</span><span>-</span><span>dashboards</span><span>-</span><span>1.3</span><span>.</span><span>1.zip</span><span> $ cd beats</span><span>-</span><span>dashboards</span><span>-</span><span>1.3</span><span>.</span><span>1</span><span>/</span><span> $ </span><span>./</span><span>load</span><span>.</span><span>sh</span></code></p>
<p>После импорта переходим в Dashboard, нажимаем Add и выбираем из списка нужный.</p>
<a rel="nofollow" href="https://s02.justpaste.it/files/justpaste/d486/a17524590/1679091c5a880faf6fb5e6087eb1b2dc.jpg"><img src="%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5%20%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7...%20-%20justpaste.it_files/1679091c5a880faf6fb5e6087eb1b2dc.jpg" alt="Добавляем Dashboard" border="0" width="1200"></a>
Добавляем Dashboard<div>&nbsp;</div>
<h2>Вывод</h2>
<p>Готово! Минимум у нас уже есть. Дальше Kibana легко подстраивается индивидуально под потребности конкретной сети.</p>
<p>Читайте ещё больше платных статей бесплатно:&nbsp;<a rel="nofollow" href="https://t.me/nopaywall">https://t.me/nopaywall</a></p> </div>
<br clear="all"><br clear="all">
<div class="row">
<div class="noteFotter">
<div class="col-md-3 col-xs-4 noteBottomFooter">Created: 08/08/2017</div>
<div class="col-md-2 col-xs-4 noteBottomFooter">
Views: 893<br>
Online: 0 </div>
<div class="col-md-1 col-xs-4 noteBottomFooter">
<a rel="nofollow" class="btn btn-sm btn-warning" href="https://justpaste.it/jppdf/19ule">Save&nbsp;as&nbsp;PDF</a> </div>
<div class="col-md-2 hidden-xs hidden-sm noteBottomFooter">
<a rel="nofollow" class="btn btn-sm btn-warning" href="http://justpaste.it/report/19ule">Report</a> </div>
<div class="col-md-4 col-xs-12 " style="padding-top: 8px" align="center">
<table border="0" width="206px"><tbody><tr><td><div style="width: 34px; float: left" align="center"><script>function fbs_click() {u='https://justpaste.it/19ule';t=document.title;window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(u)+'&t='+encodeURIComponent(t),'sharer','toolbar=0,status=0,width=650,height=306,scrollbars=yes');ga('send', 'event', 'Note', 'Share','Facebook');return false;}</script><a rel="nofollow" href="http://www.facebook.com/share.php?u=%3Curl%3E" title="Facebook" onclick="return fbs_click()" target="_blank" class="facebookShare"></a></div><div style="width: 34px; float: left" align="center"><a rel="nofollow" href="http://twitter.com/intent/tweet?url=https://justpaste.it/19ule" onclick="window.open('http:\/\/twitter.com\/intent\/tweet?url='+encodeURIComponent('https://justpaste.it/19ule')+'&amp;text='+encodeURIComponent('Хакер - Все в сборе: настраиваем Elasticsearch + Logstash + Kibana для сбора, фильтрации и анализ... '),'sharer','toolbar=0,status=0,width=550,height=420, scrollbars=yes'); ga('send', 'event', 'Note', 'Share','Tweeter'); return false;" title="Twitter" target="_blank" class="tweeterShare"></a></div><div style="width: 34px; float: left" align="center"><a rel="nofollow" href="https://plus.google.com/share?url=https://justpaste.it/19ule" onclick="window.open('https:\/\/plus.google.com\/share?url='+encodeURIComponent('https://justpaste.it/19ule'),'sharer','toolbar=0,status=0,width=620,height=620, scrollbars=yes'); ga('send', 'event', 'Note', 'Share','GooglePlus'); return false;" title="Google+" target="_blank" class="googleShare"></a></div><div style="width: 34px; float: left" align="center"><a rel="nofollow" href="http://reddit.com/submit?url=https://justpaste.it/19ule&amp;title=%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5:%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7..." onclick="window.open('http:\/\/reddit.com\/submit?url='+encodeURIComponent('https://justpaste.it/19ule')+'&amp;title='+encodeURIComponent('Хакер - Все в сборе: настраиваем Elasticsearch + Logstash + Kibana для сбора, фильтрации и анализ... '),'sharer','toolbar=0,status=0,width=1024,height=650, scrollbars=yes'); ga('send', 'event', 'Note', 'Share','Reddit'); return false;" title="Reddit" target="_blank" class="redditShare"></a></div><div style="width: 34px; float: left" align="center"><a rel="nofollow" href="http://pinterest.com/pin/create/button/?url=https://justpaste.it/19ule" onclick="window.open('http:\/\/pinterest.com\/pin\/create\/button\/?url='+encodeURIComponent('https://justpaste.it/19ule'),'sharer','toolbar=0,status=0,width=1024,height=650, scrollbars=yes'); ga('send', 'event', 'Note', 'Share','Pinterest'); return false;" title="Pinterest" target="_blank" class="pintrestShare"></a></div><div style="width: 34px; float: left" align="center"><a rel="nofollow" href="http://www.stumbleupon.com/submit?url=https://justpaste.it/19ule&amp;title=%D0%A5%D0%B0%D0%BA%D0%B5%D1%80%20-%C2%A0%D0%92%D1%81%D0%B5%20%D0%B2%20%D1%81%D0%B1%D0%BE%D1%80%D0%B5:%20%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%B0%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%20Elasticsearch%20+%20Logstash%20+%20Kibana%20%D0%B4%D0%BB%D1%8F%20%D1%81%D0%B1%D0%BE%D1%80%D0%B0,%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B8%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7..." onclick="window.open('http://www.stumbleupon.com/submit?url='+encodeURIComponent('https://justpaste.it/19ule')+'&amp;title='+encodeURIComponent('Хакер - Все в сборе: настраиваем Elasticsearch + Logstash + Kibana для сбора, фильтрации и анализ... '),'sharer','toolbar=0,status=0,width=1024,height=650,scrollbars=yes'); ga('send', 'event', 'Note', 'Share','StumbleUpon'); return false;" title="StumbleUpon" target="_blank" class="stumbleShare"></a></div></td></tr></tbody></table> </div>
</div>
</div>
</div>
</div>
</div>
</div>
</div> 
</div> 
<div id="footer" style="min-height: 50px;">
<div class="container" style="vertical-align: middle">
<div class="col-md-3 col-xs-5 col-sm-4 text-muted" style="vertical-align: middle; font-size: 95%; padding-top: 7px" align="left">
© 2017 <span class="visible-sm-inline">justpaste.it</span> </div>
<div class="col-md-9 col-xs-7 col-sm-8 text-muted" align="right">
<ul style="font-size: 90%" class="list-inline">
<li class="hidden-xs" style="vertical-align: middle"><a href="https://justpaste.it/top/popular/new">Popular</a></li>
<li class="hidden-xs" style="vertical-align: middle"><a href="https://justpaste.it/premium">Premium</a></li>
<li class="hidden-xs" style="vertical-align: middle"><a href="https://justpaste.it/jpregulations">Terms of Service</a></li>
<li class="hidden-xs" style="vertical-align: middle"><a href="https://justpaste.it/u/justpasteit">Blog</a></li>
<li style="vertical-align: middle"><a href="https://justpaste.it/jpabout">About</a></li>
<li style="vertical-align: middle"><a href="https://www.facebook.com/justpaste.it" title="Facebook" target="_blank" class="facebookShare img-circle" style="margin-right: 5px; float: left"></a>
<a href="https://twitter.com/justpasteit" title="Twitter" target="_blank" class="tweeterShare img-circle" style="float: left"></a></li>
</ul>
</div>
</div>
</div>



</body><div data="{&quot;a&quot;:&quot;show_Div&quot;,&quot;url&quot;:&quot;https://s04.justpaste.it/files/justpaste/d486/a17524590/c4ca4238a0b923820dcc509a6f75849b.jpg&quot;,&quot;host&quot;:&quot;s04.justpaste.it&quot;,&quot;safe&quot;:true,&quot;preview&quot;:false,&quot;live&quot;:true}" style="display:none" id="sp_console_event"></div></html>