<!DOCTYPE html>
<html lang="en-GB"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8"><script src="Firewalld%20Rich%20and%20Direct%20Rules_files/nr-1044.js"></script><script src="Firewalld%20Rich%20and%20Direct%20Rules_files/analytics.js" async=""></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(2),u=e(3),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}finally{f.emit("fn-end",[c.now()],t)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],4:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=m(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){v[e]=m(e).concat(n)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(t)}function g(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var v={},y={},b={on:l,emit:t,get:w,listeners:m,context:n,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(2),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=h.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+h.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===d.readyState&&i()}function i(){f("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),f=e("handle"),c=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1044.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=n.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),f("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script>
<meta name="viewport" content="width=device-width">
<meta name="author" content="Tomas Nevar">
<meta name="dcterms.dateCopyrighted" content="2013">
<meta name="dcterms.rightsHolder" content="LISENET.COM">
<meta name="dcterms.rights" content="All Rights Reserved">
<meta name="description" content="Technical blog about Linux, Security, Networking and IT. Study guides for RHCE, LPIC and more.">
<meta name="keywords" content="Linux, admin, RHCSA, RHCE, LPIC, LPIC-2, LPIC-3, Debian, Ubuntu, CentOS, RHEL, security, networking, monitoring, AWS">
<meta name="google-site-verification" content="gqUWiN6EEDXNRQDjoervu5SZomRNj8o0O6dgDv6LfQ0">
<meta property="og:type" content="blog">
<meta property="og:site_name" content="Lisenet">
<meta property="og:title" content="Lisenet.com :: Linux | Security | Networking | Admin Blog">
<meta property="og:description" content="Technical admin blog about Linux, Security, Networking and IT.">
<meta property="og:url" content="https://www.lisenet.com/">
<meta property="og:image" content="https://www.lisenet.com/wp-content/uploads/2013/10/lisenet_logo_90px.png">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<link rel="apple-touch-icon" sizes="57x57" href="https://www.lisenet.com/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://www.lisenet.com/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://www.lisenet.com/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://www.lisenet.com/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://www.lisenet.com/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://www.lisenet.com/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://www.lisenet.com/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://www.lisenet.com/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://www.lisenet.com/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://www.lisenet.com/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.lisenet.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://www.lisenet.com/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.lisenet.com/favicon-16x16.png">
<link rel="manifest" href="https://www.lisenet.com/manifest.json">
<title>Firewalld Rich and Direct Rules: Setting up RHEL 7 Server as a Router | Lisenet.com :: Linux | Security | Networking</title>
<link rel="profile" href="https://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.lisenet.com/xmlrpc.php">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Lisenet.com :: Linux | Security | Networking » Feed" href="https://www.lisenet.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Lisenet.com :: Linux | Security | Networking » Comments Feed" href="https://www.lisenet.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Lisenet.com :: Linux | Security | Networking » Firewalld Rich and Direct Rules: Setting up RHEL 7 Server as a Router Comments Feed" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/feed/">
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.lisenet.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script defer="defer" type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/wp-emoji-release.js"></script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="style-css" href="Firewalld%20Rich%20and%20Direct%20Rules_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="flexslider-css" href="Firewalld%20Rich%20and%20Direct%20Rules_files/flexslider.css" type="text/css" media="all">
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/jquery_002.js"></script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var gadwpUAEventsData = {"options":{"event_tracking":"1","event_downloads":"zip|mp3|mpeg|pdf|doc*|ppt*|xls*|jpeg|png|gif|tiff","event_bouncerate":"1","aff_tracking":0,"event_affiliates":"\/out\/","hash_tracking":0,"root_domain":"lisenet.com","event_timeout":100,"event_precision":0,"event_formsubmit":0,"ga_pagescrolldepth_tracking":0}};
/* ]]> */
</script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/tracking-analytics-events.js"></script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/keyboard-image-navigation.js"></script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/jquery.js"></script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/flexslider-init.js"></script>
<link rel="https://api.w.org/" href="https://www.lisenet.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.lisenet.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.lisenet.com/wp-includes/wlwmanifest.xml">
<link rel="prev" title="Setting up a MariaDB Server with SELinux on RHEL 7" href="https://www.lisenet.com/2016/mariadb-server-with-selinux-on-rhel-7/">
<link rel="next" title="RHCE Sample Exam for RHEL 7" href="https://www.lisenet.com/2016/rhce-sample-exam-for-rhel-7/">
<link rel="canonical" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/">
<link rel="shortlink" href="https://www.lisenet.com/?p=5239">
<link rel="alternate" type="application/json+oembed" href="https://www.lisenet.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.lisenet.com%2F2016%2Ffirewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.lisenet.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.lisenet.com%2F2016%2Ffirewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router%2F&amp;format=xml">
<link rel="stylesheet" href="Firewalld%20Rich%20and%20Direct%20Rules_files/black.css" type="text/css" media="screen">
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="stylesheet" href="Firewalld%20Rich%20and%20Direct%20Rules_files/wassup-widget.css" type="text/css">
<script type="text/javascript">
//<![CDATA[
function wassup_get_screenres(){
	var screen_res = screen.width + " x " + screen.height;
	if(screen_res==" x ") screen_res=window.screen.width+" x "+window.screen.height;
	if(screen_res==" x ") screen_res=screen.availWidth+" x "+screen.availHeight;
	if (screen_res!=" x "){document.cookie = "wassup_screen_res7a548cc76cf5a869d21212129f6cb3a6=" + encodeURIComponent(screen_res)+ "; path=/; domain=" + document.domain;}
}
wassup_get_screenres();
//]]>
</script> <style type="text/css">
			.site-title,
		.site-description {
			position: absolute !important;
			/* clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
			clip: rect(1px, 1px, 1px, 1px);
		}
		.site-header hgroup {
			background: none;
			padding: 0;
		}
		</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #eaeaea; }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-36729276-2', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>

</head>
<body class="post-template-default single single-post postid-5239 single-format-standard custom-background">
<div id="wrap">
<div id="page" class="hfeed site">

<header id="masthead" class="site-header">
<div class="site-logo">
<a href="https://www.lisenet.com/" title="Lisenet.com :: Linux | Security | Networking" rel="home"><img src="Firewalld%20Rich%20and%20Direct%20Rules_files/lisenet_logo_90px.png" alt="Lisenet.com :: Linux | Security | Networking"></a>
</div>

<nav class="site-navigation main-navigation">
<h1 class="assistive-text">Menu</h1>
<div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>
<div class="menu-livemenu-container"><ul id="menu-livemenu" class="menu"><li id="menu-item-4069" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-4069"><a href="https://www.lisenet.com/">Blog</a></li>
<li id="menu-item-308" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-308"><a href="https://www.lisenet.com/about/">About</a></li>
<li id="menu-item-592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-592"><a href="https://www.lisenet.com/all-posts/">All Posts</a></li>
<li id="menu-item-2684" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2684"><a href="https://www.lisenet.com/lpic-2/">LPIC-2</a></li>
<li id="menu-item-4778" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4778"><a href="https://www.lisenet.com/lpic-3/">LPIC-3</a></li>
<li id="menu-item-5259" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5259"><a href="https://www.lisenet.com/rhce/">RHCE</a></li>
<li id="menu-item-5862" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5862"><a href="https://www.lisenet.com/rhca/">RHCA</a></li>
</ul></div> </nav>
</header>
<div id="main" class="site-main">
<div id="primary" class="content-area">
<div id="content" class="site-content" role="main">

<nav id="nav-above" class="site-navigation post-navigation">
<h1 class="assistive-text">Post navigation</h1>
<div class="nav-previous"><a href="https://www.lisenet.com/2016/mariadb-server-with-selinux-on-rhel-7/" rel="prev"><span class="meta-nav">←</span> Setting up a MariaDB Server with SELinux on RHEL 7</a></div> <div class="nav-next"><a href="https://www.lisenet.com/2016/rhce-sample-exam-for-rhel-7/" rel="next">RHCE Sample Exam for RHEL 7 <span class="meta-nav">→</span></a></div>
</nav>
<article id="post-5239" class="post-5239 post type-post status-publish format-standard hentry category-networking tag-centos tag-ex300 tag-firewalld tag-rhce tag-rhel tag-rich-rules">
<header class="entry-header">
<h1 class="entry-title">Firewalld Rich and Direct Rules: Setting up RHEL 7 Server as a Router</h1>
<div class="entry-meta">
Posted on <a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/" title="7:05 pm" rel="bookmark"><time class="entry-date" datetime="2016-06-18T19:05:22+00:00">18/06/2016</time></a><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://www.lisenet.com/author/admin/" title="View all posts by Tomas" rel="author">Tomas</a></span></span> </div>
</header>
<div class="entry-content">
<p>We are going to configure RHEL server as a router. Masquerading, port forwarding, rich and direct rules will be covered.&nbsp;<span id="more-5239"></span></p>
<h2>The Lab</h2>
<p>We have three RHEL 7.0 servers available in our lab:</p>
<ol>
<li><strong>ipa (10.10.1.79, 10.8.8.70)</strong> – will be configured as a router,</li>
<li><strong>srv1 (10.8.8.71)</strong> – a server on our DMZ network, will be used to test masquerading,</li>
<li><strong>pub (10.10.1.10)</strong> – a server on our public network, will be used to test port forwarding.</li>
</ol>
<p>The <strong>ipa</strong> server has SELinux set to enforcing mode.</p>
<h2>Network Interfaces on the Router Server</h2>
<p>The <strong>ipa</strong> server has two network interfaces attached and configured:</p>
<pre><strong># nmcli d</strong>
DEVICE   TYPE      STATE      CONNECTION 
enp0s17  ethernet  connected  enp0s17    
enp0s8   ethernet  connected  enp0s8     
lo       loopback  unmanaged  --</pre>
<p>The <strong>enp0s8</strong> is connected to our “public” network 10.10.1.0/24, where <strong>enp0s17</strong> is connected to DMZ 10.8.8.0/24.</p>
<pre><strong># ip -4 ad</strong>
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN 
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
2: enp0s8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    inet <span style="color: #0000ff;">10.10.1.79/24</span> brd 10.10.1.255 scope global dynamic enp0s8
       valid_lft 86376sec preferred_lft 86376sec
3: enp0s17: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    inet <span style="color: #0000ff;">10.8.8.70/24</span> brd 10.8.8.255 scope global dynamic enp0s17
       valid_lft 3583sec preferred_lft 3583sec</pre>
<p>Routing table can be seen below:</p>
<pre><strong># ip ro</strong>
default via 10.10.1.1 dev enp0s8  proto static  metric 1024 
10.8.8.0/24 dev enp0s17  proto kernel  scope link  src 10.8.8.70 
10.10.1.0/24 dev enp0s8  proto kernel  scope link  src 10.10.1.79</pre>
<p>Exclude all iptables-based services from ever being started:</p>
<pre><strong># systemctl mask iptables ip6tables ebtables</strong>
ln -s '/dev/null' '/etc/systemd/system/iptables.service'
ln -s '/dev/null' '/etc/systemd/system/ip6tables.service'
ln -s '/dev/null' '/etc/systemd/system/ebtables.service'</pre>
<p>There is apparently a bug in <strong>RHEL 7.1</strong> and <strong>RHEL 7.2</strong> that prevents the iptables service from being masked if the package <strong>iptables-services</strong> is not installed:</p>
<pre><strong>[rhel7.1]# systemctl mask iptables</strong>
Failed to issue method call: Access denied</pre>
<pre><strong>[rhel7.1]# cat /var/log/audit/audit.log</strong>
type=USER_AVC msg=audit(1468920066.358:447): pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='avc:&nbsp; denied&nbsp; { disable } for auid=0 uid=0 gid=0 cmdline="systemctl mask iptables ip6tables ebtables" scontext=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 tcontext=system_u:system_r:init_t:s0 tclass=service&nbsp; exe="/usr/lib/systemd/systemd" sauid=0 hostname=? addr=? terminal=?'</pre>
<p>The version of the policy that has a bug is this:</p>
<pre><strong>[rhel7.1]# rpm -q selinux-policy-targeted</strong>
selinux-policy-targeted-3.13.1-23.el7.noarch</pre>
<pre><strong>[rhel7.2]# rpm -q selinux-policy-targeted</strong>
selinux-policy-targeted-3.13.1-60.el7.noarch</pre>
<p>Installing the <strong>iptables-services</strong> package, or putting SELinux in to permissive mode, allows masking of iptables service on RHEL 7.1 and RHEL 7.2.</p>
<h3>Firewalld Default Zone</h3>
<p>Both network interfaces should be added to the zone <strong>public</strong>:</p>
<pre><strong># firewall-cmd --get-active-zones</strong>
public
  interfaces: enp0s17 enp0s8</pre>
<p>It should be the default zone:</p>
<pre><strong># firewall-cmd --get-default-zone</strong>
public</pre>
<p>We still want to set the default zone to <strong>public</strong> (so that we know how to change it), and assign the interface enp0s17 to the zone <strong>dmz</strong>.</p>
<p>Set the default firewall zone to public, remove the network interface enp0s17 from the zone <strong>public</strong> and add to the zone <strong>dmz</strong>.</p>
<pre># firewall-cmd --set-default-zone=public
# firewall-cmd --remove-interface=enp0s17 --zone=public
# firewall-cmd --permanent --add-interface=enp0s17 --zone=dmz</pre>
<p>A permanent configuration requires a reload of the firewall configuration to work as expected:</p>
<pre># firewall-cmd --reload</pre>
<p>Let us see the actives zones:</p>
<pre><strong># firewall-cmd --get-active-zones</strong>
dmz
  interfaces: enp0s17
public
  interfaces: enp0s8</pre>
<p>Make sure that zones are correctly set in the network scripts:</p>
<pre># nmcli con mod enp0s8 connection.zone public
# nmcli con mod enp0s17 connection.zone dmz
# nmcli c reload</pre>
<h3>Custom Firewalld Services</h3>
<p>This part shows the way we can create custom firewalld services. We are going to create one for iSCSI target.</p>
<p>Copy one of the existing firewalld service configuration files, say for SSH:</p>
<pre># cp /usr/lib/firewalld/services/ssh.xml /etc/firewalld/services/iscsi-target.xml</pre>
<p>Open the file <code>/etc/firewalld/services/iscsi-target.xml</code> for editing, and put the following:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;service&gt;
 &lt;short&gt;iSCSI Target&lt;/short&gt;
 &lt;description&gt;iSCSI target.&lt;/description&gt;
 &lt;port protocol="tcp" port="3260"/&gt;
&lt;/service&gt;
</pre>
<p>The newly created firewalld service can be added to the zone <strong>dmz</strong> this way:</p>
<pre># firewall-cmd --permanent --zone=dmz --add-service iscsi-target</pre>
<p>More services depending on requirements can be also added, for example:</p>
<pre># firewall-cmd --permanent --zone=dmz --add-service={http,https,ldap,ldaps,kerberos,dns,kpasswd,ntp,ftp}
# firewall-cmd --reload</pre>
<p>List all services that are added to the zone <strong>dmz</strong>:</p>
<pre><strong># firewall-cmd --list-services --zone=dmz</strong>
dns ftp http https iscsi-target kerberos kpasswd ldap ldaps ntp ssh</pre>
<p>List all services that are added to the zone <strong>public</strong>:</p>
<pre><strong># firewall-cmd --list-services --zone=public</strong>
dhcpv6-client</pre>
<h3>Packet Forwarding</h3>
<p>To configure routing, the server needs to forward incoming packets from one interface to another interface.</p>
<p>Create a new file <code>/etc/sysctl.d/ip_forward.conf</code> and add the following:</p>
<pre>net.ipv4.ip_forward=1</pre>
<p>The above makes the change permanent. Now change the runtime value:</p>
<pre># sysctl -w net.ipv4.ip_forward=1</pre>
<h3>Routing with Rich Rules</h3>
<p>In general, all we have to do is to enable masquerading on the public
 interface. The command below masquerades packets coming from all hosts 
in the zone <strong>public</strong>:</p>
<pre># firewall-cmd --permanent --zone=public --add-masquerade
# firewall-cmd --reload</pre>
<p>In other words, the above allows all traffic to leave from the zone <strong>dmz</strong> to the zone <strong>public</strong>.</p>
<p>The easy way to test this is to try to access some public website 
from any VM that resides in the dmz network 10.8.8.0/24. We have a 
server <strong>srv1</strong> that’s on 10.8.8.71, and it has the default route going via 10.8.8.70:</p>
<pre><strong>[srv1]# ip ro</strong>
<span style="color: #0000ff;">default via 10.8.8.70</span> dev mybond0  proto static  metric 1024 
10.8.8.0/24 dev mybond0  proto kernel  scope link  src 10.8.8.71</pre>
<p>If we were to try to get access to example.com with <strong>masquerading disabled</strong>, we would have the following:</p>
<pre><strong>[srv1]# wget -O - http://example.com</strong>
--2016-06-18 17:47:30--  http://example.com/
Resolving example.com (example.com)... 93.184.216.34
Connecting to example.com (example.com)|93.184.216.34|:80... failed: <span style="color: #800000;">No route to host</span>.</pre>
<p>When masquerading on the zone <strong>public</strong> is enabled, we can access the site:</p>
<pre><strong>[srv1]# wget http://example.com</strong>
Resolving example.com (example.com)... 93.184.216.34
Connecting to example.com (example.com)|93.184.216.34|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1270 (1.2K) [text/html]
Saving to: 'index.html'

100%[================================&gt;] 1,270  --.-K/s   in 0s

2016-06-18 17:50:19 (129 MB/s) - 'index.html' saved [1270/1270]</pre>
<p>If we need some more control over which packets exactly are 
masqueraded, we can add a rich rule that matches packets coming from 
specific source addresses only, for example:</p>
<pre># firewall-cmd --permanent --zone=public --add-rich-rule='rule family=ipv4 source address=10.8.8.0/24 masquerade'
# firewall-cmd --reload</pre>
<p>Let us check the rich rule:</p>
<pre><strong># firewall-cmd --zone=public --list-all</strong>
public (default, active)
  interfaces: enp0s8
  sources:
  services: dhcpv6-client
  ports:
  masquerade: yes
  forward-ports:
  icmp-blocks:
  rich rules:
      rule family="ipv4" source address="10.8.8.0/24" masquerade</pre>
<h3>Routing with Direct Rules</h3>
<p>Routing can also be achieved with direct rules. However, the 
firewalld man page says that direct options should be used only as a 
last resort when it’s not possible to use for example <strong>–add-rich-rule=’rule’</strong>.</p>
<p>The syntax is below:</p>
<pre><span style="color: #0000ff;">[--permanent] --direct --add-rule { ipv4 | ipv6 | eb } table chain priority args</span>
    Add a rule with the arguments args to chain chain in table table with priority priority.

    The priority is used to order rules. Priority 0 means add rule on top of the chain, with a higher priority
    the rule will be added further down. Rules with the same priority are on the same level and the order of
    these rules is not fixed and may change. If you want to make sure that a rule will be added after another
    one, use a low priority for the first and a higher for the following.</pre>
<p>To allow our <strong>dmz</strong> (enp0s17) network VMs with private 
IP addresses to communicate with external networks, we have to configure
 firewall for IP masquerading:</p>
<pre># firewall-cmd --permanent --direct --add-rule ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE</pre>
<p>Forward all ICMP requests from the zone <strong>dmz</strong> (enp0s17) to the zone <strong>public</strong> (enp0s8):</p>
<pre># firewall-cmd --permanent --direct --add-rule ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 \
  -p icmp -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT</pre>
<p>Do the same for all HTTP and HTTPS traffic:</p>
<pre># firewall-cmd --permanent --direct --add-rule ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 \
  -p tcp -m multiport --dport 80,443 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT</pre>
<p>Also allow access to public SMTP and SMTPS servers:</p>
<pre># firewall-cmd --permanent --direct --add-rule ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 \
  -p tcp -m multiport --dport 25,465 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT</pre>
<p>Allow to SSH into public servers:</p>
<pre># firewall-cmd --permanent --direct --add-rule ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 \
  -p tcp --dport 22 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT</pre>
<p>Log everything else:</p>
<pre># firewall-cmd --permanent --direct --add-rule ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 \
  -j LOG --log-prefix "forward_fw "</pre>
<p>Optional, but not really required:</p>
<pre># firewall-cmd --permanent --direct --add-rule ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 -j REJECT</pre>
<p>Reload:</p>
<pre># firewall-cmd --reload</pre>
<p>Check the direct rules:</p>
<pre><strong># firewall-cmd --direct --get-all-rules</strong>
ipv4 nat POSTROUTING 0 -o enp0s8 -j MASQUERADE
ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 -p icmp -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 -p tcp -m multiport --dport 80,443 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 -p tcp -m multiport --dport 25,465 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 -p tcp --dport 22 -m state --state NEW,RELATED,ESTABLISHED -j ACCEPT
ipv4 filter FORWARD 0 -i enp0s17 -o enp0s8 -j LOG --log-prefix 'forward_fw '</pre>
<p>We can use the same server <strong>srv1</strong> to test the rules 
above. Anything that doesn’t match should be blocked and logged. For 
example, let us try to access example.com via FTP:</p>
<pre><strong>[srv1]# wget -O - ftp://example.com</strong>
--2016-06-18 18:13:49--  ftp://example.com/
           =&gt; ‘.listing’
Resolving example.com (example.com)... 93.184.216.34
Connecting to example.com (example.com)|93.184.216.34|:21... failed: <span style="color: #800000;">No route to host.</span></pre>
<p>And the log entry should be:</p>
<pre><span style="color: #0000ff;">forward_fw IN=enp0s17 OUT=enp0s8</span> MAC=08:00:27:ff:70:00:08:00:27:ff:81:00:08:00 <span style="color: #0000ff;">SRC=10.8.8.71</span> DST=93.184.216.34 LEN=60 TOS=0x00 PREC=0x00 TTL=63 ID=10304 DF PROTO=TCP SPT=34579 <span style="color: #0000ff;">DPT=21</span> WINDOW=14600 RES=0x00 SYN URGP=0</pre>
<h3>Rich Rules and Port Forwarding</h3>
<p>We may want to access servers that reside on the <strong>dmz</strong> network (10.8.8.0/24) from the <strong>public</strong> (10.10.1.0/24) over SSH. To do so, we need to put some port forwarding rules.</p>
<p>The rules below configure port forwarding so that connections to 10.10.1.79:2271 are forwarded to 10.8.8.71:22, and SSH logging.</p>
<pre># firewall-cmd --permanent --zone=public --add-forward-port='port=2271:proto=tcp:toport=22:toaddr=10.8.8.71'
# firewall-cmd --permanent --zone=public --add-rich-rule='rule service name=ssh log prefix="SSH_" level="debug" limit value=1/m reject'
# firewall-cmd --reload</pre>
<p>Let us see the rules:</p>
<pre><strong># firewall-cmd --list-all --zone=public</strong>
public (default, active)
  interfaces: enp0s8
  sources:
  services: dhcpv6-client
  ports:
  masquerade: yes
  forward-ports: port=2271:proto=tcp:toport=22:toaddr=10.8.8.71
  icmp-blocks:
  rich rules:
        rule service name="ssh" log prefix="SSH_" level="debug" limit value="1/m" reject</pre>
<p>To test port forwarding, we need some server that’s in the public network (10.10.1.0/24):</p>
<pre><strong>[pub]$ ssh root@10.10.1.79 -p2271</strong>
The authenticity of host '[10.10.1.79]:2271 ([10.10.1.79]:2271)' can't be established.
ECDSA key fingerprint is 32:e6:80:ec:ec:3e:d0:6a:7b:78:bf:6e:79:90:8f:2d.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '[10.10.1.79]:2271' (ECDSA) to the list of known hosts.
root@10.10.1.79's password: 
Last login: Sat Jun 18 17:29:59 2016 from 10.8.8.1</pre>
<div id="fsb-social-bar" class="fsb-social-bar fsb-no-float" data-post-id="5239" data-socialite="false"><style type="text/css">            #fsb-social-bar { width: 100%; border-bottom: 1px solid #dbdbdb; border-top: 1px solid #dbdbdb; padding: 10px 0; margin: 0px 0 20px 0; float: left; background: #fff; position: relative; clear: both; }            #fsb-social-bar a { border: 0px !important }            #fsb-social-bar.fsb-fixed { position: fixed; top: -2px; z-index: 99999; }            #fsb-social-bar .fsb-title { display: block; float: left; margin: 3px 20px 0 0; font-size: 16px; font-family: Arial, Helvetica, sans-serif; text-decoration: none; color: #333; }            #fsb-social-bar .fsb-share-facebook { width: 120px; float: left; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-facebook.fsb-hide-count { width: 44px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-twitter { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-twitter.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-google { float: left; width: 105px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-google.fsb-hide-count { width: 33px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-linkedin { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-linkedin.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-pinterest { float: left; width: 115px; padding: 3px 0 2px; height: 25px;}            #fsb-social-bar .fsb-share-pinterest.fsb-hide-count { width: 43px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .socialite { display: block; position: relative; background: url(https://www.lisenet.com/wp-content/plugins/floating-social-bar/images/fsb-sprite.png) no-repeat scroll 0 0; }            #fsb-social-bar .socialite-loaded { background: none !important; }            #fsb-social-bar .fsb-service-title { display: none; }            #fsb-social-bar a { color: #333; text-decoration: none; font-size: 12px; font-family: Arial, Helvetica, sans-serif; }            #fsb-social-bar .fsb-twitter { width: 105px; height: 25px; background-position: -13px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-twitter .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 69px; color: #333; }            #fsb-social-bar .fsb-google { width: 75px; height: 25px; background-position: -136px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-google .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 41px; color: #333; }            #fsb-social-bar .fsb-google .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-share-google .socialite-loaded .socialite-button{padding: 2px 0 0}            #fsb-social-bar .fsb-facebook { width: 89px; height: 25px; background-position: -231px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-facebook .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 52px; color: #333; }            #fsb-social-bar .fsb-facebook .socialite-button { margin: 0 !important;}            #fsb-social-bar .fsb-share-facebook .socialite-loaded .socialite-button {padding: 2px 0 0}            #fsb-social-bar .fsb-linkedin { width: 105px; height: 25px; background-position: -347px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-linkedin .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 70px; color: #333; }            #fsb-social-bar .fsb-linkedin .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-pinterest { width: 88px; height: 25px; background-position: -484px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-pinterest .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 50px; color: #333; }            #fsb-social-bar .fsb-pinterest .socialite-button { margin: 0 !important; }            .fsb-clear { clear: both; }            .fsb-clear:after { clear:both; content:; display:block; height:0; line-height:0; overflow:auto; visibility:hidden; zoom:1; }            @media (max-width: 768px) { #fsb-social-bar.fsb-fixed { position: relative !important; top: auto !important; } }        </style><div class="fsb-share-facebook fsb-hide-count"><a href="https://www.facebook.com/sharer.php?u=https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/" class="socialite facebook fsb-facebook" data-fsb-service="facebook" data-href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/" data-send="false" data-layout="button_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="fsb-service-title">Facebook</span><span class="fsb-count">0</span></a></div><div class="fsb-share-twitter fsb-hide-count"><a href="https://twitter.com/share?original_referer=https%3A%2F%2Fwww.lisenet.com%2F&amp;source=tweetbutton&amp;text=Firewalld+Rich+and+Direct+Rules%3A+Setting+up+RHEL+7+Server+as+a+Router&amp;url=https%3A%2F%2Fwww.lisenet.com%2F2016%2Ffirewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router%2F&amp;via=crylium" class="socialite twitter fsb-twitter" data-fsb-service="twitter" rel="nofollow" target="_blank" title="Be the first one to tweet this article!"><span class="fsb-service-title">Twitter</span><span class="fsb-count">0</span></a></div><div class="fsb-share-linkedin"><a href="https://www.linkedin.com/cws/share?url=https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/" class="socialite linkedin fsb-linkedin" data-fsb-service="linkedin" data-size="medium" data-href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/" rel="nofollow" target="_blank"><span class="fsb-service-title">LinkedIn</span><span class="fsb-count">1</span></a></div></div><div class="fsb-clear"></div> </div>
<footer class="entry-meta">
This entry was posted in <a href="https://www.lisenet.com/category/networking/" rel="category tag">Networking</a> and tagged <a href="https://www.lisenet.com/tag/centos/" rel="tag">CentOS</a>, <a href="https://www.lisenet.com/tag/ex300/" rel="tag">EX300</a>, <a href="https://www.lisenet.com/tag/firewalld/" rel="tag">firewalld</a>, <a href="https://www.lisenet.com/tag/rhce/" rel="tag">RHCE</a>, <a href="https://www.lisenet.com/tag/rhel/" rel="tag">RHEL</a>, <a href="https://www.lisenet.com/tag/rich-rules/" rel="tag">rich rules</a>. Bookmark the <a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/" title="Permalink to Firewalld Rich and Direct Rules: Setting up RHEL 7 Server as a Router" rel="bookmark">permalink</a>. If you notice any errors, please <a href="https://www.lisenet.com/about/">contact us</a>.
</footer>
</article>

<nav id="nav-below" class="site-navigation post-navigation">
<h1 class="assistive-text">Post navigation</h1>
<div class="nav-previous"><a href="https://www.lisenet.com/2016/mariadb-server-with-selinux-on-rhel-7/" rel="prev"><span class="meta-nav">←</span> Setting up a MariaDB Server with SELinux on RHEL 7</a></div> <div class="nav-next"><a href="https://www.lisenet.com/2016/rhce-sample-exam-for-rhel-7/" rel="next">RHCE Sample Exam for RHEL 7 <span class="meta-nav">→</span></a></div>
</nav>
<div id="comments" class="comments-area">
<h2 class="comments-title">
16 thoughts on “<span>Firewalld Rich and Direct Rules: Setting up RHEL 7 Server as a Router</span>” </h2>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="li-comment-687">
<article id="comment-687" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/b5b05d35e0df859bdb2e6450b425a0e0.png" srcset="https://secure.gravatar.com/avatar/b5b05d35e0df859bdb2e6450b425a0e0?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">txaz2012</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-687"><time pubdate="" datetime="2016-10-18T20:24:35+00:00">
18/10/2016 at 8:24 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>Hi Tomas, sorry to bother you again on another topic…<br>
Port forwarding – from the firewall man page –<br>
–add-forward-port=port=portid[-portid]:proto=protocol[:toport=portid[-portid]][:toaddr=address[/mask]]<br>
It seems to me the “toaddr=address/mask” is conflicting with line below in the same man page<br>
“The port can either be a single port number portid or a port range portid-portid. The protocol can<br>
either be tcp or udp. The destination address is a simple IP address.”<br>
:::::<br>
So for example, is this an invalid destination address “10.10.1.0/24” ?<br>
Should it be a specific simple IP address?</p>
</div>
<div class="reply">
<a rel="nofollow" class="comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/?replytocom=687#respond" onclick='return addComment.moveForm( "comment-687", "687", "respond", "5239" )' aria-label="Reply to txaz2012">Reply</a> </div>
</article>
<ul class="children">
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-689">
<article id="comment-689" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-689"><time pubdate="" datetime="2016-10-18T20:40:49+00:00">
18/10/2016 at 8:40 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>It shouldn’t even allow you to create a port forwarding rule if I use a mask of anything but /32.</p>
<p>The man page is correct, it is a simple IP address.</p>
</div>
<div class="reply">
</div>
</article>
</li>
</ul>
</li>
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-923">
<article id="comment-923" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/dccbaa258042683b893c1f7eca252306.png" srcset="https://secure.gravatar.com/avatar/dccbaa258042683b893c1f7eca252306?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">Alex</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-923"><time pubdate="" datetime="2016-12-09T19:01:25+00:00">
09/12/2016 at 7:01 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>Hey Tomas, the last question: should I enable anything to make firewalld direct rules work? any module?<br>
The following one is not working, maybe its not correct:</p>
<p>[root@server1 ~]# firewall-cmd –permanent –direct –add-rule ipv4 filter INPUT 0 -s 192.168.0.103 -p tcp –dport 2222 reject<br>
success<br>
[root@server1 ~]# firewall-cmd –direct –get-all-rules<br>
[root@server1 ~]#</p>
</div>
<div class="reply">
<a rel="nofollow" class="comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/?replytocom=923#respond" onclick='return addComment.moveForm( "comment-923", "923", "respond", "5239" )' aria-label="Reply to Alex">Reply</a> </div>
</article>
<ul class="children">
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-924">
<article id="comment-924" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-924"><time pubdate="" datetime="2016-12-09T20:02:55+00:00">
09/12/2016 at 8:02 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>You added the rule to the permanent set. Reload firewalld.</p>
</div>
<div class="reply">
</div>
</article>
</li>
</ul>
</li>
<li class="comment even thread-even depth-1" id="li-comment-926">
<article id="comment-926" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/dccbaa258042683b893c1f7eca252306.png" srcset="https://secure.gravatar.com/avatar/dccbaa258042683b893c1f7eca252306?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">Alex</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-926"><time pubdate="" datetime="2016-12-09T20:19:19+00:00">
09/12/2016 at 8:19 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>tried that, of course</p>
</div>
<div class="reply">
<a rel="nofollow" class="comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/?replytocom=926#respond" onclick='return addComment.moveForm( "comment-926", "926", "respond", "5239" )' aria-label="Reply to Alex">Reply</a> </div>
</article>
<ul class="children">
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-929">
<article id="comment-929" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-929"><time pubdate="" datetime="2016-12-10T16:41:52+00:00">
10/12/2016 at 4:41 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>I use direct rules for routing, but 
never for filtering incoming traffic (that’s what you seem to want to 
do) as this can be easily achieved with firewalld rich rules. Let me 
know if you figure it out.</p>
</div>
<div class="reply">
</div>
</article>
</li>
</ul>
</li>
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-1214">
<article id="comment-1214" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/03c4dc455205cbd4f34c8286c68cc636.png" srcset="https://secure.gravatar.com/avatar/03c4dc455205cbd4f34c8286c68cc636?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">Yash</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1214"><time pubdate="" datetime="2017-04-17T17:23:35+00:00">
17/04/2017 at 5:23 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>I tried using http with rich-rule and source address method for one ip in defferent zone.<br>
But I always get Failed connect – ; No route to host<br>
What I am doing wrong here ??<br>
——————case1<br>
[root@csrv176 ~]# firewall-cmd –permanent –remove-rich-rule=’rule 
family=”ipv4″ source address=”192.168.1.175/32″ service name=”http” log 
prefix=”http_from_x” level=”info” limit value=”30/m” accept’ –zone=work<br>
success<br>
[root@csrv176 ~]# firewall-cmd –permanent –remove-rich-rule=’rule 
family=”ipv4″ source address=”192.168.1.175″ service name=”http” log 
prefix=”http_from_y” level=”info” limit value=”30/m” accept’ –zone=work<br>
success</p>
<p>[root@csrv176 ~]# firewall-cmd –reload<br>
success</p>
<p>[root@csrv176 ~]# firewall-cmd –list-all –zone=work<br>
work<br>
interfaces:<br>
sources:<br>
services: dhcpv6-client ipp-client ssh<br>
ports:<br>
masquerade: no<br>
forward-ports:<br>
icmp-blocks:<br>
rich rules:<br>
rule family=”ipv4″ source address=”192.168.1.175/32″ service name=”http”
 log prefix=”http_from_x” level=”info” limit value=”30/m” accept<br>
rule family=”ipv4″ source address=”192.168.1.175″ service name=”http” 
log prefix=”http_from_y” level=”info” limit value=”30/m” accept</p>
<p>——————-case2<br>
[root@csrv176 ~]# firewall-cmd –new-zone=sphttp –permanent<br>
[root@csrv176 ~]# firewall-cmd –permanent –add-source=192.168.1.175 –zone=sphttp<br>
success<br>
[root@csrv176 ~]# firewall-cmd –permanent –add-source=192.168.1.175/32 –zone=sphttp<br>
success<br>
[root@csrv176 ~]# firewall-cmd –reload<br>
success<br>
[root@csrv176 ~]# firewall-cmd –list-all –zone=sphttp<br>
sphttp<br>
interfaces:<br>
sources: 192.168.1.175 192.168.1.175/32<br>
services: http<br>
ports:<br>
masquerade: no<br>
forward-ports:<br>
icmp-blocks:<br>
rich rules:<br>
———————–error</p>
<p>[root@csrv175 ~]# curl http://192.168.1.176<br>
curl: (7) Failed connect to 192.168.1.176:80; No route to host</p>
</div>
<div class="reply">
<a rel="nofollow" class="comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/?replytocom=1214#respond" onclick='return addComment.moveForm( "comment-1214", "1214", "respond", "5239" )' aria-label="Reply to Yash">Reply</a> </div>
</article>
<ul class="children">
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-1215">
<article id="comment-1215" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1215"><time pubdate="" datetime="2017-04-17T18:05:19+00:00">
17/04/2017 at 6:05 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>I don’t see any interfaces assigned to the zone.</p>
</div>
<div class="reply">
</div>
</article>
</li>
<li class="comment even depth-2" id="li-comment-1220">
<article id="comment-1220" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/03c4dc455205cbd4f34c8286c68cc636.png" srcset="https://secure.gravatar.com/avatar/03c4dc455205cbd4f34c8286c68cc636?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">Yash</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1220"><time pubdate="" datetime="2017-04-17T20:18:04+00:00">
17/04/2017 at 8:18 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>By default it is only assigned to 
default public zone. Can we assign the same interface to more then one 
zone ? If so then how can we use other zones like internal,work etc..<br>
I thought It is good idea not to keep interface into the same zone to make it more secure<br>
e.g. to make ssh to only certain ips I create new zone “exam” for ssh, 
add source ips, remove ssh from pubic. No interface assigned to this 
zone to not override source IPs.<br>
The result of this will be a “exam” zone which permits access to ssh, 
but only from given IP addresses. This works fine. but it didn’t work 
for http.</p>
<p>Here is the info.<br>
[root@csrv176 ~]# firewall-cmd –get-active-zones<br>
sphttp<br>
sources: 192.168.1.175 192.168.1.175/32<br>
public<br>
interfaces: eno16777736 eno33554960 eno50332184 team1<br>
exam<br>
sources: 192.168.1.0/24<br>
[root@csrv176 ~]# firewall-cmd –list-all –zone=public<br>
public (default, active)<br>
interfaces: eno16777736 eno33554960 eno50332184 team1<br>
sources:<br>
services: dhcpv6-client<br>
ports:<br>
masquerade: no<br>
forward-ports:<br>
icmp-blocks:<br>
rich rules:</p>
<p>root@csrv176 ~]# firewall-cmd –list-all –zone=exam<br>
exam<br>
interfaces:<br>
sources: 192.168.1.0/24<br>
services: ssh<br>
ports: 2022/tcp<br>
masquerade: no<br>
forward-ports: port=2022:proto=tcp:toport=22:toaddr=<br>
icmp-blocks:<br>
rich rules:<br>
rule family=”ipv4″ source address=”192.168.1.175″ service name=”ssh” log
 prefix=”ssh-reject” level=”info” limit value=”3/m” reject<br>
rule family=”ipv4″ source address=”192.168.1.170″ service name=”ssh” log
 prefix=”ssh-reject” level=”info” limit value=”3/m” reject</p>
<p>——————————————<br>
My understanding/reading says:<br>
———————————————-<br>
Traffic sources can be designated in two ways: By interface, or by 
source IP address. Traffic that matches any source passes this check. A 
firewalld zone defined with only source addresses and without interfaces
 will apply to all traffic from those addresses, regardless of which 
interface it came in.</p>
<p>– is the packet coming from a source already bound to a zone? (if yes, it is associated with this zone),<br>
– if not, is the packet coming from a network interface already bound to a zone? (if yes, it is associated with this zone),<br>
– if not, the packet is associated with the default zone.</p>
</div>
<div class="reply">
</div>
</article>
</li>
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-1221">
<article id="comment-1221" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1221"><time pubdate="" datetime="2017-04-17T21:55:16+00:00">
17/04/2017 at 9:55 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>Ah, OK, I see what you mean. Yea, it would be the same with iptables rules that apply to all interfaces.</p>
</div>
<div class="reply">
</div>
</article>
</li>
</ul>
</li>
<li class="comment even thread-even depth-1" id="li-comment-1228">
<article id="comment-1228" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/03c4dc455205cbd4f34c8286c68cc636.png" srcset="https://secure.gravatar.com/avatar/03c4dc455205cbd4f34c8286c68cc636?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">Yash</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1228"><time pubdate="" datetime="2017-04-18T13:53:54+00:00">
18/04/2017 at 1:53 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>I only want to add my observation, but still looking for the answer</p>
<p>-Zone become active if you add source, service to the zone. So my second case 2 should work<br>
as it appears in active zone list.</p>
<p>[root@csrv176 ~]# firewall-cmd –get-active-zones<br>
sphttp<br>
sources: 192.168.1.175 192.168.1.175/32<br>
public<br>
interfaces: eno16777736 eno33554960 eno50332184 team1<br>
exam<br>
sources: 192.168.1.0/24</p>
<p>[root@csrv176 ~]# firewall-cmd –list-all –zone=sphttp<br>
sphttp<br>
interfaces:<br>
sources: 192.168.1.175 192.168.1.175/32<br>
services: http<br>
ports:</p>
<p>—If you just add rich rule, zone doesn’t become active, so I may say 
case 1 may not work as it doesn’t appear in the active zone list. But if
 you look zone xml file /etc/firewalld/zones/work.xml then it does 
clearly define source, service. This throws another question – why zone 
do not become active with rich rule only ? I don’t see anywhere in the 
document where it mentions this specific issue. I also wonder if I am 
using firewalld right way ;)</p>
</div>
<div class="reply">
<a rel="nofollow" class="comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/?replytocom=1228#respond" onclick='return addComment.moveForm( "comment-1228", "1228", "respond", "5239" )' aria-label="Reply to Yash">Reply</a> </div>
</article>
<ul class="children">
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-1229">
<article id="comment-1229" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1229"><time pubdate="" datetime="2017-04-18T13:55:33+00:00">
18/04/2017 at 1:55 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>So what’s the problem here? What doesn’t work in particular?</p>
</div>
<div class="reply">
</div>
</article>
</li>
</ul>
</li>
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-1230">
<article id="comment-1230" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/03c4dc455205cbd4f34c8286c68cc636.png" srcset="https://secure.gravatar.com/avatar/03c4dc455205cbd4f34c8286c68cc636?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">Yash</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1230"><time pubdate="" datetime="2017-04-18T16:27:48+00:00">
18/04/2017 at 4:27 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>oh I mentioned it from the beginning of my thread but may be not clear<br>
I tried to allow http service with -rich-rule- and -source address- method for -one ip- in different zone.<br>
Both method doesn’t allow http service and fails with error “Failed connect – ; No route to host”</p>
</div>
<div class="reply">
<a rel="nofollow" class="comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/?replytocom=1230#respond" onclick='return addComment.moveForm( "comment-1230", "1230", "respond", "5239" )' aria-label="Reply to Yash">Reply</a> </div>
</article>
<ul class="children">
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-1231">
<article id="comment-1231" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1231"><time pubdate="" datetime="2017-04-18T17:14:36+00:00">
18/04/2017 at 5:14 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>Do you get any hits for the http rule? If you don’t, then it’s blocked some other place before you even reach it.</p>
</div>
<div class="reply">
</div>
</article>
</li>
</ul>
</li>
<li class="comment even thread-even depth-1" id="li-comment-1384">
<article id="comment-1384" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/f5cbe9c4725cecb615ad4fb926cd976e.png" srcset="https://secure.gravatar.com/avatar/f5cbe9c4725cecb615ad4fb926cd976e?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn">Mario</cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1384"><time pubdate="" datetime="2017-08-26T22:30:47+00:00">
26/08/2017 at 10:30 pm </time></a>
</div>
</footer>
<div class="comment-content"><p>Hello,<br>
Thanks for your post, very helpful!<br>
Do you now if there is a way to limit the masquerading destination ? for
 exemple disable all http calls or enable only port 587 has destination?<br>
Thank for your answer.<br>
Regards</p>
</div>
<div class="reply">
<a rel="nofollow" class="comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/?replytocom=1384#respond" onclick='return addComment.moveForm( "comment-1384", "1384", "respond", "5239" )' aria-label="Reply to Mario">Reply</a> </div>
</article>
<ul class="children">
<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-1385">
<article id="comment-1385" class="comment">
<footer>
<div class="comment-author vcard">
<img alt="" src="Firewalld%20Rich%20and%20Direct%20Rules_files/a13ce6338c214213933f4a15603b532b.jpg" srcset="https://secure.gravatar.com/avatar/a13ce6338c214213933f4a15603b532b?s=80&amp;d=identicon&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> <cite class="fn"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></cite> <span class="says">says:</span> </div>
<div class="comment-meta commentmetadata">
<a href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#comment-1385"><time pubdate="" datetime="2017-08-27T11:21:24+00:00">
27/08/2017 at 11:21 am </time></a>
</div>
</footer>
<div class="comment-content"><p>Hi Mario, if you want to enable NAT for a particular subnet or range, you need a rich rule or direct rule.</p>
</div>
<div class="reply">
</div>
</article>
</li>
</ul>
</li>
 </ol>
<div id="respond" class="comment-respond">
<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://www.lisenet.com/2016/firewalld-rich-and-direct-rules-setup-rhel-7-server-as-a-router/#respond" style="display:none;">Cancel reply</a></small></h3> <form action="https://www.lisenet.com/wp-comments-post.php" method="post" id="commentform" class="comment-form anti-spam-form-processed">
<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" maxlength="245" aria-required="true" required="required" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required" type="text"></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Post Comment" type="submit"> <input name="comment_post_ID" value="5239" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p> <p class="antispam-group antispam-group-q" style="clear: both; display: none;">
<label>Current ye@r <span class="required">*</span></label>
<input name="antspm-a" class="antispam-control antispam-control-a" value="2017" type="hidden">
<input name="antspm-q" class="antispam-control antispam-control-q" value="2017" autocomplete="off" type="text">
</p>
<p class="antispam-group antispam-group-e" style="display: none;">
<label>Leave this field empty</label>
<input name="antspm-e-email-url-website" class="antispam-control antispam-control-e" autocomplete="off" type="text">
</p>
<input value="2017" class="antispam-control antispam-control-d" name="antspm-d" type="hidden"></form>
</div>
</div>
</div>
</div>
<div id="secondary" class="widget-area" role="complementary">
<aside id="search-2" class="widget widget_search"><h1 class="widget-title">Lookup</h1> <form method="get" id="searchform" action="https://www.lisenet.com/" role="search">
<label for="s" class="assistive-text">Search</label>
<input class="field" name="s" id="s" placeholder="Search …" type="text">
<input class="submit" name="submit" id="searchsubmit" value="Search" type="submit">
</form>
</aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1> <label class="screen-reader-text" for="archives-dropdown-2">Archives</label>
<select id="archives-dropdown-2" name="archive-dropdown" onchange="document.location.href=this.options[this.selectedIndex].value;">
<option selected="selected" value="">Select Month</option>
<option value="https://www.lisenet.com/2017/09/"> September 2017 &nbsp;(1)</option>
<option value="https://www.lisenet.com/2017/08/"> August 2017 &nbsp;(1)</option>
<option value="https://www.lisenet.com/2017/06/"> June 2017 &nbsp;(1)</option>
<option value="https://www.lisenet.com/2017/02/"> February 2017 &nbsp;(1)</option>
<option value="https://www.lisenet.com/2017/01/"> January 2017 &nbsp;(2)</option>
<option value="https://www.lisenet.com/2016/12/"> December 2016 &nbsp;(4)</option>
<option value="https://www.lisenet.com/2016/10/"> October 2016 &nbsp;(3)</option>
<option value="https://www.lisenet.com/2016/09/"> September 2016 &nbsp;(4)</option>
<option value="https://www.lisenet.com/2016/08/"> August 2016 &nbsp;(2)</option>
<option value="https://www.lisenet.com/2016/07/"> July 2016 &nbsp;(3)</option>
<option value="https://www.lisenet.com/2016/06/"> June 2016 &nbsp;(7)</option>
<option value="https://www.lisenet.com/2016/05/"> May 2016 &nbsp;(9)</option>
<option value="https://www.lisenet.com/2016/04/"> April 2016 &nbsp;(3)</option>
<option value="https://www.lisenet.com/2016/03/"> March 2016 &nbsp;(4)</option>
<option value="https://www.lisenet.com/2016/02/"> February 2016 &nbsp;(1)</option>
<option value="https://www.lisenet.com/2016/01/"> January 2016 &nbsp;(4)</option>
<option value="https://www.lisenet.com/2015/12/"> December 2015 &nbsp;(7)</option>
<option value="https://www.lisenet.com/2015/11/"> November 2015 &nbsp;(3)</option>
<option value="https://www.lisenet.com/2015/10/"> October 2015 &nbsp;(13)</option>
<option value="https://www.lisenet.com/2015/08/"> August 2015 &nbsp;(3)</option>
<option value="https://www.lisenet.com/2015/07/"> July 2015 &nbsp;(4)</option>
<option value="https://www.lisenet.com/2015/06/"> June 2015 &nbsp;(3)</option>
<option value="https://www.lisenet.com/2015/05/"> May 2015 &nbsp;(5)</option>
<option value="https://www.lisenet.com/2015/03/"> March 2015 &nbsp;(4)</option>
<option value="https://www.lisenet.com/2015/02/"> February 2015 &nbsp;(6)</option>
<option value="https://www.lisenet.com/2015/01/"> January 2015 &nbsp;(2)</option>
<option value="https://www.lisenet.com/2014/12/"> December 2014 &nbsp;(1)</option>
<option value="https://www.lisenet.com/2014/11/"> November 2014 &nbsp;(4)</option>
<option value="https://www.lisenet.com/2014/10/"> October 2014 &nbsp;(6)</option>
<option value="https://www.lisenet.com/2014/09/"> September 2014 &nbsp;(3)</option>
<option value="https://www.lisenet.com/2014/08/"> August 2014 &nbsp;(11)</option>
<option value="https://www.lisenet.com/2014/07/"> July 2014 &nbsp;(10)</option>
<option value="https://www.lisenet.com/2014/06/"> June 2014 &nbsp;(6)</option>
<option value="https://www.lisenet.com/2014/05/"> May 2014 &nbsp;(7)</option>
<option value="https://www.lisenet.com/2014/04/"> April 2014 &nbsp;(14)</option>
<option value="https://www.lisenet.com/2014/03/"> March 2014 &nbsp;(8)</option>
<option value="https://www.lisenet.com/2014/02/"> February 2014 &nbsp;(13)</option>
<option value="https://www.lisenet.com/2014/01/"> January 2014 &nbsp;(14)</option>
<option value="https://www.lisenet.com/2013/12/"> December 2013 &nbsp;(13)</option>
<option value="https://www.lisenet.com/2013/11/"> November 2013 &nbsp;(14)</option>
</select>
</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1> <ul>
<li class="cat-item cat-item-67"><a href="https://www.lisenet.com/category/aws/">AWS</a> (12)
</li>
<li class="cat-item cat-item-54"><a href="https://www.lisenet.com/category/database/">Database</a> (6)
</li>
<li class="cat-item cat-item-184"><a href="https://www.lisenet.com/category/dns/">DNS</a> (3)
</li>
<li class="cat-item cat-item-42"><a href="https://www.lisenet.com/category/exchange-2010/">Exchange Server</a> (6)
</li>
<li class="cat-item cat-item-39"><a href="https://www.lisenet.com/category/ftp/">FTP</a> (3)
</li>
<li class="cat-item cat-item-255"><a href="https://www.lisenet.com/category/ha/">High Availability</a> (12)
</li>
<li class="cat-item cat-item-182"><a href="https://www.lisenet.com/category/ldap/">LDAP/Kerberos</a> (7)
</li>
<li class="cat-item cat-item-7"><a href="https://www.lisenet.com/category/linux/">Linux</a> (61)
</li>
<li class="cat-item cat-item-71"><a href="https://www.lisenet.com/category/osx/">Mac OS X</a> (2)
</li>
<li class="cat-item cat-item-201"><a href="https://www.lisenet.com/category/mail/">Mail/SMTP</a> (5)
</li>
<li class="cat-item cat-item-74"><a href="https://www.lisenet.com/category/monitoring/">Monitoring</a> (24)
</li>
<li class="cat-item cat-item-31"><a href="https://www.lisenet.com/category/networking/">Networking</a> (11)
</li>
<li class="cat-item cat-item-132"><a href="https://www.lisenet.com/category/notes/">Notes</a> (10)
</li>
<li class="cat-item cat-item-51"><a href="https://www.lisenet.com/category/openvpn/">OpenVPN</a> (3)
</li>
<li class="cat-item cat-item-183"><a href="https://www.lisenet.com/category/proxy/">Proxy</a> (3)
</li>
<li class="cat-item cat-item-66"><a href="https://www.lisenet.com/category/python/">Python</a> (3)
</li>
<li class="cat-item cat-item-9"><a href="https://www.lisenet.com/category/raspberrypi/">Raspberry Pi</a> (4)
</li>
<li class="cat-item cat-item-252"><a href="https://www.lisenet.com/category/samba_nfs/">Samba/NFS</a> (7)
</li>
<li class="cat-item cat-item-21"><a href="https://www.lisenet.com/category/security/">Security</a> (17)
</li>
<li class="cat-item cat-item-187"><a href="https://www.lisenet.com/category/ssh/">SSH</a> (2)
</li>
<li class="cat-item cat-item-125"><a href="https://www.lisenet.com/category/virtualisation/">Virtualisation</a> (7)
</li>
<li class="cat-item cat-item-148"><a href="https://www.lisenet.com/category/voip/">VoIP</a> (4)
</li>
<li class="cat-item cat-item-179"><a href="https://www.lisenet.com/category/webserver/">Webserver</a> (4)
</li>
<li class="cat-item cat-item-62"><a href="https://www.lisenet.com/category/windows/">Windows</a> (11)
</li>
</ul>
</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></span> on <a href="https://www.lisenet.com/rhce/#comment-1432">RHCE</a></li><li class="recentcomments"><span class="comment-author-link">Lee Gardiner</span> on <a href="https://www.lisenet.com/rhce/#comment-1431">RHCE</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></span> on <a href="https://www.lisenet.com/2016/configure-unique-local-ipv6-addresses-on-rhel-7/#comment-1430">Configure Unique Local IPv6 Addresses on RHEL 7</a></li><li class="recentcomments"><span class="comment-author-link">Eduardo</span> on <a href="https://www.lisenet.com/2016/configure-unique-local-ipv6-addresses-on-rhel-7/#comment-1429">Configure Unique Local IPv6 Addresses on RHEL 7</a></li><li class="recentcomments"><span class="comment-author-link"><a href="https://www.lisenet.com/" rel="external nofollow" class="url">Tomas</a></span> on <a href="https://www.lisenet.com/2016/configure-aggregated-network-links-on-rhel-7-bonding-and-teaming/#comment-1428">Configure Aggregated Network Links on RHEL 7: Bonding and Teaming</a></li></ul></aside> </div>
</div>

<footer id="colophon" class="site-footer">
<div class="site-info">
Copyright © 2013-2017 LISENET.COM, All Rights Reserved | <a href="https://www.lisenet.com/feed" target="_blank">Feed</a> | Theme by <a href="https://www.templateexpress.com/" target="_blank">Ossie</a>. Logo by Solutin.
</div>
</footer>
</div>
</div>

<script style="display: none !important;">!function(e,t,r,n,c,a,l){function i(t,r){return r=e.createElement('div'),r.innerHTML='<a href="'+t.replace(/"/g,'&quot;')+'"></a>',r.childNodes[0].getAttribute('href')}function o(e,t,r,n){for(r='',n='0x'+e.substr(t,2)|0,t+=2;t<e.length;t+=2)r+=String.fromCharCode('0x'+e.substr(t,2)^n);return i(r)}try{for(c=e.getElementsByTagName('a'),l='/cdn-cgi/l/email-protection#',n=0;n<c.length;n++)try{(t=(a=c[n]).href.indexOf(l))>-1&&(a.href='mailto:'+o(a.href,t+l.length))}catch(e){}for(c=e.querySelectorAll('.__cf_email__'),n=0;n<c.length;n++)try{(a=c[n]).parentNode.replaceChild(e.createTextNode(o(a.getAttribute('data-cfemail'),0)),a)}catch(e){}}catch(e){}}(document);</script><script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/anti-spam-4.js"></script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/small-menu.js"></script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/comment-reply.js"></script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/wp-embed.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var fsb = {"ajax":"https:\/\/www.lisenet.com\/wp-admin\/admin-ajax.php","nonce":"a3eb779343"};
/* ]]> */
</script>
<script type="text/javascript" src="Firewalld%20Rich%20and%20Direct%20Rules_files/fsb.js"></script>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"02bc0260cd","applicationID":"82042001","transactionName":"MgdSZ0pTWEJRUkdYWQtNcVBMW1lfH0JaX1EJBw==","queueTime":0,"applicationTime":937,"atts":"HkBREQJJS0w=","errorBeacon":"bam.nr-data.net","agent":""}</script>

</body><div style="display:none" id="sp_console_event"></div></html>