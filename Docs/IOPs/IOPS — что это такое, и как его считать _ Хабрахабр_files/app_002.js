function show_form_errors(e){if(void 0!==e.errors){for(var t in e.errors)classname=t.replace(/[\]\[]/g,""),$("."+classname+" .error").html(e.errors[t]).fadeIn();$.scrollTo($(".error:visible").first(),800,{axis:"y",offset:-150})}show_system_error(e)}function show_system_error(e){if(show_system_warnings(e),void 0!==e.system_errors)for(var t in e.system_errors)$.jGrowl(e.system_errors[t],{theme:"error"})}function show_system_warnings(e){if(void 0!==e.system_warnings)for(var t in e.system_warnings)$.jGrowl(e.system_warnings[t],{theme:"warning"})}function userFollow(){var e=$(this),t=e.attr("data-login"),o=e.data("id");return e.addClass("loading"),$.post("/json/users/follow/",{login:t},function(t){"ok"==t.messages?($(".js-user_"+o+" .unsubscribeUser").removeClass("hidden"),$(".js-user_"+o+" .subscribeUser").addClass("hidden"),$(".js-user_"+o).addClass("subscribed")):show_system_error(t),e.removeClass("loading")},"json"),!1}function userUnfollow(){var e=$(this),t=e.data("login"),o=e.data("id");return e.addClass("loading"),$.post("/json/users/unfollow/",{login:t},function(t){"ok"==t.messages?($(".js-user_"+o+" .unsubscribeUser").addClass("hidden"),$(".js-user_"+o+" .subscribeUser").removeClass("hidden"),$(".js-user_"+o).removeClass("subscribed")):show_system_error(t),e.removeClass("loading")},"json"),!1}function userKarmaVote(e){var t=$(e),o=t.closest(".js-user-vote"),s=o.find(".js-score"),n=t.attr("data-action"),a={ti:o.attr("data-id"),tt:o.attr("data-type"),v:function(e){return"plus"==e?"1":"-1"}(n)};return $.post("/json/vote/",a,function(e){if("ok"==e.messages){var n=a.v,r=(Number(e.score),"positive"==e.sign?"green":"red");switch(o.find('button[type="button"]').attr("disabled",!1),o.find('button[type="button"]').children().removeClass("icon-svg_arrow-green icon-svg_arrow-red"),n){case"1":t.attr({title:"Вы проголосовали положительно.",disabled:!0}),t.children().addClass("icon-svg_arrow-green");break;case"-1":t.attr({title:"Вы проголосовали отрицательно.",disabled:!0}),t.children().toggleClass("icon-svg_arrow-red")}s.replaceWith('<div class="stacked-counter__value stacked-counter__value_'+r+'" title="Всего '+e.votes_count+'">'+e.score+"</div>")}else show_system_error(e)},"json"),!1}function _getDate(e){var t=new Array("января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"),o=e.getDate(),s=e.getMonth(),n=e.getFullYear();return o+" "+t[s]+" "+n}function _getTime(e){var t=e.getHours(),o=e.getMinutes();return o<10&&(o="0"+o),t+":"+o}function timer_countdown(e){days=Math.floor(e/86400),hours=Math.floor(e/3600),mins=Math.floor(e/60),secs=Math.floor(e),dd=days,hh=hours-24*days,mm=mins-60*hours,ss=secs-60*mins;var t=[];return hh>0&&t.push(hh?addzero(hh):"00"),t.push(mm?addzero(mm):"00"),t.push(ss?addzero(ss):"00"),t.join(":")}function addzero(e){return e<10?"0"+e:e}function plural_str(e,t,o,s){switch(function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}(e)){case 0:return t;case 1:return o;default:return s}}function replaceURLWithHTMLLinks(e){var t=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/i,o=/(^|\s)@(\w+)/g,s=/(^|\s)#(\w+)/g;return e=e.replace(t,'<a href="$1">$1</a>'),e=e.replace(o,'$1@<a href="https://www.twitter.com/$2">$2</a>'),e=e.replace(s,'$1<a href="https://twitter.com/search?q=%23$2">#$2</a>')}function empty(e){var t=/\s+/g;return""===(e=e.replace(t,""))}function mention_autocomplete(e){e.textcomplete([{match:/(^|\s)@(\w*)$/,template:function(e){return'<img src="'+e.avatar+'" alt="" /> <span class="name">'+e.value+"</span>"},search:function(e,t){e.length>=3?$.getJSON("/json/mentions/",{term:e}).done(function(e){t(e.results)}).fail(function(){t([])}):t([])},replace:function(e){return"$1@"+e.value+" "}}])}function createCookie(e,t,o){if(o){var s=new Date;s.setTime(s.getTime()+24*o*60*60*1e3);s.toGMTString()}else{document.cookie=e+"="+t+""+"; path=/"}}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function makeAdClass(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",o=getRandomInt(4,12),s=0;s<o;s++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function btnFollow(e,t,o){var s=e.attr("data-state"),n=e.find(".js-btn-value"),a=e.closest(".js-subscribe_item"),r=a.find(".js-subscribed"),i=t+s+"/";$.post(i,o,function(t){"ok"===t.messages?"unfollow"===s?(e.attr("data-state","follow").removeClass("btn_subscribed").addClass("btn_subscribe"),n.text("Подписаться"),r.removeClass("is-subscribed")):"follow"===s&&(e.attr("data-state","unfollow").removeClass("btn_subscribe").addClass("btn_subscribed"),n.text("Подписан"),r.addClass("is-subscribed")):show_system_error(t)},"json")}function fuzzySearch(e,t){var o,s=t,n=$(".page__footer"),a=e.attr("data-type"),r=s.html();return{reset:function(){s.html(r),n.show(),o=""},fetch:function(e,t){var o={query:e,type:a};$.get("/json/suggest/",o,function(e){"ok"===e.messages?(n.hide(),s.html(e.html),t&&t(null,e.html)):(window.show_system_error(e),t&&t(e,null))},"json")}}}function show_uploader(e){var t=$(e),o=$('input[name="upload_id"]',t),s=t.offset();$("img",t).remove(),$("a",t).remove(),o.val(""),t.css("height","60px");var n=$('<form action="/upload/" class="upload_form" method="post" enctype="multipart/form-data" accept="image/gif, image/jpeg"><input type="file" name="image" /><div class="progress"><div class="bar"></div></div><div class="state">Выберите файл для загрузки</div></form>');$("body").append(n),n.css({position:"absolute",left:s.left+1,top:s.top+1});var a=$('input[type="file"]',n),r=$(".bar",n),i=$(".state",n);return t.bind("reset_position",function(){s=t.offset(),n.css({position:"absolute",left:s.left+1,top:s.top+1})}),a.change(function(){var e=g_user_login+(new Date).getTime();n.ajaxSubmit({dataType:"xml",url:"/upload/?X-Progress-ID="+e,iframe:!0,forceSync:!0,resetForm:!0,beforeSubmit:function(t){check_progress=setInterval(function(){$.get("/progress/",{"X-Progress-ID":e},function(e){if("uploading"==e.state){var t=e.received/e.size*100;r.css("width",t+"%"),i.html("Загружено "+e.received+" из "+e.size)}else"done"==e.state&&clearInterval(check_progress)},"json")},500)},success:function(e){if(clearInterval(check_progress),"ok"==$(e).find("message").text())r.css({width:"0%"}),i.html("Файл успешно загружен"),n.remove(),t.append('<img src="'+$(e).find("url").text()+'" alt=""  /><a href="#upload" class="upload_again" onclick="return show_uploader($(this).parent());">удалить или изменить</a>'),t.css("height","auto"),o.val($(e).find("id").text());else{r.css({width:"0%"});var s=$(e).find("error");s?s.each(function(){i.html('<span class="error">'+$(this).text()+"</span>")}):i.html('<span class="error">Загрузка не удалась</span>')}}})}),!1}function show_float_block(e){if($.browser.isMobileDevice=/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent.toLowerCase()),!($.browser.isMobileDevice||$(window).width()<1024||$(window).height()<500||screen.width<1024)){if($(".content_left").outerHeight()<$(".sidebar_right").outerHeight())return!1;var t=$(e);if(t.size()){var o=t.width(),s=$(".sidebar_right");if(s.size()){var n=!1,a=$(".content_left"),r=function(){if(0==n)var e=s.offset().top+s.outerHeight();else var e=s.offset().top+s.outerHeight()+t.outerHeight()+20;$(window).width()<1024||$(window).height()<500||screen.width<1024||(t.outerHeight()+this.pageYOffset>a.offset().top+a.outerHeight()?(!0===n&&t.removeClass("float_block").css("width","auto"),n=!1):this.pageYOffset>e?(!1===n&&(t.addClass("float_block").css("width",o+"px"),$(window).height()>t.outerHeight(!0)?t.animate({opacity:0},0,function(){t.animate({opacity:1},500)}):t.removeClass("float_block").css("width","auto")),n=!0):(!0===n&&t.removeClass("float_block").css("width","auto"),n=!1))};$(window).bind("scroll resize",r),r()}}}}function posts_poll(e){var t=$(e),o=t.closest("form")||null,s=t.closest(".js-post-polling"),n={ti:t.attr("data-id"),action:t.attr("data-action")};o.ajaxSubmit({data:n,form:o,beforeSubmit:ajaxFormBeforSubmit,success:ajaxFormSuccess(function(e,t,o,n){s.replaceWith(e.question_html)})})}function posts_vote(e){var t=$(e),o=t.closest(".js-post-vote"),s=o.find(".js-score"),n=t.attr("data-action"),a={ti:o.attr("data-id"),tt:o.attr("data-type"),v:function(e){return"plus"==e?parseInt(1):parseInt(-1)}(n)};$.post("/json/vote/",a,function(e){if("ok"==e.messages){var n=a.v;parseInt(e.score);switch(o.find('button[type="button"]').attr("disabled","disabled"),n){case 1:t.attr("title","Вы проголосовали положительно."),t.children().addClass("icon-svg_arrow-green");break;case-1:t.attr("title","Вы проголосовали отрицательно."),t.children().addClass("icon-svg_arrow-red")}s.replaceWith('<span class="voting-wjt__counter voting-wjt__counter_'+e.sign+' js-score" title="Всего '+e.votes_count+": &uarr;"+e.votes_count_plus+" и &darr;"+e.votes_count_minus+'">'+e.score+"</span>")}else show_system_error(e)},"json"),sendGA("post",n)}function sendGA(e,t){"function"==typeof ga&&ga("send","event",e,t)}function change_post_subscibptions_checkboxes(e){void 0!==typeof e.subscribe_mark&&"1"===e.subscribe_mark&&$("#subscribe_comments").length&&$("#subscribe_comments").attr("checked",!0),void 0!==typeof e.tracker_mark&&"1"===e.tracker_mark&&$("#tracker_comments").length&&$("#tracker_comments").attr("checked",!0)}function posts_add_to_favorite(e){var t=$(e),o=t.find(".js-favs_count"),s=o.html()?parseInt(o.html()):0,n={tt:t.attr("data-type"),ti:t.attr("data-id"),action:t.attr("data-action")};return $.post("/json/favorites/",n,function(e){"ok"==e.messages?(t.find(".icon-svg_bookmark").toggleClass("icon-svg_bookmark-add","add"==n.action),"add"==n.action?($.jGrowl("Публикация добавлена в закладки",{}),t.attr({"data-action":"remove",title:"Удалить из избранного"}),o.html(s+=1),$(".js-fav-edit-link").removeClass("hidden"),change_post_subscibptions_checkboxes(e)):($.jGrowl("Публикация удалена из закладок",{}),t.attr({"data-action":"add",title:"Добавить в избранное"}),o.html(s-=1),$(".js-fav-edit-link").addClass("hidden")),t.blur()):show_system_error(e)},"json"),!1}function closeForm(e,t){$(e).closest("form").toggleClass("hidden",t)}function show_edit_tags(e){var t=$(e),o=$("#edit_tags_form"),s=[],n={type:t.attr("data-type"),id:t.attr("data-id")},a=$("#post_"+n.id).find(".fav");a.each(function(){s[s.length]=$(this).text()}),o.find('button[type="submit"]').attr("disabled",!1),o.find('input[name="tt"]').val(n.type),o.find('input[name="ti"]').val(n.id),o.find('input[name="tags_string"]').val(s.join(", ")).focus(),o.toggleClass("hidden"),o.size()&&o.ajaxForm({form:o,beforeSubmit:ajaxFormBeforSubmit,success:ajaxFormSuccess(function(e,t,s,n){var r=o.find('input[name="ti"]').val();o.find('input[name="tt"]').val();a.parent().remove();for(k in e.user_tags)$("#post_"+r+" .js-post-tags").append('<li class="inline-list__item inline-list__item_tag"><a href="/tag/'+e.user_tags[k]+'/" rel="tag" class="inline-list__item-link post__tag fav js-fav-tag">'+e.user_tags[k]+"</a></li>");o.toggleClass("hidden",!0)})})}function showAbuseForm(){var e=$("#abuse_form"),t=e.find('input[name="text"]'),o=e.find('button[type="submit"]');t.on("change keyup",function(){var e=""==$(this).val();o.attr("disabled",e)}),e.ajaxForm({form:e,beforeSubmit:function(s,n,a){ajaxFormBeforSubmit(s,n,a);var r=t.val(),i=/\s+/g;if(r=r.replace(i,""),o.attr("disabled",!0),e.toggleClass("hidden",!0),""===r)return!1},success:ajaxFormSuccess(function(t,s,n,a){$.jGrowl("Спасибо, жалоба отправлена.",{}),e.resetForm(),o.attr("disabled",!0),e.toggleClass("hidden",!0)},!1,!0)}),e.toggleClass("hidden")}function showForm(e){e.removeClass("hidden")}function enableButton(e,t){e.prop("disabled",t)}function checkReadinessToSubmit(e){var t=$(".form__input_checkbox",e),o=t.toArray().some(function(e){return $(e).prop("checked")});enableButton($('button[type="submit"]',e),!o)}function show_recommend_form(){var e=$("#admin_causes");showForm(e),$(".form__input_checkbox",e).on("change",function(){checkReadinessToSubmit()})}$(document).ready(function(){"use strict";function e(){var e=$(".sidebar_content-area"),t=$(".sidebar_content-area > div"),o=$(".sidebar_content-area").outerHeight(!0),s=function(){var e=$(".js-content_left").outerHeight(),t=null;return e<o&&(t=e),t}();if(s)!function(t){e.css("height",t)}(s),t.overflowing(e,function(e){t.addClass("is_visible")});else{var n=$(".js-ad_sticky"),a=n.closest(".js-sticky-wrapper");if(t.addClass("is_visible"),$(".js-content_left").outerHeight()>o&&($(".sidebar_content-area").addClass("sticky_init"),n.length)){var r=n.offset().top-a.offset().top,i=r;if($(".xyz_wrapper_bottom").length){i=r+$(".xyz_wrapper_bottom").outerHeight()}n.hcSticky({top:20,bottomEnd:i,followScroll:!1,stickTo:a})}}}$.jGrowl.defaults.closerTemplate="<div>Закрыть все уведомления</div>",$(".help-tip").length&&$(".help-tip").tipTip({maxWidth:"auto",edgeOffset:10}),$(window).load(function(){e()})}),$(window).load(function(){"use strict";!!(!window.history||!history.pushState)||"#habracut"!==document.location.hash&&"#comments"!==document.location.hash||history.replaceState({},document.title,document.location.pathname+document.location.search)}),$(document).ready(function(){window.ajax_errors_count=0,$(document).on("click",".subscribeUser",userFollow),$(document).on("click",".unsubscribeUser",userUnfollow),$(document).on("submit",'form[data-remote="true"]',function(){var e=$(this);return e.ajaxSubmit({form:e,beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e){void 0!==e.message&&$.jGrowl(e.message)})}),!1}),$(document).on("click",'a[data-remote="true"]',function(e){for(var t=$(this),o={},s=0,n=t.get(0).attributes,a=n.length;s<a;s++)if((n.item(s).nodeName+"").indexOf("data-",0)>=0){var r=n.item(s).nodeName;r=r.replace(/data-/g,""),o[r]=$(this).attr("data-"+r)}var i=$.map(o,function(e,t){return t+"="+e}).join("&");$.post(t.attr("href"),i,function(e){}),e.preventDefault()}),$(".join_hub_panel .join_hub").on("click",function(){var e=$(this);e.addClass("loading");var t=$(this).attr("data-id"),o=$("#hub_item_"+t);return $.post("/json/hubs/subscribe/",{hub_id:t},function(t){"ok"==t.messages?($(".leave_hub",o).removeClass("hidden"),$(".join_hub",o).addClass("hidden"),o.addClass("membership")):show_system_error(t),e.removeClass("loading")},"json"),!1}),$(".join_hub_panel .leave_hub").on("click",function(){var e=$(this).attr("data-id"),t=$(this);t.addClass("loading");var o=$("#hub_item_"+e);return $.post("/json/hubs/unsubscribe/",{hub_id:e},function(e){"ok"==e.messages?($(".leave_hub",o).addClass("hidden"),$(".join_hub",o).removeClass("hidden"),o.removeClass("membership")):show_system_error(e),t.removeClass("loading")},"json"),!1}),$(document).ajaxError(function(e,t,o){window.ajax_errors_count,$("input.loading, button.loading").attr("disabled",!1).removeClass("loading"),window.ajax_errors_count++}),$(document).ajaxSuccess(function(e,t,o,s){"json"==o.dataType&&s&&"string"==typeof s.debug&&$("#php-debug").replaceWith(s.debug)}),$("pre code").each(function(e,t){hljs.highlightBlock(t,"    ")}),$(document).on("click",".spoiler_title",function(){var e=$(this).closest(".spoiler");e.hasClass("spoiler_open")&&$("iframe",e).attr("src",function(e,t){return t}),$("> .spoiler_text",e).toggle(),e.toggleClass("spoiler_open")}),$("#broadcast_tabs_comments, #broadcast_tabs_posts").length&&$("#broadcast_tabs_comments, #broadcast_tabs_posts").tabslet({animation:!0}),$(function(){$("a.js-smoothscroll").on("click",function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);if(e=e.length?e:$("[name="+this.hash.slice(1)+"]"),e.length)return $("html,body").animate({scrollTop:e.offset().top},1e3),!1}})}),$("#global_notify .close").live("click",function(){var e=$(this).attr("data-id"),t=$("#notification_"+e),o=t.next(".inner_notice");return t.remove(),o&&o.removeClass("hidden"),$.post("/json/notifications/close/",{id:e},function(e){"ok"==e.messages||show_system_error(e)},"json"),!1})});var ajaxFormBeforSubmit=function(e,t,o){$(".error",t).text("").hide(),$('input[type="submit"], input[type="button"]',t).attr("disabled",!0)},ajaxFormError=function(e,t){$('input[type="submit"], input[type="button"]',t).attr("disabled",!1).removeClass("loading")},ajaxFormSuccess=function(e,t,o){return function(o,s,n,a){if($('input[type="submit"], input[type="button"]',this.form).attr("disabled",!1).removeClass("loading"),"ok"==o.messages)return ajaxFormRedirect(o)?void 0:e(o,s,n,a);show_form_errors(o),"function"==typeof t&&t(o,s,n,a)}},ajaxFormRedirect=function(e){return void 0!==e.redirect_debug?($.jGrowl('REDIRECT DEBUG: <a href="'+e.redirect_debug+'">'+e.redirect_debug+"</a>",{theme:"message",sticky:!0}),!0):void 0!==e.redirect&&(document.location.href=e.redirect,!0)},K=function(){return{ie:navigator.userAgent.match(/MSIE\s([^;]*)/)}}(),H=function(e){var t=new Date,o=new Date(e),s=t-o,n=864e5;return K.ie&&(o=Date.parse(e.replace(/( \+)/," UTC$1"))),isNaN(s)||s<0?"":s<7e3?"right now":s<6e4?Math.floor(s/1e3)+" s":s<12e4?"1 m":s<36e5?Math.floor(s/6e4)+" m":s<72e5?"1 h":s<n?Math.floor(s/36e5)+" h":s>n&&s<2*n?"yesterday":s<31536e6?Math.floor(s/n)+" d":"over a year ago"};$(document).on("mousedown","a[data-utm]",function(){var e=$(this),t=e.attr("href")+e.data("utm");e.attr("href",t)}),$(document).on("click",".informer > .close",function(){$(".informer").hide(),$.cookie("bttf",1,{expires:60,path:"/"})}),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports={addzero:addzero,ajaxFormBeforSubmit:ajaxFormBeforSubmit,ajaxFormError:ajaxFormError,ajaxFormRedirect:ajaxFormRedirect,ajaxFormSuccess:ajaxFormSuccess,btnFollow:btnFollow,createCookie:createCookie,empty:empty,fuzzySearch:fuzzySearch,_getDate:_getDate,getRandomInt:getRandomInt,_getTime:_getTime,H:H,K:K,makeAdClass:makeAdClass,mention_autocomplete:mention_autocomplete,plural_str:plural_str,replaceURLWithHTMLLinks:replaceURLWithHTMLLinks,show_form_errors:show_form_errors,show_system_error:show_system_error,show_system_warnings:show_system_warnings,timer_countdown:timer_countdown,userFollow:userFollow,userKarmaVote:userKarmaVote,userUnfollow:userUnfollow}),$(document).ready(function(){window.last_scroll_position=0;var e=$("#scroll_to_top"),t=0,o=!1;e.on("click",function(t){t.preventDefault(),e.hasClass("back-down")?(e.attr("title","Наверх").removeClass("back-down"),$.scrollTo(window.last_scroll_position,700,{axis:"y"}),window.last_scroll_position=0):(window.last_scroll_position=window.pageYOffset,e.attr("title","Вниз").addClass("back-down"),$.scrollTo(0,700,{axis:"y"}))}),$(window).on("scroll",function(){window.pageYOffset>100?o||(e.removeClass("hidden"),o=!0):o&&(e.addClass("hidden"),o=!1),t<window.pageYOffset&&e.hasClass("back-down")&&e.removeClass("back-down"),t=window.pageYOffset})});var RecaptchaOptions={lang:"ru",theme:"clean"},check_progress=null;$(window).load(function(){$("form").each(function(){var e=$(this);$('input[type="submit"], input[type="button"]',e).live("click",function(){$(this).addClass("loading")}),$(".item.required",e).each(function(e,t){$(t).hasClass("hubs")?$("input#token-input-hubs",t).live("blur",function(){0==$('input[name="hubs"]',t).tokenInput("get").length?$(".error",t).text("Необходимо заполнить поле").show():$(".error",t).text("").hide()}):$('input[type="text"], input[type="password"], textarea',t).on("blur",function(){var e=$(this).val(),o=/\s+/g;e=e.replace(o,""),""==e?$(".error",t).text("Необходимо заполнить поле").show():$(".error",t).text("").hide()})})});var e=$(".select_date");$(".country",e).live("change",function(){var t=$(".region",e),o=$(".city",e);t.attr("disabled",!0),o.attr("disabled",!0),$.get("/json/geo/regions/",{country_id:$(this).val()},function(e){t.html('<option value="0">Регион</option>'),o.html('<option value="0">Город</option>');for(k in e.regions){var s=e.regions[k];t.append('<option value="'+s.id+'">'+s.name+"</option>")}t.attr("disabled",!1)},"json")}),$(".region",e).live("change",function(){var t=$(".city",e);t.attr("disabled",!0),$.get("/json/geo/cities/",{region_id:$(this).val()},function(e){t.html('<option value="0">Город</option>');for(k in e.cities){var o=e.cities[k];t.append('<option value="'+o.id+'">'+o.name+"</option>")}t.attr("disabled",!1)},"json")});var t=$(".iframe_uploader_preview .image");$(".delete",t).live("click",function(){var e=$(this).data("name");return $('input[name="'+e+'"]').val("-1"),$("."+e+" .iframe_uploader_preview").html('<div class="image">Изображение удалено</div>'),!1})}),$(document).ready(function(){$(".radio_list.custom").each(function(e,t){$("label",t).each(function(e,o){$('input[type="radio"]',o).each(function(e,s){$(s).attr("checked")&&($("label",t).removeClass("checked"),$(o).addClass("checked")),$(s).click(function(){$(s).attr("checked")&&($("label",t).removeClass("checked"),$(o).addClass("checked"))})})})}),$("textarea[maxlength], input[maxlength]").each(function(e,t){if(!0!==$(t).data("nocount")){var o=$(this).parents(".item"),t=$(t),s=$('<div class="count" title="Доступное количество символов для ввода">'+t.attr("maxlength")+"</div>");o.append(s),s.text(t.attr("maxlength")-t.val().length),t.bind("keyup blur focus change",function(){s.text(t.attr("maxlength")-t.val().length)})}})}),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports={RecaptchaOptions:RecaptchaOptions,check_progress:check_progress,show_uploader:show_uploader}),$(function(){$.getJSON("https://habrahabr.ru/hauusbx/toplink/",function(e){var t="";if(e.links.length)$.each(e.links,function(e,o){var s=o.color?'style="color: '+o.color+'"':"";t+='<a href="'+o.link+'" target="_blank" '+s+">"+o.title+"</a>"});else{if(!e.link||!e.title)return;var o=e.color?'style="color: '+e.color+'"':"";t='<a href="'+e.link+'" target="_blank" '+o+">"+e.title+"</a>"}$("#TMpanel .slink").html(t)}),window.TMPanelShowLink=function(e){var t=e.color?'style="color: '+e.color+'"':"",o='<a href="'+e.link+'" target="_blank" '+t+">"+e.title+"</a>";"left"===e.position?$("#TMpanel .slink").prepend(o):$("#TMpanel .slink").append(o)},"undefined"!=typeof adriver&&new adriver("adriver_banner_465568687",{sid:210194,bt:52,bn:1})}),$(document).ready(function(){function e(){var e=a.find("input"),t={};return e.each(function(e){t[this.name]=this.checked}),t}function t(){var t=e(),s=0,n=r.data("posts-count");return r.find("li").each(function(e){var o=$(this),a=o.attr("data-type");t[a]&&s<n?(s++,o.removeClass("hidden"),o.addClass("visible")):o.addClass("hidden")}),o()}function o(){var e=a.find("input");return a.find("input:checked").length<=1?a.find("input:checked").prop("disabled",!0):e.prop("disabled",!1),!1}function s(){var t=e();$.jStorage.set(i,t)}function n(){var o=$.jStorage.get(i,e());a.find("input").each(function(){var e=$(this),t=e.attr("name");e.prop("checked",o[t])}),t()}var a=$("#filter"),r=$("#list"),i="__checkedCheckboxes";$(document).on("ready",n),$(document).on("change","#filter input",t),$(document).on("change","#filter input",o),$(document).on("change","#filter input",s)}),$(document).ready(function(){var e=".daily_best_posts";$(".corporate_blog").length&&(e=".corporate_blog"),$(e).length&&show_float_block(e)}),$(document).ready(function(){$(".post_full .content > :header[id]").each(function(){$(this).append('<a class="title_anchor" href="#'+$(this).attr("id")+'"></a>')}),$(".post_teaser .content > :header[id]").each(function(){var e=$(this).closest(".post_teaser").find(".post__title_link"),t=e.attr("href");$(this).append('<a class="title_anchor" href="'+t+"#"+$(this).attr("id")+'"></a>')}),$('#edit_tags_form [name="tags_string"]').autocomplete({serviceUrl:"/json/suggest/",minChars:2,delimiter:/(,|;)\s*/,maxHeight:400,width:300,zIndex:9999,deferRequestBy:500,params:{type:"tags"}}),$("#lenta_notifications .close").click(function(){return $("#lenta_notifications").fadeOut(),$.post("/json/notifications/hint_get_more_blogs/",function(e){"ok"==e.messages||show_system_error(e)},"json"),!1})}),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports={change_post_subscibptions_checkboxes:change_post_subscibptions_checkboxes,close_edit_tags:close_edit_tags,posts_add_to_favorite:posts_add_to_favorite,posts_poll:posts_poll,posts_vote:posts_vote,show_edit_tags:show_edit_tags,show_recommend_form:show_recommend_form}),function e(t,o,s){function n(r,i){if(!o[r]){if(!t[r]){var c="function"==typeof require&&require;if(!i&&c)return c(r,!0);if(a)return a(r,!0);var m=new Error("Cannot find module '"+r+"'");throw m.code="MODULE_NOT_FOUND",m}var l=o[r]={exports:{}};t[r][0].call(l.exports,function(e){var o=t[r][1][e];return n(o||e)},l,l.exports,e,t,o,s)}return o[r].exports}for(var a="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(e,t,o){function s(e,t){for(itemIndex in e)if(e[itemIndex]==element)return e.splice(itemIndex,1),e;return null}function n(e){for(var t=window.location.search.substring(1),o=t.split("&"),s=0;s<o.length;s++){var n=o[s].split("=");if(n[0]==e)return unescape(n[1])}return!1}e("./comments/_abuse.js"),e("./comments/_markdown.js"),e("./comments/_message.js"),e("./comments/_moderate.js"),e("./comments/_popover.js"),e("./comments/_toolbar.js"),e("./comments/_tree_traversing.js");var a=e("./comments/_favorite.js"),r=e("./comments/_helpers.js"),i=e("./comments/_highlight_parents.js"),c=e("./comments/_instagram.js"),m=e("./comments/_preview.js"),l=e("./comments/_remove.js"),d=e("./comments/_send.js"),u=e("./comments/_show_edit_form.js"),_=e("./comments/_show_form.js"),f=e("./comments/_show_reply_form.js"),p=e("./comments/_timer.js"),h=e("./comments/_title.js"),g=e("./comments/_update.js"),v=e("./comments/_vote.js"),b=e("./comments/_xpanel.js");window.comment_delete=l.comment_delete,window.comment_preview=m.comment_preview,window.comments_add_to_favorite=a.comments_add_to_favorite,window.comment_send=d.comment_send,window.comment_show_edit_form=u.comment_show_edit_form,window.comment_show_form=_.comment_show_form,window.comment_show_reply_form=f.comment_show_reply_form,window.comment_update=g.comment_update,window.comment_vote=v.comment_vote,window.instagrammProcess=c.instagrammProcess,window.showCommentParents=i.showCommentParents;var w=(p.endTimer,h.listenCommentFormTitle,r.setCommentForm,r.showCommentButtons,p.startTimer,window.mention_autocomplete);window.empty;document.unreadcomments=[],$(function(){w($("#comment_text"))}),$(document).ready(function(){if($(".comment_item .bad").on("touchstart",function(){$(this).toggleClass("focused")}),$(document).on("click",".comment_item .html_format a",function(){$(this).attr("target","_blank")}),$(document).on("keyup change blur focus paste","#comment_text",function(e){var t=$(e.currentTarget),o=t.closest("#comments_form"),s=Boolean(t.val().trim());r.enableCommentButtons(o,s);var n=o.find("button:disabled");s&&n.prop("disabled",!1)}),n("reply_to")){var e=n("reply_to");comment_show_reply_form(e)}g_show_xpanel&&b.initXPanel()}),window.getQueryVariable=n,window.removeFromArray=s,void 0!==t&&void 0!==t.exports&&(t.exports={getQueryVariable:n,removeFromArray:s})},{"./comments/_abuse.js":2,"./comments/_favorite.js":4,"./comments/_helpers.js":6,"./comments/_highlight_parents.js":7,"./comments/_instagram.js":8,"./comments/_markdown.js":9,"./comments/_message.js":10,"./comments/_moderate.js":11,"./comments/_popover.js":12,"./comments/_preview.js":13,"./comments/_remove.js":14,"./comments/_send.js":15,"./comments/_show_edit_form.js":16,"./comments/_show_form.js":17,"./comments/_show_reply_form.js":18,"./comments/_timer.js":19,"./comments/_title.js":20,"./comments/_toolbar.js":21,"./comments/_tree_traversing.js":22,"./comments/_update.js":23,"./comments/_vote.js":24,"./comments/_xpanel.js":25}],2:[function(e,t,o){$(document).ready(function(){$(".abuse_link").on("click",function(){var e=$(this),t=window.confirm("Вы уверены, что хотите пожаловаться на комментарий?"),o={tt:$(this).data("tt"),ti:$(this).data("ti")};return t&&$.post($(this).data("url"),o,function(t){"ok"==t.messages?e.replaceWith('<span class="comment__footer-notice comment__footer-notice_sucess">Cпасибо, жалоба отправлена</span>'):show_form_errors(t)}),!1})})},{}],3:[function(e,t,o){function s(e){e.forEach(function(e){n(e)})}function n(e){if(!a(e)){r(e).append(e.html),m.showCommentParents(e.id)}}function a(e){return $("#comment_"+e.id).length>0}function r(e){if(i(e))return $("#comments-list");e.parent_id||e.parrent_id;return $("#reply_comments_"+e.parent_id)}function i(e){return"0"===e.parent_id||"0"===e.parrent_id}function c(e){var t=$("#comments_count"),o=parseInt(t.text(),10);t.text(o+e)}var m=e("../comments/_highlight_parents.js");void 0!==t&&void 0!==t.exports&&(t.exports={addCountForAllComments:c,appendNewComments:s})},{"../comments/_highlight_parents.js":7}],4:[function(e,t,o){function s(e){return"add"===e?"Комментарий добавлен в закладки":"Комментарий удален из закладок"}function n(e){return"add"===e?"remove":"add"}function a(e){return"ok"===e.messages||(c(e),!1)}function r(e,t){var o=s(t),a=n(t);$.jGrowl(o,{}),e.data("action",a)}function i(e){var t=$(e),o=t.data("action"),s={tt:t.data("type"),ti:t.data("id"),action:o};return t.toggleClass(m.BOOKMARKED,"add"===s.action),$.post("/json/favorites/",s,function(e){a(e)&&r(t,o)},"json"),!1}var c=window.show_system_error,m={BOOKMARKED:"icon_comment-bookmark_add"};void 0!==t&&void 0!==t.exports&&(t.exports={comments_add_to_favorite:i})},{}],5:[function(e,t,o){function s(e,t){$('input[name="ts"]',e).val(t)}function n(e){$('textarea[name="text"]',e).val("")}function a(e){$("#preview_placeholder").addClass("hidden")}function r(e){e.closest(d.FORM_PLACEHOLDER).addClass(l.FORM_HIDDEN)}function i(e){return!e.closest(d.FORM_PLACEHOLDER).hasClass(l.BRANCH_FORM)}function c(){$(d.CURRENT_FORM).closest(d.FORM_PLACEHOLDER).removeClass(l.FORM_HIDDEN)}function m(e,t,o){(t||$("button",e)).toggleClass("loading",o)}var l={BTN_LOADING:"loading",FORM_HIDDEN:"hidden",BRANCH_FORM:"comment__reply-form"},d={CURRENT_FORM:"#comments_form",FORM_PLACEHOLDER:".js-form_placeholder"};void 0!==t&&void 0!==t.exports&&(t.exports={clearInputField:n,hideForm:r,hidePreview:a,isRootCommentsForm:i,showForm:c,toggleLoadingState:m,updateTimestamp:s})},{}],6:[function(e,t,o){function s(e,t){e.toggleClass("hidden",!t)}function n(e){var t=$(".js-form-buttons");s($('button[type="button"]',t),!1);var o=$('button[name="preview"]',t),n=$('button[name="send"]',t),a=$('button[name="save"]',t),r=$('button[name="delete"]',t);switch(e){case"reply":s(o,!0),s(n,!0);break;case"edit":s(o,!0),s(a,!0),s(r,!0)}}function a(e,t){var o=$(".js-form-buttons"),s=$('button[name="preview"]',o),n=$('button[name="send"]',o),a=$('button[name="save"]',o);s.prop("disabled",!t),n.prop("disabled",!t),a.prop("disabled",!t)}function r(e,t,o,s,n){var a=$('input[name="parent_id"]',e),r=$('input[name="comment_id"]',e),i=$("#comment_text",e),c=$("#preview_placeholder",e);a.val(t),r.val(o),i.val(s),c.text(""),n||i.focus()}function i(e){return $("#comment_"+e).parent(".js-comment")}function c(e){var t=e.find('textarea[name="text"]').val();return!!$.trim(t)||($.jGrowl("Вы забыли ввести текст комментария",{theme:"error"}),!1)}function m(e){var t=document||e;$("pre code",t).each(function(){l.highlightBlock(this)})}var l=window.hljs;void 0!==t&&void 0!==t.exports&&(t.exports={enableCommentButtons:a,findCommentById:i,refreshSyntaxHighlight:m,setCommentForm:r,showCommentButtons:n,validateFormInput:c})},{}],7:[function(e,t,o){function s(e){return $("> .parent_id",e).data("parent_id")||$("> .comment > .parent_id",e).data("parent_id")}function n(e){var t=a.findCommentById(e),o=s(t);$("#reply_comments_"+o).removeClass("hidden"),t.show(),o&&n(o)}var a=e("../comments/_helpers.js");void 0!==t&&void 0!==t.exports&&(t.exports={showCommentParents:n})},{"../comments/_helpers.js":6}],8:[function(e,t,o){function s(){"undefined"!=typeof instgrm&&instgrm.Embeds.process()}t.exports={instagrammProcess:s}},{}],9:[function(e,t,o){$(document).ready(function(){function e(e){
$.post("/json/comment/markdown/",{action:"markdown",state:e})}function t(t){var o=$(t.currentTarget);e(Boolean(o.prop("checked")))}var o={CHECKBOX:"#comment_markdown"};$(o.CHECKBOX).on("change",t)})},{}],10:[function(e,t,o){$(document).ready(function(){function e(e){if(!e.length)return null;var t=e.serializeArray();return t.length?t.reduce(function(e,t){return e[t.name]=t.value,e},{}):null}function t(e,t){var o=$(a.SUBMIT,e);o.toggleClass(r.BTN_LOADING,t),o.prop("disabled",t)}function o(e,t){if(t)e.addClass(r.FORM_HIDDEN);else{e.fadeOut(300,function(){e.addClass(r.FORM_HIDDEN)})}}function s(e,s){t(e,!0);var n=s["user-id"],a=s.url;$.post(a,{user_id:n},function(){t(e,!1),o(e)})}function n(t){t.preventDefault();var n=$(t.currentTarget);if(!n.hasClass(r.BTN_LOADING)){var i=n.closest(a.MESSAGE),c=e(i);if(!c)return o(i,!0),void $("#comments_form_placeholder").show();s(i,c)}}var a={SUBMIT:".js-h-message__submit",MESSAGE:".js-h-message"},r={BTN_LOADING:"loading",FORM_HIDDEN:"hidden"};$(document).on("click",a.SUBMIT,n)})},{}],11:[function(e,t,o){function s(e){var t=$(e.currentTarget),o=t.data("id"),s=t.data("action");return t.addClass("loading"),$.post("/json/comment/",{id:o,action:"moderate",status:s},function(e){if("approve"==s)if("ok"==e.messages){var n;for(n in e.comments)0==$("#comment_"+e.comments[n].id).size()&&(0==e.comments[n].parent_id?$("#comment_"+o).replaceWith(e.comments[n].html):$("#reply_comments_"+e.comments[n].parent_id).find("#comment_"+o).replaceWith(e.comments[n].html),l(e.comments[n].id),document.unreadcomments.push({id:parseInt(e.comments[n].id)}));r.syncCommentCountFromDOM();var a=$("#comments_count");a.text(parseInt($("#comments_count").text())+e.comments.length),$("pre code").each(function(){c.highlightBlock(this)}),i(e),m()}else d(e);else"ok"==e.messages?$("#comment_"+o).remove():d(e);t.removeClass("loading")},"json"),!1}var n=e("../comments/_highlight_parents.js"),a=e("../comments/_instagram.js"),r=e("../comments/_xpanel.js"),i=window.change_post_subscibptions_checkboxes,c=window.hljs,m=a.instagrammProcess,l=n.showCommentParents,d=window.show_system_error;$(document).on("click",".comment-moderate",s)},{"../comments/_highlight_parents.js":7,"../comments/_instagram.js":8,"../comments/_xpanel.js":25}],12:[function(e,t,o){$(document).ready(function(){$("*[rel=user-popover]").each(function(){var e=$(this);e.webuiPopover({animation:"fade",arrow:!1,padding:!1,placement:"bottom-right",trigger:"hover",offsetTop:5,delay:{show:1e3},type:"async",url:"/json/users/info/",async:{method:"POST",data:{login:e.data("user-login")}},content:function(e){return e.html}})})})},{}],13:[function(e,t,o){function s(){var e=window.g_user_login;return'<span class="user_info user-info_inline">  <img src='+window.g_user_avatar+' class="user-info__image-pic user-info__image-pic_small" />  <span class="user-info__nickname user-info__nickname_small user-info__nickname_comment">'+e+"   </span></span>"}function n(e){return'<time class="comment__date-time">'+window._getDate(e)+" в "+window._getTime(e)+"</time>"}function a(e){return'<div class="comment__head">'+s()+n(new Date)+"</div>"+e}function r(e,t){e.toggleClass("loading",t)}function i(e,t){var o=$(t);$(e).ajaxSubmit({data:{action:"preview"},beforeSubmit:function(e,t){return r(o,!0),!!c.validateFormInput(t)||(r(o,!1),!1)},success:m(function(e){var t=a(e.text);$("#preview_placeholder").removeClass("hidden").html(t),r(o,!1),c.refreshSyntaxHighlight()})})}var c=e("../comments/_helpers.js"),m=window.ajaxFormSuccess;void 0!==t&&void 0!==t.exports&&(t.exports={comment_preview:i})},{"../comments/_helpers.js":6}],14:[function(e,t,o){function s(e){e.addClass(_.COMMENT_DELETED);var t=$(u.HEADER,e);t.addClass(_.HEADER_DELETED),t.append(f.HIDDEN),e.find(u.FOOTER).hide()}function n(e){m.comment_show_reply_form(null,!0),s($(u.COMMENT.replace("{id}",e.comment_id)))}function a(){}function r(e){e.ajaxSubmit({data:{action:"delete"},form:e,dataType:"json",error:l,success:d(n,null,!0)})}function i(e,t){confirm("Точно удаляем?")?(c.toggleLoadingState($(e),$(t),!0),r($(e))):(c.hideForm(e),a())}var c=e("../comments/_form.js"),m=e("../comments/_show_reply_form.js"),l=window.ajaxFormError,d=window.ajaxFormSuccess,u={COMMENT:"#comment_{id}",FOOTER:".comment__footer",HEADER:".comment__head"},_={COMMENT_DELETED:"js-comment_deleted",HEADER_DELETED:"comment__head_deleted"},f={HIDDEN:'<span class="comment__status">(комментарий скрыт)</span>'};void 0!==t&&void 0!==t.exports&&(t.exports={comment_delete:i})},{"../comments/_form.js":5,"../comments/_show_reply_form.js":18}],15:[function(e,t,o){function s(e,t){return!e.comments_moderation&&!r.isRootCommentsForm(t)}function n(e,t,o){o.preventDefault();var n=$(e),c=$(t);n.ajaxSubmit({data:{action:"add"},dataType:"json",beforeSubmit:function(){return r.toggleLoadingState(n,c,!0),!!i.validateFormInput(n)||(r.toggleLoadingState(n,c,!1),!1)},error:function(e,t){r.toggleLoadingState(n,c,!0),d(e,t)},success:u(function(e,t,o,m){r.toggleLoadingState(n,c,!1);var d=e.comments_moderation;d.html&&(d=[d]);var u=[].concat.apply(e.comments||[],d||[]);a.appendNewComments(u),e.comments_moderation&&($("#moderated_placeholder").removeClass("hidden"),r.showForm(),$("#comments_form_placeholder").hide()),e.ts&&r.updateTimestamp(e.ts),l.syncCommentCountFromDOM(),r.clearInputField(n),r.hidePreview(n),s(e,n)&&r.hideForm(n),a.addCountForAllComments(u.length),i.refreshSyntaxHighlight(),f(),_(e)},function(){r.toggleLoadingState(n,c,!1)})})}var a=e("../comments/_append.js"),r=e("../comments/_form.js"),i=e("../comments/_helpers.js"),c=e("../comments/_highlight_parents.js"),m=e("../comments/_instagram.js"),l=e("../comments/_xpanel.js"),d=window.ajaxFormError,u=window.ajaxFormSuccess,_=window.change_post_subscibptions_checkboxes,f=(window.empty,window.hljs,m.instagrammProcess);c.showCommentParents;void 0!==t&&void 0!==t.exports&&(t.exports={comment_send:n})},{"../comments/_append.js":3,"../comments/_form.js":5,"../comments/_helpers.js":6,"../comments/_highlight_parents.js":7,"../comments/_instagram.js":8,"../comments/_xpanel.js":25}],16:[function(e,t,o){function s(e){m();var t=$("#comment_"+e),o=$("#comment-form"),s=o.find(".time_left");return m(),n.hidePreview(o),$.post("/json/comment/",{comment_id:e,action:"source"},function(n){if("ok"==n.messages){var a=n.text;o.find(".js-form-buttons");t.find(".js-form_placeholder").append(o),t.children(".js-form_placeholder").removeClass("hidden");d(o,0,e,a),p($("#comment_text")),u("edit"),_(s,n.time_left,1e3),l(Boolean(e),f)}else h(n)}),!1}var n=e("../comments/_form.js"),a=e("../comments/_helpers.js"),r=e("../comments/_show_reply_form.js"),i=e("../comments/_timer.js"),c=e("../comments/_title.js"),m=i.endTimer,l=c.listenCommentFormTitle,d=a.setCommentForm,u=a.showCommentButtons,_=i.startTimer,f=r.comment_show_reply_form,p=window.mention_autocomplete,h=window.show_system_error;void 0!==t&&void 0!==t.exports&&(t.exports={comment_show_edit_form:s})},{"../comments/_form.js":5,"../comments/_helpers.js":6,"../comments/_show_reply_form.js":18,"../comments/_timer.js":19,"../comments/_title.js":20}],17:[function(e,t,o){function s(e){r();var t=$("#comment_"+e),o=$("#comment-form");t.children(".js-form_placeholder").removeClass("hidden"),t.children("#comment-form_placeholder").html(o);return i(o,e,0,""),o.find(".time_left").text(""),m($("#comment_text")),c("reply"),!1}var n=e("../comments/_helpers.js"),a=e("../comments/_timer.js"),r=a.endTimer,i=n.setCommentForm,c=n.showCommentButtons,m=window.mention_autocomplete;void 0!==t&&void 0!==t.exports&&(t.exports={comment_show_form:s})},{"../comments/_helpers.js":6,"../comments/_timer.js":19}],18:[function(e,t,o){function s(e,t){i();var o=$("#comment_"+e),n=$("#comment-form");if(n.length){e?o.children(".js-form_placeholder").html(n):$("#comments_form_placeholder").append(n),o.children(".js-form_placeholder").removeClass("hidden");m(n,e,0,"",t),l("reply"),n.find(".time_left").text(""),d($("#comment_text")),c(Boolean(e),s)}else{var a=$("#expired_placeholder");$("#comment_"+e+" .js-form_placeholder").html(a),a.removeClass("hidden")}return!1}var n=e("../comments/_timer.js"),a=e("../comments/_helpers.js"),r=e("../comments/_title.js"),i=n.endTimer,c=r.listenCommentFormTitle,m=a.setCommentForm,l=a.showCommentButtons,d=window.mention_autocomplete;void 0!==t&&void 0!==t.exports&&(t.exports={comment_show_reply_form:s})},{"../comments/_helpers.js":6,"../comments/_timer.js":19,"../comments/_title.js":20}],19:[function(e,t,o){function s(e){if(null!==i.timer){clearInterval(i.timer);n(e?"Время истекло":"")}}function n(e){i.element&&i.element.text(e.toString())}function a(e,t,o){i.element=e,i.left=t,i.timer=setInterval(function(){if(i.left>0)i.left=i.left-1,n(r(i.left));else{s(!0)}},o)}var r=window.timer_countdown,i={element:null,left:0,timer:null};void 0!==t&&void 0!==t.exports&&(t.exports={endTimer:s,startTimer:a})},{}],20:[function(e,t,o){function s(e,t){var o=$(".comment-form__title"),s=o.data("has-listener");if(e){if(s)return;o.on("click",function(){t()})}else{if(!s)return;o.off("click")}o.toggleClass("comment-form__title_listened",e),o.data("has-listener",e)}void 0!==t&&void 0!==t.exports&&(t.exports={listenCommentFormTitle:s})},{}],21:[function(require,module,exports){$(document).ready(function(){function toggleHideDeletedBtnState(e,t){var o=t?"Показать удаленные комментарии":"Скрыть удаленные комментарии";e.text(o),e.data("deleted-comments-hidden",t)}function toggleDeletedCommentsState(e){var t=$(SELECTORS.COMMENTS);e?t.hide():t.show()}function onHideDeletedClick(e){e.preventDefault();var t=$(e.currentTarget),o=t.data("deleted-comments-hidden"),s=!o;toggleHideDeletedBtnState(t,s),toggleDeletedCommentsState(s)}function onSubscribeByEmailClick(){var subscribe_checkbox=$(this);eval("var data = "+subscribe_checkbox.attr("rel")+";"),data.action=subscribe_checkbox.attr("checked")?"subscribe":"unsubscribe",$.post("/json/subscription/",data,function(e){"ok"==e.messages?$.jGrowl("Настройки уведомления о новых комментариях успешно сохранены",{theme:"notice"}):show_system_error(e)},"json")}function onSubscribeByTrackerClick(){var checkbox=$(this);eval("var data = "+checkbox.attr("rel")+";");var url=checkbox.attr("checked")?"/json/tracker/add/":"/json/tracker/remove/";$.post(url,data,function(e){"ok"==e.messages?$.jGrowl("Настройки уведомления о новых комментариях успешно сохранены",{theme:"notice"}):show_system_error(e)},"json")}var SELECTORS={BUTTON:"#hide_all_deleted_comments",COMMENTS:".js-comment_deleted",SUBSCRIBE_BY_EMAIL:"#subscribe_comments",SUBSCRIBE_BY_TRACKER:"#tracker_comments"};$(SELECTORS.BUTTON).on("click",onHideDeletedClick),g_is_guest&&($(SELECTORS.SUBSCRIBE_BY_EMAIL).on("click",onSubscribeByEmailClick),$(SELECTORS.SUBSCRIBE_BY_TRACKER).on("click",onSubscribeByTrackerClick))})},{}],22:[function(e,t,o){$(document).ready(function(){function e(e){var t=$(window).height();$.scrollTo(e,1,{axis:"y",offset:{top:t/2*-1}})}function t(t){var o=$(t.currentTarget),s=$(".js-comment"),n=!o.hasClass("open");s.toggle(!n),o.toggleClass("open",n);var a=o.data("id"),r=$("#comment_"+a);n&&showCommentParents(a),e(r)}$(document).on("click",".js-comment_parent",function(){var e=$(this).data("parent_id"),t=$(this).data("id");return $(this).hasClass("back_to_children")?$("#comment_"+t).find(".js-comment_chidren").addClass("hidden"):($("#comment_"+e).find(".js-comment_children").removeClass("hidden"),$("#comment_"+e).find(".js-comment_children > .js-comment_parent").attr({href:"#comment_"+t,"data-id":e,"data-parent_id":t})),$.scrollTo($("#comment_"+e),800,{axis:"y",offset:-10}),!1}),$(document).on("click",".js-comment_tree",t)})},{}],23:[function(e,t,o){function s(e,t){$(e).ajaxSubmit({data:{action:"edit"},form:$(e),dataType:"json",beforeSubmit:function(){$(t).addClass("loading");var o=$('textarea[name="text"]',e).val();if(m(o))return $.jGrowl("Вы забыли ввести текст комментария",{theme:"error"}),$(t).removeClass("loading"),!1},error:function(e,o){$(t).removeClass("loading"),i(e,o)},success:c(function(e,o,s,n){$(t).removeClass("loading");r(null,!0);var a=$("#comment_"+e.comment_id);$("> .comment__message",a).html(e.message),$("> .comment__date-time",a).html(e.time_changed+' <span class="comment-item__time_changed icon_comment-edit" title="Kомментарий был изменён"><i class="comment-item__sign_changed">(комментарий был изменён)</i></span>'),$("pre code").each(function(){l.highlightBlock(this)}),d()},null,!0)})}var n=e("../comments/_instagram.js"),a=e("../comments/_show_reply_form.js"),r=a.comment_show_reply_form,i=window.ajaxFormError,c=window.ajaxFormSuccess,m=window.empty,l=window.hljs,d=n.instagrammProcess;void 0!==t&&void 0!==t.exports&&(t.exports={comment_update:s})},{"../comments/_instagram.js":8,"../comments/_show_reply_form.js":18}],24:[function(e,t,o){function s(e,t){"function"==typeof ga&&ga("send","event",e,t)}function n(e){return"plus"==e?parseInt(1):parseInt(-1)}function a(e){var t=$(e),o=t.closest(".js-comment-vote"),a=o.find(".js-score"),r=t.attr("data-action"),i={ti:o.attr("data-id"),tt:o.attr("data-type"),pti:o.attr("data-post-target"),v:n(r)};$.post("/json/vote/",i,function(e){if("ok"==e.messages){var s=i.v;parseInt(e.score,10);switch(o.find('button[type="button"]').attr("disabled","disabled"),s){case 1:t.attr("title","Вы проголосовали положительно."),t.children().addClass("icon-svg_arrow-green");break;case-1:t.attr("title","Вы проголосовали отрицательно."),t.children().addClass("icon-svg_arrow-red")}a.replaceWith('<span class="voting-wjt__counter voting-wjt__counter_'+e.sign+' js-score" title="Всего '+e.votes_count+": &uarr;"+e.votes_count_plus+" и &darr;"+e.votes_count_minus+'">'+e.score+"</span>"),e.is_negative}else show_system_error(e)},"json"),s("comment",r)}void 0!==t&&void 0!==t.exports&&(t.exports={comment_vote:a})},{}],25:[function(e,t,o){function s(e){var t=$(T.REFRESH_BUTTON());return t.on("click",e),t}function n(e){var t=$(T.PREV_BUTTON());return t.on("click",e),t}function a(e){var t=$(T.NEXT_BUTTON());return t.on("click",e),t}function r(e,t){var o=$(T.COUNTER(e));return o.on("click",t),o}function i(e){var t=$(T.WRAPPER()),o=r(e,x),i=s(b),c=n(y),m=a(j);return t.append([i,c,o,m]),0===e&&(c.hide(),m.hide(),o.hide()),E=o,B=m,R=c,H=i,D=t,t}function c(){if($("#comments").length){var e=l().length,t=i(e);$("body").append(t)}}function m(){var e=$(".js-comment"),t=$(".js-comment_tree");e.show(),t.removeClass("open")}function l(){return $(".js-comment_new")}function d(){l().toArray().forEach(u)}function u(e){$(e).removeClass("js-comment_new").find(".comment__head_new-comment").eq(0).removeClass("comment__head_new-comment")}function _(){var e=l().length;p(e),e&&g(!0)}function f(){return $("#comments_form")}function p(e){E.text(e)}function h(e){var t=f();if(!t.length)return void e([]);t.ajaxSubmit({data:{action:"get_new"},url:"/json/comment/",success:function(t){S.updateTimestamp(f(),t.ts),e(t.comments)}})}function g(e){var t=$([E[0],B[0],R[0]]);e?t.show():t.hide()}function v(e){C.appendNewComments(e);var t=e.length;p(t),C.addCountForAllComments(t),g(Boolean(t)),H.removeClass("loading"),F.instagrammProcess()}function b(e){var t=$(e.currentTarget);t.hasClass("loading")||(m(),d(),h(v),t.addClass("loading"))}function w(e,t){return l().toArray().reduce(function(o,s){var n=$(s),a=-100*t;return(n.offset().top+a-e)*t>0?o.concat(n):o},[])}function j(e){var t=window.pageYOffset,o=w(t,1),s=o[0];$(".js-comment .comment.is_selected").removeClass("is_selected"),s&&s.length&&($(".comment",s).first().addClass("is_selected"),k(s))}function y(e){var t=window.pageYOffset,o=w(t,-1),s=o[o.length-1];$(".js-comment .comment.is_selected").removeClass("is_selected"),s&&s.length&&($(".comment",s).first().addClass("is_selected"),k(s))}function k(e,t){var o=parseInt($(e).css("padding-top"),10),s=-10+o||-10;$.scrollTo(e,100,{axis:"y",offset:s,onAfter:t})}function x(e){m();var t=l(),o=t.length;if(o){var s=t[0];o-=1,k(s,function(){setTimeout(function(){u(s)},300)})}p(o),o||g(!1)}var C=e("../comments/_append.js"),S=e("../comments/_form.js"),F=e("../comments/_instagram.js"),T=e("../comments/_xpanel_templates.js"),E=null,B=null,R=null,H=null,D=null;void 0!==t&&void 0!==t.exports&&(t.exports={initXPanel:c,syncCommentCountFromDOM:_})},{"../comments/_append.js":3,"../comments/_form.js":5,"../comments/_instagram.js":8,"../comments/_xpanel_templates.js":26}],26:[function(e,t,o){function s(e){return'<span class="new" title="Количество новых комментариев.По клику (горячая клавиша - f) переходит к первому непрочитанному комментарию.">'+e+"</span>"}function n(){return'<span class="next_new" title="По клику (горячая клавиша - j) переходит к следующему непрочитанному комментарию.">&darr;</span>'}function a(){return'<span class="prev_new" title="По клику (горячая клавиша - k) переходит к предыдущему непрочитанному комментарию.">&uarr;</span>'}function r(){return'<span class="refresh" title="Обновить комментарии"></span>'}function i(){return'<div id="xpanel"></div>'}void 0!==t&&void 0!==t.exports&&(t.exports={COUNTER:s,NEXT_BUTTON:n,PREV_BUTTON:a,REFRESH_BUTTON:r,WRAPPER:i})},{}]},{},[1]),$(document).ready(function(){if($("#adriver_banner_1109509440").length){var e=function(){var t=$("#adriver_banner_1109509440");scrollTop=$(window).scrollTop(),scrollBottom=$(window).scrollTop()+$(window).height(),blockTopPosition=t.parent().offset().top,adBannerHeight=t.height(),scrollBottom>blockTopPosition&&(loadAdriverBanner(),$(window).off("scroll",e))};$(window).on("ready",e),$(window).on("scroll",e)}});var openSearch,closeSearch;!function(){var e=document.getElementById("search-form"),t=document.getElementById("search-form-btn"),o=document.getElementById("search-form-field"),s=document.getElementById("search-form-clear"),n=document.getElementById("navbar-links");t.onclick=function(e){e.preventDefault(),openSearch()},s.onclick=function(e){e.preventDefault(),closeSearch()},o.onfocus=function(e){document.onkeydown=function(e){e=e||window.event,27==e.which&&closeSearch()}},openSearch=function(){e.className+=" search-form_expanded",n.className+=" hidden",o.focus()},closeSearch=function(){o.value="",o.blur(),e.classList.remove("search-form_expanded"),n.classList.remove("hidden")}}(),"undefined"!=typeof module&&void 0!==module.exports&&(module.exports={closeSearch:closeSearch,openSearch:openSearch}),function(){function e(e,t){var o,s;return function(){var n=arguments,a=(new Date).getTime();o&&a-o>t?(o=a,e.apply(null,n)):(clearTimeout(s),s=setTimeout(function(){o=a,e.apply(null,n)},t))}}function t(e){var t=$(window).scrollTop(),o=e.offset().top,s=t-o;e.children().eq(0).toggleClass("sticked",s>=20)}function o(o){if(o.children().eq(0).length){var s=e(t.bind(null,o),50);s(),$(window).on("scroll",s)}}$(document).ready(function(){o($(".sidebar_right_stickable"))})}(),$(document).ready(function(){$('#search_form input[type="text"]').autocomplete({serviceUrl:"/json/suggest/",minChars:2,delimiter:/(,|;)\s*/,maxHeight:400,width:300,zIndex:9999,deferRequestBy:500,params:{type:"search"}})}),$(document).ready(function(){function e(){return["A","B"][t(0,1)]}function t(e,t){return Math.floor(Math.random()*(t-e+1))+e}var o=function(t){var o=$.cookie(t);return o||(o=e(),$.cookie(t,o,{expires:14,path:"/"}),o)}("ab_test_vacancies_block_group");$(".promo-block_vacancies a").each(function(){var e=$(this),t=e.data("utm"),s="utm_campaign=tm_promo_"+o,n=t.replace("utm_campaign=tm_promo",s);e.data("utm",n),e.attr("data-utm",n)})});var _H=window._H||{};$(document).ready(function(){"use strict";new _H.Suggest({selectors:{clear:"#hubs_suggest_clear",container:"#hubs",suggest:"#hubs_suggest"}}),new _H.Follow({selectors:{follow:".js-hub-follow-btn"},suggestUrl:"/json/hubs/",suggestRequest:function(e){return{hub_id:$(e).attr("data-id")}}})}),$(document).ready(function(){var e=$.jStorage.get("last_navigator_category"),t=$.jStorage.get("last_navigator_hubs"),o=$.jStorage.get("last_navigator_hub");if(e&&"null"!=e){if($('#fast_navagator select[name="category"]').val(e),t){var s="";for(k in t)s+='<option value="'+t[k].alias+'">'+t[k].name+"</option>";$('#fast_navagator select[name="hub"]').html(s).attr("disabled",!1),$('#fast_navagator input[type="submit"]').attr("disabled",!1)}o&&($('#fast_navagator select[name="hub"]').val(o),$("#fast_navagator .buttons input").attr("disabled",!1).removeClass("loading"))}else $('#fast_navagator select[name="hub"]').html("<option>Хаб</option>").attr("disabled",!0),$('#fast_navagator input[type="submit"]').attr("disabled",!0);$('#fast_navagator select[name="category"]').change(function(){var e=$(this).val();$.jStorage.set("last_navigator_category",e),"null"==e?($('#fast_navagator select[name="hub"]').html("<option>Хаб</option>").attr("disabled",!0),$('#fast_navagator input[type="submit"]').attr("disabled",!0)):$.post("/json/hubs/category/"+e+"/",function(e){if("ok"==e.messages){var t="";for(k in e.hubs)t+='<option value="'+e.hubs[k].alias+'">'+e.hubs[k].name+"</option>";$.jStorage.set("last_navigator_hubs",e.hubs),$('#fast_navagator select[name="hub"]').html(t).attr("disabled",!1),$('#fast_navagator input[type="submit"]').attr("disabled",!1)}else show_system_error(e)},"json")}),$("#fast_navagator").submit(function(){var e=$('#fast_navagator select[name="hub"]').val();return $.jStorage.set("last_navigator_hub",e),document.location.href="/hub/"+e+"/",!1}),$("#addCompanyFan").click(function(){var e=$(this).attr("data-id"),t=$(this);return t.addClass("loading"),$.post("/json/corporation/fan_add/",{company_id:e},function(e){"ok"==e.messages?($("#removeCompanyFan").removeClass("hidden"),$("#addCompanyFan").addClass("hidden"),$("#fans_count").text(e.fans_count_str)):show_system_error(e),t.removeClass("loading")},"json"),!1}),$("#removeCompanyFan").click(function(){var e=$(this).attr("data-id"),t=$(this);return t.addClass("loading"),$.post("/json/corporation/fan_del/",{company_id:e},function(e){"ok"==e.messages?($("#removeCompanyFan").addClass("hidden"),$("#addCompanyFan").removeClass("hidden"),$("#fans_count").text(e.fans_count_str)):show_system_error(e),t.removeClass("loading")},"json"),!1})}),$(document).ready(function(){$('button[name="send_invite"]').on("click",function(){var e=$(this).data("id");return $.post("/json/users/give_invite_bypost/",{post_id:e},function(t){"ok"==t.messages?$("#sandbox-panel_"+e+" .send_invite_wrapper").html('<span style="color:green;">Приглашение отправлено</span>'):show_system_error(t)},"json"),!1}),$('button[name="send_invite_plus"]').on("click",function(){var e=$(this).data("id");return $.post("/json/users/give_invite_bypost_plus/",{post_id:e},function(t){"ok"==t.messages?$("#sandbox-panel_"+e+" .send_invite_wrapper").html('<span style="color:green;">Приглашение отправлено</span>'):show_system_error(t)},"json"),!1}),$('button[name="reject"]').on("click",function(){var e=$(this).data("id");$("#reject_form_post_"+e).removeClass("hidden"),$("#transfer_form_post_"+e).addClass("hidden");var t=$("#reject_form_post_"+e+' select[name="reject_reason"]');return t.attr("enabled","true"),$.each(reasonsList,function(){t.append($("<option></option>").text(this.optionValue).val(this.optionValue).attr({"data-text":this.textareaValue,"data-action":this.action}))}),!1}),$(document).on("change",'.reject_form select[name="reject_reason"]',function(e){var t=$(this).closest(".reject_form").data("id"),o=this.options[e.target.selectedIndex],s=$(o).data("text"),n=$(o).data("action");$("#reject_form_post_"+t).find("#reject_text_textarea").val(s),$("#reject_form_post_"+t).find('input[name="reject_action"]').val(n),""===n&&$("#reject_form_post_"+t+" .reject_reason").find(".error").text("Вы не выбрали причину отклонения публикации!")}),$('button[name="transfer"]').on("click",function(){var e=$(this).data("id");return $("#reject_form_post_"+e).addClass("hidden"),$("#transfer_form_post_"+e).removeClass("hidden"),!1}),$('button[name="publish"]').on("click",function(){var e=$(this).data("id");return $.post("/json/sandbox/publish/",{post_id:e},function(t){"ok"==t.messages?$("#post_"+e).fadeOut(500,function(){$(this).remove()}):show_system_error(t)},"json"),!1})}),$(function(){if(!$("#habralenta-settings").length)return!1;var e=$('<img src="/images/form/ajax_loader.gif" alt="" class="ajax_loader" align="top"/>'),t=$("#hubs_category"),o=($("#habralenta-settings"),$("#form_habralenta_settings"),$("#save_success"),""),s=hubs_category_json;$.each(s.categories,function(e,t){var n=2==t.subscription?"full":"",a=1==t.subscription?"part":"",r=2==t.subscription?"Отписаться от всех хабов в этом потоке":"Подписаться на все хабы в этом потоке",i="corporative_blogs"==t.alias?"/companies/":"/hubs/"+t.alias+"/",c=s.lenta_show_all||0==t.count?"disabled":"",m=t.have_new?' <span class="new">'+t.have_new+"</span>":"",l=t.count>0?'<a href="'+i+'" title="Нажмите, чтобы посмотреть хабы из этого потока">'+t.name+"</a>":'<span class="category_title">'+t.name+"</span>";o+='<div class="category '+n+" "+a+" "+c+'" data-alias="'+t.alias+'">                       <div class="checkbox" title="'+r+'"></div>                       <input type="hidden" name="categories['+t.alias+']" class="input" value="'+t.subscription+'" />                       <div class="title">                         '+l+'                         <span class="count" title="Количество хабов в категории">('+t.count+")</span>                         "+m+'                       </div>                       <div class="hubs"></div>                     </div>'}),t.html(o),$(".lenta-tip").tipTip({maxWidth:"300",edgeOffset:10}),void 0!==s.subscription&&s.subscription&&($('input[name="enable_subscription"]').prop("checked",!0),$('select[name="subscription_frequency"]').val(s.subscription.frequency)),$(".category .title a",t).live("click",function(){var t=$(this),o=t.parent().parent(".category"),s=$(".hubs",o),n=$(".title .count",o),a=o.attr("data-alias");return!o.hasClass("disabled")&&(s.html()?s.toggleClass("show"):(n.after(e),$.get("/json/hubs/category/"+a+"/",function(t){var n="";$.each(t.hubs,function(e,t){o.hasClass("full")?t.subscription=1:o.hasClass("part")||(t.subscription=0);var s=t.subscription?"subscription":"",r=t.subscription?"Отписаться от хаба":"Подписаться на хаб",i="corporative_blogs"==a?"/company/"+t.alias+"/blog/":"/hub/"+t.alias+"/",c=t.is_new?' <span class="new">новый</span>':"";n+='<div class="hub '+s+'">                         <div class="checkbox" title="'+r+'"></div>                         <input type="hidden" name="blogs['+t.id+']" class="input" value="'+t.subscription+'" />                         <a href="'+i+'" target="_blank">'+t.name+"</a>                         "+c+"                       </div>"}),e.remove(),s.html(n),s.toggleClass("show"),$(".hub a",s).click(function(){if($(this).parent(".hub").parent().parent(".category").hasClass("disabled"))return!1}),$(".hub .checkbox",s).on("click",function(e){e.preventDefault();var t=$(this),o=t.parent(".hub"),n=o.parent().parent(".category"),a=$(".input",o),r=$("> .input",n);if(n.hasClass("disabled"))return!1;o.hasClass("subscription")?(o.removeClass("subscription"),a.val(0),t.attr("title","Подписаться на хаб")):(o.addClass("subscription"),a.val(1),t.attr("title","Отписаться от хаба"));var i=$(".subscription",s),c=$(".hub",s);0==i.size()?(n.removeClass("part").removeClass("full"),r.val(0),n.find("> .checkbox").attr("title","Подписаться на все хабы в этой категории")):i.size()==c.size()?(n.removeClass("part").addClass("full"),r.val(2),n.find("> .checkbox").attr("title","Отписаться от всех хабов в этой категории")):(n.removeClass("full").addClass("part"),r.val(1),n.find("> .checkbox").attr("title","Подписаться на все хабы в этой категории"))})},"json")),!1)}),$(".category > .checkbox",t).live("click",function(){var e=$(this),t=e.parent(".category"),o=(t.attr("data-alias"),$(".hubs",t)),s=$(".input",t);return!t.hasClass("disabled")&&(t.hasClass("full")?(t.removeClass("full").removeClass("part"),s.val(0),$(".hub",o).removeClass("subscription"),$(".hub .input",o).val(0),e.attr("title","Подписаться на все хабы в этой категории")):t.hasClass("part")?(t.removeClass("part").addClass("full"),s.val(2),$(".hub",o).addClass("subscription"),$(".hub .input",o).val(1),e.attr("title","Отписаться от всех хабов в этой категории")):(t.addClass("full"),s.val(2),$(".hub",o).addClass("subscription"),$(".hub .input",o).val(1),e.attr("title","Отписаться от всех хабов в этой категории")),!1)}),$("#form_habralenta_settings").ajaxForm({form:$("#form_habralenta_settings"),url:"/json/hubs/save_subscriptions/",beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e,t,o,s){$.jGrowl("Настройки ленты успешно сохранились")})})}),$(document).ready(function(){$("#give_invite_button").click(function(){var e=$(this).data("login");return $.post("/json/users/send_invite/",{login:e},function(e){"ok"==e.messages?($.jGrowl("Вы подарили приглашение.<br> У вас осталось "+e.invites_string+".",{theme:"notice"}),ajaxFormRedirect(e)):show_system_error(e)}),!1}),$("#send_invite").click(function(){var e=$(this).data("user_id");return $.post("/json/users/set_invite/",{user_id:e},function(e){"ok"==e.messages?$.jGrowl("Приглашение отправлено",{theme:"notice"}):show_system_error(e)},"json"),!1}),$("#go_ppg").click(function(){var e=$(this).data("user_id");return $.post("/json/users/ppg_comments/",{user_id:e},function(e){"ok"==e.messages?$.jGrowl("Пользователь отправлен на ППГ",{theme:"notice"}):show_system_error(e)},"json"),!1}),$("#go_pis").click(function(){var e=$(this).data("user_id");return $.post("/json/users/ppg_smiles/",{user_id:e},function(e){"ok"==e.messages?$.jGrowl("Пользователь отправлен на ПИС",{theme:"notice"}):show_system_error(e)},"json"),!1})}),$(document).ready(function(){var e=function(){function e(){a.removeClass("hidden"),$("#userNoteFormTextarea").focus(),""!=o()&&$(".js-saveUserNote").attr("disabled",!1)}function t(e){var t=""!=e?"сохранена":"удалена",o="Заметка успешно  "+t;return $.jGrowl(o,{theme:"notice"})}function o(){return $("#userNoteFormTextarea").val()}function s(e){var o=e.note;"ok"==e.messages?(t(o),""!=o?(r.html(e.note),$(".js-userNote").removeClass("hidden"),a.addClass("hidden")):($(".js-noteBlockHeader").addClass("hidden"),$(".js-writeNoteBtn").removeClass("hidden"),a.addClass("hidden"))):window.show_system_error(e)}function n(){r.val()}var a=$(".js-userNoteForm"),r=$(".js-userNoteText");return{showForm:e,saveForm:s,clearForm:n,getValue:o}}();$(".js-writeNoteBtn").on("click",function(t){t.preventDefault(),$(this).addClass("hidden"),$(".js-noteBlockHeader").removeClass("hidden"),e.showForm()}),$(".js-editNoteBtn").on("click",function(t){t.preventDefault(),$(".js-userNote").addClass("hidden"),$(".js-cancelNoteBtn").addClass("hidden"),$(".js-userNoteForm").addClass("edit-mode"),e.showForm()}),$(".js-cancelNoteBtn").on("click",function(e){e.preventDefault(),$(".js-writeNoteBtn").removeClass("hidden"),$(".js-noteBlockHeader").addClass("hidden"),$(".js-userNoteForm").addClass("hidden"),$("#userNoteFormTextarea").val("").blur()}),$(".js-userNoteForm").on("change keyup",function(){var t=$(".js-saveUserNote");t.attr("disabled",!0),(""!=e.getValue()||$(".js-userNoteForm").hasClass("edit-mode"))&&t.attr("disabled",!1)}),$(".js-userNoteForm").ajaxForm({dataType:"json",url:"/json/users/save_note/",beforeSubmit:function(){e.clearForm()},success:function(t){e.saveForm(t)}}),$(".js-showmore_items").on("click",function(e){e.preventDefault();var t=($(this).data("login"),$(this).data("type"));$("#"+t+"_items li.hidden").removeClass("hidden"),$(this).remove()}),$("*[rel=hub-popover]").each(function(){var e=$(this);e.webuiPopover({animation:"fade",arrow:!1,padding:!1,placement:"bottom-right",trigger:"hover",offsetTop:5,delay:{show:1e3},type:"async",url:"/json/hubs/info/",async:{method:"POST",data:{alias:e.data("hub-alias")}},content:function(e){return e.html}})})}),$(document).ready(function(){$("#invite_form").ajaxForm({dataType:"json",url:"/json/users/give_invite_byform/",beforeSubmit:function(){$('#invite_form input[type="submit"]').addClass("loading")},
success:function(e){"ok"==e.messages?($.jGrowl("Приглашение отправлено",{theme:"notice"}),$("#count_invite").text(e.invite_string),$(".used_invites").prepend('<div class="invite_item" id="invite_item_'+e.invite_id+'">                <img src="/register/icode/'+e.invite_code+'/"  alt="" />                <a href="mailto:'+e.to_email+'">'+e.to_email+'</a>                <a href="#cancel" class="cancel" title="Отозвать приглашение" data-id="'+e.invite_id+'">x</a>            </div>'),$("#invite_form").resetForm()):show_system_error(e),$('#invite_form input[type="submit"]').removeClass("loading")}}),$("img.invite_preloader").live("click",function(){return $(this).attr("src",$(this).data("invite_url")).removeClass("invite_preloader").attr("title",""),!1}),$(".resend_invite").live("click",function(){var e=$(this),t=e.data("code");return $.post("/json/users/send_invite_notification/",{code:t},function(t){"ok"==t.messages?e.replaceWith("Приглашение повторно отправлено"):show_system_error(t)}),!1}),$(".used_invites .invite_item .cancel").live("click",function(){var e=$(this).data("id");return $.post("/json/users/unset_invites/",{invite_id:e},function(t){"ok"==t.messages?($.jGrowl("Приглашение отозвано",{theme:"notice"}),$("#invite_item_"+e).remove(),$("#count_invite").text(t.invite_string)):show_system_error(t)},"json"),!1})}),$(document).ready(function(){$("#karma_reset_input").click(function(){var e=!$(this).attr("checked");$('#karma_reset_form input[type="submit"]').attr("disabled",e)}),$("#karma_reset_form").ajaxForm({dataType:"json",url:"/json/users/reset/request/",beforeSubmit:function(){$('#karma_reset_form input[type="submit"]').addClass("loading")},success:function(e){"ok"==e.messages?$("#karma_reset").removeClass("karma_reseting").addClass("karma_noreseting"):show_system_error(e),$('#karma_reset_form input[type="submit"]').removeClass("loading")}}),$("#karma_reset_abort_form").ajaxForm({dataType:"json",url:"/json/users/reset/abort/",beforeSubmit:function(){$('#karma_reset_abort_form input[type="submit"]').addClass("loading")},success:function(e){"ok"==e.messages?$("#karma_reset").addClass("karma_reseting").removeClass("karma_noreseting"):show_system_error(e),$('#karma_reset_abort_form input[type="submit"]').removeClass("loading")}})});var _H=window._H||{};_H.Suggest=function(e){"use strict";this.validateSettings(e)&&(this._settings=e,this._clearButton=null,this._suggestElement=null,this._suggestWrapper=null,this._debounceTimer=!1,this._value="",this.init())},_H.Suggest.prototype.validateSettings=function(e){return!!e.selectors&&!!(e.selectors.clear&&e.selectors.container&&e.selectors.suggest)},_H.Suggest.prototype.init=function(){"use strict";this._suggestElement=$(this._settings.selectors.suggest),this._suggestWrapper=this._suggestElement.parent(),this._clearButton=$(this._settings.selectors.clear);var e=$(this._settings.selectors.container);this._fuzzySearch=window.fuzzySearch(this._suggestElement,e),this._clearButton.on("click",$.proxy(this.onClearClick,this)),this._suggestElement.on("change keyup",$.proxy(this.onElementChange,this))},_H.Suggest.prototype.onClearClick=function(){"use strict";this.clear()},_H.Suggest.prototype.onElementChange=function(e){"use strict";27===(e.charCode||e.keyCode)&&this.clear();var t=this._suggestElement.val();this._value!==t&&(this._value=t,this.enableLoadingState(!0),this.enableFilledState(!1),this._debounce($.proxy(function(){this.fetchResults(t)},this)))},_H.Suggest.prototype.clear=function(){"use strict";this._suggestElement.val(""),this._suggestElement.trigger("change"),this.enableFilledState(!1)},_H.Suggest.prototype._debounce=function(e){"use strict";this._debounceTimer&&clearTimeout(this._debounceTimer),this._debounceTimer=setTimeout($.proxy(e,this),300)},_H.Suggest.prototype.fetchResults=function(){"use strict";this._value?this._fuzzySearch.fetch(this._value,$.proxy(function(){this.enableLoadingState(!1),this.enableFilledState(!0)},this)):(this._fuzzySearch.reset(),this.enableFilledState(!1),this.enableLoadingState(!1))},_H.Suggest.prototype.enableLoadingState=function(e){this._suggestWrapper.toggleClass("loading",e)},_H.Suggest.prototype.enableFilledState=function(e){this._suggestWrapper.toggleClass("filled",e)},"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=_H.Suggest);var _H=window._H||{};_H.Follow=function(e){"use strict";this.validateSettings(e)&&(this._settings=e,this.init())},_H.Follow.prototype.validateSettings=function(e){return!!e.selectors&&(!!e.selectors.follow&&(!!e.suggestUrl&&"function"==typeof e.suggestRequest))},_H.Follow.prototype.init=function(){"use strict";$(document).on("click",this._settings.selectors.follow,$.proxy(this.onFollowButtonClick,this))},_H.Follow.prototype.onFollowButtonClick=function(e){"use strict";var t=e.currentTarget;this.followUserByButton(t)},_H.Follow.prototype.followUserByButton=function(e){"use strict";var t=this._settings.suggestUrl,o=this._settings.suggestRequest(e);window.btnFollow($(e),t,o)},"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=_H.Follow);var _H=window._H||{};$(document).ready(function(){"use strict";new _H.Suggest({selectors:{clear:"#people_suggest_clear",container:"#peoples",suggest:"#people_suggest"}}),new _H.Follow({selectors:{follow:".js-user-follow-btn"},suggestUrl:"/json/users/",suggestRequest:function(e){return{login:$(e).attr("data-login")}}})}),$(document).ready(function(){$("#i_work_in_company").click(function(){var e=$(this),t=$(this).data("id"),o=$("#js-companyWorkersCount"),s=$("#js-companyWorkersList");e.attr("checked")?$.post("/json/corporation/worker_add/",{company_id:t},function(t){"ok"==t.messages?(e.attr("title","Уволиться из компании"),$.jGrowl("Вы работаете в этой компании"),o.text(parseInt(o.text())+1),s.append('<li><a href="http://'+g_user_login+"."+g_base_url+'/" class="you">'+g_user_login+"</a></li>")):show_system_error(t)},"json"):$.post("/json/corporation/worker_del/",{company_id:t},function(t){"ok"==t.messages?(e.attr("title","Я работаю в этой компании"),$.jGrowl("Вы не работаете в этой компании"),o.text(parseInt(o.text())-1),$(".you",s).remove()):show_system_error(t)},"json")})}),$(document).ready(function(){$("#add_director").click(function(){var e=$("#directors_list .row").size(),t=$('<div class="row directors_'+e+'" id="row_'+e+'">                <div class="td name"><input type="text" name="directors['+e+'][name]" value=""/></div>                <div class="td position"><input type="text" name="directors['+e+'][position]" value=""/></div>                <div class="td delete"><a href="#remove" data-id="'+e+'" class="dotted">удалить</a></div>                <div class="clear"></div>                <div class="error"></div>              </div>');return $("#directors_list").append(t),!1}),$("#directors_list .row .delete a").live("click",function(){var e=$(this).data("id");return $("#row_"+e).html("").hide(),!1}),$("#add_stage").click(function(){var e=$("#stages_list .row").size()+1,t=$("#stage_select_date_template").html();t=t.replace(/NUM/g,e);var o=$('<div class="row" id="row_'+e+'">                <div class="td text"><input type="text" name="stages['+e+'][description]" value=""/></div>                <div class="td date">'+t+'</div>                <div class="td delete"><a href="#remove" data-id="'+e+'" class="dotted">удалить</a></div>              </div>');return $("#stages_list").append(o),!1}),$("#stages_list .row .delete a").live("click",function(){var e=$(this).data("id");return $("#row_"+e).html("").hide(),!1}),$("#company_add_form").ajaxForm({form:$("#company_add_form"),beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(ajaxFormRedirect)}),$("#startup_add_form").ajaxForm({beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e){"ok"==e.messages&&($(".company_add").hide(),$(".result").show(),$("html, body").animate({scrollTop:$(".result").offset().top+"px"}))})})});var _H=window._H||{};$(document).ready(function(){"use strict";new _H.Suggest({selectors:{clear:"#companies_suggest_clear",container:"#companies",suggest:"#companies_suggest"}}),new _H.Follow({selectors:{follow:".js-company-follow-btn"},suggestUrl:"/json/corporation/",suggestRequest:function(e){return{company_id:$(e).attr("data-id")}}})}),$(document).ready(function(){var e=$("#conversation_form");e.ajaxForm({form:e,beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e,t,o,s){var n=$(e.message_html);$("#messages").prepend(n),$("#conversation_form textarea").val(""),$("pre code",n).each(function(e,t){hljs.highlightBlock(t,"    ")}),$("#preview_placeholder").html("").addClass("hidden"),$(".item.captcha").addClass("hidden")},function(e,t,o,s){"undefined"!=typeof Recaptcha&&Recaptcha.reload(),$("#imgCaptcha").size()&&($("#imgCaptcha").attr("src","/core/captcha?"+Math.random()),$("#captcha").val(""))})}),$("textarea",e).on("keyup change blur focus",function(t){$(this).val().length>0?$(".js-form-buttons > button",e).attr("disabled",!1):$(".js-form-buttons > button",e).attr("disabled",!0)}),mention_autocomplete($("#conversation_form textarea")),$(".js-btn_preview").on("click",function(){e.ajaxSubmit({form:e,url:"/json/conversations/preview/",beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e,t,o,s){var n=$(e.message_html);$("#preview_placeholder").html(n).removeClass("hidden"),$("pre code",n).each(function(e,t){hljs.highlightBlock(t,"    ")})})})}),$("#load_more").click(function(){var e=$(this);return e.addClass("loading"),$.post(e.data("url"),{conversation_id:e.data("id"),respondent:e.data("respondent"),offset:e.data("offset")},function(t){if("ok"==t.messages){for(k in t.items)if(0==$("#message_"+t.items[k].id).size()){var o=$(t.items[k].html);o.hide(),$("#messages ").append(o),o.fadeIn(500)}0!=t.has_more?e.data("offset",t.offset):e.remove()}else show_system_error(t);e.removeClass("loading")}),!1})});var _H=window._H||{};$(document).ready(function(){"use strict";new _H.Suggest({selectors:{clear:"#people_suggest_clear",container:"#conversations",suggest:"#conversations_suggest"}}),$(".js-delete-conversation").on("click",function(e){e.preventDefault();var t=$(this).data("id");confirm("Вы уверены, что хотите удалить диалог?")&&$.post("/json/conversations/delete/",{conversation_id:t},function(e){"ok"==e.messages?$("#conversation_"+t).parent().remove():show_system_error(e)})})}),$(document).ready(function(){$('#feedback_form input[name="submit"]').click(function(){$("#feedback_form").ajaxForm({form:$("#feedback_form"),url:"/json/feedback/save/",beforeSubmit:function(e,t,o){return $("#preview_placeholder").html("").addClass("hidden"),ajaxFormBeforSubmit(e,t,o)},error:ajaxFormError,success:ajaxFormSuccess(function(e,t,o,s){$("#feedback_form").html('<div class="global_notify"><div class="inner_notice">Ваше сообщение отправлено. Сохраняйте терпение, в ближайшее время вы получите ответ.</div></div>')},function(e,t,o,s){"undefined"!=typeof Recaptcha&&Recaptcha.reload(),$("#imgCaptcha").size()&&($("#imgCaptcha").attr("src","/core/captcha?"+Math.random()),$("#captcha").val(""))})})})}),$(document).ready(function(){if(!$("#notifications_settings_form").length)return!1;$("#notifications_settings_form").ajaxForm({dataType:"json",url:"/json/settings/notifications/ ",beforeSubmit:function(){$("#notifications_settings_form .error").text("").hide(),$('#notifications_settings_form input[type="submit"]').addClass("loading")},success:function(e){"ok"==e.messages?$.jGrowl("Новые настройки успешно сохранились"):(show_form_errors(e),$.scrollTo($("#notifications_settings_form"),800,{axis:"y"})),$('#notifications_settings_form input[type="submit"]').removeClass("loading")}}),void 0!==json.subscription&&json.subscription&&($('input[name="enable_subscription"]').prop("checked",!0),$('select[name="subscription_frequency"]').val(json.subscription.frequency))}),$(document).ready(function(){$("#password_settings_form").ajaxForm({dataType:"json",url:"/json/settings/password/ ",beforeSubmit:function(){$("#password_settings_form .error").text("").hide(),$('#password_settings_form input[type="submit"]').addClass("loading")},success:function(e){"ok"==e.messages?$.jGrowl("Новые настройки успешно сохранились"):(show_form_errors(e),$.scrollTo($("#password_settings_form"),800,{axis:"y"})),$('#password_settings_form input[type="submit"]').removeClass("loading")}}),$("#email_settings_form").ajaxForm({dataType:"json",url:"/json/settings/email/",beforeSubmit:function(){$("#email_settings_form .error").text("").hide(),$('#email_settings_form input[type="submit"]').addClass("loading")},success:function(e){"ok"==e.messages?$.jGrowl("Новые настройки успешно сохранились"):(show_form_errors(e),$.scrollTo($("#email_settings_form"),800,{axis:"y"})),$('#email_settings_form input[type="submit"]').removeClass("loading")}})}),$(document).ready(function(){$("#other_settings_form").ajaxForm({form:$("#other_settings_form"),url:"/json/settings/others/",beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e,t,o,s){$.jGrowl("Новые настройки успешно сохранились")})})}),$(document).ready(function(){$("#privacy_settings_form").ajaxForm({dataType:"json",url:"/json/settings/privacy/ ",beforeSubmit:function(){$("#privacy_settings_form .error").text("").hide(),$('#privacy_settings_form input[type="submit"]').addClass("loading")},success:function(e){"ok"==e.messages?$.jGrowl("Новые настройки успешно сохранились"):(show_form_errors(e),$.scrollTo($("#privacy_settings_form"),800,{axis:"y"})),$('#privacy_settings_form input[type="submit"]').removeClass("loading")}})}),$(document).ready(function(){$(document).on("click","#add_contact",function(){var e=$("#contacts_list .row").size()+1,t=$("#contact_select_date_template").html();t=t.replace(/NUM/g,e);var o=$('<div class="row contacts'+e+'" id="row_'+e+'">                <div class="td type">'+t+'</div>                <div class="td value"><input type="text" name="contacts['+e+'][value]" value=""/></div>                <div class="td checkbox"><input type="checkbox" class="js-contacts-show_on_post" name="contacts['+e+'][show_on_post]" title="Показывать в инфопанели на странице публикации"/></div>                <div class="td delete"><a href="#remove" data-id="'+e+'" class="dotted">удалить</a></div>                <div class="error"></div>              </div>');return $("#contacts_list").append(o),!1});$(document).on("change","input.js-contacts-show_on_post",function(e){$("input.js-contacts-show_on_post:checked").length>5&&(this.checked=!1)}),$("#contacts_list .row .delete a").live("click",function(){var e=$(this).data("id");return $("#contacts_list #row_"+e).html("").hide(),!1}),$("#contacts_list .row .type select").live("change",function(){var e=$(this).parents(".row");18==$(this).val()?$('<div class="row_description">Связь аккаунта на Хабрахабре с учётной записью в Google+ позволит вам числиться автором статей в поисковой выдаче.<br>Подробности читайте в <a href="http://habrahabr.ru/info/help/settings/#2google">справочном разделе</a>.</div>').appendTo(e):$(".row_description",e).remove()}),$("#profile_settings_form").ajaxForm({form:$("#profile_settings_form"),beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e,t,o,s){$.jGrowl("Новые настройки успешно сохранились")})}),$("#avatar_settings_form").ajaxForm({form:$("#avatar_settings_form"),beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(function(e,t,o,s){$.jGrowl("Новые настройки успешно сохранились")})})}),$(document).ready(function(){$(".connect-service").each(function(e,t){$.post($(t).data("url"),{ajax:!0},function(e){e.id&&$(".about",t).html('<a href="'+e.link+'" class="pic"><img src="'+e.pic+'" alt="" /></a><a href="'+e.link+'" class="name">'+e.name+"</a>"),e.auth_error&&($(".about",t).html('<span class="auth_error">'+e.error_message+"</span>"),$("form",t).attr("action",e.connect_url),$("form button",t).text("Подключить"))})})}),$(document).ready(function(){$("#upgrade_settings_form").ajaxForm({form:$("#upgrade_settings_form"),beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,url:"/json/settings/upgrade/ ",success:ajaxFormSuccess(function(e,t,o,s){return $.jGrowl("Приглашение активировано"),window.location="/",!1},function(e,t,o,s){"undefined"!=typeof Recaptcha&&Recaptcha.reload(),$("#imgCaptcha").size()&&($("#imgCaptcha").attr("src","/core/captcha?"+Math.random()),$("#captcha").val(""))})})}),$(document).ready(function(){$(".app_title").on("click",function(){var e=$(this).data("key");$("#text-"+e).toggle("slow"),$.post("/json/tracker/apps/mark_as_read/",{single:!0,key:e})}),$("#check_all").click(function(){$(".tracker_apps td input:checkbox").attr("checked",!!$(this).attr("checked")).trigger("change")}),$(".tracker_apps td input:checkbox").change(function(){$(".tracker_apps td input:checked").length>0?$("#remove_button, #mark_read_button").attr("disabled",!1):$("#remove_button, #mark_read_button").attr("disabled",!0)}),$("#remove_button").on("click",function(){return $("#tracker_apps_form").ajaxSubmit({form:$("#tracker_apps_form"),url:"/json/tracker/apps/remove/",beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(ajaxFormRedirect)}),!1}),$("#mark_read_button").on("click",function(){return $("#tracker_apps_form").ajaxSubmit({form:$("#tracker_apps_form"),url:"/json/tracker/apps/mark_as_read/",beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(ajaxFormRedirect)}),!1})}),$(document).ready(function(){$("#check_all").click(function(){$(".tracker_comments td input:checkbox").attr("checked",!!$(this).attr("checked")).trigger("change")}),$(".tracker_comments td input:checkbox").change(function(){$(".tracker_comments td input:checked").length>0?$(".remove_button, .mark_read_button").attr("disabled",!1):$(".remove_button, .mark_read_button").attr("disabled",!0)});var e=$("#tracker_feed_form");$(".remove_button").on("click",function(t){return t.preventDefault(),$(e).ajaxSubmit({form:$(e),url:"/json/tracker/feed/remove/",beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(ajaxFormRedirect)}),!1}),$(".mark_read_button").on("click",function(t){return t.preventDefault(),$(e).ajaxSubmit({form:$(e),url:"/json/tracker/feed/mark_as_read/",beforeSubmit:ajaxFormBeforSubmit,error:ajaxFormError,success:ajaxFormSuccess(ajaxFormRedirect)}),!1})}),_H=window._H||{},_H.makeParagraphAnchors=function(e,t){$(e).find("h2[id], h3[id], li[id]").each(function(e,t){var o=t.getAttribute("id");$(t).append('<a class="h-anchor" href="#{href}">¶</a>'.replace("{href}",o))})},$(document).ready(function(){_H.makeParagraphAnchors(".h-info")});