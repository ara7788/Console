<!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class=" gecko win js" xmlns="http://www.w3.org/1999/xhtml" xmlns:exsl="http://exslt.org/common" xmlns:ng="http://docbook.org/docbook-ng" xmlns:fb="http://ogp.me/ns/fb#"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/font-awesome.css" rel="stylesheet">
<title>Глава 6. Минимизация времени простоя и накатывания развёртываний - Полное руководство Ansible</title>
<meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1">
<meta name="mavenGroupId" content="www.mdl.ru">
<meta name="MasteringAnsible2nd">
<meta name="mavenVersionId" content="1.0.0">
<link rel="home" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html" title="Полное руководство Ansible">
<link rel="up" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html" title="Полное руководство Ansible">
<link rel="prev" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html" title="Глава 5. Компоновка повторно используемого содержания и ролей Ansible">
<link rel="next" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html" title="Глава 7. Поиск неисправностей Ansible">
<meta name="git-sha" content="">
<meta name="buildTime" content="">
<script src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/ga_002.js" async="" type="text/javascript"></script><script type="text/javascript">
            //The id for tree cookie
            var treeCookieId = "mastering-ansible-2nd";
            var language = "en";
            var w = new Object();
            //Localization
            txt_filesfound = 'Results';
            txt_enter_at_least_1_char = "You must enter at least one character.";
            txt_browser_not_supported = "Please enable JavaScript.";
            txt_please_wait = "Please wait. Search in progress...";
            txt_results_for = "Results for: ";
</script>
<style type="text/css">
            input {
            margin-bottom: 5px;
            margin-top: 2px;
            }

            .folder {
            display: block;
            height: 22px;
            padding-left: 20px;
            background: transparent url(/common/jquery/treeview/images/folder.gif) 0 0px no-repeat;
            }
</style>
<link rel="shortcut icon" href="http://onreader.mdl.ru/MdlLogo.gif" type="image/gif">
<link rel="stylesheet" type="text/css" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/positioning.css">
<link rel="stylesheet" type="text/css" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/custom.css">
<link rel="canonical" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html">
<!--[if IE]>
	<link rel="stylesheet" type="text/css" href="/common/css/ie.css"/>
<![endif]-->
<link rel="stylesheet" type="text/css" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery-ui-1.css">
<link rel="stylesheet" type="text/css" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery_002.css">
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery-1.js"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery-ui-1.js"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery.js"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery_002.js"><!----></script>
<link rel="stylesheet" type="text/css" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery.css">
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/jquery_003.js">
<!--jQuery plugin for glossary popups. --></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/htmlFileList.htm"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/htmlFileInfoList.htm"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/nwSearchFnt.js"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/en_stemmer.js">
<!--//make this scalable to other languages as well.--></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/index-1.htm"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/index-2.htm"><!----></script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/index-3.htm"><!----></script>
<script type="text/javascript">
	    var _gaq = _gaq || [];
	    _gaq.push(['_setAccount', 'UA-17511903-1']);
	    
	    _gaq.push(['_setDomainName', '.openstack.org']);	        
</script>
<script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/ga.js"><!----></script>
<script language="javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/common.js"></script>
<link rel="stylesheet" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/googlecode.css">
<script src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/highlight.js"></script>
</head>
<body>
<!----><script type="text/javascript"><!--
hljs.initHighlightingOnLoad();
HeaderName = 'Глава 6. Минимизация времени простоя и накатывания развёртываний';
PrevRef = 'Ch05.html';
UpRef = 'index.html';
NextRef = 'Ch07.html';//--></script>
<!----><script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/HeaderAndToolbar.js">
</script><script type="text/javascript"><!--
document.write(HeaderAndToolbar); //-->
</script><div id="header"><div class="string"><div style="overflow: hidden; width: 100%;" id="marquee"><div style="width: 200%; margin-left: -99.7417%;"><span style="width: 50%; display: inline-block; text-align: center;"><a href="http://www.mdl.ru/Solutions/Put.htm?Nme=MdlAccelerator#RX461i">от100k USD решение с 8ю Tesla Volta V100</a> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.mdl.ru/Solutions/Put.htm?Nme=EveryPlacePC">23" терминал с 4core ЦПУ/4ГБ/1ТБ от 15тыс.руб.</a></span><span style="width: 50%; display: inline-block; text-align: center;"><a href="http://www.mdl.ru/Solutions/Put.htm?Nme=MdlAccelerator#RX461i">от100k USD решение с 8ю Tesla Volta V100</a> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.mdl.ru/Solutions/Put.htm?Nme=EveryPlacePC">23" терминал с 4core ЦПУ/4ГБ/1ТБ от 15тыс.руб.</a></span></div></div></div>	<a onclick="_gaq.push(['_trackEvent', 'Header', 'logo', 'click', 1]);" align="middle" target="_blank" href="http://www.mdl.ru/">	<img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/mdl-reg.jpg" style="position: relative; border-style: none; top: 18%;" alt="Перевод Mdl®" align="middle" height="14" width="40"></a>	<a onclick="_gaq.push(['_trackEvent', 'Header', 'logo', 'click', 1]);" target="_blank" href="https://www.packtpub.com/virtualization-and-cloud/">	<img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/PacktPub-logo.jpg" alt="Документация Virtualization and Cloud" height="44" width="109"></a>	<h1>Глава 6. Минимизация времени простоя и накатывания развёртываний</h1>	<div id="navheader" align="right"><!----><table class="navLinks"><tbody><tr>		<td><a id="showHideButton" onclick="showHideToc(); _gaq.push(['_trackEvent', 'Header', 'show/hide', 'click', 1]);" class="pointLeft" title="Скрыть дерево оглавления">Боковое поле</a>		</td><td><a accesskey="p" class="navLinkPrevious" onclick="_gaq.push(['_trackEvent', 'Header', 'prevLink', 'click', 1]);" tabindex="5" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html">Предыдущий</a>&nbsp;		  |       <a accesskey="u" class="navLinkUp" onclick="_gaq.push(['_trackEvent', 'Header', 'upLink', 'click', 1]);" tabindex="5" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html">Вверх</a>		  |        <a accesskey="n" class="navLinkNext" onclick="_gaq.push(['_trackEvent', 'Header', 'nextLink', 'click', 1]);" tabindex="5" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html">Следующий</a>		</td></tr></tbody></table>	</div></div><div id="toolbar" class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">	<div id="toolbar-left">		<p class="breadcrumbs"><a href="http://cloudcomputing.mdl.ru/">CloudComputing:mdl.ru</a>		<a href="http://onreader.mdl.ru/KVMVirtualizationCookbook/content/Ch08.html">Книга рецептов виртуализации KVM</a>		<a href="http://onreader.mdl.ru/MasteringPythonNetworking/content/Ch04.html">Полное руководство работы с сетями на Python</a>		(<a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" alt="Купите оригинал" class="pdficon" href="https://www.packtpub.com/networking-and-servers/mastering-ansible-second-edition">		<img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/pdf.png"></a>) &nbsp; 		</p>		<div id="gplusone">			<a id="AskMdl1" href="javascript:tocall()" onmouseover="this.href=mail" target="_blank" title="Вопросы? Обсудите их на mdl.ru">			<i class="icon-question"><!----></i></a>&nbsp;&nbsp;			<a id="logABugLink1" href="https://bugs.launchpad.net/openstack-manuals/+filebug?field.title=MasteringAnsible2nd&amp;field.comment=%0A%0A-----------------------------------%0ABuilt:%202017-06-29T17:43:47+00:00%0Agit%20SHA:%2013fb30b7c263d715eee84f0ca1a16df79697eb88%0AURL:%20http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html%0Asource%20File:%20file:a35-prades%0Axml:id:%20mastering-ansible-2nd" onmouseover="this.href=mail" title="Нашли ошибку? Сообщите о ней на данной странице">			<i class="icon-bug"><!----></i></a>		</div>	</div></div>
<div style="visibility: visible;" id="content">
 <div class="part">
  <div xmlns="" class="titlepage"><div><div><h1 xmlns="http://www.w3.org/1999/xhtml" class="title">
   Глава 6. Минимизация времени простоя и накатывания развёртываний
  </h1></div></div></div>

  <div class="toc"><p><strong>Содержание</strong></p>
   <dl>
     <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html">Глава 6. Минимизация времени простоя и накатывания развёртываний</a></span></dt>
     <dd><dl>
       <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#01">Обновления на месте</a></span></dt>
       <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#02">Расширение вовне и контрактация</a></span></dt>
       <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#03">Быстрые отказы</a></span></dt>
       <dd><dl>
         <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0301">Опция any_errors_fatal</a></span></dt>
         <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0302">Опция max_fail_percentage</a></span></dt>
         <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0303">Форсирование обработки</a></span></dt>
       </dl></dd>
       <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#04">Минимизация срывов</a></span></dt>
       <dd><dl>
         <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0401">Откладывание срывов</a></span></dt>
         <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0402">Одноразовое исполнение разрушающих задач</a></span></dt>
       </dl></dd>
       <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#05">Построение в серию отдельных задач</a></span></dt>
       <dt><span class="chapter"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#06">Выводы</a></span></dt>
     </dl></dd>
   </dl>
  </div>
  <p>Для разработки и обновления приложений могут применяться различные стратегии. Наилучший подход зависит от 
  самого приложения, возможностей той инфраструктуры, в которой исполняется это приложение, а также всех обещанных 
  соглашений уровня обслуживания для пользователей данного приложения. Какая бы стратегия не применялась, Ansible 
  хорошо приспособлен для снабжения её развёртывания. В данной главе мы пройдём парой общепринятых стратегий 
  развёртывания выставим те свойства Ansible, которые будут полезны в рамках этих стратегий. Мы также обсудим 
  пару прочих соображений развёртывания, которые являются общими для тех стратегий развёртывания которые:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p>Выполняют обновление на площадке</p>
	 </li><li class="listitem">
	 <p>Осуществляют расширение вовне и заключение контрактов</p>
	 </li><li class="listitem">
	 <p>Быстро приводят к неудаче</p>
	 </li><li class="listitem">
	 <p>Сводят к минимуму разрушительные действия</p>
	 </li><li class="listitem">
	 <p>Последовательно выполняют отдельные задачи</p>
	 </li>
    </ul>
    </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="01"> </a>Обновления на месте</h3>
   </div></div></div>
   <p>Первым типом обсуждаемого нами развёртывания являются обновления на площадке. Этот стиль развёртывания 
   работает в уже имеющейся инфраструктуре с целью обновления существующего приложения. Такая модель может 
   рассматриваться как некая обычная схема, которая имеется, когда определённое создание новой инфраструктуры 
   было бы затратным усилием и сточки зрения времени, и с точки зрения денег.</p>
   <p>Для минимизации времени простоя на протяжении данного типа какого-то обновления неким общим шаблоном 
   проектирования является развёртывание такого приложения по множеству хостов позади некоторого балансировщика 
   нагрузки. Такой балансировщик нагрузки будет действовать как некий шлюз между пользователями данного приложения 
   и теми серверами, которые исполняют само приложение. Запросы для этого приложения поступают на имеющийся 
   балансировщик нагрузки и, в зависимости от настройки, этот балансировщик нагрузки принимает решение на какой 
   сервер заднего плана направить данный запрос.</p>
   <p>Для выполнения карусельного обновления на месте некоторого развёрнутого приложения в соответствии с данным 
   шаблоном, каждый сервер (или меньшее подмножество таких серверов) будет отключено от своего балансировщика 
   нагрузки, обновлено и затем повторно включено для получения новых запросов. Этот процесс будет повторён для 
   оставшихся серверов в общем пуле пока все серверы не будут обновлены. Поскольку только некая часть из всех 
   доступных серверов приложения отключается для обновления, само приложение в целом остаётся доступным для 
   запросов. Конечно, это предполагает что некое приложение может нормально исполняться на смеси версий работающих 
   в одно и то же время.</p>
   <p>Давайте построим некий плейбук для обновления какого- то выдуманного приложения. Наше фиктивное приложение 
   будет работать на серверах с <span class="term"><code>foo-app01</code></span> по <span class="term"><code>foo-app08</code></span>, 
   которые присутствуют в группе <span class="term"><code>foo-app</code></span>. Эти серверы будут иметь в обслуживании 
   некий простой вебсайт посредством вебсервера <span class="term"><code>nginx</code></span> со своим 
   содержимым, поступающим из некоторого репозитория git <span class="term"><code>foo-app</code></span>, определяемого 
   имеющейся переменной <span class="term"><code>foo-app.repo</code></span>. Некий сервер балансировки нагрузки, 
   <span class="term"><code>foo-lb</code></span>, работающий под управлением программного обеспечения 
   <span class="term"><code>haproxy</code></span>, будет передним фронтом данного приложения серверов.</p>
   <p>Для работы некоторого подмножества наших серверов <span class="term"><code>foo-app</code></span>, нам 
   потребуется употребить имеющийся последовательный (serial) режим. Такой режим изменяет порядок исполнения 
   воспроизведений Ansible. По умолчанию Ansible будет выполнять задачи некоторого воспроизведения на каждом хосте в 
   том порядке как в нём перечислены все задачи. Всякая задача данного воспроизведения исполняется на каждом хосте 
   прежде чем будет осуществлён переход на следующий определённый хост. Если бы мы применили установленный по умолчанию 
   метод, наша первая задача удалила бы все серверы из имеющегося балансировщика заданий, что имело бы результатом 
   полный простой нашего приложения. Имеющийся последовательный метод вместо этого позволит нам работать на 
   некотором подмножестве с тем, чтобы наше приложение в целом оставалось доступным даже если некоторые участники 
   отключены. В своём примере мы воспользуемся количеством в последовательности равным двум для сохранения 
   основного числа участников данного приложения в рабочем состоянии:</p>
	   <pre class="screen"><code class="hljs applescript">
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: Upgrade foo-app <span class="hljs-keyword">in</span> place
  hosts: foo-app
  serial: <span class="hljs-number">2</span>
 	   </code></pre>
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table summary="Замечание" border="0"><tbody><tr><td rowspan="2" align="center" valign="top" width="25">
	   <img alt="[Замечание]" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/note.png"></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Ansible 2.2 вводит понятие <span class="term"><code>serial</code></span> batches (порций последовательного 
	   выполнения), некоторого списка номеров, способного увеличить общее число хостов к которым в процессе данного 
	   воспроизведения адресована последовательность. Это позволяет увеличивать имеющуюся величину адресуемых хостов 
	   при возрастании уверенности. Последний представленный номер определит величину любой остающейся исполняемой
	   партии до тех пор пока не завершится работа на всех хостах.</p></td></tr></tbody></table>
     </div>
   <p>Теперь мы можем начать создание своих задач. Первая задача будет отключать определённый хост от своего 
   балансировщика нагрузки. Сам балансировщик нагрузки исполняется на хосте <span class="term"><code>foo-lb</code></span>; 
   однако мы работаем на хостах <span class="term"><code>foo-app</code></span>. Вследствие этого нам необходимо 
   передать права определённой задаче с применением оператора задачи 
   <span class="term"><code>delegate_to</code></span>. Данный оператор выполняет перенаправление того места, откуда 
   Ansible подключится для выполнения данной задачи, однако сохранит весь контекст переменных своего первоначального 
   хоста. Мы воспользуемся модулем <span class="term"><code>haproxy</code></span> для отключения текущего хоста от 
   своего работающего пула заднего плана <span class="term"><code>foo-app</code></span>:</p>
	   <pre class="screen"><code class="hljs applescript">
tasks:
- <span class="hljs-property">name</span>: disable member <span class="hljs-keyword">in</span> balancer
  haproxy:
    backend: foo-app
    host: <span class="hljs-string">"{{ inventory_hostname }}"</span>
    state: disabled
  delegate_to: foo-lb
 	   </code></pre>
   <p>После того, как этот хост отключён, мы теперь можем обновить своё содержимое 
   <span class="term"><code>foo-app</code></span>. Мы воспользуемся модулем git для обновления имеющегося пути 
   содержимого с желаемой версией, определяемой в <span class="term"><code>foo-version</code></span>. 
   Мы добавим обработчик <span class="term"><code>notify</code></span> в данную задачу для перезагрузки своего 
   сервера <span class="term"><code>nginx</code></span> если вступят в силу результаты обновления данного 
   содержимого. Это можно делать всякий раз, но мы применяем это в качестве некоторого примера использования 
   уведомления (notify):</p>
	   <pre class="screen"><code class="hljs applescript">
- <span class="hljs-property">name</span>: pull stable foo-app
  git:
    repo: <span class="hljs-string">"{{ foo-app.repo }}"</span>
    dest: /srv/foo-app/
    <span class="hljs-property">version</span>: <span class="hljs-string">"{{ foo-version }}"</span>
  notify:
    - reload nginx
 	   </code></pre>
   <p>Нашим следующим шагом будет повторное вкючение данного хоста в его балансировщик нагрузки; однако, если мы 
   сделаем эту задачу следующей, мы поместим свою старую версий обратно на место, поскольку наш обработчик 
   уведомления ещё пока не выполнился. Поэтому нам необходимо включить свой обработчик с помощью вызова 
   <span class="term"><code>meta: flush_handlers</code></span>, который мы изучили в своей предыдущей главе:</p>
	   <pre class="screen"><code class="hljs markdown">
<span class="hljs-bullet">- </span>meta: flush_handlers
 	   </code></pre>
   <p>Теперь мы можем повторно разрешить данный хост в нашем балансировщике нагрузки. Мы можем просто включить его 
   непосредственно и положиться на то, что наш балансировщик нагрузки ожидает пока этот хост вернётся в 
   рабочеспособное состояние прежде чем отправлять на него запросы. Однако, поскольку мы работаем с уменьшеным 
   числом доступных хостов, нам необходимо быть уверенным, что все остающиеся хосты являются жизнеспособными. 
   Мы можем воспользоваться задачей <span class="term"><code>wait_for</code></span> для ожидания пока наша 
   служба <span class="term"><code>nginx</code></span> снова не вернётся к обслуживанию соединений. Этот модуль 
   <span class="term"><code>wait_for</code></span> будет ожидать некоторого условия либо в некотором порту, либо 
   в каком- то пути файла. В нашем примере мы будет ожидать свой порт <span class="term"><code>80</code></span> 
   и само условие в том, что порт должен иметься. Если он запущен (значение по умолчанию), это означает, что он 
   принимает соединения:</p>
	   <pre class="screen"><code class="hljs bash">
- name: ensure healthy service
  <span class="hljs-built_in">wait</span>_<span class="hljs-keyword">for</span>:
    port: <span class="hljs-number">80</span>
 	   </code></pre>
   <p>наконец, мы можем повторно разрешить участие внутри <span class="term"><code>haproxy</code></span>. 
   Опять же, мы передаём полномочия своей задачи в <span class="term"><code>foo-lb</code></span>:</p>
	   <pre class="screen"><code class="hljs applescript">
- <span class="hljs-property">name</span>: enable member <span class="hljs-keyword">in</span> balancer
  haproxy:
    backend: foo-app
    host: <span class="hljs-string">"{{ inventory_hostname }}"</span>
    state: enabled
  delegate_to: foo-lb
 	   </code></pre>
   <p>Конечно, нам всё ещё необходимо определять свой обработчик 
   <span class="term"><code>reload nginx</code></span>:</p>
	   <pre class="screen"><code class="hljs applescript">
handlers:
  - <span class="hljs-property">name</span>: reload nginx
    service:
      <span class="hljs-property">name</span>: nginx
      state: restarted
 	   </code></pre>
   <p>Данный плейбук, по окончанию исполнения, тепрь выполнил карусельное обновление на месте своего 
   приложения.</p>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="02"> </a>Расширение вовне и контрактация</h3>
   </div></div></div>
   <p>Некоторой альтернативой для представленной стратегии обновления на месте является стратегия раскрытия вовне 
   и заключения контракта. Такая стратегия становится популярной в последнее время благодаря её природе 
   самостоятельного обслуживания предоставляемой по запросу инфраструктуры, например облачных вычислений или 
   пулов виртуализации. такая возможность создавать серверы по запросу из некоторого большого пула доступных 
   ресурсов означает, что каждое развёртывание некоторого приложения может происходить на соверщенно новой 
   системе. Данная стратегия избегает каких- либо проблем с хостами, таких как некоторое нарастание неприятных 
   свойств программ в долгоиграющих системах, таких как:</p>
  	<div class="itemizedlist">
	<ul class="itemizedlist" type="disc">
	 <li class="listitem">
	 <p>Оставшиеся позади файлы настройки, которые больше не управляются Ansible</p>
	 </li><li class="listitem">
	 <p>Быстрорастущие процессы потребляют ресурсы в фоновом режиме</p>
	 </li><li class="listitem">
	 <p>Вручную изменяемые персоналом вещи при помощи доступа к сервверу через оболочку</p>
	 </li>
    </ul>
    </div>
   <p>Постоянно осуществляемый запуск с нуля также удаляет различия между начальным развёртыванием и неким 
   обновлением. Может применяться один и тот же код исправления ошибок, снижая риск неожиданностей при обновлении 
   некоторого приложения. Такой способ установки может также быть чрезвычайно простым для отката обратно в случае, 
   если новая версия не работает как ожидалось. Кроме того для данного варианта, поскольку новые системы создаются 
   для замены старых систем, такое приложение не нуждается в переходе в ухудшенное состояние в процессе обновления.</p>
   <p>Давайте применим новый подход к своему предыдущему плейбуку обновления для стратегии расширения вовне и 
   контрактации. Наш шаблон будет состоять в создании новых серверов, развёртывании нашего приложения, проверки 
   нашего приложения и добавлении новых серверов к имеющемуся балансировщику нагрузки, а также удалении старых 
   серверов из этого балансировщика нагрузки. Вначале давайте запустим создание новых серверов. Для этого примера 
   мы воспользуемся Вычислительным облаком OpenStack для запуска новых экземпляров:</p>
	   <pre class="screen"><code class="hljs sql">
<span class="hljs-comment">---</span>
- name: <span class="hljs-operator"><span class="hljs-keyword">Create</span> new foo servers
  <span class="hljs-keyword">hosts</span>: localhost

  tasks:
    - name: launch instances
      os_server:
        name: foo-appv{{ <span class="hljs-keyword">version</span> }}-{{ item }}
        image: foo-appv{{ <span class="hljs-keyword">version</span> }}
        flavor: <span class="hljs-number">4</span>
        key_name: ansible-prod
        security_groups: foo-app
        auto_floating_ip: <span class="hljs-literal">false</span>
        state: present
        auth:
          auth_url: https://me.openstack.blueboxgrid.com:<span class="hljs-number">5001</span>/v2<span class="hljs-number">.0</span>
          username: jlk
          <span class="hljs-keyword">password</span>: FAKEPASSW0RD
          project_name: mastery
        register: launch
        with_sequence: <span class="hljs-keyword">count</span>=<span class="hljs-number">8</span>
 	   </span></code></pre>
   <p>В данной задаче мы проходим циклом со счётчиком <span class="term"><code>8</code></span> применяя 
   <span class="term"><code>ith_sequence</code></span>. При кждом цикле его переменная элемента будет заменяться 
   неким номером. Это позволяет нам создать восемь экземпляров новых серверов с каким- то именем на основании 
   номера версии нашего приложения и номера данного цикла. Мы также предполагаем для применения некий предварительно 
   подготовленный образ с тем, чтобы нам не было нужды выполнять какую- либо ещё настройку этого экземпляра.
   Чтобы применять эти серверы в последующих воспроизведениях, нам необходимо добавить их подробности в свой 
   список учёта (inventory). Для осуществления этого мы регистрируем все результаты своего исполнения в определённой
   переменной launch, которая будет применена впоследствии для создания записей регистрации времени исполнения:</p>
	   <pre class="screen"><code class="hljs applescript">
- <span class="hljs-property">name</span>: add hosts
  add_host:
  <span class="hljs-property">name</span>: <span class="hljs-string">"{{ item.openstack.name }}"</span>
  ansible_ssh_host: <span class="hljs-string">"{{ item.openstack.private_v4 }}"</span>
  groups: new-foo-app
with_items: <span class="hljs-command">launch</span>.results
 	   </code></pre>
   <p>Данная задача создаст новые записи учёта с теми же самыми именами, которые имеют наши экзепляры сервера. 
   Чтобы помочь Ansible с информацией о том как осуществлять соединение, мы установим 
   <span class="term"><code>ansible_ssh_host</code></span> в тои IP адрес, который наш поставщик облака назначает 
   данному экземпляру (это предполагает, что данный адрес достижим самим исполняющим Ansible хостом). Наконец, мы 
   добавим все хосты в свою группу <span class="term"><code>new-foo-app</code></span>. По мере того как наша 
   переменная launch поступает из некоторой задачи в цикле, нам необходимо повторить итерацию по полученным 
   результатам этого цикла обратившись по полученным ключам результатов. Это позволит нам пройти циклом по каждому 
   действию launch чтобы получить доступ к спцецифичным для данной задачи данным.</p>
   <p>Далее мы проверим свои новые серверы что их новые службы готовы для применения. Мы вновь воспользуемся 
   <span class="term"><code>wait_for</code></span>, в точности как мы делали это ранее, как некая часть какого- то 
   воспроизведения в нашей новой группе <span class="term"><code>new-foo-app</code></span>:</p>
	   <pre class="screen"><code class="hljs cpp">
- name: Ensure <span class="hljs-keyword">new</span> app
  hosts: <span class="hljs-keyword">new</span>-foo-app
  tasks:
    - name: ensure healthy service
      wait_for:
        port: <span class="hljs-number">80</span>
 	   </code></pre>
   <p>Раз они уже готовы к исполнению, мы можем повторно настроить свой балансировщик нагрузки чтобы применять наши 
   новые серверы. Для целей упрощения мы предположим наличие некого шаблона для настройки своего 
   <span class="term"><code>haproxy</code></span>, который ожидает хосты в группе 
   <span class="term"><code>new-foo-app</code></span> и окончательным результатом будет настройка, которая узнает 
   всё о наших новых хостах и забудет всё о старых хостах. Это означает, что мы можем просто вызвать некую 
   задачу шаблона в самой системе нашего балансирощика нагрузки вместо того чтобы пытаться манипулировать самим 
   состоянием исполнения этого балансировщика:</p>
	   <pre class="screen"><code class="hljs applescript">
- <span class="hljs-property">name</span>: Configure load balancer
  hosts: foo-lb
  tasks:
  - <span class="hljs-property">name</span>: haproxy config
    template:
	  dest: /etc/haproxy/haproxy.cfg
      src: templates/etc/haproxy/haproxy.cfg

  - <span class="hljs-property">name</span>: reload haproxy
    service:
      <span class="hljs-property">name</span>: haproxy
        state: reloaded
 	   </code></pre>
   <p>Раз данный новый файл настройки находится на своём месте, мы можем исполнить некий повторный запуск своей 
   службы <span class="term"><code>haproxy</code></span>. Это выполнит синтаксический разбор полученного нового 
   файла настройки и запустит новые процессы ожидания для новых входящих соединений. Все имеющиеся соединения будут 
   со временем закрыты и все старые процессы завершатся {<span class="emphasis"><em>Прим. пер.: такая процедура остановки
   имеет название осушения/ дренажа</em></span>}. Всем новым соединениям будут предоставляться маршруты к 
   полученным новым серверам, исполняющим нашу новую версию приложения.</p>
   <p>Данный плейбук может быть расширен на списание всех старых версий наших серверов, либо на то, что это действие 
   может происходить в некое другое время, когда будет принято решение что какой бы то ни было откат к 
   возможностям нашей старой версии больше не требуется.</p>
   <p>Данная стратегия расширения вовне и заключения контрактов может включать больше задач и даже отдельные 
   плейбуки для создания некоторого набора золотого образа, однако преимущества свежей инфраструктуры для каждого 
   выпуска намного перевешивают все дополнительные задачи или добавляемые усложнения создания за которым 
   следует удаление.</p>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="03"> </a>Быстрые отказы</h3>
   </div></div></div>
   <p>При выполнении какого- то обновления некоторого приложения может быть желательным полный останов 
   данного развёртывания при любом признаке ошибки. Частично обновлённая система со смесью версий может не 
   работать вовсе, поэтому продолжение с частью имеющейся инфраструктуры при оставлении всех систем с оказами 
   может повлечь крупные неприятности. К счастью, Ansible предоставляет некий механизм принятия решения когда 
   доходить до варианта фатальной ошибки.</p>
   <p>По умолчанию, когда Ansible осуществляет исполнение некоторого плейбука и встречает некоторую ошибку, 
   Ansible удалит такие отказавшие узлы из своего списка воспроизведения хостов и продолжит оставшиеся задачи 
   или воспроизведения. Ansible остановит исполнение когда либо отказали все запрошенные для некоторого 
   воспроизведения хосты, либо все воспроизведения были осуществлены. Для изменения такого поведения имеется пара
   управлений воспроизведением, которые могут быть применены. Этими управлениями являются 
   <span class="term"><code>any_errors_fatal</code></span> и 
   <span class="term"><code>max_fail_percentage</code></span>.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0301"> </a>
	<span style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Опция any_errors_fatal</span></h4>
   </div></div></div>
   <p>Эта установка указывает Ansible рассматривать всю операцию целиком как фатальную и немедленно останавливать 
   исполнение если любой хост сталкивается с некоторой ошибкой. Чтобы продемонстрировать это мы добавим некую новую 
   группу в свою инвентаризацию <span class="term"><code>mastery-hosts</code></span> при помощи некоторого 
   шаблона, который выполнит расширение до десяти новых хостов:</p>
	   <pre class="screen"><code class="hljs css">
<span class="hljs-attr_selector">[failtest]</span>
<span class="hljs-tag">failer</span><span class="hljs-attr_selector">[01:10]</span>
 	   </code></pre>
   <p>Затем мы создадим некое воспроизведение для этой группы с установленным в true значением 
   <span class="term"><code>any_errors_fatal</code></span>. Мы также отключим получение фактов, так как эти 
   хосты не существуют:</p>
	   <pre class="screen"><code class="hljs applescript">
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: any errors fatal
  hosts: failtest
  gather_facts: <span class="hljs-constant">false</span>
  any_errors_fatal: <span class="hljs-constant">true</span>
 	   </code></pre>
   <p>Мы хотим чтобы некоторая задача выполнила отказ для одного из этих хостов, но не для всех остальных. Далее 
   мы хотим выполнить также некую вторую задачу, просто чтобы продемонстрировать как она не исполнится:</p>
	   <pre class="screen"><code class="hljs applescript">
tasks:
  - <span class="hljs-property">name</span>: fail <span class="hljs-keyword">last</span> host
    fail:
      msg: <span class="hljs-string">"I am last"</span>
    when: inventory_hostname == play_hosts[-<span class="hljs-number">1</span>]
  - <span class="hljs-property">name</span>: never ran
    debug:
      msg: <span class="hljs-string">"I should never be ran"</span>
    when: inventory_hostname == play_hosts[-<span class="hljs-number">1</span>]
 	   </code></pre>
   <p>Теперь, когда мы осуществим исполнение, мы увидим что один хост отказал, однако всё воспроизведение остановится после 
   своей первой задачи:</p>
	<div class="figure"><a id="Fig0601">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.1</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0601.jpg" height="730" width="728"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
   <p>Мы можем видеть что только один хост отказал, однако Ansible сообщил, что все хосты должны выполнить отказа и 
   прервал данный плейбук прежде чем получил своё следующее воспроизведение.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0302"> </a>
	<span style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Опция max_fail_percentage</span></h4>
   </div></div></div>
   <p>Данная установка позволяет разработчикам воспроизведений определять некое проценнтное соотношение 
   хостов, которые могут отказывать прежде чем вся операция будет прервана. В самом конце каждой задачи Ansible 
   выполнит некую математическую операцию для определения общего числа всех хостов, имеющих целью данное 
   воспроизведение, которые достигли состояния отказа и, если это число более допустимого значения, Ansible 
   прервёт данный плейбук. Это аналогично <span class="term"><code>any_errors_fatal</code></span>, по существу, 
   <span class="term"><code>any_errors_fatal</code></span> внутренне всего лишь выражает некий параметр 
   <span class="term"><code>max_fail_percentage</code></span> со значением <span class="term"><code>0</code></span>, 
   при котором любой отказ рассматривается как фатальный. Давайте отредактируем своё воспроизведение из предыдущего 
   и заменим свой параметр <span class="term"><code>max_fail_percentage</code></span> на значение
   <span class="term"><code>20</code></span>:</p>
	   <pre class="screen"><code class="hljs applescript">
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: any errors fatal
  hosts: failtest
  gather_facts: <span class="hljs-constant">false</span>
  max_fail_percentage: <span class="hljs-number">20</span>
 	   </code></pre>
   <p>После выполнения такого изменения наше воспроизведение должно завершить обе задачи без прерывания:</p>
	<div class="figure"><a id="Fig0602">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.2</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0602.jpg" height="888" width="682"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
   <p>Теперь, если мы изменим свою условную зависимость с тем, чтобы мы получали отказ на более чем 20 процентах 
   от всех хостов, мы обнаружим, что наш плейбук прервётся раньше:</p>
	   <pre class="screen"><code class="hljs applescript">
- <span class="hljs-property">name</span>: fail <span class="hljs-keyword">last</span> host
  fail:
    msg: <span class="hljs-string">"I am last"</span>
  when: inventory_hostname <span class="hljs-keyword">in</span> play_hosts[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>]
 	   </code></pre>
   <p>Мы установили три хоста отказавшими, что даёт нам значение соотношение отказа превышающим 20 процентов. 
   Имеющаяся установка <span class="term"><code>max_fail_percentage</code></span> является максимально 
   допустимой, поэтому наша установка этого значения в 20 позволит нам отказ только 2 хостов из 10. При отказе 
   трёх хостов мы видим фатальную ошибку перед исполнением второй задачи:</p>
	<div class="figure"><a id="Fig0603">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.3</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0603.jpg" height="789" width="707"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0303"> </a>
	<span style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Форсирование обработки</span></h4>
   </div></div></div>
   <p>Обычно, когда Ansible отказывает на некотором хосте, он прекращает исполнять что бы то ни было на этом 
   хосте. Это означает, что никакие отложенные обработчики не будут исполняться. Это может оказаться 
   нежелательным и имеется некое управление воспроизведением, которое принудит Ansible отработать нерешённые 
   обработчики для отказавших хостов. Этим упралвением воспроизведения является 
   <span class="term"><code>force_handlers</code></span>, которое должно быть установлено в Булево значение 
   <span class="term"><code>true</code></span>.</p>
   <p>Давайте слегка изменим свой предыдущий пример для демонстрации такой функциональности. Мы удалим свой 
   параметр <span class="term"><code>max_fail_percentage</code></span>, добавив новую задачу. Нам необходимо 
   создать некую задачу, которая успешно возвратится с неким изменением. мы можем сделать это при помощи модуля 
   <span class="term"><code>debug</code></span> воспользовавшись имеющимся управлением задачи 
   <span class="term"><code>changed_when</code></span>, даже хотя наш модуль 
   <span class="term"><code>debug</code></span> никогда не регистрирует некое изменение по умолчанию. 
   Также мы вернём условную зависимость своей отказавшей задачи в то, с чего мы первоначально стартовали:</p>
	   <pre class="screen"><code class="hljs applescript">
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: any errors fatal
  hosts: failtest
  gather_facts: <span class="hljs-constant">false</span>
    tasks: - <span class="hljs-property">name</span>: <span class="hljs-command">run</span> <span class="hljs-keyword">first</span>
      debug:
        msg: <span class="hljs-string">"I am a change"</span>
      changed_when: <span class="hljs-constant">true</span>
      when: inventory_hostname == play_hosts[-<span class="hljs-number">1</span>]
      notify: critical handler
    - <span class="hljs-property">name</span>: change a host
      fail:
        msg: <span class="hljs-string">"I am last"</span>
      when: inventory_hostname == play_hosts[-<span class="hljs-number">1</span>]
 	   </code></pre>
   <p>Наша третья задача остаётся без изменений, однако мы определим свой обработчик критических ситуаций:</p>
	   <pre class="screen"><code class="hljs applescript">
- <span class="hljs-property">name</span>: never ran
  debug:
    msg: <span class="hljs-string">"I should never be ran"</span>
  when: inventory_hostname == play_hosts[-<span class="hljs-number">1</span>]
  handlers:
  - <span class="hljs-property">name</span>: critical handler
    debug:
      msg: <span class="hljs-string">"I really need to run"</span>
 	   </code></pre>
   <p>Давайте исполним это новое воспроизведение чтобы показать определённое по умолчанию поведение своего обработчика, который 
   не выполнится. В интересах уменьшения вывода мы ограничили исполнение только одним из хостов:</p>
	<div class="figure"><a id="Fig0604">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.4</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0604.jpg" height="469" width="702"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
   <p>Теперь мы добавим управление воспроизведением <span class="term"><code>force_handlers</code></span> и 
   установим его значением <span class="term"><code>true</code></span>:</p>
	   <pre class="screen"><code class="hljs applescript">
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: any errors fatal
  hosts: failtest
  gather_facts: <span class="hljs-constant">false</span>
  max_fail_percentage: <span class="hljs-number">0</span>
  force_handlers: <span class="hljs-constant">true</span>
 	   </code></pre>
   <p>На этот раз, когда мы выполним этот плейбук, мы должны обнаружить что наш обработчик работает даже для 
   испытавшего отказ хоста:</p>
	<div class="figure"><a id="Fig0605">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.5</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0605.jpg" height="529" width="703"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
	   <table summary="Замечание" border="0"><tbody><tr><td rowspan="2" align="center" valign="top" width="25">
	   <img alt="[Замечание]" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/note.png"></td><th align="left">Замечание</th></tr><tr><td align="left" valign="top">
	   <p>Принудительное исполнение обработчиков может быть также решением времени исполнения при помощи аргумента 
	   командной строки <span class="term"><code>--force_handlers</code></span> для 
	   <span class="term"><code>ansible-playbook</code></span>.</p></td></tr></tbody></table>
     </div>
   <p>Принудительное исполнение обработчиков может быть на самом деле полезным для повторяющегося исполнения 
   плейбука. Самое первое исполнение может приводить в результате к некоторым изменениям, однако если некоторая 
   фатальная ошибка встретится прежде чем промелькнут имеющиеся обработчики, эти вызовы обработчиков могут 
   быть утрачены. Повторные исполнения не приведут в результате к тем же самым изменениям, поэтому такой 
   обработчик никогда не исполнится без вмешательства вручную. Принудительное исполнение обработчиков предпримет 
   некую попытку, гарантируя что такие вызовы обработчиков не будут потеряны.</p>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="04"> </a>Минимизация срывов</h3>
   </div></div></div>
   <p>На протяжении разработки часто имеются задачи, которые могут рассматриваться как подрывные или разрушительные.
   Эти задачи могут содержать службы повторного запуска, осуществление миграций базы данных и тому подобное. 
   Подраывающие задачи следует собирать в общий кластер для минимизации общего воздействия на некоторое приложение, 
   хотя разрушительные задачи должны исполнится всего лишь один раз.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0401"> </a>
	<span style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Откладывание срывов</span></h4>
   </div></div></div>
   <p>Перезапуск служб для некоторой новой версии кода достаточно распространённая потребность. При рассмотрении в 
   изоляции, некоторая отдельная служба может повторно запускаться всякий раз, когда сам код или настроки для 
   данного приложения были изменены, причём без рассмотрения общей работоспособности распределённой системы. Обычно, 
   некая распределённая система будет иметь роли для каждоя части всей системы, причём каждая роль будет в 
   сущности работать в изоляции на тех хостах, которые предназначены для исполнения таких ролей. При развёртывании 
   некоторого приложения в самый первый раз, не существует времени работы всей системы целиком до этого момента, 
   о котором стоит позаботиться; поэтому службы могут повторно запускаться когда возникнет такое желание. Однако, 
   в процессе обновления может быть желательно задержка перезапуска всех служб пока каждая служба не будет готова 
   минимизировать прерывания.</p>
   <p>Вместо того чтобы разрабатывать некий полностью отдельный путь кода обновления, настоятельно рекомендуется 
   повторное применение кода роли. Для обеспечения согласованной перезагрузки имеющийся код роли для определённой 
   службы необходимо защитить вокруг перезагрузки такой службы. Неким общим шаблоном является помещение какого- то 
   выражения условной зависимости в таких подрывных задачах, которая проверит некое значение переменной. При 
   выполении некоторого обновления эта переменная может быть определена в реальном масштабе времени для переключения 
   такого альтернативного поведения. Эта переменная также может включать некий скоординированный повторный запуск 
   служб по окончанию своего основного плейбука когда завершатся все роли чтобы скоординировать все разрушения и 
   мимнимизировать общее время простоя.</p>
   <p>Давайте создадим некое вымышленное обновление приложения, которое содержит две роли с имитацией повторного 
   запуска служб. Мы назовём эти роли <span class="term"><code>microA</code></span> и
   <span class="term"><code>microB</code></span>:</p>
	   <pre class="screen"><code class="hljs">
roles/microA
├── handlers
│   └── main.yaml
└── tasks
    └── main.yaml
roles/microB
├── handlers
│   └── main.yaml
└── tasks
    └── main.yaml
 	   </code></pre>
   <p>Для обеих этих ролей у нас есть некая простая задача отладки, которая имитирует процесс установки некоторого 
   пакета. Мы уведомим некий обработчик имитировать необходимы перезапуск какой- то службы. А чтобы гарантировать 
   что такой обработчик включится, мы принудим эту задачу всегда регистрироваться как изменённую:</p>
	   <pre class="screen"><code class="hljs applescript">
roles/microA/tasks/main.yaml:
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: install microA package
  debug:
    msg: <span class="hljs-string">"This is installing A"</span>
  changed_when: <span class="hljs-constant">true</span>
  notify: restart microA

roles/microB/tasks/main.yaml:
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: install microB package
  debug:
    msg: <span class="hljs-string">"This is installing B"</span>
  changed_when: <span class="hljs-constant">true</span>
  notify: restart microB
 	   </code></pre>
   <p>Сами обработчики для этих ролей также будут отладочными действиями и мы подключим некое условие к 
   имеющейся задаче обработчиков чтобы выполнять перезапуск только если его переменная upgrade вычисляет 
   Булево значение <span class="term"><code>false</code></span>. Мы также применим установленный по умолчанию 
   фильтр чтобы предоставить этой переменной некое значение по умолчанию равным 
   <span class="term"><code>false</code></span>:</p>
	   <pre class="screen"><code class="hljs applescript">
roles/microA/handlers/main.yaml:
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: restart microA
  debug:
    msg: <span class="hljs-string">"microA is restarting"</span>
  when: <span class="hljs-keyword">not</span> upgrade | default(<span class="hljs-constant">false</span>) | bool

roles/microB/handlers/main.yaml:
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: restart microB
  debug:
    msg: <span class="hljs-string">"microB is restarting"</span>
  when: <span class="hljs-keyword">not</span> upgrade | default(<span class="hljs-constant">false</span>) | bool
 	   </code></pre>
   <p>Для нашего плейбука верхнего уровня мы создадим четыре воспроизведения. Первые два воспроизведения применяют 
   каждую из имеющихся микро ролей, а два последних последующих воспроизведения выполнят необходимые повторные запуски. 
   Самые последние два воспроизведения будут исполняться только ели обновление произошло; поэтому мы применим свою 
   переменную upgrade в качестве условной зависимости. Давайте взглянем на следующий фрагмент кода:</p>
	   <pre class="screen"><code class="hljs applescript">
micro.yaml:
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: apply microA
  hosts: localhost
  gather_facts: <span class="hljs-constant">false</span>

  roles:
    - role: microA


- <span class="hljs-property">name</span>: apply microB
  hosts: localhost
  gather_facts: <span class="hljs-constant">false</span>

  roles:
    - role: microB

- <span class="hljs-property">name</span>: restart microA
  hosts: localhost
  gather_facts: <span class="hljs-constant">false</span>

  tasks:
    - <span class="hljs-property">name</span>: restart microA <span class="hljs-keyword">for</span> upgrade
      debug:
        msg: <span class="hljs-string">"microA is restarting"</span>
      when: upgrade | default(<span class="hljs-constant">false</span>) | bool

- <span class="hljs-property">name</span>: restart microB
  hosts: localhost
  gather_facts: <span class="hljs-constant">false</span>

  tasks:
    - <span class="hljs-property">name</span>: restart microB <span class="hljs-keyword">for</span> upgrade
      debug:
        msg: <span class="hljs-string">"microB is restarting"</span>
      when: upgrade | default(<span class="hljs-constant">false</span>) |bool
 	   </code></pre>
   <p>Если мы исполним этот плейбук без определения своего модуля обновления, мы увидим соответствующее исполнение 
   каждой роли и её обработчиков внутри неё. Самые последние два воспроизведения будут иметь только пропущенные 
   задачи:</p>
	<div class="figure"><a id="Fig0606">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.6</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0606.jpg" height="821" width="705"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
   <p>Теперь давайте исполним этот плейбук снова, причём на этот раз мы определим свой переменную upgrade значением 
   <span class="term"><code>true</code></span> времени исполнения:</p>
	<div class="figure"><a id="Fig0607">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.7</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0607.jpg" height="821" width="699"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
   <p>на этот раз мы можем видеть, что наши обработчики пропущены, однако наши два окончательных воспроизведения 
   получили задачи для исполнения. В сценарии реального мира, в котором имеется множество вещей, которые 
   происходят в таких ролях <span class="term"><code>microA</code></span> и 
   <span class="term"><code>microB</code></span>, а также потенциально имеются прочие роли микро- служб, имеющаяся 
   разница может составлять много минут и даже более. Сбор воедино всех перезапусков в самом конце может существенно 
   снизить такой период прерывания.</p>

   <div xmlns="" class="titlepage"><div><div>
    <h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="0402"> </a>
	<span style="color:#FEFEFE; background-color:#888888; padding:0.5em;">Одноразовое исполнение разрушающих задач</span></h4>
   </div></div></div>
   <p>Разрушительные задачи возникают во многих проявлениях. Это могут быть однонаправленные задачи, которые чрезвычайно 
   сложно откатить обратно, одноразовые задачи, которые не так просто выполнить повторно, либо это могут быть 
   задачи состязания условий, которые при одновременном исполнении имеют результатом катастрофический отказ.
   По этим причинам, или вследствие чего- либо ещё, существенным является то, что эти задачи выполняются только 
   единожды с отдельного хоста. Ansible предоставляет некий механизм для их выполнения посредством управления 
   задачами <span class="term"><code>run_once</code></span>.</p>
   <p>Управление задачей <span class="term"><code>run_once</code></span> обеспечит что данная задача исполнится только 
   один раз на отдельном хосте вне зависимости от того сколько хостов может участвовать в некотором 
   воспроизведении. В то время как существуют прочие методы для выполнения этой цели, такие как использование некоторого 
   условия чтобы заставить данную задачу исполниться только однократно на самом первом хосте какого- то 
   воспроизведения, управление <span class="term"><code>run_once</code></span> является наиболее простым и 
   и прямым способом для выражения этого пожелания. Кроме того, любые переменные данные, зарегистрированные из 
   некоторой управляемой <span class="term"><code>run_once</code></span> задачи будут сделаны доступными для всех 
   хостов в данном воспроизведении, не только в том хосте, который был выбран Ansible для выполнения данного 
   действия. Это может упростить последующую выборку таких переменных данных.</p>
   <p>Давайте создадим некий пример плейбука чтобы продемонстрировать данную функциональность. Мы повторно 
   воспользуемся своими хостами <span class="term"><code>failtest</code></span>, созданными в предыдущих примерах 
   чтобы иметь некий пул хостов и выбрать два из них с применением некоторого шаблона хостов. Мы сделаем некий набор задач 
   <span class="term"><code>debug</code></span> исполняющимся <span class="term"><code>run_once</code></span> и 
   зарегистрируем полученные результаты, затем осуществим доступ к этим результатам в различных задачах 
   разными хостами:</p>
	   <pre class="screen"><code class="hljs applescript">
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: <span class="hljs-command">run</span> once test
hosts: failtest[<span class="hljs-number">0</span>:<span class="hljs-number">1</span>]
gather_facts: <span class="hljs-constant">false</span>

tasks:
  - <span class="hljs-property">name</span>: do a thing
    debug:
      msg: <span class="hljs-string">"I am groot"</span>
    register: groot
    run_once: <span class="hljs-constant">true</span>

  - <span class="hljs-property">name</span>: what <span class="hljs-keyword">is</span> groot
    debug:
      var: groot
    when: inventory_hostname == play_hosts[-<span class="hljs-number">1</span>]
 	   </code></pre>
   <p>Когда мы исполним данное воспроизведение, мы обратим особое внимание на те имена хостов, которые перечисляются 
   для каждой операции задачи:</p>
	<div class="figure"><a id="Fig0608">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.8</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0608.jpg" height="486" width="700"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
   <p>Мы може видеть, что наша задача <span class="term"><code>do a thing</code></span> исполняется на хосте
   <span class="term"><code>failer01</code></span>, в то время как задача 
   <span class="term"><code>what is groot</code></span>, которая изучает полученные данные от этой задачи 
   <span class="term"><code>do a thing</code></span>, работает на хосте 
   <span class="term"><code>failer02</code></span>.</p>
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="05"> </a>Построение в серию отдельных задач</h3>
   </div></div></div>
   <p>Определённые приложения, которые исполняют множество копий служб, могут не отзываться должным образом на все те 
   службы, которые подлежат однократному перезапуску. Обычно при обновлении такого типа приложений применяется 
   воспроизведение <span class="term"><code>serial</code></span>. Однако, если данное приложение имеет достаточно 
   большой масштаб, упорядочивание всего воспроизведения целиком может быть дико неэффективным. Могут применяться 
   различные подходы, которые состоят в упорядочивании только чувствительных к этому задач, как правило определённые 
   обработчики для перезапуска служб.</p>
   <p>Для упорядочивания определённой задачи обработки мы можем воспользоваться встроенной переменной 
   <span class="term"><code>play_hosts</code></span>. Эта переменная содержит полный список хостов, которые должны быть 
   использованы этой задачей как частью общего воспроизведения. Он постоянно поддерживаетя в актуальном состоянии в 
   отношении отказавших или недостижимых хостов. Применяя эту переменную мы можем выстраивать некий цикл для итеративного 
   прохода по всем хостам, которые потенциально могут исполнять некую задачу обработчика. Вместо применения самого 
   <span class="term"><code>item</code></span> из имеющихся аргументов данного модуля мы будем применять элемент 
   <span class="term"><code>item</code></span> в условной зависимости <span class="term"><code>when</code></span>, 
   а также некую директиву <span class="term"><code>delegate_to</code></span>, таким образом мы можем исполнить данную 
   задачу обработчика если этот хост уведомил данный обработчик и представил данную задачу обработчика самому 
   хосту в исполняемом цикле вместо того чтобы выполнять её на первоначальном хосте. Однако, если мы применим это 
   только как список для некоторой директивы <span class="term"><code>with_items</code></span>, мы завершим 
   исполнение данной задачи для всех хостов, причём для каждого включившего некий обработчик хоста. Очевидно, что мы 
   хотим не этого, поэтому мы можем применить некую директиву задачи, <span class="term"><code>run_once</code></span>, 
   для изменения поведения. Такая директива <span class="term"><code>run_once</code></span>  указывает Ansible необходимость 
   исполнять данную задачу только для одного хоста, вместо обычного целеуказания, которым являлось бы исполнение на 
   всех хостах. Сочетание <span class="term"><code>run_once</code></span> и нашего <span class="term"><code>with_items</code></span> 
   из <span class="term"><code>play_hosts</code></span> создаёт некий сценарий, при котором Ansible пройдет по данному циклу 
   только один раз. Наконец, мы желаем выполнять некое непродолжительное ожидание между всеми проходами с тем, чтобы 
   все перезапускаемые службы могли стать работающими прежде чем мы выполним повторный запуск в следующий раз. Мы 
   можем воспользоваться  неким <span class="term"><code>loop_control</code></span> из 
   <span class="term"><code>pause</code></span> (введённом в Ansible версии 2.2) чтобы вставлять паузу между 
   всеми последовательными исполнениями данного цикла.</p>
   <p>Для демонстрации того как будет работать такое упорядочение, мы напишем некое воспроизведение применив несколько 
   хостов из своей группы <span class="term"><code>failtest</code></span>, причём некая задача, которая создаёт какое- то 
   изменение регистрирует свой вывод (поэтому мы можем выполнить проверку в своеё задаче обработчика) и упорядочивает 
   задачу обработчика:</p>
	   <pre class="screen"><code class="hljs applescript">
<span class="hljs-comment">---</span>
- <span class="hljs-property">name</span>: parallel <span class="hljs-keyword">and</span> serial
  hosts: failtest[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>]
  gather_facts: <span class="hljs-constant">false</span>

  tasks:
    - <span class="hljs-property">name</span>: do a thing
      debug:
        msg: <span class="hljs-string">"I am groot"</span>
      changed_when: inventory_hostname <span class="hljs-keyword">in</span> play_hosts[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>]
      register: groot
      notify: restart groot

  handlers:
    - <span class="hljs-property">name</span>: restart groot
      debug:
        msg: <span class="hljs-string">"I am groot?"</span>
      with_items: <span class="hljs-string">"{{ play_hosts }}"</span>
      delegate_to: <span class="hljs-string">"{{ item }}"</span>
      run_once: <span class="hljs-constant">true</span>
      when: hostvars[<span class="hljs-property">item</span>]['groot']['changed'] | bool
      loop_control:
        pause: <span class="hljs-number">2</span>
 	   </code></pre>
   <p>На протяжении исполнения данного плейбука мы можем видеть уведомления всоего обработчика (благодаря удваенной 
   многословности, <span class="term"><code>-vv</code></span>), а также в этой задаче обработчика мы можем видеть 
   определённый цикл, условную зависимсоть и делегирование. К сожалению, мы не можем видеть саму задержку, поскольку 
   эта информация не является частью нашего вывода:</p>
	<div class="figure"><a id="Fig0609">&nbsp;</a>
	 <p class="title"><strong>Рисунок 6.9</strong></p>
	 <div class="figure-contents"><div class="mediaobject">
	 <img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/Fig0609.jpg" height="862" width="651"><br>
	 <span></span>
	 </div></div>
	</div><br class="figure-break">
  </div>

  <div class="section">
   <div xmlns="" class="titlepage"><div><div>
    <h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="06"> </a>Выводы</h3>
   </div></div></div>
   <p>Стратегии развёртывания и обновления - дело вкуса. Каждая привносит свои преимущества и недостатки. 
   Ansible е обладает каким- то положением по поводу того какая из них лучше и, тем самым, хорошо соответствует 
   выполнению развёртываний и обновлений вне зависимости от принятой стратегии. Ansible предоставляет свойства и 
   шаблоны разработки которые легко снаряжают некое разнообразие стилей. Понимание природы каждой стратегии и того, 
   как Ansible может быть настроен под эту стратегию вооружит вас для решения и проектирования развёртываний любого 
   вашего приложения. Управления задачами и встроенные переменные предоставляют методы эффективного обновления 
   крупномасштабных приложений при тщательной отработке специфических задач.</p>
   <p>В <a class="link" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html" target="_top">Главе 7, Поиск неисправностей Ansible</a>, мы обсудим темы, 
   которые помогут нам когда вещи идут не так как ожидалось при исполнении плейбуков Ansible.</p>
  </div>
 </div>

<!----><script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/FooterAndSidebar.js">
</script><script type="text/javascript"><!--</div id="content"> is inside next code
document.write(FooterAndSidebar);//-->
</script><script src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/f.js" id="eXF-mstansb2-0" async="" defer="defer"></script><a title="eXTReMe Tracker - Free Website Statistics" id="eXTReMe-Free-mstansb2" target="_blank" href="http://extremetracking.com/free?login=mstansb2"><img src="data:image/gif;base64,R0lGODlhKQAmAPcAAAAAAP////C3ueChpqplbMiQmFgXIkwWH9J5jbFnd/PP16+SmmMmUZphjdWyzggACAcEB5pjmmFNZiUIOaWEvZx7xlMrjyoTVq+usqWc8wIAISQYslJNoi0mzSklcFJN1iooVQEANXBvzZ+e7QgITg0NbhwdkBAQSmlptnd3mM/P/ZWVr4+PlI2NkoyMkQwSqRATa4aI2GRr4zlCjDFCpXOM597n//f//11cWlxbWVhXVVpYVmZkYl9dW2poZmlnZWhmZGdlY5SEeyYICIwxMXssLHUrK85aWlElJUojI0MgIAwJCf3n50I+Pk5KSk1JSUtHR0pGRlBMTBUUFEVCQkI/P0A9PUtISEpHRxoZGf/39zo4OEA+PiQjIyIhISopKSkoKCcmJiYlJSsqKnR0dHNzc3Jycm5ubmxsbGRkZGJiYldXV0xMTEtLS0JCQj8/Pz4+Pj09PTw8PDk5OTQ0NDMzMzIyMjExMSsrKyoqKiUlJSMjIyAgIB0dHRwcHBsbGxoaGhkZGRgYGBcXFxUVFRQUFBISEhERERAQEA0NDQwMDAsLCwoKCgkJCQgICAcHBwYGBgUFBQQEBAMDAwICAgEBAf///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAJYALAAAAAApACYAAAj/AM+kGUiwoMGDCBMSPKNmjcOHECNKnEjxYcM2GDNq3Mixo8eMa9i8GUmypMmRcOLIWQnnpEuSbNzQmUmzJs06d6hgecIDSBAsXOrYHFrTzRw8SJMqRToGSxkWGKJKbYEmx5alWJHOsbOnq9evXayUiboihVmzK1ZEdbFDzNe3Xe3k+UO3bt0+OqCukOABBAwPHkyYmIGiQlQzW/zYXZxHD6HHkB9nwbFgLwkSfwdz2MwZRdQyVQgZKkS6EGQ9fBCpXo0oUI/KIEicgCG4s4jbIlCgoICBjJMkB4wkUMJINR8/ipIrF3SFxYrYJ0AENkGDBgoRMWKMGBEjN4UFRwQE/xjPpEhyP4EaqVe/KAoZDCBCyC5RQjCND7cz6Nc/4vYABQMQYAASTCiwRCOBDALJggsC4gMGKYRwwmz1mbDBfSKMkIEKDiDgQAb9xYCBD18AAIACAkAAySCESOKiJJE08V58E8JAm4UdfCDDhjYg8F8F3Hm2ghQAIKEFAZRIQkghkzQ5ySNQrMCCBhPOJtgLG+RYw4Y3DMBEAAPEUAN2Iw4hABMGVDJJIYZU4mYliPyAgQRUnlDCjVjmuKMKXSrwJQW4jUiAFkSYWIkhbb45xYx12ljfCy/oyaOXCvjJwW0YDACmiQAcmqibgTA6IQn0mQCpnhqqgIAWCiBQIA0cNP8QgABDcHroIZwC0IeoJ5D6aKSoZhCBFiqIUIAWCzTABBNIOJLrIbga6gWj8mFWYZ56yjCsAzFwoGkATBDwRSHPRmtiGA+CoIF8FF6JpQUEfPCBBUw4cBsDBTSwABnjlpsrGA/SWa21j5YwgBYNzFvvdRxYwEFvXzjLKbS5FiIFC1OuexkMpb5QggIBKGABvQ5wxoFaJEpsIsWcOoIEAQWoOzDH9V1QKcI2O+AwBxJgwIIU5PrL6RB+LpCCBhpvzPEF9SqghQEKOODBDB6kAHHQE5sLwLEEBPxACOzORgIDWkRggBYIRO1BCTP4LEWJuQLAMgAMBICAxVCB8IAGl13RdsGxDZxwcNQTeLDCAinHLXe0QzBBKwBfXDynBnszQAATrIIAAgNfLjAByuOqnLWJRhJgoiORk7GABBIUALICDEgYHwGzNjBi6IovTjoTDAyNr9NasErnuiFozoAAAwhBYiGiC23AlwMI4DTmTAxQAAERYJwCxmphQAABb2Od+9wG/AdggEh8EbkPZGCMweEskOHD2/3mPjqnDwwxxAO5OlKI+lIIoADpxzz7Cc2Ap/NfaRYoPgTqzoEQjODKtCbBCipubhbM4MQSocEOmigRAQEAOw==" style="border:0;border-radius:4px;height:38px;width:41px;" alt="eXTReMe Tracker - Free Website Statistics"></a><script type="text/javascript" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/main.js"><!----></script><div class="logabug" style="text-align: center"><a id="AskMdl002" href="javascript:tocall()" onmouseover="this.href=mail" target="_blank"><i class="icon-question"><!----></i>Вопросы? Обсудите их на mdl.ru</a><br><a id="logABugLink2" href="https://bugs.launchpad.net/openstack-manuals/+filebug?field.title=MasteringAnsible2nd&amp;field.comment=%0A%0A-----------------------------------%0ABuilt:%202017-06-29T17:43:47+00:00%0Agit%20SHA:%2013fb30b7c263d715eee84f0ca1a16df79697eb88%0AURL:%20http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html%0Asource%20File:%20file:a35-prades%0Axml:id:%20mastering-ansible-2nd" onmouseover="this.href=mail" target="_blank"><i class="icon-bug"><!----></i>Нашли ошибку? Сообщите о ней на данной странице</a></div><script language="JavaScript">	  var sourceFile = "source File: file:a35-prades";	  var xmlId = "xml:id: mastering-ansible-2nd";	  var lineFeed = "%0A";	  var docUrl = "URL: " + window.location;	  var bugTitle = "MasteringAnsible2nd";	  var buildTime = "Built: 2017-06-29T17:43:47+00:00";	  var gitSha = "git SHA: 13fb30b7c263d715eee84f0ca1a16df79697eb88";	  var fieldComment = encodeURI(buildTime) +  lineFeed + encodeURI(gitSha) + lineFeed + encodeURI(docUrl) + lineFeed + encodeURI(sourceFile) + lineFeed + encodeURI(xmlId);	  logABug(bugTitle,fieldComment);	</script>   <hr><div class="itemizedlist">	<ul class="itemizedlist" type="disc"><p>Дополнительные ссылки:</p>	 <li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/KVMVirtualizationCookbook/content/Ch08.html" target="_top">Книга рецептов виртуализации KVM</a> Константин Иванов, Packt Publishing, июнь 2017</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/MasteringCeph/content/index.html" target="_top">Полное руководство Ceph</a> Ник Фиск, Packt Publishing, май 2017</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/ContainerizationWithLXC/content/index.html" target="_top"> Контейнеризация при помощи LXC</a> Константин Иванов, Packt Publishing, март 2017</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/CephCookbook/content/index.html" target="_top">Книга рецептов Ceph</a> Каран Сингх, Packt Publishing, февраль 2016</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/LearningCeph2ed/content/index.html" target="_top">Изучаем Ceph</a>, 2е изд., Энтони Д`Атри, Вайбхав Бхембре, Каран Сингх, Packt Publishing, октябрь 2017</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/LearningCeph/content/index.html" target="_top">Изучаем Ceph</a> Каран Сингх, Packt Publishing, январь 2015</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/MasteringProxmox.2ed/content/index.html" target="_top">Proxmox. Полное руководство</a>. 2е изд., Васим Ахмед, Packt Publishing, май 2016</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/ProxmoxCookbook/content/index.html" target="_top">Книга рецептов Proxmox. Главы 1-6, Дополнения: Преобразование OpenVZ в LXC, Организация ограждения</a> Васим Ахмед, Packt Publishing, август 2015</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/VirtualizationComplete/content/index.html" target="_top">Полная виртуализация. Базовая коммерческая редакция</a>: Proxmox-freeNAS-Zentyal-pfSense. Ли Р. Сюрбер, февраль 2016</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html" target="_top">Полное руководство Ansible</a>. 2е изд., Джесс Китинг, май 2017</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/MasteringZabbix.2ed/content/Ch04.html" target="_top">Zabbix. Полное руководство</a>. 2е изд., Андреа Далле Ваккье, сентябрь 2015</p>	 </li><li class="listitem">	 <p><a class="link" href="http://onreader.mdl.ru/MasteringPythonNetworking/content/index.html" target="_top">Полное руководство работы с сетями на Python</a>. Эрик Чоу, Июнь 2017</p>	 </li>    </ul>   </div>      <hr><div class="legal"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html">Уведомление о правах</a><hr><br><table style="border-style: none;" align="left" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td style="border-style: none; text-align:left;" valign="top" width="80%">Перевод: Copyright ©&nbsp;2017 &nbsp;<img alt="mdl.ru" src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/mdl-reg.jpg" widht="35" style="border-style: none;" height="12">.<br>All rights reserved.<br>Ссылки обязательны (Refs and links are obligatory).</td><td border="0" style="border-style: none; text-align:right;" valign="top" width="20%"><em><a href="http://www.mdl.ru/">http://www.mdl.ru</a><br> <br><a href="http://onreader.mdl.ru/sddc-mdl-portfolio.pdf">портфолио SD DC</a></em></td></tr><tr><td colspan="2" border="0"> <a href="http://www.mdl.ru/Solutions/Put.htm?Nme=CanonOffer"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/MFUoffer170420-610x315.jpg" "width="610&quot;" heigh="315"></a></td></tr></tbody></table></div><div><div id="leftnavigation" style="padding-top:3px; background-color:white;">	<div class="ui-tabs ui-widget ui-widget-content ui-corner-all" id="tabs"><ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"><li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active"><a href="#treeDiv" tabindex="1"><span class="contentsTab">Содержание</span></a></li>	<li class="ui-state-default ui-corner-top"><a href="#searchDiv" tabindex="1"><span class="searchTab">Поиск</span></a></li></ul>	<div class="ui-tabs-panel ui-widget-content ui-corner-bottom" id="treeDiv"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%206.%20%D0%9C%D0%B8%D0%BD%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8%20%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D1%8F%20%D0%B8%20%D0%BD%D0%B0%D0%BA%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20%D1%80%D0%B0%D0%B7%D0%B2%D1%91%D1%80%D1%82%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B9%20-%20%D0%9F%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5%20%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE%20Ansible_files/loading.gif" alt="загрузка таблицы содержания..." id="tocLoading" style="display:none;">	<div id="ulTreeDiv" style="" class="thisisthat">	<ul id="tree" class="filetree treeview"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Preface">Предисловие<sup>~</sup></a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Covers">Что охватывает эта книга</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#You_need">Что вам нужно для этой книги</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#For_Who">Для кого эта книга</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Conventions">Соглашения</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Feedback">Обратная связь с читателями</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Support">Поддержка пользователей</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#DownloadingExamples">Загрузка кодов примеров</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Errata">Опечатки</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Piracy">Незаконное тиражирование</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/index.html#Questions">Вопросы</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html">Глава 1. Архитектура системы и проектирование Ansible</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#01">Версии и конфигурации Ansible</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#02">Разбор учёта ресурсов и исходных данных</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0201">Статичный учёт ресурсов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0202">Переменные данные учёта ресурсов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0203">Динамическая инвентаризация</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0204">Добавления учёта ресурсов времени исполнения</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0205">Ограничения учёта ресурсов</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#03">Синтаксический разбор плейбуков</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0301">Порядок операций</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0302">Допущения относительных путей</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0303">Директивы поведения воспроизведения</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0304">Стратегии исполнения</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0305">Выбор хоста для воспроизведений и задач</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0306">Имена воспроизведений и задач</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#04">Транспортировка и исполнение модуля</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0401">Ссылка на модуль</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0402">Аргументы модуля</a></span></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0403">Транспортировка и исполнение модуля</a></span><ul style="display: none;"><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#040301">Производительность задачи</a></span></li></ul></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#05">Типы и положение переменных</a></span><ul style="display: none;"><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0501">Типы переменных</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#06">Доступ к внешним данным</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#07">Старшинство переменных</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0701">Порядок старшинства</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#0702">Слияние хэшей</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch01.html#08">Выводы</a></span></li></ul></li><li class="collapsable" tabindex="2"><div class="hitarea collapsable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html">Глава 2. Защита вашей секретной информации в Ansible</a></span><ul style="display: block;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#01">Шифрование неподвижных данных</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0101">Вещи, которые может шифровать Vault</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0102">Создание новых зашифрованных файлов</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#010201">Приглашение ко вводу пароля</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#010202">Файл пароля</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#010203">Сценарий пароля</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0103">Шифрование существующих файлов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0104">Изменение зашифрованных файлов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0105">Чередование паролей зашифрованных файлов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0106">Расшифровка зашифрованных файлов</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0107">Исполнение плейбуков Ansible c зашифрованными файлами</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#02">Защита секретной информации при работе</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0201">Секретная информация, передаваемая на удалённые хосты</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#0202">Секретная информация, протоколируемая в удалённые или локальные файлы</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch02.html#03">Выводы</a></span></li></ul></li><li class="collapsable" tabindex="2"><div class="hitarea collapsable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html">Глава 3. Высвобождение всей мощи шаблонов Jinja2</a></span><ul style="display: block;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#01">Управляющие структуры</a></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0101">Условные зависимости</a></span><ul style="display: none;"><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#010101">Встроенные условные зависимости</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0102">Циклы</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#010201">Фильтрация элементов цикла</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#010202">Индексация цикла</a></span></li></ul></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0103">Макросы</a></span><ul style="display: none;"><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#010301">Макро переменные</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#01030101">name</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#01030102">arguments</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#01030103">defaults</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#01030104">catch_kwargs</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#01030105">catch_varargs</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#01030106">caller</a></span></li></ul></li></ul></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#02">Манипуляция данными</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0201">Синтаксис</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0202">Полезные встроенные фильтры</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020201">default</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020202">count</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020203">random</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020204">round</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0203">Полезные создаваемые Ansible фильтры</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020301">Связанные с состоянием задачи фильтры</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020302">shuffle</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020303">Фильтры для обработки имён пути</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#02030301">basename</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#02030302">dirname</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#02030303">expanduser</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020304">Кодирование Base64</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020305">Поиск содержимого</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0204">Пропуск неопределённых аргументов</a></span></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0205">Объектные методы Python</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020501">Строковые методы</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020502">Методы списков</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#020503">Методы int и float</a></span></li></ul></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#03">Сравнение значений</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0301">Сравнения</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0302">Логика</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#0303">Тесты</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch03.html#03">Выводы</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html">Глава 4. Условия управления задачами</a></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#01">Определение отказа</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#0101">Игнорирование ошибок</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#0102">Определение условия ошибки</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#02">Определение изменения</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#0201">Особая обработка семейства команд</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#0202">Неотложное изменение</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#03">Восстановление после ошибки</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#0301">rescue</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#0302">always</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch04.html#04">Выводы</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html">Глава 5. Компоновка повторно используемого содержания и ролей Ansible</a></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#01">Концепции включения задач, обработчика, переменной и плейбука</a></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0101">Включения задач</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010101">Передача значений переменных во включённые задачи</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010102">Передача сложных данных во включённые задачи</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010103">Условные включения задач</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010104">Помеченные включения задач</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0102">Включения задач с циклами</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0103">Включения обработчиков</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0104">Включения переменных</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010401">vars_files</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010402">Динамические включения vars_files</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010403">include_vars</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#010404">extra-vars</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0105">Включения плейбуков</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#02">Роли</a></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0201">Структура ролей</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020101">Задачи</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020102">Обработчики</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020103">Переменные</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020104">Модули и встраиваемые модули</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020105">Зависимости</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020106">Файлы и шаблоны</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020107">Собираем всё вместе</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0202">Зависимости ролей</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020201">Переменные зависимости ролей</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020202">Тэги</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020203">Условные зависимости ролей</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0203">Приложения ролей</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020301">Смешанные роли и задачи</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020302">Включения ролей</a></span></li></ul></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#0204">Совместное использование ролей</a></span><ul style="display: none;"><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#020401">Ansible Galaxy</a></span></li></ul></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch05.html#03">Выводы</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html">Глава 6. Минимизация времени простоя и накатывания развёртываний</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#01">Обновления на месте</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#02">Расширение вовне и контрактация</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#03">Быстрые отказы</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0301">Опция any_errors_fatal</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0302">Опция max_fail_percentage</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0303">Форсирование обработки</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#04">Минимизация срывов</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0401">Откладывание срывов</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#0402">Одноразовое исполнение разрушающих задач</a></span></li></ul></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#05">Построение в серию отдельных задач</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch06.html#06">Выводы</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html">Глава 7. Поиск неисправностей Ansible</a><sup>~</sup></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#01">Ведение журналов и подробности плейбуков</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#0101">Подробности</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#0102">Ведение журнала</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#02">Самонаблюдение переменной</a></span><ul style="display: none;"><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#0201">Подэлементы переменной</a></span><ul style="display: none;"><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#020101">Сопоставление подэлементов и методов объектов Python</a></span></li></ul></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#03">Исполнение отладочного кода</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#0301">Отладка плейбуков</a></span></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#0302">Отладка локального кода</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#030201">Отладка кода учёта ресурсов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#030202">Отладка кода плейбуков</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#030203">Отладка кода исполнителя</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#030204">Отладка удалённого кода</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#030205">Отладка действия встраиваемого модуля</a></span></li></ul></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch07.html#04">Выводы</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html">Глава 8. Расширение Ansible</a><sup>...</sup></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#01">Разработка модулей</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0101">Построение базового модуля</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0102">Пользовательские модули</a></span></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0103">Простой модуль</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#010301">Документирование модуля</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#010302">Предоставление фактических данных</a></span></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#010303">Режим проверки</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#01030301">Поддержка режима проверки</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#01030302">Обработка режима проверки</a></span></li></ul></li></ul></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#02">Разработка встраиваемых модулей</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0201">Тип подключения встраиваемого модуля</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0202">Встраиваемые модули оболочки</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0203">Встраиваемые модули поиска</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0204">Встраиваемые модули переменных</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0205">Встраиваемые модули кэширования фактов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0206">Встраиваемые модули обратного вызова</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0207">Встраиваемые модули действия</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0208">Встраиваемые модули распространения</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#03">Разработка встраиваемых модулей динамического учёта резервов</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0301">Просмотр хостов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0302">Просмотр переменных хостов</a></span></li><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0303">Простой встраиваемый модуль учёта ресурсов</a></span><ul style="display: none;"><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#030301">Оптимизация производительности сценария</a></span></li></ul></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#04">Участие в проекте Ansible</a></span><ul style="display: none;"><li class="expandable lastExpandable" tabindex="2"><div class="hitarea expandable-hitarea lastExpandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#0401">Представление содействия</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#040101">Репозиторий Ansible</a></span></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#040102">Исполнение тестов</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#04010201">Тестирование модуля</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#04010202">Интеграция тестов</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#04010203">Стиль кодирования тестов</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#040103">Выполнение запроса пула</a></span></li></ul></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch08.html#05">Выводы</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html">Глава 9. Предоставление инфраструктуры</a><sup>~</sup></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#01">Управление облачной инфраструктурой</a></span><ul style="display: none;"><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0101">Создание серверов</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#010101">Загрузка виртуальных серверов</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#010102">Добавление учёта ресурсов в реальном времени</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0102">Использование исходного кода учёта ресурсов OpenStack</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#02">Взаимодействие с контейнерами Docker</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0201">Построение образов</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0202">Построение контейнеров без Dockerfile</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0203">Учёт Docker</a></span></li></ul></li><li class="expandable" tabindex="2"><div class="hitarea expandable-hitarea"></div><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#03">Предварительный просмотр контейнера Ansible</a></span><ul style="display: none;"><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0301">Init</a></span></li><li tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0302">Build</a></span></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#0303">Run</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ch09.html#04">Выводы</a></span></li></ul></li><li class="last" tabindex="2"><span class="file"><a href="http://onreader.mdl.ru/MasteringAnsible2nd/content/Ix01.html">Указатель<sup>-</sup></a></span></li></ul>	</div></div>		<div class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide" id="searchDiv">	 <div id="search"><form onsubmit="Verifie(ditaSearch_Form);return false" name="ditaSearch_Form" class="searchForm">	  <fieldset class="searchFieldSet"><legend>Поиск</legend><center><input id="textToSearch" name="textToSearch" class="searchText" type="text"> &nbsp; <input onclick="Verifie(ditaSearch_Form)" class="searchButton" value="Go" id="doSearch" type="button"></center></fieldset></form>	 </div>	<div id="searchResults"><center>		</center></div>	<p class="searchHighlight"><a href="#" onclick="toggleHighlight()">Подсветка поиска (Вкл/Выкл)</a>	</p>	</div></div></div></div>

</div></body><div data="{&quot;a&quot;:&quot;setShowingSafe&quot;,&quot;f&quot;:false}" style="display:none" id="sp_console_event"></div></html>