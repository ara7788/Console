<!DOCTYPE html>
<html lang="ru-RU" prefix="og: http://ogp.me/ns#" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="https://serveradmin.ru/xmlrpc.php" />
<title>Почтовый сервер на centos 7 - postfix + dovecot</title>

<!-- This site is optimized with the Yoast SEO plugin v5.5.1 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Подробное описание полноценного почтового сервера postfix на centos со всем необходимым функционалом для малого и среднего бизнеса."/>
<link rel="canonical" href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/" />
<meta property="og:locale" content="ru_RU" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Почтовый сервер на centos 7 - postfix + dovecot" />
<meta property="og:description" content="Подробное описание полноценного почтового сервера postfix на centos со всем необходимым функционалом для малого и среднего бизнеса." />
<meta property="og:url" content="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/" />
<meta property="og:site_name" content="Системное администрирование" />
<meta property="article:tag" content="centos" />
<meta property="article:tag" content="dovecot" />
<meta property="article:tag" content="mailserver" />
<meta property="article:tag" content="postfix" />
<meta property="article:section" content="CentOS" />
<meta property="article:published_time" content="2017-03-20T03:05:15+00:00" />
<meta property="article:modified_time" content="2017-09-15T18:33:18+00:00" />
<meta property="og:updated_time" content="2017-09-15T18:33:18+00:00" />
<meta property="og:image" content="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server.png" />
<meta property="og:image:secure_url" content="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server.png" />
<meta property="og:image:width" content="660" />
<meta property="og:image:height" content="330" />
<script type='application/ld+json'>{"@context":"http:\/\/schema.org","@type":"WebSite","@id":"#website","url":"https:\/\/serveradmin.ru\/","name":"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u043e\u0435 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435","potentialAction":{"@type":"SearchAction","target":"https:\/\/serveradmin.ru\/?s={search_term_string}","query-input":"required name=search_term_string"}}</script>
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Системное администрирование &raquo; Лента" href="https://serveradmin.ru/feed/" />
<link rel="alternate" type="application/rss+xml" title="Системное администрирование &raquo; Лента комментариев" href="https://serveradmin.ru/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Системное администрирование &raquo; Лента комментариев к &laquo;Настройка postfix + dovecot + mysql база + postfixadmin + roundcube + dkim на CentOS 7&raquo;" href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/serveradmin.ru\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='toc-screen-css'  href='https://serveradmin.ru/wp-content/plugins/table-of-contents-plus/screen.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wpforo-widgets-css'  href='https://serveradmin.ru/wp-content/plugins/wpforo/wpf-themes/classic/widgets.css' type='text/css' media='all' />
<link rel='stylesheet' id='tie-style-css'  href='https://serveradmin.ru/wp-content/themes/sahifa/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='tie-ilightbox-skin-css'  href='https://serveradmin.ru/wp-content/themes/sahifa/css/ilightbox/dark-skin/skin.css' type='text/css' media='all' />
<link rel='stylesheet' id='Droid+Sans-css'  href='https://fonts.googleapis.com/css?family=Droid+Sans%3Aregular%2C700' type='text/css' media='all' />
<script type='text/javascript' src='https://serveradmin.ru/wp-includes/js/jquery/jquery.js'></script>
<script type='text/javascript' src='https://serveradmin.ru/wp-includes/js/jquery/jquery-migrate.min.js'></script>
<script type='text/javascript' src='https://serveradmin.ru/wp-content/plugins/duracelltomi-google-tag-manager/js/gtm4wp-form-move-tracker.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var tieViewsCacheL10n = {"admin_ajax_url":"https:\/\/serveradmin.ru\/wp-admin\/admin-ajax.php","post_id":"4993"};
/* ]]> */
</script>
<script type='text/javascript' src='https://serveradmin.ru/wp-content/themes/sahifa/js/postviews-cache.js'></script>
<link rel='https://api.w.org/' href='https://serveradmin.ru/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://serveradmin.ru/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://serveradmin.ru/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.8.2" />
<link rel='shortlink' href='https://serveradmin.ru/?p=4993' />
<link rel="alternate" type="application/json+oembed" href="https://serveradmin.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fserveradmin.ru%2Fnastroyka-postfix-dovecot-centos-7%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://serveradmin.ru/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fserveradmin.ru%2Fnastroyka-postfix-dovecot-centos-7%2F&#038;format=xml" />
<style type="text/css">div#toc_container {background: #f9f9f9;border: 1px solid #aaaaaa;width: 100%;}div#toc_container ul li {font-size: 15px;}</style>		<script type="text/javascript">
			jQuery(document).ready(function($){
				$(document).on('click','.attach_cant_view', function(){
					$("#wpf-msg-box").hide();
					$('#wpforo-load').visible();
					$("#wpf-msg-box p.wpf-msg-box-triangle-right").removeClass("error").removeClass("success");
					$("#wpf-msg-box p.wpf-msg-box-triangle-right").html("<span>Пожалуйста, <a href=\"https://serveradmin.ru/forum/?wpforo=signin\" rel=\"nofollow\">Вход</a> или <a href=\"https://serveradmin.ru/forum/?wpforo=signup\" rel=\"nofollow\">Зарегистрироваться</a></span>");
					$("#wpf-msg-box").show(150).delay(1000);
					$('#wpforo-load').invisible();
				});
			});
		</script>
		
<!-- Google Tag Manager for WordPress by DuracellTomi - http://duracelltomi.com -->
<script data-cfasync="false" type="text/javascript">
	var gtm4wp_datalayer_name = "dataLayer";
	var dataLayer = dataLayer || [];
	dataLayer.push({"pagePostType":"post","pagePostType2":"single-post","pageCategory":["centos","linux"],"pageAttributes":["centos","dovecot","mailserver","postfix"],"pagePostAuthor":"Zerox"});
</script>
<script data-cfasync="false">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.'+'js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-N32MZXJ');</script>
<!-- End Google Tag Manager -->
<!-- End Google Tag Manager for WordPress by DuracellTomi --><link rel="shortcut icon" href="https://serveradmin.ru/wp-content/uploads/2015/08/favicon.ico" title="Favicon" />	
<!--[if IE]>
<script type="text/javascript">jQuery(document).ready(function (){ jQuery(".menu-item").has("ul").children("a").attr("aria-haspopup", "true");});</script>
<![endif]-->	
<!--[if lt IE 9]>
<script src="https://serveradmin.ru/wp-content/themes/sahifa/js/html5.js"></script>
<script src="https://serveradmin.ru/wp-content/themes/sahifa/js/selectivizr-min.js"></script>
<![endif]-->
<!--[if IE 9]>
<link rel="stylesheet" type="text/css" media="all" href="https://serveradmin.ru/wp-content/themes/sahifa/css/ie9.css" />
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" type="text/css" media="all" href="https://serveradmin.ru/wp-content/themes/sahifa/css/ie8.css" />
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" type="text/css" media="all" href="https://serveradmin.ru/wp-content/themes/sahifa/css/ie7.css" />
<![endif]-->


<meta name="viewport" content="width=device-width, initial-scale=1.0" />

< meta name="referrer" content="origin">

<style type="text/css" media="screen"> 

	
body {
	background-image : url(https://serveradmin.ru/wp-content/themes/sahifa/images/patterns/body-bg15.png);
	background-position: top center;
}

body.single .post .entry a, body.page .post .entry a {
	color: #e6773c;
}
		
</style> 


<!-- BEGIN recaptcha, injected by plugin wp-recaptcha-integration  -->

<!-- END recaptcha -->
</head>
<body id="top" class="post-template-default single single-post postid-4993 single-format-standard">

<div class="wrapper-outer">

	<div class="background-cover"></div>

	<aside id="slide-out">
	
			<div class="search-mobile">
			<form method="get" id="searchform-mobile" action="https://serveradmin.ru/">
				<button class="search-button" type="submit" value="Поищем"><i class="fa fa-search"></i></button>	
				<input type="text" id="s-mobile" name="s" title="Поищем" value="Поищем" onfocus="if (this.value == 'Поищем') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Поищем';}"  />
			</form>
		</div><!-- .search-mobile /-->
		
		
		<div id="mobile-menu" ></div>
	</aside><!-- #slide-out /-->

		<div id="wrapper" class="boxed-all">
		<div class="inner-wrapper">

		<header id="theme-header" class="theme-header">
						<div id="top-nav" class="top-nav">
				<div class="container">

								
				<div class="top-menu"><ul id="menu-menyu-1" class="menu"><li id="menu-item-522" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-522"><a href="//serveradmin.ru/">Главная</a></li>
<li id="menu-item-636" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-636"><a href="https://serveradmin.ru/karta-sayta/">Карта сайта</a></li>
<li id="menu-item-1183" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1183"><a href="https://serveradmin.ru/zakazat-statyu/">Заказать статью</a></li>
<li id="menu-item-2592" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2592"><a href="https://serveradmin.ru/uslugi/">Услуги</a></li>
<li id="menu-item-2593" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2593"><a href="https://serveradmin.ru/kontaktyi/">Контакты</a></li>
</ul></div>
						<div class="search-block">
						<form method="get" id="searchform-header" action="https://serveradmin.ru/">
							<button class="search-button" type="submit" value="Поищем"><i class="fa fa-search"></i></button>	
							<input class="search-live" type="text" id="s-header" name="s" title="Поищем" value="Поищем" onfocus="if (this.value == 'Поищем') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Поищем';}"  />
						</form>
					</div><!-- .search-block /-->
			<div class="social-icons">
		<a class="ttip-none" title="Rss" href="https://serveradmin.ru/feed/" target="_blank"><i class="fa fa-rss"></i></a>		
			</div>

		
	
				</div><!-- .container /-->
			</div><!-- .top-menu /-->
			
		<div class="header-content">
		
					<a id="slide-out-open" class="slide-out-open" href="#"><span></span></a>
				
			<div class="logo">
			<h2>								<a title="Системное администрирование" href="https://serveradmin.ru/">
					<img src="https://serveradmin.ru/wp-content/uploads/2015/12/logo-new.png" alt="Системное администрирование"  /><strong>Системное администрирование Сайт содержит статьи, обзоры, инструкции по установке, настройке и администрированию различных информационных систем</strong>
				</a>
			</h2>			</div><!-- .logo /-->
			<div class="e3lan e3lan-top">			
			<a href="https://www.keyweb.ru/products/server/root-virtual-server" title="Виртуальные серверы в Германии" target="_blank">
				<img src="https://serveradmin.ru/wp-content/uploads/2017/07/server_vds.gif" alt="Виртуальные серверы в Германии" />
			</a>
				</div>			<div class="clear"></div>
			
		</div>	
													<nav id="main-nav">
				<div class="container">
				
				
					<div class="main-menu"><ul id="menu-osnovnoe" class="menu"><li id="menu-item-1934" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1934"><a href="//serveradmin.ru">Главная</a></li>
<li id="menu-item-3761" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3761"><a target="_blank" href="https://serveradmin.ru/forum/"><i class="fa fa-comments-o"></i>Форум</a></li>
<li id="menu-item-1921" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-1921"><a><i class="fa fa-server"></i>Системы</a>
<ul class="sub-menu menu-sub-content">
	<li id="menu-item-1932" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1932"><a href="https://serveradmin.ru/category/freebsd/">Freebsd</a></li>
	<li id="menu-item-1922" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1922"><a href="https://serveradmin.ru/category/linux/centos/">CentOS</a></li>
	<li id="menu-item-1923" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1923"><a href="https://serveradmin.ru/category/linux/debian/">Debian</a></li>
	<li id="menu-item-1924" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1924"><a href="https://serveradmin.ru/category/windows/">Windows</a></li>
	<li id="menu-item-1925" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1925"><a href="https://serveradmin.ru/category/synology/">Synology</a></li>
</ul>
</li>
<li id="menu-item-5106" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-5106"><a><i class="fa fa-list-ul"></i>Сервисы</a>
<ul class="sub-menu menu-sub-content">
	<li id="menu-item-5114" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5114"><a href="https://serveradmin.ru/tag/sysconfig/">Настройка системы</a></li>
	<li id="menu-item-5112" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5112"><a href="https://serveradmin.ru/tag/gate/">Шлюз</a></li>
	<li id="menu-item-5110" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5110"><a href="https://serveradmin.ru/tag/webserver/">Веб сервер</a></li>
	<li id="menu-item-5107" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5107"><a href="https://serveradmin.ru/tag/mailserver">Почтовый сервер</a></li>
	<li id="menu-item-5702" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5702"><a href="https://serveradmin.ru/tag/fileserver/">Файловый сервер</a></li>
	<li id="menu-item-5113" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5113"><a href="https://serveradmin.ru/tag/backup/">Бэкап</a></li>
</ul>
</li>
<li id="menu-item-1927" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1927"><a href="https://serveradmin.ru/category/virtual/"><i class="fa fa-cloud"></i>Виртуализация</a>
<ul class="sub-menu menu-sub-content">
	<li id="menu-item-1928" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1928"><a href="https://serveradmin.ru/category/virtual/hyperv/">Hyper-V</a></li>
	<li id="menu-item-1929" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1929"><a href="https://serveradmin.ru/category/virtual/vmware/">VMware</a></li>
	<li id="menu-item-1972" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1972"><a href="https://serveradmin.ru/category/virtual/xenserver/">XenServer</a></li>
	<li id="menu-item-3700" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3700"><a href="https://serveradmin.ru/category/virtual/proxmox/">Proxmox</a></li>
	<li id="menu-item-4903" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4903"><a href="https://serveradmin.ru/category/virtual/kvm/">KVM</a></li>
</ul>
</li>
<li id="menu-item-1926" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1926"><a href="https://serveradmin.ru/category/mikrotik/"><i class="fa fa-maxcdn"></i>Mikrotik</a></li>
<li id="menu-item-2272" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-2272"><a><i class="fa fa-binoculars"></i>Мониторинг</a>
<ul class="sub-menu menu-sub-content">
	<li id="menu-item-2273" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2273"><a href="https://serveradmin.ru/category/zabbix/">Zabbix</a></li>
</ul>
</li>
<li id="menu-item-3340" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3340"><a href="https://serveradmin.ru/category/asterisk/"><i class="fa fa-phone-square"></i>Asterisk</a></li>
<li id="menu-item-4832" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4832"><a href="https://serveradmin.ru/category/1c/"><i class="fa fa-copyright"></i>1C</a></li>
<li id="menu-item-1930" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1930"><a href="https://serveradmin.ru/category/virus/"><i class="fa fa-exclamation-circle"></i>Осторожно, вирус!</a></li>
<li id="menu-item-1931" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1931"><a href="https://serveradmin.ru/category/poleznyie-sovetyi/"><i class="fa fa-cogs"></i>Советы</a></li>
<li id="menu-item-2803" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2803"><a href="https://serveradmin.ru/category/errors/"><i class="fa fa-times-circle"></i>Ошибки</a></li>
<li id="menu-item-3205" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3205"><a href="https://serveradmin.ru/category/lichnoe/"><i class="fa fa-android"></i>Личное</a></li>
</ul></div>					
					
				</div>
			</nav><!-- .main-nav /-->
					</header><!-- #header /-->
	
		
	
	
	<div id="main-content" class="container">
			
		
	
	
		
	<div class="content">
	
				
		<div xmlns:v="http://rdf.data-vocabulary.org/#"  id="crumbs"><span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" class="crumbs-home" href="https://serveradmin.ru">Home</a></span> <span class="delimiter">&raquo;</span> <span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="https://serveradmin.ru/category/linux/">Linux</a></span> <span class="delimiter">&raquo;</span> <span typeof="v:Breadcrumb"><a rel="v:url" property="v:title" href="https://serveradmin.ru/category/linux/centos/">CentOS</a></span> <span class="delimiter">&raquo;</span> <span class="current">Настройка postfix + dovecot + mysql база + postfixadmin + roundcube + dkim на CentOS 7</span></div>
					
				
						
		<article class="post-listing post-4993 post type-post status-publish format-standard has-post-thumbnail hentry category-centos category-linux tag-centos tag-dovecot tag-mailserver tag-postfix" id="the-post">
			
			<div class="post-inner">
			
							<h1 class="name post-title entry-title" itemprop="itemReviewed" itemscope itemtype="http://schema.org/Thing"><span itemprop="name">Настройка postfix + dovecot + mysql база + postfixadmin + roundcube + dkim на CentOS 7</span></h1>

						
<p class="post-meta">
	
		
	<span class="tie-date"><i class="fa fa-clock-o"></i>Обновлено: 15.09.2017</span>	
	<span class="post-cats"><i class="fa fa-folder"></i><a href="https://serveradmin.ru/category/linux/centos/" rel="category tag">CentOS</a>, <a href="https://serveradmin.ru/category/linux/" rel="category tag">Linux</a></span>
	
	<span class="post-comments"><i class="fa fa-comments"></i><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comments">123 комментария</a></span>
<span class="post-views"><i class="fa fa-eye"></i>21,320 Views</span> </p>
<div class="clear"></div>
			
				<div class="entry">
					
					
					<p style="text-align: justify;">Некоторое время назад я рассказывал, как настроить почтовый сервер на базе готовой сборки <a href="https://serveradmin.ru/ustanovka-i-nastroyka-iredmail/" target="_blank" rel="noopener">iredmail</a>. Я подробно разобрал все актуальные вопросы почтового сервера на linux на базе postfix. Сейчас хочу настроить похожий функционал, но с нуля, за основу взяв postfix + dovecot. Я расскажу про установку и настройку postfix на centos 7, причем только тех модулей и дополнений, которые сам считаю нужными и полезными на почтовом сервере.</p>
<p><span id="more-4993"></span></p>
<div id="toc_container" class="no_bullets"><p class="toc_title">Содержание:</p><ul class="toc_list"><li><a href="#i"><span class="toc_number toc_depth_1">1</span> Введение</a></li><li><a href="#_postfixadmin"><span class="toc_number toc_depth_1">2</span> Установка postfixadmin</a></li><li><a href="#_postfix"><span class="toc_number toc_depth_1">3</span> Настройка postfix</a></li><li><a href="#_dovecot"><span class="toc_number toc_depth_1">4</span> Настройка dovecot</a></li><li><a href="#i-2"><span class="toc_number toc_depth_1">5</span> Проверка работы почтового сервера</a></li><li><a href="#_web_roundcube"><span class="toc_number toc_depth_1">6</span> Установка web интерфейса roundcube</a></li><li><a href="#__sieve"><span class="toc_number toc_depth_1">7</span> Настройка фильтра почты sieve</a></li><li><a href="#i-3"><span class="toc_number toc_depth_1">8</span> Настройка автоответчика</a></li><li><a href="#__imap"><span class="toc_number toc_depth_1">9</span> Общие папки по imap</a></li><li><a href="#_dkim_spf"><span class="toc_number toc_depth_1">10</span> Настройка dkim и spf</a></li><li><a href="#__postfix"><span class="toc_number toc_depth_1">11</span> Дополнительный функционал почтового сервера postfix</a></li><li><a href="#__postfix-2"><span class="toc_number toc_depth_1">12</span> Борьба со спамом средствами postfix</a></li><li><a href="#i-4"><span class="toc_number toc_depth_1">13</span> Заключение</a></li></ul></div>

<h2><span id="i">Введение</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Я буду настраивать почтовый сервер на ОС linux, а точнее на <strong>CentOS 7</strong>. За основу будет взят <strong>postfix</strong>, который присутствует в этой системе из коробки. Инструкция получится универсальной, можно использовать и для других дистрибутивов. Все основные конфиги легко переносятся на разные системы, требуя минимальной правки, в основном путей.</p>
<p style="text-align: justify;">Я напишу статью на самом что ни на есть реальном примере, без какой-либо правки доменов, ip и прочего, чтобы не ошибиться и показать максимально возможный реальный пример. У меня есть технический домен zeroxzed.ru. Я буду использовать его в своей работе. Почтовый сервер будет иметь имя mail.zeroxzed.ru. Всю теорию по подготовке dns к установке и настройке почтового сервера я рассказывал в <a href="https://serveradmin.ru/ustanovka-i-nastroyka-iredmail/#i-2" target="_blank" rel="noopener">предыдущей статье</a> о почтовом сервере. Не хочу здесь повторяться. Уточню только список действий, которые вам нужно проделать c ДНС:</p>
<ol>
<li>Создаем A запись в DNS &#8212; mail.zeroxzed.ru.</li>
<li>Добавляем или редактируем MX запись, указывая в качестве почтового сервера mail.zeroxzed.ru.</li>
<li>Просим провайдера прописать PTR для внешнего ip адреса, который будет использовать почтовый сервер. В качестве ptr записи просим установить имя нашего сервера &#8212; mail.zeroxzed.ru.</li>
</ol>
<p><img class="aligncenter wp-image-5028 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-01.png" alt="Настройка dns записей для почтового сервера" width="935" height="403" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-01.png 935w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-01-300x129.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-01-768x331.png 768w" sizes="(max-width: 935px) 100vw, 935px" /></p>
<p style="text-align: justify;">Я предпочитаю в качестве dns хостинга использовать <a href="https://pdd.yandex.ru/" target="_blank" rel="noopener">сервера яндекса</a>, даже если не прикрепляю его почту к домену. На картинке показан минимально необходимый набор записей, кроме PTR. Этими записями управляете не вы, а провайдер, который вам выдает ip. Пока с днс все. Позже мы вернемся к этому вопросу, когда будем добавлять dkim и spf записи. Но обо всем по порядку.</p>
<p style="text-align: justify;">Подготовим систему centos к установке и настройке почтового сервера postfix. Если у вас еще нет готовой системы, то рекомендую воспользоваться моими статьями по <a href="https://serveradmin.ru/ustanovka-centos-7/" target="_blank" rel="noopener">установке</a> и <a href="https://serveradmin.ru/centos-7-nastroyka-servera/" target="_blank" rel="noopener">настройке centos</a>. Отдельно потратьте время на <a href="https://serveradmin.ru/nastroyka-iptables-v-centos-7/" target="_blank" rel="noopener">настройку iptables</a>. Я не буду касаться этого вопроса в данной статье, чтобы не раздувать ее второстепенными вещами. Удобнее, когда все по отдельности рассказано и описано с должной глубиной. Сваливать все в одну кучу не хочется.</p>
<p>По вступлению вроде все, основное рассказал. Приступим к настройке нашего почтового сервера.</p>
<div class="box warning  "><div class="box-inner-block"><i class="fa tie-shortcode-boxicon"></i>
			Сразу хочу сделать предупреждение. Настройка почтового сервера достаточно трудоемкий процесс, требует определенных навыков, знаний и понимания принципов работы используемых средств. Я не ставлю для себя цель расписать максимально подробно так, чтобы было понятно даже неподготовленному администратору linux. Вы должны быть так или иначе подготовлены, либо запаситесь терпением и разбирайтесь внимательно сами в нюансах. Эта статья на полный копипаст не подходит, что-то остается за кадром для самостоятельного выполнения. Иначе нельзя, получится очень большой и громоздкий материал.
			</div></div>
<h2><span id="_postfixadmin">Установка postfixadmin</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Начнем с установки и настройки панели управления почтовым сервером postfix &#8212; <strong>postfixadmin</strong>. Без него начинать что-то делать неудобно, так как управлять пользователями, ящиками, алиасами будет нечем. По своей сути postfixadmin &#8212; набор php скриптов для управления записями в mysql базе данных, которую использует сервер postfix во время своей работы. Соответственно, для работы postfixadmin нам нужен web сервер. Подробно о <a href="https://serveradmin.ru/ustanovka-lamp-apache-php-mysql-v-centos-7/" target="_blank" rel="noopener">настройке web сервера на centos</a> читайте отдельно. Сейчас же мы быстро установим все необходимое. Привожу только команды, без комментариев. Все подробности по приведенной выше ссылке.</p>
<pre># yum install httpd php phpmyadmin mariadb mariadb-server php-imap</pre>
<p style="text-align: justify;">Этих пакетов со всеми зависимостями будет достаточно для установки всех необходимых компонентов веб сервера. Я специально ставлю phpmyadmin, с ним удобно работать с базой. В нашем случае все пользователи будут храниться в mysql, иногда может понадобиться туда заглянуть. Подробнее с <a href="https://serveradmin.ru/ustanovit-i-nastroit-phpmyadmin-na-centos-7/" target="_blank" rel="noopener">установкой и настройкой phpmyadmin</a> можете ознакомиться отдельно.</p>
<p>Запускаем httpd и mariadb и добавляем их в автозагрузку.</p>
<pre># systemctl start httpd
# systemctl enable httpd
# systemctl start mariadb
# systemctl enable mariadb</pre>
<p>Задаем пароль root для mysql.</p>
<pre># /usr/bin/mysql_secure_installation</pre>
<p style="text-align: justify;">Проверяем работу web сервера. Заходим по ip адресу сервера &#8212; <em>http://188.35.19.125/</em>, а также проверяем работу phpmyadmin &#8212; <em>http://188.35.19.125/phpmyadmin/</em>. Его нужно настроить, об этом рассказано в статье, которую я привел чуть выше. По-умолчанию в phpmyadmin доступ закрыт. Если все сделали правильно, то увидите примерно следующее.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-02.png"><img class="aligncenter wp-image-5029 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-02.png" alt="Вход в phpmyadmin" width="1857" height="666" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-02.png 1857w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-02-300x108.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-02-768x275.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-02-1024x367.png 1024w" sizes="(max-width: 1857px) 100vw, 1857px" /></a></p>
<p>Сразу создадим тут пользователя postfix и одноименную базу данных. Запомните учетные данные, они нам далее понадобятся.</p>
<p>Веб сервер готов, продолжаем настройку почтового сервера. Скачиваем последнюю версию postfixadmin.</p>
<pre># cd /usr/src
# wget https://downloads.sourceforge.net/project/postfixadmin/postfixadmin/postfixadmin-3.0.2/postfixadmin-3.0.2.tar.gz</pre>
<div class="box info  "><div class="box-inner-block"><i class="fa tie-shortcode-boxicon"></i>
			Скорее всего во время вашей установки версия postfixadmin изменится и ссылка может быть неактуальной. Но даже если она будет актуальна, возможно выйдет более новая версия. Проверьте ее по ссылке <a href="https://sourceforge.net/projects/postfixadmin/" target="_blank" rel="noopener">https://sourceforge.net/projects/postfixadmin/</a> и скачайте самую свежую версию.
			</div></div>
<p>Распаковываем архив и копируем в директорию веб сервера.</p>
<pre># tar -xvzf postfixadmin-*
# mv /usr/src/postfixadmin-3.0.2 /var/www/html/postfixadmin</pre>
<p>Назначаем владельцем пользователя веб сервера:</p>
<pre># chown -R apache. /var/www/html/postfixadmin/</pre>
<p>Дальше редактируем конфигурационный файл postfixadmin.</p>
<pre># mcedit /var/www/html/postfixadmin/config.inc.php</pre>
<p>Приводим параметры к следующему виду:</p>
<pre>$CONF['configured'] = true;
$CONF['default_language'] = 'ru';
$CONF['database_type'] = 'mysqli';
$CONF['database_host'] = 'localhost';
$CONF['database_user'] = 'postfix';
$CONF['database_password'] = '12345678';
$CONF['database_name'] = 'postfix';
$CONF['admin_email'] = 'root@zeroxzed.ru';
$CONF['encrypt'] = '<strong>md5crypt</strong>';
$CONF['default_aliases'] = array (
 'abuse' =&gt; 'root',
 'hostmaster' =&gt; 'root',
 'postmaster' =&gt; 'root',
 'webmaster' =&gt; 'root'
);
$CONF['domain_path'] = 'YES';
$CONF['domain_in_mailbox'] = 'YES';</pre>
<p style="text-align: justify;">Обращаю внимание на выделенный параметр. Он указывает на то, в каком виде хранить пароли пользователей в базе данных. Конечно, хранить обычным текстом без шифрования это дурной тон и может быть опасно. Я указал хранение в шифрованном виде. Но если мы говорим о небольшой компании без публичного доступа к серверу, можно использовать нешифрованные пароли. Для этого указываем значение параметра <strong>cleartext</strong>. Я сам так часто делаю просто из соображений удобства. Объясню, в чем удобство.</p>
<p style="text-align: justify;">К примеру, у пользователя несколько устройств подключены к почте и он забыл свой пароль. Админ при создании почему-то тоже его никуда не записал, или забыл, или потерял. Вам придется сбросить пароль и перенастроить все устройства. Если же у вас пароль хранится в открытом виде, вы просто смотрите в базу и говорите пользователю пароль. Пароли в открытом виде удобно просто выгрузить дампом из базы, если понадобится кому-то все учетки передать. Но тут как посмотреть 🙂 С одной стороны плюс, с другой минус &#8212; кто-то очень просто может спереть все ваши пароли. В общем, тут от ситуации зависит, решайте сами, как вам удобнее хранить пароли.</p>
<p style="text-align: justify;">У меня распространены ситуации, когда я удаленно администрирую сервера, а на месте эникеи работают с пользователями. Чаще всего это не очень аккуратные и ответственные люди, иначе они бы работали с серверами 🙂 Они часто забывают записать пароль, путают что-то и т.д. В итоге, когда один человек увольняется и приходит другой, оказывается, что найти пароли на некоторые ящики просто невозможно. Тут очень выручает возможность посмотреть пароль в базе. Я новому админу либо пароль говорю, либо весь дамп сразу отдаю, пусть работает.</p>
<p style="text-align: justify;">Если вы сами работаете с сервером и все аккуратно ведете, записываете, например, в keepass все пароли от почтовых ящиков, то смело шифруйте все пароли, так будет спокойнее.</p>
<p style="text-align: justify;">Последние 2 параметра <strong>domain_path</strong> и <strong>domain_in_mailbox</strong> указывайте по своему усмотрению. В файле конфигурации в комментариях расписано, за что они отвечают и в чем отличие. Мне кажется, удобно хранить директории именно в таком виде, как я указал. Получится следующий путь до ящика, если у вас архив почты будет жить, к примеру, в директории <em>/mnt/mail</em> &#8212; <span class="highlight highlight-yellow">/mnt/mail/zeroxzed.ru/root@zeroxzed.ru</span>.</p>
<p style="text-align: justify;">С параметрами разобрались. Сохраняем конфиг. Идем по адресу <em>http://188.35.19.125/postfixadmin/setup.php</em> и начинаем установку postfixadmin. Первым делом идет проверка всех необходимых для установки и работы компонентов. Для продолжения установки у вас должна быть такая картинка.</p>
<p><img class="aligncenter wp-image-5030 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-03.png" alt="Установка postfixadmin" width="809" height="780" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-03.png 809w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-03-300x289.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-03-768x740.png 768w" sizes="(max-width: 809px) 100vw, 809px" /></p>
<p style="text-align: justify;">Если чего-то не хватает, разбирайтесь по месту. Если делаете по моей инструкции, то все должно быть в порядке. Указывайте пароль установки и продолжайте. Вы должны получить строку с хэшем этого пароля.</p>
<p><img class="aligncenter wp-image-5031 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-04.png" alt="Добавление пароля установки" width="768" height="169" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-04.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-04-300x66.png 300w" sizes="(max-width: 768px) 100vw, 768px" /></p>
<p>Добавляем полученную строку в файл конфигурации postfixadmin.</p>
<pre># mcedit /var/www/html/postfixadmin/config.inc.php</pre>
<pre>$CONF['setup_password'] = '67e46bdcc7aeb431f7af9a6d02f43352:30672e5a9deacaf505d32807b967caf9fd0c32ef';</pre>
<p style="text-align: justify;">Используя этот пароль, можно создать учетную запись администратора панели управления. Делаем это, учитывая, что пароль должен содержать не менее двух цифр. Если все сделали правильно, то увидите сообщение.</p>
<p><img class="aligncenter wp-image-5032 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-05.png" alt="Добавление администратора postfixadmin" width="729" height="124" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-05.png 729w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-05-300x51.png 300w" sizes="(max-width: 729px) 100vw, 729px" /></p>
<p style="text-align: justify;">Переходим по ссылке и авторизуемся с помощью учетной записи администратора, которую только что сделали. Вы должны увидеть основную страницу интерфейса postfixadmin.</p>
<p><img class="aligncenter wp-image-5033 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-06.png" alt="Главная страница postfixadmin" width="829" height="403" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-06.png 829w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-06-300x146.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-06-768x373.png 768w" sizes="(max-width: 829px) 100vw, 829px" /></p>
<p style="text-align: justify;">Теперь нам нужно добавить домен в панель управления. Идем в раздел <span class="highlight highlight-gray">Список доменов -&gt; Новый домен</span> и добавляем свой домен.</p>
<p><img class="aligncenter wp-image-5034 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-07.png" alt="Создание нового домена" width="898" height="409" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-07.png 898w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-07-300x137.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-07-768x350.png 768w" sizes="(max-width: 898px) 100vw, 898px" /></p>
<p style="text-align: justify;">При создании домена были добавлены стандартные алиасы, получателя для которых мы указали еще в конфиге &#8212; ящик root@zeroxzed.ru. Создание таких алиасов требование стандартов, но по факту, кроме спама, вы скорее всего ничего не будете получать по этим адресам. Так что их создание оставляйте на свое усмотрения. Я обычно их не делаю, так как ящик для этих алиасов все равно не читаю.</p>
<p style="text-align: justify;">Далее создадим почтовый ящик администратора &#8212; <span class="highlight highlight-yellow">root@zeroxzed.ru</span>. Для этого идем в раздел <span class="highlight highlight-gray">Обзор -&gt; Создать ящик</span> и заполняем поля.</p>
<p><img class="aligncenter wp-image-5035 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-08.png" alt="Добавление почтового ящика" width="690" height="448" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-08.png 690w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-08-300x195.png 300w" sizes="(max-width: 690px) 100vw, 690px" /></p>
<p style="text-align: justify;">Непосредственно ящик на диске создан не будет, так как у нас еще не настроена почтовая система, но запись в базе данных появится. Это можно проверить через phpmyadmin.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-09.png"><img class="aligncenter wp-image-5036 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-09.png" alt="Проверка нового ящика в mysql базе" width="1703" height="482" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-09.png 1703w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-09-300x85.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-09-768x217.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-09-1024x290.png 1024w" sizes="(max-width: 1703px) 100vw, 1703px" /></a></p>
<p style="text-align: justify;">Как мы видим, пароль указан в зашифрованном виде. На этом установку и настройку postfixadmin завершаем. Интерфейс для управления почтовым сервером мы подготовили. Теперь можно заняться непосредственно настройкой postfix.</p>
<h2><span id="_postfix">Настройка postfix</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Сердце нашего почтового сервера на linux &#8212; postfix. В дистрибутиве centos он уже установлен, можно сразу переходить к настройке. Рисуем следующий конфиг.</p>
<pre># mcedit /etc/postfix/main.cf</pre>
<pre>soft_bounce = no
queue_directory = /var/spool/postfix
command_directory = /usr/sbin
daemon_directory = /usr/libexec/postfix
data_directory = /var/lib/postfix
mail_owner = postfix

myhostname = <strong>mail.zeroxzed.ru</strong>
mydomain = <strong>zeroxzed.ru</strong>
myorigin = $myhostname

inet_interfaces = all
inet_protocols = ipv4

mydestination = localhost.$mydomain, localhost
unknown_local_recipient_reject_code = 550
mynetworks = 127.0.0.0/8

alias_maps = hash:/etc/aliases
alias_database = hash:/etc/aliases

smtpd_banner = $myhostname ESMTP $mail_name

debug_peer_level = 2
# Строки с PATH и ddd должны быть с отступом в виде табуляции от начала строки
debugger_command =
         PATH=/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin
         ddd $daemon_directory/$process_name $process_id &amp; sleep 5

sendmail_path = /usr/sbin/sendmail.postfix
newaliases_path = /usr/bin/newaliases.postfix
mailq_path = /usr/bin/mailq.postfix
setgid_group = postdrop
html_directory = no
manpage_directory = /usr/share/man
sample_directory = /usr/share/doc/postfix-2.10.1/samples
readme_directory = /usr/share/doc/postfix-2.10.1/README_FILES

relay_domains = mysql:/etc/postfix/mysql/relay_domains.cf
virtual_alias_maps = mysql:/etc/postfix/mysql/virtual_alias_maps.cf,
 mysql:/etc/postfix/mysql/virtual_alias_domain_maps.cf
virtual_mailbox_domains = mysql:/etc/postfix/mysql/virtual_mailbox_domains.cf
virtual_mailbox_maps = mysql:/etc/postfix/mysql/virtual_mailbox_maps.cf

smtpd_discard_ehlo_keywords = etrn, silent-discard
smtpd_forbidden_commands = CONNECT GET POST
broken_sasl_auth_clients = yes
smtpd_delay_reject = yes
smtpd_helo_required = yes
smtp_always_send_ehlo = yes
disable_vrfy_command = yes

smtpd_helo_restrictions = permit_mynetworks,
 permit_sasl_authenticated,
 reject_non_fqdn_helo_hostname,
 reject_invalid_helo_hostname

smtpd_data_restrictions = permit_mynetworks,
 permit_sasl_authenticated,
 reject_unauth_pipelining,
 reject_multi_recipient_bounce,

smtpd_sender_restrictions = permit_mynetworks,
 permit_sasl_authenticated,
 reject_non_fqdn_sender,
 reject_unknown_sender_domain

smtpd_recipient_restrictions = reject_non_fqdn_recipient,
 reject_unknown_recipient_domain,
 reject_multi_recipient_bounce,
 permit_mynetworks,
 permit_sasl_authenticated,
 reject_unauth_destination,

smtp_tls_security_level = may
smtpd_tls_security_level = may
smtpd_tls_loglevel = 1
smtpd_tls_received_header = yes
smtpd_tls_session_cache_timeout = 3600s
smtp_tls_session_cache_database = btree:$data_directory/smtp_tls_session_cache
smtpd_tls_key_file = /etc/postfix/certs/key.pem
smtpd_tls_cert_file = /etc/postfix/certs/cert.pem
tls_random_source = dev:/dev/urandom

# Ограничение максимального размера письма в байтах
message_size_limit = 20000000
smtpd_soft_error_limit = 10
smtpd_hard_error_limit = 15
smtpd_error_sleep_time = 20
anvil_rate_time_unit = 60s
smtpd_client_connection_count_limit = 20
smtpd_client_connection_rate_limit = 30
smtpd_client_message_rate_limit = 30
smtpd_client_event_limit_exceptions = 127.0.0.0/8
smtpd_client_connection_limit_exceptions = 127.0.0.0/8

maximal_queue_lifetime = 1d
bounce_queue_lifetime = 1d

smtpd_sasl_auth_enable = yes
smtpd_sasl_security_options = noanonymous
smtpd_sasl_type = dovecot
smtpd_sasl_path = private/dovecot-auth

# Директория для хранения почты
virtual_mailbox_base = <strong>/mnt/mail</strong>
virtual_minimum_uid = 1000
virtual_uid_maps = static:1000
virtual_gid_maps = static:1000
virtual_transport = dovecot
dovecot_destination_recipient_limit = 1

sender_bcc_maps = hash:/etc/postfix/sender_bcc_maps
recipient_bcc_maps = hash:/etc/postfix/recipient_bcc_maps</pre>
<p style="text-align: justify;">Я выделил жирным имя домена и путь для директории с почтовыми ящиками. Не забудьте поменять эти параметры на свои. Сохраняем конфиг и продолжаем настройку. В таком виде сервер еще не готов. Нужно теперь создать все то, что описано в файле конфигурации. Создаем папку для файлов с конфигурацией подключения к mysql и сами файлы подключения.</p>
<pre># mkdir /etc/postfix/mysql &amp;&amp; cd /etc/postfix/mysql</pre>
<pre># mcedit relay_domains.cf

hosts = localhost
user = postfix
password = 12345678
dbname = postfix
query = SELECT domain FROM domain WHERE domain='%s' and backupmx = '1'</pre>
<pre># mcedit  virtual_alias_domain_maps.cf

hosts = localhost
user = postfix
password = 12345678
dbname = postfix
query = SELECT goto FROM alias,alias_domain WHERE alias_domain.alias_domain = '%d' and alias.address = CONCAT('%u', '@', alias_domain.target_domain) AND alias.active = 1</pre>
<pre># mcedit virtual_alias_maps.cf

hosts = localhost
user = postfix
password = 12345678
dbname = postfix
query = SELECT goto FROM alias WHERE address='%s' AND active = '1'</pre>
<pre># mcedit virtual_mailbox_domains.cf</pre>
<pre>hosts = localhost
user = postfix
password = 12345678
dbname = postfix
query = SELECT domain FROM domain WHERE domain='%s' AND backupmx = '0' AND active = '1'</pre>
<pre># mcedit virtual_mailbox_maps.cf

hosts = localhost
user = postfix
password = 12345678
dbname = postfix
query = SELECT maildir FROM mailbox WHERE username='%s' AND active = '1'</pre>
<p style="text-align: justify;">Редактируем файл <em>/etc/postfix/master.cf</em>. Нам надо добавить строки, касающиеся настройки Submission для того, чтобы почтовый сервер работал на 587 порту. Смартфоны очень часто при настройке используют этот порт по-умолчанию, где-то даже без возможности изменить эту настройку. Приводим секцию, отвечающую за эту работу к следующему виду.</p>
<pre>submission inet n - n - - smtpd
 -o syslog_name=postfix/submission
 -o smtpd_tls_wrappermode=no
 -o smtpd_tls_security_level=encrypt
 -o smtpd_sasl_auth_enable=yes
 -o smtpd_recipient_restrictions=permit_mynetworks,permit_sasl_authenticated,reject
 -o smtpd_relay_restrictions=permit_mynetworks,permit_sasl_authenticated,defer_unauth_destination
 -o milter_macro_daemon_name=ORIGINATING</pre>
<p style="text-align: justify;">Обращаю внимание на пробел в начале строки, начиная со второй. Его надо обязательно оставить. Добавляем еще настройки для того, чтобы наш сервер поддерживал протокол SSL/TLS и слушал порт 465</p>
<pre style="text-align: justify;">smtps inet n - n - - smtpd
 -o syslog_name=postfix/smtps
 -o smtpd_tls_wrappermode=yes
 -o smtpd_sasl_auth_enable=yes
 -o smtpd_recipient_restrictions=permit_mynetworks,permit_sasl_authenticated,reject
 -o smtpd_relay_restrictions=permit_mynetworks,permit_sasl_authenticated,defer_unauth_destination
 -o milter_macro_daemon_name=ORIGINATING</pre>
<p style="text-align: justify;">В этот же файл добавляем еще одну настройку, которая будет указывать postfix, что доставкой почты у нас будет заниматься dovecot, который мы настроим следом. Добавляем в master.cf в самый конец.</p>
<pre>dovecot unix - n n - - pipe
 flags=DRhu user=vmail:vmail argv=/usr/libexec/dovecot/deliver -f ${sender} -d ${recipient}</pre>
<p style="text-align: justify;">Сгенерируем самоподписанные ssl сертификаты для нашего почтового сервера. Позже отдельным пунктом я расскажу как использовать полноценные сертификаты. Они не всем нужны, поэтому показываю быструю настройку postfix на использование своих сертификатов, которые уже указаны в конфиге postfix.</p>
<p>Создаем директорию и сами сертификаты:</p>
<pre># mkdir /etc/postfix/certs
# openssl req -new -x509 -days 3650 -nodes -out /etc/postfix/certs/cert.pem -keyout /etc/postfix/certs/key.pem</pre>
<p>Для генерации вам зададут несколько вопросов по поводу данных о сертификате. В принципе, можете там писать все, что угодно. Вот мои данные.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-10.png"><img class="aligncenter wp-image-5037 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-10.png" alt="Создание ssl сертификата для postfix" width="1185" height="388" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-10.png 1185w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-10-300x98.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-10-768x251.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-10-1024x335.png 1024w" sizes="(max-width: 1185px) 100vw, 1185px" /></a></p>
<p>Создадим файлы для информации о ящиках, куда будет собираться вся входящая и исходящая почта.</p>
<pre># mcedit /etc/postfix/recipient_bcc_maps</pre>
<pre>@zeroxzed.ru all_in@zeroxzed.ru</pre>
<pre># mcedit /etc/postfix/sender_bcc_maps</pre>
<pre>@zeroxzed.ru all_out@zeroxzed.ru</pre>
<p>Создаем индексированные базы данных из этих файлов. Это нужно делать каждый раз, после изменения.</p>
<pre># postmap /etc/postfix/recipient_bcc_maps /etc/postfix/sender_bcc_maps</pre>
<p>Теперь создайте два почтовых ящика all_in@zeroxzed.ru и all_out@zeroxzed.ru через postfixadmin.</p>
<p style="text-align: justify;">Немного поясню по этим ящикам &#8212; для чего они нужны. Изначально я их делал, когда пользователи использовали протокол pop3 без сохранения писем на сервере. Это позволяло организовать бэкап всей переписки. Эти ящики очень быстро заполняются и занимают огромный объем, поэтому их обязательно надо чистить. Я просто скриптами регулярно собирал всю почту в архивы с именами в виде дат. Если нужно было какое-то письмо найти, то просто распаковывал нужный архив.</p>
<p style="text-align: justify;">В случае с imap роль бэкапа отпадает, так как вся почта хранится на сервере. Но эти ящики все равно бывают полезны, когда пользователь, к примеру, удалил какое-то важное письмо и потом делает вид, что его и не было. Если это письмо пришло только сегодня и еще не успело улететь в бэкап, то кроме записи в логах об этом письме, вы не увидите само содержимое. А с такими ящиками все сразу будет понятно, и вопросы отпадут. Последнее применение &#8212; служба безопасности. Если у вас есть кто-то, кому положено читать всю переписку, то реализовать этот функционал можно таким простым способом.</p>
<p style="text-align: justify;">Все основные настройки для postfix мы сделали. Некоторые из них завязаны на работу с dovecot, который мы еще не настроили. Поэтому больше postfix не трогаем, не перезапускаем. Идем настраивать dovecot &#8212; imap сервер нашей почтовой системы.</p>
<h2><span id="_dovecot">Настройка dovecot</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Займемся настройкой dovecot &#8212; сервер доставки почты пользователю по протоколам pop3 и imap. Я не вижу причин использовать pop3. Он неудобен по сравнению с imap. Чаще всего pop3 отключаю вовсе. Но это уже на ваше усмотрение. Приведу пример с настройкой обоих протоколов. Помимо основного функционала по доставке почты, я настрою несколько полезных плагинов. Расскажу о них поподробнее:</p>
<ul>
<li style="text-align: justify;"><strong>Sieve</strong> &#8212; выполняет фильтрацию почты по заданным правилам в момент локальной доставки на почтовом сервере. Удобство такого подхода в том, что вы один раз можете настроить правило сортировки, и оно будет работать во всех клиентах, которыми вы будете получать почту по imap. Правила создаются, хранятся и исполняются на самом сервере.</li>
<li style="text-align: justify;"><strong>Acl</strong> &#8212; позволяет пользователям расшаривать папки в своем почтовом ящике и предоставлять доступ к этим папкам другим пользователям. Не часто видел, чтобы этот функционал настраивали и использовали. Думаю, просто по незнанию. По мне так очень удобный и полезный функционал.</li>
</ul>
<p style="text-align: justify;">Часто вижу, что люди настраивают плагин <strong>quota</strong>, который позволяет ограничивать максимальный размер почтового ящика. Я лично в своей работе его не использую. Возможно, когда у тебя клиентов сотни и тысячи это имеет значение и надо обязательно настроить ограничение. Когда же ящиков меньше, нет смысла напрягать людей постоянной чисткой. Сейчас диски стоят не так дорого. Мне кажется, проще и дешевле увеличить место на сервере, нежели постоянно беспокоить пользователей необходимостью чистки ящика. Лучше ограничить максимальный размер письма, скажем 20-ю мегабайтами. Тогда сильно забить ящик даже при большом желании быстро не получится. А почта все-таки важный инструмент в работе. Мне кажется, ее лучше хранить как можно дольше.</p>
<p style="text-align: justify;">Есть еще один полезный плагин <strong>expire</strong>, который позволяет удалять устаревшие письма в определенных папках. Например, удалять все письма старше 30-ти дней в корзине и папке со спамом. Но реально пользоваться им не получается по простой причине. Разные почтовые клиенты создают различные папки для корзины и спама. Thunderbird создает папки с латинскими именами trash и spam, outlook с русскими, которые на почтовом сервере преобразуются в кодировку UTF7, мобильные клиенты тоже используют разные имена папок. В итоге нет единообразия, плагин полноценно не работает.</p>
<p style="text-align: justify;">Я рассказал об этих плагинах для наводки. Сам их не настраиваю, но если вам захочется реализовать описанный функционал, можете сами разобраться и настроить.</p>
<p>Небольшую теорию я дал, теперь переходим к практике. Устанавливаем необходимые для dovecot пакеты.</p>
<pre># yum install dovecot dovecot-mysql dovecot-pigeonhole</pre>
<p style="text-align: justify;">Изначально конфиг dovecot разбит на отдельные сегменты и лежат в директории <em>/etc/dovecot/conf.d</em>. Каждый файл &#8212; отдельный функционал. Мне не нравится прыгать по файлам, поэтому я храню все в едином общем файле конфигурации <em>/etc/dovecot/dovecot.conf</em>. С ним мы и будем работать. Приводим его к следующему виду.</p>
<pre># mcedit /etc/dovecot/dovecot.conf</pre>
<pre>listen = * [::]

mail_plugins = mailbox_alias acl

protocols = imap pop3 sieve lmtp

mail_uid = 1000
mail_gid = 1000

first_valid_uid = 1000
last_valid_uid = 1000

log_path = /var/log/dovecot/main.log
info_log_path = /var/log/dovecot/info.log
debug_log_path = /var/log/dovecot/debug.log

ssl_protocols = !SSLv2 !SSLv3
ssl = required
verbose_ssl = no
ssl_cert = &lt;/etc/postfix/certs/cert.pem
ssl_key = &lt;/etc/postfix/certs/key.pem

ssl_cipher_list = ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:ECDHE-RSA-DES-CBC3-SHA:ECDHE-ECDSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA
ssl_dh_parameters_length = 2048
ssl_prefer_server_ciphers = yes

disable_plaintext_auth = yes

mail_location = maildir:/mnt/mail/%d/%u/

auth_default_realm = zeroxzed.ru

auth_mechanisms = PLAIN LOGIN

service auth {
 unix_listener /var/spool/postfix/private/dovecot-auth {
 user = postfix
 group = postfix
 mode = 0666
 }
unix_listener auth-master {
 user = vmail
 group = vmail
 mode = 0666
 }

unix_listener auth-userdb {
 user = vmail
 group = vmail
 mode = 0660
 }
}

service lmtp {
 unix_listener /var/spool/postfix/private/dovecot-lmtp {
 user = postfix
 group = postfix
 mode = 0600
 }

 inet_listener lmtp {
 address = 127.0.0.1
 port = 24
 }
}

userdb {
 args = /etc/dovecot/dovecot-mysql.conf
 driver = sql
 }

passdb {
 args = /etc/dovecot/dovecot-mysql.conf
 driver = sql
 }

auth_master_user_separator = *
 
plugin {
 auth_socket_path = /var/run/dovecot/auth-master

 acl = vfile
 acl_shared_dict = file:/mnt/mail/shared-folders/shared-mailboxes.db
 sieve = /mnt/mail/sieve/%u.sieve
 mailbox_alias_old = Sent
 mailbox_alias_new = Sent Messages
 mailbox_alias_old2 = Sent
 mailbox_alias_new2 = Sent Items
}

protocol lda {
 mail_plugins = $mail_plugins sieve
 auth_socket_path = /var/run/dovecot/auth-master
 deliver_log_format = mail from %f: msgid=%m %$
 log_path = /var/log/dovecot/lda-errors.log
 info_log_path = /var/log/dovecot/lda-deliver.log
 lda_mailbox_autocreate = yes
 lda_mailbox_autosubscribe = yes
 postmaster_address = root
}

protocol lmtp {
 info_log_path = /var/log/dovecot/lmtp.log
 mail_plugins = quota sieve
 postmaster_address = postmaster
 lmtp_save_to_detail_mailbox = yes
 recipient_delimiter = +
}

protocol imap {
 mail_plugins = $mail_plugins imap_acl
 imap_client_workarounds = tb-extra-mailbox-sep
 mail_max_userip_connections = 30
}

protocol pop3 {
 mail_plugins = $mail_plugins
 pop3_client_workarounds = outlook-no-nuls oe-ns-eoh
 pop3_uidl_format = %08Xu%08Xv
 mail_max_userip_connections = 30
}

service imap-login {
 service_count = 1
 process_limit = 500
 }

service pop3-login {
 service_count = 1
 }

service managesieve-login {
 inet_listener sieve {
 port = 4190
 }
}

namespace {
 type = private
 separator = /
 prefix =
 inbox = yes

 mailbox Sent {
 auto = subscribe
 special_use = \Sent
 }
 mailbox "Sent Messages" {
 auto = no
 special_use = \Sent
 }
 mailbox "Sent Items" {
 auto = no
 special_use = \Sent
 }
 mailbox Drafts {
 auto = subscribe
 special_use = \Drafts
 }
 mailbox Trash {
 auto = subscribe
 special_use = \Trash
 }
 mailbox "Deleted Messages" {
 auto = no
 special_use = \Trash
 }
 mailbox Junk {
 auto = subscribe
 special_use = \Junk
 }
 mailbox Spam {
 auto = no
 special_use = \Junk
 }
 mailbox "Junk E-mail" {
 auto = no
 special_use = \Junk
 }
 mailbox Archive {
 auto = no
 special_use = \Archive
 }
 mailbox Archives {
 auto = no
 special_use = \Archive
 }
}

namespace {
 type = shared
 separator = /
 prefix = Shared/%%u/
 location = maildir:%%h:INDEX=%h/shared/%%u
 subscriptions = yes
 list = children
}</pre>
<p>Создаем группу и пользователя с указанными в конфиге uid 1000.</p>
<pre># groupadd  -g 1000 vmail
# useradd -d /mnt/mail/ -g 1000 -u 1000 vmail
# chown vmail. /mnt/mail</pre>
<p>Создаем конфигурационные файлы для доступа к mysql базе.</p>
<pre># mcedit /etc/dovecot/dovecot-mysql.conf</pre>
<pre>driver = mysql
default_pass_scheme = CRYPT
connect = host=127.0.0.1 dbname=postfix user=postfix password=12345678
user_query = SELECT '/mnt/mail/%d/%u' as home, 'maildir:/mnt/mail/%d/%u' as mail, 1000 AS uid, 1000 AS gid, concat('*:bytes=', quota) AS quota_rule FROM mailbox WHERE username = '%u' AND active = '1'
password_query = SELECT username as user, password, '/mnt/mail/%d/%u' as userdb_home, 'maildir:/mnt/mail/%d/%u' as userdb_mail, 1000 as userdb_uid, 1000 as userdb_gid, concat('*:bytes=', quota) AS userdb_quota_rule FROM mailbox WHERE username = '%u' AND active = '1'</pre>
<p>Создадим директорию и файлы для логов.</p>
<pre># mkdir /var/log/dovecot
# cd /var/log/dovecot &amp;&amp; touch main.log info.log debug.log lda-errors.log lda-deliver.log lmtp.log
# chown -R vmail:dovecot /var/log/dovecot</pre>
<p>Создаем пару служебных папок для плагинов sieve и acl.</p>
<pre># mkdir /mnt/mail/sieve &amp;&amp; mkdir /mnt/mail/shared-folders
# chown -R vmail. /mnt/mail</pre>
<p>И небольшой штрих в завершении настройки.</p>
<pre># chown vmail. /var/run/dovecot/auth-master</pre>
<p>Уже не помню, зачем это было нужно, запись осталась в черновиках. Знаю только, что какая-то ошибка всплывала без этого.</p>
<p>На этом основная настройка почтового сервера на базе postfix и dovecot завершена. Можно перезапускать службы и проверять работу системы.</p>
<pre># systemctl restart postfix
# systemctl start dovecot
# systemctl enable dovecot</pre>
<h2><span id="i-2">Проверка работы почтового сервера</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Самаый простой и быстрый способ проверить работу почтового сервера &#8212; отправить на него письмо. Я буду отправлять со своего почтового адреса zeroxzed@gmail.com на адрес root@zeroxzed.ru. Вот что должно быть в логе, если у вас все правильно настроено и почтовый сервер нормально работает.</p>
<pre># cat /var/log/maillog</pre>
<pre>Mar 10 21:56:27 mail postfix/smtpd[28075]: connect from mail-yw0-f172.google.com[209.85.161.172]
Mar 10 21:56:28 mail postfix/smtpd[28075]: Anonymous TLS connection established from mail-yw0-f172.google.com[209.85.161.172]: TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits)
Mar 10 21:56:28 mail postfix/smtpd[28075]: D4263420BB7B: client=mail-yw0-f172.google.com[209.85.161.172]
Mar 10 21:56:29 mail postfix/cleanup[28086]: D4263420BB7B: message-id=&lt;CAHWPLcOeqf6uNHRg34+wuppDUGPDLY=fp8s-E=o9fmxYMS48cQ@mail.gmail.com&gt;
Mar 10 21:56:29 mail postfix/qmgr[28042]: D4263420BB7B: from=&lt;zeroxzed@gmail.com&gt;, size=2533, nrcpt=2 (queue active)
Mar 10 21:56:29 mail postfix/pipe[28089]: D4263420BB7B: to=&lt;all_in@zeroxzed.ru&gt;, relay=dovecot, delay=0.39, delays=0.33/0.02/0/0.05, dsn=2.0.0, status=sent (delivered via dovecot service)
Mar 10 21:56:29 mail postfix/pipe[28090]: D4263420BB7B: to=&lt;root@zeroxzed.ru&gt;, relay=dovecot, delay=0.4, delays=0.33/0.03/0/0.04, dsn=2.0.0, status=sent (delivered via dovecot service)
Mar 10 21:56:29 mail postfix/qmgr[28042]: D4263420BB7B: removed
Mar 10 21:56:29 mail postfix/smtpd[28075]: disconnect from mail-yw0-f172.google.com[209.85.161.172]</pre>
<p style="text-align: justify;">Пояснять тут нечего, по логу все понятно. Письмо было доставлено в указанный ящик и в общий ящик для сбора всей входящей почты. В директории <em>/mnt/mail</em> была создана директория с именем домена zeroxzed.ru, а в ней созданы 3 папки с именами ящиков:</p>
<ul>
<li>all_in@zeroxzed.ru</li>
<li>all_out@zeroxzed.ru</li>
<li>root@zeroxzed.ru</li>
</ul>
<p style="text-align: justify;">Директории с почтовыми ящиками создаются в момент получения первого письма в ящик. Непрочитанное письмо помещается в директорию /new в почтовом ящике. После прочтения переносится в /cur.</p>
<p style="text-align: justify;">Попробуем теперь подключиться к почтовому ящику по imap, прочитать письмо и отправить ответ. Настроим любой почтовый клиент для проверки работы настроенного почтового сервера. Я для этих целей буду использовать Thunderbird. Из всех почтовых клиентов мне он нравится больше всего. В основном из-за его портированной версии. Указываем следующие настройки.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-11.png"><img class="aligncenter wp-image-5038 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-11.png" alt="Настройка подключения к почтовому серверу" width="848" height="469" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-11.png 848w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-11-300x166.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-11-768x425.png 768w" sizes="(max-width: 848px) 100vw, 848px" /></a></p>
<p>Так как мы используем самоподписанный сертификат ssl, почтовый клиент предупредит нас о том, что серверу нельзя доверять.</p>
<p><img class="aligncenter wp-image-5039 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-12.png" alt="Добавление ssl сертификата в исключения" width="528" height="533" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-12.png 528w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-12-150x150.png 150w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-12-297x300.png 297w" sizes="(max-width: 528px) 100vw, 528px" /></p>
<p style="text-align: justify;">Нас это не пугает, добавляем сертификат в список доверенных и продолжаем работать. Позже получим и настроим нормальный сертификат.</p>
<p style="text-align: justify;">Я подключился к почтовому ящику и увидел тестовые письма. Отвечу на одно из них и посмотрю в логе, как прошла отправка. У меня еще раз выскочило окно с предупреждением о небезопасном сертификате. Еще раз добавляю его в исключения. Это нормально, сертификат проверяется во время получения почты в dovecot, а во время отправки в postfix. Так что нужны 2 подтверждения. Отправляю письмо еще раз и смотрю лог.</p>
<pre># cat /var/log/maillog</pre>
<pre>Mar 10 22:10:12 mail postfix/smtpd[28764]: connect from broadband-75-37-235-139.moscow.gw.ru[75.37.235.139]
Mar 10 22:10:12 mail postfix/smtpd[28764]: Anonymous TLS connection established from broadband-75-37-235-139.moscow.gw.ru[75.37.235.139]: TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits)
Mar 10 22:10:12 mail postfix/smtpd[28764]: B24C2420BB70: client=broadband-75-37-235-139.moscow.gw.ru[75.37.235.139], sasl_method=PLAIN, sasl_username=root@zeroxzed.ru
Mar 10 22:10:12 mail postfix/cleanup[28779]: B24C2420BB70: message-id=&lt;aaac96c3-197e-c6bd-4dfe-85d09bce216a@zeroxzed.ru&gt;
Mar 10 22:10:12 mail postfix/qmgr[28042]: B24C2420BB70: from=&lt;root@zeroxzed.ru&gt;, size=955, nrcpt=2 (queue active)
Mar 10 22:10:12 mail postfix/smtpd[28764]: disconnect from broadband-75-37-235-139.moscow.gw.ru[75.37.235.139]
Mar 10 22:10:12 mail postfix/pipe[28784]: B24C2420BB70: to=&lt;all_out@zeroxzed.ru&gt;, relay=dovecot, delay=0.14, delays=0.07/0.01/0/0.06, dsn=2.0.0, status=sent (delivered via dovecot service)
Mar 10 22:10:13 mail postfix/smtp[28783]: B24C2420BB70: to=&lt;zeroxzed@gmail.com&gt;, relay=gmail-smtp-in.l.google.com[64.233.163.26]:25, delay=0.62, delays=0.07/0.01/0.28/0.26, dsn=2.0.0, status=sent (250 2.0.0 OK 1489173013 13si2106703ljv.3 - gsmtp)
Mar 10 22:10:13 mail postfix/qmgr[28042]: B24C2420BB70: removed
</pre>
<p style="text-align: justify;">Все в порядке. Видно подключение с моего ip, успешную sasl авторизацию, формирование письма на сервере, присваивание ему message-id, отправка копии письма в ящик для сбора исходящей почты и отправка оригинала в ящик получателя. Все этапы прошли без ошибок.</p>
<p style="text-align: justify;">Расскажу, куда еще надо смотреть для отладки почтовой системы. Да и не только отладки, во время работы периодически придется разбираться, куда ушло то или иное письмо, кто и когда подключался к ящику. Разные ситуации бывают. В файле <em>/var/log/dovecot/lda-deliver.log</em> содержится информация обо всех пришедших письмах &#8212; когда, от кого и в какой ящик было положено.</p>
<pre>Mar 10 22:25:29 lda(all_in@zeroxzed.ru): Info: mail from zeroxzed@gmail.com: msgid=&lt;CAHWPLcNG=WMOoWW2Y_Lw4qn9+V4TOrbxZpwtA=O+CSEBaiwuBg@mail.gmail.com&gt; saved mail to INBOX
Mar 10 22:25:29 lda(root@zeroxzed.ru): Info: mail from zeroxzed@gmail.com: msgid=&lt;CAHWPLcNG=WMOoWW2Y_Lw4qn9+V4TOrbxZpwtA=O+CSEBaiwuBg@mail.gmail.com&gt; saved mail to INBOX
Mar 10 22:25:49 lda(all_out@zeroxzed.ru): Info: mail from root@zeroxzed.ru: msgid=&lt;75358e4d-7c8e-24c2-a21f-7ee0df2a4704@zeroxzed.ru&gt; saved mail to INBOX</pre>
<p>В <em>/var/log/dovecot/info.log</em> информация о подключениях к почтовым ящикам &#8212; кто, когда, откуда и каким способом авторизовывался на сервере.</p>
<pre>Mar 10 22:10:20 imap-login: Info: Login: user=&lt;root@zeroxzed.ru&gt;, method=PLAIN, rip=75.37.235.139, lip=188.35.19.125, mpid=28790, TLS, session=&lt;3tDeHGVKpQBNJeCL&gt;
Mar 10 22:19:39 imap-login: Info: Login: user=&lt;root@zeroxzed.ru&gt;, method=PLAIN, rip=75.37.235.139, lip=188.35.19.125, mpid=29248, TLS, session=&lt;7VY8PmVKbwBNJeCL&gt;</pre>
<p>Остальное уже не так полезно. Сами посмотрите, что собирается в остальных лог файлах.</p>
<p style="text-align: justify;">На текущий момент сервер полностью работоспособен. В таком виде им без проблем можно пользоваться. Но функционал полностью не раскрыт. Использовать плагины sieve и acl через удаленные почтовые клиенты неудобно. Проще всего их настроить через web почту roundcube. Установим эту web панель на наш почтовый сервер.</p>
<h2><span id="_web_roundcube">Установка web интерфейса roundcube</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p>Установим и настроим самый популярный web интерфейс для postfix &#8212; roundcube. Скачиваем исходники.</p>
<pre># cd /usr/src
# wget https://github.com/roundcube/roundcubemail/releases/download/1.2.3/roundcubemail-1.2.3-complete.tar.gz</pre>
<div class="box info  "><div class="box-inner-block"><i class="fa tie-shortcode-boxicon"></i>
			Не забудьте проверить в момент установки, какая версия является самой свежей на текущий момент. Нет необходимости устанавливать устаревшую версию. Рекомендую ставить самую последнюю на момент настройки.
			</div></div>
<pre># tar -xzvf roundcubemail-*
# mv roundcubemail-1.2.3 /var/www/html/webmail
# chown -R apache. /var/www/html/webmail</pre>
<p style="text-align: justify;">Переходим в браузер по следующей ссылке для установки roundcube &#8212; <em>http://188.35.19.125/webmail/installer/</em>. Вы увидите несколько незначительных замечаний. На них можно не обращать внимание, если установщик позволяет нажать кнопку NEXT. Единственное, рекомендую установить правильный часовой пояс в <em>/etc/php.ini</em> и перезапустить после этого httpd.</p>
<p style="text-align: justify;">На следующем этапе нам надо указать настройки подключения к mysql базе. Предварительно ее следует создать через phpmyadmin. Я создал пользователя roundcube и такую же базу с полными правами пользователя на нее. Эти параметры указал в настройках.</p>
<p><img class="aligncenter wp-image-5040 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-13.png" alt="Установка roundcube" width="764" height="337" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-13.png 764w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-13-300x132.png 300w" sizes="(max-width: 764px) 100vw, 764px" /></p>
<p>Так же на этой странице нужно будет указать несколько параметров:</p>
<ul>
<li>smtp_server &#8212; пусто (ничего не пишем)</li>
<li>language &#8212; ru_RU</li>
<li>Выбираем плагины &#8212; managesieve, userinfo, acl. Остальные на свое усмотрение.</li>
</ul>
<p>Жмем CREATE CONFIG. Должны увидеть сообщение:</p>
<pre>The config file was saved successfully into <tt>RCMAIL_CONFIG_DIR</tt> directory of your Roundcube installation.</pre>
<p style="text-align: justify;">Жмем CONTINUE. Открывается страница с проверкой настроек. Тут проверять неудобно, можно этого не делать. Зайдем в почтовый ящик и там все проверим. Если что, конфиг потом все равно можно вручную отредактировать. Папку <em>/var/www/html/webmail/installer</em> удаляем. Заходим в почтовый ящик через roundcube &#8212; <em>http://188.35.19.125/webmail/</em> Набирать нужно полное имя ящика и пароль. Если все сделали правильно, должны попасть в свой почтовый ящик.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-14.png"><img class="aligncenter wp-image-5041 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-14.png" alt="Вход в почтовый ящик через roundcube" width="1864" height="468" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-14.png 1864w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-14-300x75.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-14-768x193.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-14-1024x257.png 1024w" sizes="(max-width: 1864px) 100vw, 1864px" /></a></p>
<p style="text-align: justify;">Ну вот и все. Можно пользоваться web интерфейсом для почтового сервера. У меня есть статья по настройке <a href="https://serveradmin.ru/mobilnaya-versiya-roundcube/" target="_blank" rel="noopener">мобильной версии roundcube</a>. Рекомендую ее настроить, если есть необходимость. Тема качественная и добротная. Пользоваться удобно.</p>
<p>Дальше рассмотрим настройку и использование плагинов acl и sieve с помощью roundcube.</p>
<h2><span id="__sieve">Настройка фильтра почты sieve</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Sieve очень удобная штука, но вот хорошего интерфейса для управления через почтовый клиент я не знаю. Существует плагин для thunderbird, который так и называется sieve. Но лично мне он не понравился вообще, так как предлагает писать правила определенным кодом. Для этого надо знать синтаксис, тратить время. Можете сами на него посмотреть &#8212; <a href="https://github.com/thsmi/sieve" target="_blank" rel="noopener">https://github.com/thsmi/sieve</a>.</p>
<p style="text-align: justify;">К счастью, есть удобный способ писать правила фильтрации для sieve через roundcube. Там это реализовано отдельным плагином <strong>managesieve</strong>, который мы активировали во время установки. Для создания правила фильтрации, зайдите в свой почтовый ящик через roundcube. Переходите в раздел <span class="highlight highlight-blue">Настройки -&gt; Фильтры</span> и создавайте новое правило.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-15.png"><img class="aligncenter wp-image-5042 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-15.png" alt="Настройка фильтра почты в roundcube" width="1413" height="672" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-15.png 1413w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-15-300x143.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-15-768x365.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-15-1024x487.png 1024w" sizes="(max-width: 1413px) 100vw, 1413px" /></a></p>
<p style="text-align: justify;">После этого письма будут обрабатываться правилом сразу после поступления в почтовый сервер, в независимости от вашего подключения к ящику. В папке <em>/mnt/mail/sieve</em> появилась запись с настроенным правилом. Можете познакомиться с синтаксисом написания правил. Он не сложный.</p>
<h2><span id="i-3">Настройка автоответчика</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">В roundcube есть замечательная возможность настроить автоответчик в почтовом ящике. Это актуально, к примеру, если вы уходите в отпуск. Вы можете сами настроить автоответчик, который будет отправлять письмо с указанной вами информацией всем, от кого будут приходить письма в ваш ящик. Возможность эта реализована на базе того же плагина managesieve. По-умолчанию она отключена. Активировать ее нужно вручную.</p>
<p style="text-align: justify;">Для того, чтобы модуль автоответчика заработал, отредактируйте конфигурационный файл плагина. Для этого открываем его в моем случае по следующему адресу:</p>
<pre># mcedit /var/www/html/webmail/plugins/managesieve/config.inc.php</pre>
<p>Изменяем там параметр:</p>
<pre>$config['managesieve_vacation'] = 1;</pre>
<p style="text-align: justify;">После этого достаточно просто обновить веб интерфейс roundcube, и появятся новые настройки по адресу <span class="highlight highlight-blue">Настройки -&gt; Отпуск</span>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-16.png"><img class="aligncenter wp-image-5043 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-16.png" alt="Настройка автоответчика" width="1416" height="678" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-16.png 1416w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-16-300x144.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-16-768x368.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-16-1024x490.png 1024w" sizes="(max-width: 1416px) 100vw, 1416px" /></a></p>
<p style="text-align: justify;">На вкладке <span style="color: #808080;">Дополнительные настройки</span> есть возможность настроить различные полезные действия, в том числе пересылку входящей почты вашему заместителю.</p>
<h2><span id="__imap">Общие папки по imap</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Рассмотрим настройку необычного и полезного функционала в виде общих папок. С их помощью один пользователь почтового ящика может предоставить другому пользователю доступ к папке внутри своего почтового ящика. Где и как использовать этот функционал, каждый может придумать сам, в зависимости от своих потребностей. Мне кажется это удобным в том случае, когда создан какой-то общий ящик, на который только поступает информация и нет необходимости писать ответ от его имени. То есть по сути работает как обычный почтовый алиас. Но в случае с алиасом и несколькими почтовыми ящиками, письмо падает в каждый ящик. Если таких писем и получателей много, то идет большое дублирование одного и того же письма в рамках почтового сервера. Если сделать ящик и расшарить на нем папку, подключить ее всем пользователям, то дублирования почты не будет. Каждый сможет прочитать письмо, без необходимости его доставки в каждый конкретный ящик.</p>
<p style="text-align: justify;">Настроим общую папку imap. Хотя настраивать нам, по сути, нечего. Мы уже все настроили ранее. Добавили соответствующие настройки в dovecot и активировали плагин <strong>acl</strong> в roundcube. Теперь нужно просто сделать папку и открыть ее для другого пользователя. Для этого идем в раздел <span class="highlight highlight-blue">Настройки -&gt; Папки</span>. Создаем там любую папку. В моем случае это папка с названием Общая.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-17.png"><img class="aligncenter wp-image-5044 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-17.png" alt="Настройка общей папки imap" width="1412" height="874" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-17.png 1412w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-17-300x186.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-17-768x475.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-17-1024x634.png 1024w" sizes="(max-width: 1412px) 100vw, 1412px" /></a></p>
<p>Добавляем необходимый доступ либо всем ящикам в домене, либо какому-то конкретному. Так же можно указать, какого рода это будет доступ:</p>
<ul>
<li>чтение</li>
<li>запись</li>
<li>удаление</li>
</ul>
<p><img class="aligncenter wp-image-5045 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-18.png" alt="Права доступа на общую папку imap" width="548" height="449" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-18.png 548w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-18-300x246.png 300w" sizes="(max-width: 548px) 100vw, 548px" /></p>
<p>Заходим в ящик, которому добавили общий доступ и проверяем.</p>
<p><img class="aligncenter wp-image-5046 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-19.png" alt="Проверка общей папки" width="557" height="389" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-19.png 557w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-19-300x210.png 300w" sizes="(max-width: 557px) 100vw, 557px" /></p>
<p>Все в порядке, общая папка imap настроена и подключена. В папке <em>/mnt/mail/shared-folders</em> появился файл с настроенным выше правилом.</p>
<p style="text-align: justify;">На этом настройка пользовательского функционала закончена. В принципе, почтовый сервер полностью готов к работе. Но мы сделаем еще несколько полезных настроек на стороне сервера.</p>
<h2><span id="_dkim_spf">Настройка dkim и spf</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Напишу своими словами как я понимаю работу <strong>dkim</strong>. С помощью dkim вся исходящая почта сервера подписывается электронной цифровой подписью, связанной с именем домена. Открытый ключ шифрования с помощью DNS публикуется в txt записи. Таким образом, удаленный сервер, при получении письма от вас, сравнивает цифровую подпись с опубликованным в dns открытым ключом вашего домена. Если все в порядке, то считает, что ваше письмо в самом деле пришло от вас, а не от мошенников. То есть с помощью этой технологии можно однозначно идентифицировать отправителя.</p>
<p>Некоторые считают, что эта технология помогает бороться со спамом. Не знаю, насколько это верно. Спамеру не составит большого труда настроить на своем сервере dkim и отправлять спам, но подписанный электронной цифровой подписью. Теоретически, dkim помогает защититься от подделки адреса отправителя, когда письмо якобы от вас шлет совсем другой сервер. Но с этим можно бороться и другими способами. В общем, я до конца не понимаю, зачем это надо. Прошу поделиться в комментариях тем, к кого есть бОльший опыт. Я только недавно стал шагать в ногу со временем и настраивать dkim. Раньше всегда без него обходился.</p>
<div class="box info  "><div class="box-inner-block"><i class="fa tie-shortcode-boxicon"></i>
			Плюс настройки dkim я вижу только в том, что автоматические фильтры определения спама будут добавлять больше траста письмам с корректной dkim подписью. У вас будет больше шанса не попасть в спам при прочих равных условиях. В принципе, ради этого можно немного заморочиться.
			</div></div>
<p>Для настройки dkim устанавливаем соответствующий пакет:</p>
<pre># yum install opendkim</pre>
<p>Создаем директорию для хранения ключей:</p>
<pre># mkdir -p /etc/postfix/dkim &amp;&amp; cd /etc/postfix/dkim</pre>
<p>Генерируем ключи для домена:</p>
<pre># opendkim-genkey -D /etc/postfix/dkim/ -d zeroxzed.ru -s mail</pre>
<table>
<tbody>
<tr>
<td>zeroxzed.ru</td>
<td>имя почтового домена</td>
</tr>
<tr>
<td>mail</td>
<td>непосредственно имя сервера</td>
</tr>
</tbody>
</table>
<p style="text-align: justify;">На выходе получаете пару файлов &#8212; закрытый (приватный) и открытый ключ. Закрытый останется на сервере, открытый будет опубликован в dns. Переименуем их сразу, чтобы не путаться, если у вас будет несколько доменов. Ключи нужно будет делать для каждого домена.</p>
<pre># mv mail.private mail.zeroxzed.ru.private
# mv mail.txt mail.zeroxzed.ru.txt</pre>
<p>Создаем файл с таблицей ключей, в которой будут описаны все домены. В данном случае только один.</p>
<pre># mcedit keytable</pre>
<pre>mail._domainkey.zeroxzed.ru zeroxzed.ru:mail:/etc/postfix/dkim/mail.zeroxzed.ru.private</pre>
<p style="text-align: justify;">Тут же создаем еще один файл, в котором будет описано, каким ключом подписывать письма каждого домена. У нас один домен, поэтому только одна запись.</p>
<pre># mcedit signingtable</pre>
<pre>*@zeroxzed.ru mail._domainkey.zeroxzed.ru</pre>
<p>Выставляем права доступа на все файлы:</p>
<pre># chown root:opendkim *
# chmod u=rw,g=r,o= *</pre>
<p>Рисуем конфиг службы.</p>
<pre># mcedit /etc/opendkim.conf</pre>
<pre>AutoRestart Yes
AutoRestartRate 10/1h
PidFile /var/run/opendkim/opendkim.pid
Mode sv
Syslog yes
SyslogSuccess yes
LogWhy yes
UserID opendkim:opendkim
Socket inet:8891@localhost
Umask 022
Canonicalization relaxed/relaxed
Selector default
MinimumKeyBits 1024
KeyFile /etc/postfix/dkim/mail.zeroxzed.ru.private
KeyTable /etc/postfix/dkim/keytable
SigningTable refile:/etc/postfix/dkim/signingtable</pre>
<p>Добавляем в конфигурационный файл postfix в самый конец следующие параметры:</p>
<pre># mcedit /etc/postfix/main.cf</pre>
<pre>smtpd_milters = inet:127.0.0.1:8891
non_smtpd_milters = $smtpd_milters
milter_default_action = accept
milter_protocol = 2</pre>
<p>Перезапускаем postfix и dkim, последний добавляем в автозагрузку.</p>
<pre># systemctl restart postfix
# systemctl restart opendkim.service
# systemctl enable opendkim.service</pre>
<p style="text-align: justify;">Теперь нам надо добавить открытый ключ в dns. Идем в консоль управления dns и добавляем новую txt запись. Ее содержание берем из файла <em>/etc/postfix/dkim/mail.zeroxzed.ru.txt</em></p>
<pre>cat /etc/postfix/dkim/mail.zeroxzed.ru.txt</pre>
<pre>mail._domainkey IN TXT ( "v=DKIM1; k=rsa; "
 "p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQClZX2xWRDISlVLF4b4pUiinY5N9WN7VXEHeyPw8smHTamXh35wJoh+j0+MIQDWG/KtdCcETeawTuypXbvtbneXniYR0iiv6kt754T2WXBjz7O/uHL+vK58LhJsm4TGyhUN6ZBit+w22jG92zdeybSZeU/g7hQdkaAAi0I+0nIkUwIDAQAB" ) ; ----- DKIM key mail for zeroxzed.ru</pre>
<p>Убираем кавычки, лишние проблемы и вставляем. Должно получиться вот так:</p>
<p><img class="aligncenter wp-image-5047 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-20.png" alt="Настройка dkim записи в dns" width="857" height="233" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-20.png 857w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-20-300x82.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-20-768x209.png 768w" sizes="(max-width: 857px) 100vw, 857px" /></p>
<p>Проверяю работу. Отправляю письмо на gmail и смотрю лог почтового сервера:</p>
<pre># cat /var/log/maillog</pre>
<pre>Mar 17 17:40:26 mail postfix/smtpd[22352]: connect from localhost[127.0.0.1]
Mar 17 17:40:26 mail postfix/smtpd[22352]: BB1794195584: client=localhost[127.0.0.1]
Mar 17 17:40:26 mail postfix/cleanup[22364]: BB1794195584: message-id=&lt;baf63dcec016594d49f2d80f815e5d26@zeroxzed.ru&gt;
Mar 17 17:40:26 mail opendkim[21744]: BB1794195584: <strong>DKIM-Signature field added (s=mail, d=zeroxzed.ru)</strong>
Mar 17 17:40:26 mail postfix/qmgr[21990]: BB1794195584: from=&lt;root@zeroxzed.ru&gt;, size=593, nrcpt=2 (queue active)
Mar 17 17:40:26 mail postfix/pipe[22369]: BB1794195584: to=&lt;all_out@zeroxzed.ru&gt;, relay=dovecot, delay=0.14, delays=0.11/0.02/0/0.02, dsn=2.0.0, status=sent (delivered via dovecot service)
Mar 17 17:40:26 mail postfix/smtpd[22352]: disconnect from localhost[127.0.0.1]
Mar 17 17:40:27 mail postfix/smtp[22370]: BB1794195584: to=&lt;zeroxzed@gmail.com&gt;, relay=gmail-smtp-in.l.google.com[64.233.163.26]:25, delay=0.84, delays=0.11/0.02/0.31/0.4, dsn=2.0.0, status=sent (250 2.0.0 OK 1489761627 185si4568435lfa.398 - gsmtp)</pre>
<p>Все в порядке, электронная цифровая подпись установлена. Проверим, как гугл отреагировал на нашу подпись:</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-21.png"><img class="aligncenter wp-image-5048 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-21.png" alt="Проверка dkim" width="1086" height="395" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-21.png 1086w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-21-300x109.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-21-768x279.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-21-1024x372.png 1024w" sizes="(max-width: 1086px) 100vw, 1086px" /></a></p>
<p style="text-align: justify;">Тоже все в порядке. Подпись выполнена корректно, проверку прошла. Дополнительно, проверить корректность dkim записи в dns можно онлайн сервисом &#8212; <a href="http://dkimcore.org/c/keycheck" target="_blank" rel="noopener">http://dkimcore.org/c/keycheck</a>.</p>
<p style="text-align: justify;">Настроим еще одно средство для повышения доверия к нашей почте со стороны других серверов &#8212; <strong>spf</strong>. Расскажу опять своими словами для чего это нужно. Spf запись добавляется в виде txt записи в dns вашего домена. С помощью этой записи вы указываете, какие ip адреса имеют право отправлять почту от вашего имени. Если кто-то из спамеров будет использовать ваше имя домена при рассылке спама, он не пройдет проверку по spf и скорее всего будет идентифицирован как спам.</p>
<p style="text-align: justify;">Можно указать конкретные ip адреса в записи, а можно сказать, чтобы ip адреса проверялись по спискам A и MX записей. У нас простой случай и только 1 сервер с одним ip, поэтому укажем конкретно этот ip адрес. Идем в панель управления dns и добавляем новую txt запись.</p>
<pre>zeroxzed.ru. TXT v=spf1 ip4:188.35.19.125 ~all</pre>
<p><img class="aligncenter wp-image-5049 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-22.png" alt="Добавление spf записи в dns" width="862" height="59" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-22.png 862w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-22-300x21.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-22-768x53.png 768w" sizes="(max-width: 862px) 100vw, 862px" /></p>
<p>Больше ничего делать не надо. Снова отправляем письмо на gmail и смотрим логи.</p>
<p><a href="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-23.png"><img class="aligncenter wp-image-5050 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-23.png" alt="Проверка spf записи" width="1513" height="398" srcset="https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-23.png 1513w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-23-300x79.png 300w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-23-768x202.png 768w, https://serveradmin.ru/wp-content/uploads/2017/03/centos-postfix-mail-server-23-1024x269.png 1024w" sizes="(max-width: 1513px) 100vw, 1513px" /></a></p>
<p style="text-align: justify;">Обращаю внимание на прошлый скрин, когда мы проверяли dkim и еще не настроили spf, и этот. Видно, что запись работает, гугл определил наш ip, как доверенный для отправки писем с этого домена.</p>
<h2><span id="__postfix">Дополнительный функционал почтового сервера postfix</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Я рассмотрел и настроил наиболее актуальный с моей точки зрения функционал почтового сервера. В статье я основывался исключительно на своем опыте работы с почтой в малых и средних организациях, поэтому не претендую на истину в последней инстанции. Рекомендую осмысленно подходить к настройке своего сервера и решать, что нужно именно вам. Будет хорошо, если кто-то укажет на мои ошибки или подскажет какие-то более удобные и эффективные приемы для решения затронутых задач.</p>
<p style="text-align: justify;">В данном виде почтовый сервер представляет собой готовое и законченное решение, но есть еще несколько вещей, которые ему бы не помешали. Я их сейчас перечислю, а затем постараюсь постепенно писать статьи на указанные темы и ставить на них ссылки в этой теме. Вот список того, что по моему мнению нужно еще настроить на почтовом сервере:</p>
<ol>
<li>Защиту от подбора паролей с помощью fail2ban.</li>
<li><a href="https://serveradmin.ru/monitoring-postfix-v-zabbix/" target="_blank" rel="noopener">Мониторинг почтового сервера postfix с помощью zabbix</a>.</li>
<li>Сбор статистики с помощью pflogsumm или чего-то подобного.</li>
<li>Просмотр и анализ логов с помощью <a href="https://serveradmin.ru/ustanovka-webmin-na-centos-7/" target="_blank" rel="noopener">webmin</a>.</li>
<li>Использование бесплатных сертификатов let&#8217;s encrypt.</li>
<li><a href="https://serveradmin.ru/ochistka-i-obsluzhivanie-pochtovoy-bazyi-postfix/" target="_blank" rel="noopener">Регулярную очистку служебных почтовых ящиков</a>.</li>
<li>Бэкап всей почтовой базы.</li>
</ol>
<p>Расскажу еще почему я не настраиваю некоторые популярные программы, которые использую на почтовых серверах:</p>
<ol>
<li style="text-align: justify;">Clamav &#8212; известный антивирус. Считаю, что сейчас он не актуален, так как вирусов, от которых он способен защитить, я уже давно не видел. Сейчас вирусная эпидемия шифровальщиков. От них он не защищает.</li>
<li style="text-align: justify;">Spamassasin &#8212; популярный бесплатный антиспам фильтр. Скажу честно, работал с ним очень мало и могу быть не объективен. Насколько я видел его настройку и работу &#8212; он требует к себе некоторого внимания, калибровки, особенно на начальном этапе. Мне обычно не хочется этим заниматься.</li>
<li style="text-align: justify;">Graylist &#8212; эффективное средство борьбы со спамом. Я уже подробно его рассматривал, когда писал про <a href="https://serveradmin.ru/ustanovka-i-nastroyka-iredmail/#Graylist" target="_blank" rel="noopener">iredmail</a>, так что не буду повторяться. Скажу лишь, что режет спам очень эффективно и бесплатно, но есть существенные неудобства, которые по моему мнению не перекрывают плюсы. Поэтому я не использую.</li>
</ol>
<p style="text-align: justify;">В качестве антиспама я предпочитаю коммерческое решение &#8212; Kaspersky Anti-Spam. Я знаю этот продукт уже лет 8. Он действительно отлично фильтрует спам. Ложных срабатываний вообще не припоминаю, 95% спама фильтрует, может больше. С ним вопрос спама отпадает вообще. Стоит он недорого, можно купить лицензию на меньшее количество ящиков, чем реально используется в системе. Этот вопрос никак не отслеживается и на качество работы не влияет. Но нужно понимать, что это уже нарушение лицензионного соглашения. Но можно всякие хитрости придумать, чтобы и фильтровать и не нарушать.</p>
<h2 style="text-align: justify;"><span id="__postfix-2">Борьба со спамом средствами postfix</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Сначала хотел сразу все настройки postfix разместить в соответствующем разделе в едином конфиге, но потом передумал и решил все же вынести этот вопрос на отдельное рассмотрение. Возможно, не каждому захочется сразу в эту тему углубляться. Все, что рассказано выше, позволит настроить полноценный почтовый сервер, который будет успешно принимать почту и доставлять ее пользователям. Но в таком виде он будет принимать слишком много спама, но зато не будет проблем с тем, что от кого-то что-то не придет. Как ни крути, но все средства борьбы со спамом так или иначе несут накладные расходы в виде ложных срабатываний с той или иной вероятностью. Если вы решите не заморачиваться и купить Kaspersky Anti-Spam, можете этот раздел не читать. Он сам реализует все те проверки, что мы будем делать. Если же хотите своими силами бороться со спамом средствами postfix, то давайте дальше разбираться.</p>
<p style="text-align: justify;">Я буду использовать штатные возможности postfix, позволяющие отсеять спам по тем или иным параметрам еще до получения письма. Это очень эффективный способ с точки зрения производительности. Благодаря этому, правильно настроенный на отсев спама postfix часто ставят перед exchange, чтобы снизить на него нагрузку. Сразу дам ссылки на официальную документацию с описанием параметров, которые я буду использовать:</p>
<ol>
<li style="text-align: justify;"><a href="http://www.postfix.org/postconf.5.html#smtpd_helo_restrictions" target="_blank" rel="noopener">smtpd_helo_restrictions</a></li>
<li style="text-align: justify;"><a href="http://www.postfix.org/postconf.5.html#smtpd_sender_restrictions" target="_blank" rel="noopener">smtpd_sender_restrictions</a></li>
<li style="text-align: justify;"><a href="http://www.postfix.org/postconf.5.html#smtpd_recipient_restrictions" target="_blank" rel="noopener">smtpd_recipient_restrictions</a></li>
<li style="text-align: justify;"><a href="http://www.postfix.org/postconf.5.html#smtpd_data_restrictions" target="_blank" rel="noopener">smtpd_data_restrictions</a></li>
<li style="text-align: justify;"><a href="http://www.postfix.org/postconf.5.html#smtpd_client_restrictions" target="_blank" rel="noopener">smtpd_client_restrictions</a></li>
</ol>
<p>Есть еще парочка &#8212; smtpd_etrn_restrictions и smtpd_end_of_data_restrictions, но я ими не пользуюсь.</p>
<p style="text-align: justify;"><div class="box warning  "><div class="box-inner-block"><i class="fa tie-shortcode-boxicon"></i>
			Обращаю внимание на то, что нужно очень аккуратно работать с настройками, о которых пойдет речь. Нужно четко понимать как, зачем и что вы делаете. Неверные настройки могут нарушить нормальное хождение почты. Нужно уметь анализировать лог файл почтового сервера и понимать, что там происходит. 
			</div></div>
<p style="text-align: justify;">Долго думал, как лучше всего представить информацию по этому разделу. В итоге решил просто написать часть конфига, которая отвечает за restrictions с комментариями. Более подробную информацию по каждой настройке вы можете найти в официальной документации postfix, ссылки я привел выше, либо в гугле. Данные настройки это моя многолетняя калькуляция различных параметров, собранных из черновиков и рабочих серверов. Не везде все было настроено именно в таком виде, так как ситуации бывают разные. Сейчас я постарался все собрать в одном месте и аккуратно описать. Те проверки в борьбе со спамом, что вам не нужны, просто закомментируйте. В конце я еще пройдусь по некоторым из них и поделюсь своим опытом.</p>
<pre>#Описание списков исключений
smtpd_restriction_classes = white_client_ip,
                            black_client_ip,
                            block_dsl,
                            white_client,
                            white_helo,
                            black_client,
                            mx_access

# IP адреса, которые нужно пропускать всегда
white_client_ip		= check_client_access hash:/etc/postfix/lists/white_client_ip

# IP адреса, которые нужно блокировать всегда
black_client_ip		= check_client_access hash:/etc/postfix/lists/black_client_ip

# E-mail, которые нужно пропускать всегда
white_client		= check_sender_access hash:/etc/postfix/lists/white_client

# E-mail, которые нужно блокировать всегда
black_client		= check_sender_access hash:/etc/postfix/lists/black_client

# Неправильные значения HELO, которые мы тем не менее принимаем
white_helo = check_sender_access hash:/etc/postfix/lists/white_helo
# Правила для блокировки различных динамических ip.
block_dsl 		= check_client_access regexp:/etc/postfix/lists/block_dsl

# Список приватных сетей, которые не могут быть использованы в качестве IP для MX записей
mx_access		= check_sender_mx_access cidr:/etc/postfix/lists/mx_access

# Проверки на основе данных, переданных в HELO/EHLO hostname
smtpd_helo_restrictions =	permit_mynetworks,
		permit_sasl_authenticated,
		white_client_ip,
                white_helo,
		black_client_ip,
		block_dsl,
		# Отказываем серверам, у которых в HELO несуществующий или не FQDN адрес 
		reject_invalid_helo_hostname,
		reject_non_fqdn_helo_hostname,
		# Запрещаем приём писем от серверов, представляющихся адресом, для которого не существует A или MX записи.
		reject_unknown_helo_hostname

# Проверки клиентского компьютера или другого почтового сервера, который соединяется с сервером postfix для отправки письма
smtpd_client_restrictions = 	permit_mynetworks,
		permit_sasl_authenticated,
		# Отвергает запрос, когда клиент отправляет команды SMTP раньше времени, еще не зная, поддерживает ли Postfix конвейерную обработку команд ESMTP
		reject_unauth_pipelining,
		# Блокируем клиентов с адресами from, домены которых не имеют A/MX записей
		reject_unknown_address,
		reject_unknown_client_hostname

# Проверки исходящей или пересылаемой через нас почты на основе данных MAIL FROM
smtpd_sender_restrictions =	permit_mynetworks,
		permit_sasl_authenticated,
		white_client,
		black_client,
		# Запрет отправки писем, когда адрес MAIL FROM не совпадает с логином пользователя
		reject_authenticated_sender_login_mismatch,
		# Отклоняем письма от несуществующих доменов
		reject_unknown_sender_domain,
		# Отклоняем письма от доменов в не FQDN формате
		reject_non_fqdn_sender,
		# Отклонение писем с несуществующим адресом отправителя
		reject_unlisted_sender,
		reject_unauth_destination,
		# Отклонять сообщения от отправителей, ящики которых не существуют, использовать аккуратно
		#reject_unverified_sender,
		mx_access

# Правила приема почты нашим сервером на основе данных RCPT TO
smtpd_recipient_restrictions =  permit_mynetworks,
		permit_sasl_authenticated,
		# Отклоняет всю почту, что адресована не для наших доменов
		reject_unauth_destination,
		# Отклонение писем с несуществующим адресом получателя
		reject_unlisted_recipient,
		# Отклоняет сообщения на несуществующие домены
		reject_unknown_recipient_domain,
		# Отклоняет сообщения если получатель не в формате FQDN
		reject_non_fqdn_recipient,
		# Отклоняем прием от отправителя с пустым адресом письма, предназначенным нескольким получателям.
		reject_multi_recipient_bounce
</pre>
<p style="text-align: justify;">У меня во всех ограничениях первыми правилами стоят разрешения для mynetworks и авторизовавшихся пользователей. Важно понимать, что это значит и для чего сделано. Ограничения читаются последовательно в порядке их перечисления. Таким образом, мы своих пользователей пускаем мимо ограничений, а для всех остальных выполняются проверки.</p>
<p style="text-align: justify;">Теперь важные комментарии по указанным параметрам. Если бы все почтовые сервера всех системных администраторов были настроены по правилам, то эти комментарии не были бы нужны. Пройдемся по некоторым ограничениям, которые нужно включать осторожно:</p>
<ul>
<li style="text-align: justify;">reject_invalid_helo_hostname и reject_unknown_helo_hostname &#8212; под эти правила иногда попадают почтовые серверы клиентов, которые не очень хорошо настроены. У них бывают неправильные адреса, кривые записи dns, отсутствие обратных зон и т.д. Их не много, но попадаются. Это не страшно, если вы регулярно следите за сервером. Отправитель получит сразу сообщение о том, что его письмо не дошло до вас. Если он как-то сообщит вам о проблеме, вы легко добавите его в белый список и все будет нормально. Если вам не хочется следить за сервером, лучше не указывайте эти ограничения. Но спам они отсекают не плохо. Сюда попадают все завирусованные компьютеры и сервера без нормальных настроек dns (а их чаще всего и нет).</li>
<li style="text-align: justify;">reject_unverified_sender &#8212; специально его закомментировал. Я тестировал этот параметр. В принципе, работает нормально, но есть, как обычно, нюансы. Поясню, что делает этот параметр. Когда вам кто-то шлет письмо, ваш сервер обращается к серверу отправителю и спрашивает его стандатрной командой, есть ли на сервере такой отправитель. Если удаленный сервер отвечает, что есть, то никаких проблем &#8212; письмо принимается. Если удаленный сервер не отвечает или говорит, что такого адресата нет &#8212; письмо отклоняем. Очевидно, что такие проверки создают дополнительную постоянную нагрузку. Это нужно учитывать. К тому же, у вас почтовый лог постоянно будет забит этими проверками, особенно, если вам приходит много спама. На каждое спамовое письмо будет идти проверка, а сервера отправителя скорее всего либо нет, либо он неправильный, либо не отвечает и т.д. Все это будет постоянно проверяться и фиксироваться. В общем, я не использую.</li>
</ul>
<p>На время отладки ограничений, рекомендую пользоваться параметром:</p>
<pre>soft_bounce = yes</pre>
<p style="text-align: justify;">Когда он включен, все ответы сервера с кодами ошибок 5XX, заменяются на 4ХХ. То есть постоянная ошибка, которая сразу отклоняет письмо, заменяется на временную, которая предлагает повторить отправку позже. Таким образом, вы увидите работу всех ограничений, но письма не будут отклонены навсегда. Сервер отправителя через некоторое время снова придет к вам с новой попыткой доставки почты. Письмо безвозвратно не отклоняется. Вы можете проанализировать работу фильтра и решить, ставить его на постоянную работу или с ним что-то не так.</p>
<p>Создадим теперь файлы с белыми и черными списками.</p>
<pre>cd /etc/postfix/lists &amp;&amp; touch white_client_ip black_client_ip white_client black_client white_helo block_dsl mx_access</pre>
<p>Ниже пример содержания этих файлов. Вы можете менять по своему усмотрению.</p>
<pre># cat white_client_ip
195.28.34.162 OK
141.197.4.160 OK</pre>
<pre># cat black_client_ip
205.201.130.163 REJECT You IP are blacklisted!
198.2.129.162 REJECT You IP are blacklisted!</pre>
<pre># cat white_client
# Принимать всю почту с домена яндекс
yandex.ru OK
# Разрешить конкретный ящик
spammer@mail.ru OK</pre>
<pre># cat black_client
# Блокировать всю почту с домена mail.ru
mail.ru REJECT You domain are blacklisted!
# Блокировать конкретный ящик
spam@rambler.ru REJECT You e-mail are blacklisted!</pre>
<pre># cat white_helo
# Могут попадаться вот такие адреса, которые не пройдут наши проверки
ka-s-ex01.itk.local     OK
exchange.elcom.local    OK</pre>
<pre># cat block_dsl
/^dsl.*\..*\..*/i                               553 AUTO_DSL spam
/dsl.*\..*\..*/i                                553 AUTO_DSL1 spam
/[ax]dsl.*\..*\..*/i                            553 AUTO_XDSL spam
/client.*\..*\..*/i                             553 AUTO_CLIENT spam
/cable.*\..*\..*/i                              553 AUTO_CABLE spam
/pool.*\..*\..*/i                               553 AUTO_POOL spam
/dial.*\..*\..*/i                               553 AUTO_DIAL spam
/ppp.*\..*\..*/i                                553 AUTO_PPP spam
/dslam.*\..*\..*/i                              553 AUTO_DSLAM spam
/node.*\..*\..*/i                               553 AUTO_NODE spam
/([0-9]*-){3}[0-9]*(\..*){2,}/i                 553 SPAM_ip-add-rr-ess_networks
/([0-9]*\.){4}(.*\.){3,}.*/i                    553 SPAM_ip-add-rr-ess_networks
/.*\.pppool\..*/i                               553 SPAM_POOL
/[0-9]*-[0-9]*-[0-9]*-[0-9]*-tami\.tami\.pl/i   553 SPAM_POOL
/pool-[0-9]*-[0-9]*-[0-9]*-[0-9]*\..*/i         553 SPAM_POOL
/.*-[0-9]*-[0-9]*-[0-9]*-[0-9]*\.gtel.net.mx/i  553 SPAM_POOL
/dhcp.*\..*\..*/i                               553 SPAM_DHCP
</pre>
<pre># cat mx_access
127.0.0.1      DUNNO 
127.0.0.2      550 Domains not registered properly
0.0.0.0/8      REJECT Domain MX in broadcast network 
10.0.0.0/8     REJECT Domain MX in RFC 1918 private network 
127.0.0.0/8    REJECT Domain MX in loopback network 
169.254.0.0/16 REJECT Domain MX in link local network 
172.16.0.0/12  REJECT Domain MX in RFC 1918 private network 
192.0.2.0/24   REJECT Domain MX in TEST-NET network 
192.168.0.0/16 REJECT Domain MX in RFC 1918 private network 
224.0.0.0/4    REJECT Domain MX in class D multicast network 
240.0.0.0/5    REJECT Domain MX in class E reserved network 
248.0.0.0/5    REJECT Domain MX in reserved network</pre>
<p style="text-align: justify;">По сути файлы белых и черных списков не отличаются друг от друга. Можно использовать только один файл и в нем в каждой отдельной строке указывать либо запрет, либо разрешение. Я разделил просто для удобства восприятия и редактирования. Возможно вам будет удобнее с одним файлом.</p>
<p>После редактирования файлов обязательно выполняем команду на перестроение базы данных. Я перестрою сразу все файлы:</p>
<pre>cd /etc/postfix/lists &amp;&amp; postmap white_client_ip black_client_ip white_client black_client white_helo block_dsl mx_access</pre>
<p style="text-align: justify;">Еще упомяну о таком популярном явлении в спамерских письмах, как подделка адреса отправителя. Причем не просто подделка на абы кого, а именно на ваше имя домена. Пользователь получает спам письмо и в почтовом клиенте видит, что оно отправлено с вашего домена. Только по заголовкам можно определить реального отправителя. Такой подход позволяет обходить некоторые антиспам системы, которые не фильтруют письма внутреннего домена. Бороться с подменой адреса отправителя в нашем случае очень просто. Для этого в black_client добавим следующую запись:</p>
<pre>zeroxzed.ru 554 Stop spam from my name</pre>
<p style="text-align: justify;">Отправка с нашего домена осуществляется только с SASL авторизацией, а она во всех ограничениях стоит первой, поэтому письма реальных пользователей без проблем будут уходить. А всех тех, кто только притворяется нашим доменом, мы будет отфильтровывать этим правилом.</p>
<p>Приведу в завершении описания методов борьбы со спамом простой пример. Добавим в black_client почтовый адрес и отправим с него письмо.</p>
<pre># cat black_client
zeroxzed@gmail.com REJECT Your e-mail was banned!</pre>
<pre># postmap black_client</pre>
<p>Отправляем сообщение и проверяем почтовый лог.</p>
<pre># cat /var/log/maillog</pre>
<pre>Mar 20 02:21:34 mail postfix/smtpd[10816]: connect from mail-yw0-f177.google.com[209.85.161.177]
Mar 20 02:21:35 mail postfix/smtpd[10816]: Anonymous TLS connection established from mail-yw0-f177.google.com[209.85.161.177]: TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits)
Mar 20 02:21:35 mail postfix/smtpd[10816]: NOQUEUE: reject: RCPT from mail-yw0-f177.google.com[209.85.161.177]: 554 5.7.1 &lt;zeroxzed@gmail.com&gt;: <strong>Sender address rejected: Your e-mail was banned!</strong>; from=&lt;zeroxzed@gmail.com&gt; to=&lt;root@zeroxzed.ru&gt; proto=ESMTP helo=
Mar 20 02:21:35 mail postfix/smtpd[10816]: disconnect from mail-yw0-f177.google.com[209.85.161.177]</pre>
<p>Вот и результат. На этом по борьбе со спамом все.</p>
<h2><span id="i-4">Заключение</span></h2><p style="text-align: center;"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Статьи -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1310661631569687"
     data-ad-slot="3326828851"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<p style="text-align: justify;">Проверить настроенный почтовый сервер можно с помощью онлайн сервиса <a href="https://www.mail-tester.com" target="_blank" rel="noopener">https://www.mail-tester.com</a>. Не факт, что получите максимальный бал, но все недочеты будут указаны. Критичное нужно исправить (например, если обратная зона неправильная), некритичное можно пропустить (если dkim, к примеру, не настраивали).</p>
<p style="text-align: justify;">Кажется все написал, что знал по поводу почтового сервера на linux в небольших и средних организациях. У некоторых может возникнуть вопрос, а зачем свой почтовый сервер? Почему бы не воспользоваться средствами корпоративной почты, которую представляют популярные почтовые сервисы бесплатно? Я планирую написать по этому поводу отдельную заметку (в итоге написал &#8212; <a href="https://serveradmin.ru/kakoy-pochtovyiy-server-vyibrat-dlya-sredney-kompanii/" target="_blank" rel="noopener">выбор почтового сервера</a>). У меня тоже есть определенный опыт на этот счет. И если некоторое время назад я считал, что свои почтовые серверы в небольших организациях уже не актуальны, то сейчас я так не думаю, поэтому и появилась эта статья.</p>
<p>Буду рад замечаниям по делу и советам в комментариях.</p>
<!-- Start shortcoder --><hr />

<h4 style="text-align: center;">Помогла статья? Есть возможность отблагодарить автора</h4>
<p style="text-align: center;"><iframe src="https://money.yandex.ru/quickpay/shop-widget?account=4100198746754&amp;quickpay=shop&amp;payment-type-choice=on&amp;mobile-payment-type-choice=on&amp;writer=seller&amp;targets=%D0%A1%D0%BF%D0%B0%D1%81%D0%B8%D0%B1%D0%BE+%D0%B0%D0%B2%D1%82%D0%BE%D1%80%D1%83+%D0%B7%D0%B0+%D0%BF%D0%BE%D0%BB%D0%B5%D0%B7%D0%BD%D1%83%D1%8E+%D1%81%D1%82%D0%B0%D1%82%D1%8C%D1%8E&amp;targets-hint=&amp;default-sum=&amp;button-text=03&amp;comment=on&amp;hint=&amp;successURL=" width="450" height="258" frameborder="0" scrolling="no"></iframe></p><!-- End shortcoder v4.1.1-->
<!-- Start shortcoder --><div class="clear"></div><div style="margin-top:20px; margin-bottom:20px;" class="divider divider-normal"></div>
<table class=" aligncenter" style="border-color: #e5e5e5;">
<tbody>
<tr>
<td style="background-color: #e7f6ff; border-color: #e5e5e5; text-align: center;"><span style="color: #ff0000;"><strong><span style="color: #000000;">Рекомендую полезные материалы по <a href="//serveradmin.ru/category/linux/centos/" target="_blank">CentOS</a>:</span></strong></span></td>
</tr>
<tr>
<th style="text-align: center;">Настройки системы</th>
</tr>
<tr>
<td style="border-color: #e5e5e5;">
	<script type="text/javascript">	jQuery(document).ready(function($){	jQuery("ul.tabs-nav").tabs("> .pane"); }); </script>

		<div class="post-tabs-ver">
		
<ul class="tabs-nav">
<li>Установка</li>
<li><strong>Базовая настройка</strong></li>
<li>Настройка времени</li>
<li>Настройка сети</li>
<li>Настройка репозиториев</li>
<li>Настройка iptables</li>
</ul>

		<div class="pane">
		<a href="//serveradmin.ru/ustanovka-centos-7/" target="_blank">Установка CentOS 7</a> в конфигурации minimal или netinstall с загрузочной флешки или по сети на диск или raid раздел.
		</div>
	

		<div class="pane">
		<a href="//serveradmin.ru/centos-7-nastroyka-servera/" target="_blank">Базовая настройка CentOS 7</a> для работы с любым функционалом. Приведены практические советы по улучшению безопасности и удобства администрирования.
		</div>
	

		<div class="pane">
		Как установить точное <a href="//serveradmin.ru/ustanovka-nastroyka-i-sinhronizatsiya-vremeni-v-centos/" target="_blank">время на сервере CentOS</a>, настроить часовой пояс, синхронизировать время с помощью ntpdate и ntpd и другое.
		</div>
	

		<div class="pane">
		Подробное описание <a href="//serveradmin.ru/nastroyka-seti-v-centos/" target="_blank">настройки сети в CentOS 7</a> - задать ip адрес, dhcp, отключить ipv6, dns, hostname, статические маршруты и др.
		</div>
	

		<div class="pane">
		Установка репозиториев epel, rpmforge и др. Добавление, удаление, обновление rpm <a href="//serveradmin.ru/ustanovka-repozitoriya-epel-rpmforge-v-centos/" target="_blank">репозиториев в CentOS</a>.
		</div>
	

		<div class="pane">
		Рассмотрены основные моменты <a href="//serveradmin.ru/nastroyka-iptables-v-centos-7/" target="_blank">настройки iptables в Centos 7</a> - установка, добавление правил, проброс портов, nat, логирование и д.р.
		</div>
	

		</div>
	</td>
</tr>
<tr>
<th style="text-align: center;">Настройка программных комплексов</th>
</tr>
<tr>
<td style="border-color: #e5e5e5;"> 
	<script type="text/javascript">	jQuery(document).ready(function($){	jQuery("ul.tabs-nav").tabs("> .pane"); }); </script>

		<div class="post-tabs-ver">
		
<ul class="tabs-nav">
<li>Прокси сервер</li>
<li>Шлюз</li>
<li>Asterisk</li>
<li>Asterisk+Freepbx</li>
<li>Сервер VPN</li>
<li>Web сервер Apache</li>
<li>Web сервер Nginx</li>
<li>Почтовый сервер</li>
</ul>

		<div class="pane">
		Подробное описание настройки прокси сервера на базе CentOS 7 со связкой <a href="//serveradmin.ru/nastroyka-proksi-servera-na-centos-7-squid-ad-sams2/" target="_blank">squid+AD+sams2</a>, реализован запрет доступа по url и группам пользователей.
		</div>
	

		<div class="pane">
		Простая и быстрая <a href="//serveradmin.ru/nastroyka-shlyuza-dlya-lokalnoy-seti-na-centos-7/" target="_blank">настройка шлюза на базе CentOS 7</a> для организации доступа в интернет из локальной сети.
		</div>
	

		<div class="pane">
		Описание установки и <a href="//serveradmin.ru/nastroyka-servera-telefonii-asterisk-s-nulya/" target="_blank">настройки asterisk</a> - популярной современной sip атс. Описан расширенный функционал, покрывающий большинство потребностей стандартного офиса в современной телефонии.
		</div>
	

		<div class="pane">
		Подробное описание установки voip сервера <a href="//serveradmin.ru/ustanovka-asterisk-i-freepbx-na-centos-7/" target="_blank">asterisk и панели управления freepbx на CentOS 7</a>.
		</div>
	

		<div class="pane">
		<a href="//serveradmin.ru/nastroyka-openvpn-na-centos-7/" target="_blank">Установка и настройка OpenVPN</a> сервера на CentOS для объединения офисов и подключения удаленных пользователей
		</div>
	

		<div class="pane">
		<a href="//serveradmin.ru/ustanovka-lamp-apache-php-mysql-v-centos-7/" target="_blank">Настройка web сервера CentOS 7</a> на базе связки http сервера apache, php и сервера db mysql, или коротко - установка lamp.
		</div>
	

		<div class="pane">
		Установка и настройка высокопроизводительного web сервера на базе <a href="//serveradmin.ru/nginx-php-fpm-na-centos-7/" target="_blank">nginx и php fpm</a>. В качестве кэша используется APC.
		</div>
	

		<div class="pane">
		<p>Описание установки и <a href="//serveradmin.ru/ustanovka-i-nastroyka-iredmail/" target="_blank">настройки почтового сервера iRedMail</a> на основе готовой сборки на CentOS 7. Обзор основных возможностей и рекомендации по настройке.</p>
<p>Самостоятельная <a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/" target="_blank">настройки почтового сервера postfix + dovecot</a> а так же дополнительных полезных модулей для полноценной и удобной работы почты.</p>
<p>Размышления на тему <a href="https://serveradmin.ru/kakoy-pochtovyiy-server-vyibrat-dlya-sredney-kompanii/" target="_blank">выбора почтового сервера</a> для малых и средних компаний.</p>
		</div>
	

		</div>
	</td>
</tr>
<tr>
<th style="text-align: center;">Настройка отдельных программ</th>
</tr>
<tr>
<td style="border-color: #e5e5e5;"> 
	<script type="text/javascript">	jQuery(document).ready(function($){	jQuery("ul.tabs-nav").tabs("> .pane"); }); </script>

		<div class="post-tabs-ver">
		
<ul class="tabs-nav">
<li>Zabbix</li>
<li>Phpmyadmin</li>
<li>Webmin</li>
<li>Ruby</li>
<li>Обновление php</li>
<li>Vsftpd</li>
<li>Bind</li>
<li>Unison</li>
<li>Observium</li>
<li>Syslog-NG</li>
</ul>

		<div class="pane">
		Видео и подробное описание <a href="//serveradmin.ru/ustanovka-i-nastroyka-zabbix-3-2-na-centos-7/" target="_blank">установки и настройки Zabbix 3.2</a>, а также установка агентов на linux и windows и подключение их к мониторингу.
		</div>
	

		<div class="pane">
		Подробное описание <a href="//serveradmin.ru/ustanovit-i-nastroit-phpmyadmin-na-centos-7/" target="_blank">установки и настройки панели управления phpmyadmin</a> на веб сервер apache и nginx под управлением Centos 7.
		</div>
	

		<div class="pane">
		Подробное описание <a href="//serveradmin.ru/ustanovka-webmin-na-centos-7/" target="_blank">установки и настройки Webmin на CentOS 7</a> для удаленного подключения и управления сервером.
		</div>
	

		<div class="pane">
		Подробное описание <a href="//serveradmin.ru/ustanovka-ruby-na-centos-7/" target="_blank">установки языка Ruby</a> последней версии на веб сервер под управлением CentOS 7.
		</div>
	

		<div class="pane">
		Подробное описание установки или <a href="//serveradmin.ru/ustanovka-i-obnovlenie-php-7-na-centos-7/" target="_blank">обновления php 7 на CentOS 7</a>. Рассмотрен вариант отката обновления и возврата на php 5.6 или 5.4.
		</div>
	

		<div class="pane">
		Подробное описание с видео <a href="//serveradmin.ru/ustanovka-i-nastroyka-ftp-servera-na-centos-7/" target="_blank">установки и настройки ftp сервера vsftpd</a>, примеры с локальными и виртуальные пользователями в mysql.
		</div>
	

		<div class="pane">
		Настройка DNS сервера <a href="//serveradmin.ru/nastroyka-dns-servera-bind-v-centos-7/" target="_blank">BIND (Named) в CentOS 7</a>. Рассмотрены наиболее популярные конфигурации, в том числе подробное логирование.
		</div>
	

		<div class="pane">
		<a href="//serveradmin.ru/ustanovka-unison-v-centos-7/" target="_blank">Установка Unison в CentOS 7</a> для двухсторонней синхронизации файлов.
		</div>
	

		<div class="pane">
		Инструкция по <a href="//serveradmin.ru/observium-ustanovka-i-nastroyka/" target="_blank">установке и настройке сервера мониторинга Observium</a> на CentOS 7. В качестве примера в конце добавлено одно устройство для мониторинга.
		</div>
	

		<div class="pane">
		Настройка сервера для централизованного сбора логов с удаленных устройств и серверов с помощью программы <a href="https://serveradmin.ru/nastroyka-syslog-ng-dlya-tsentralizovannogo-sbora-logov/" target="_blank">syslog-ng.</a>
		</div>
	

		</div>
	</td>
</tr>
<tr>
<th style="text-align: center;">Разное</th>
</tr>
<tr>
<td style="border-color: #e5e5e5;">
	<script type="text/javascript">	jQuery(document).ready(function($){	jQuery("ul.tabs-nav").tabs("> .pane"); }); </script>

		<div class="post-tabs-ver">
		
<ul class="tabs-nav">
<li>Настройка ssl в Apache</li>
<li>Бэкап с помощью rsync</li>
</ul>

		<div class="pane">
		Настройка работы веб сервера apache с <a href="//serveradmin.ru/nastroyka-ssl-v-apache-na-centos/" target="_blank">виртуальными хостами по протоколу https</a> с использованием бесплатного ssl сертификата.
		</div>
	

		<div class="pane">
		Подробное описание <a href="//serveradmin.ru/rsync-nastroyka-bekapa-na-centos-debian-ubuntu/" target="_blank">настройки бэкапа с помощью rsync</a> на примере скрипта инкрементного архива на системе Centos, Debian, Ubuntu, Windows.
		</div>
	

		</div>
	</td>
</tr>
</tbody>
</table><!-- End shortcoder v4.1.1-->
										
									</div><!-- .entry /-->
				<span style="display:none"><a href="https://serveradmin.ru/tag/centos/" rel="tag">centos</a> <a href="https://serveradmin.ru/tag/dovecot/" rel="tag">dovecot</a> <a href="https://serveradmin.ru/tag/mailserver/" rel="tag">mailserver</a> <a href="https://serveradmin.ru/tag/postfix/" rel="tag">postfix</a></span>				<span style="display:none" class="updated">2017-03-20</span>
								<div style="display:none" class="vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person"><strong class="fn" itemprop="name"><a href="https://serveradmin.ru/author/zerox/" title="Записи Zerox" rel="author">Zerox</a></strong></div>
								
								<div class="clear"></div>
			</div><!-- .post-inner -->
		</article><!-- .post-listing -->
		
		
		<div class="e3lan e3lan-post">			<!-- Yandex.RTB R-A-184428-1 -->
<div id="yandex_rtb_R-A-184428-1"></div>
<script type="text/javascript">
    (function(w, d, n, s, t) {
        w[n] = w[n] || [];
        w[n].push(function() {
            Ya.Context.AdvManager.render({
                blockId: "R-A-184428-1",
                renderTo: "yandex_rtb_R-A-184428-1",
                async: true
            });
        });
        t = d.getElementsByTagName("script")[0];
        s = d.createElement("script");
        s.type = "text/javascript";
        s.src = "//an.yandex.ru/system/context.js";
        s.async = true;
        t.parentNode.insertBefore(s, t);
    })(this, this.document, "yandexContextAsyncCallbacks");
</script>				</div>		
				
		
			
			<section id="related_posts">
		<div class="block-head">
			<h3>Похожие записи</h3><div class="stripe-line"></div>
		</div>
		<div class="post-listing">
						<div class="related-item">
							
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/nastroyka-samba-s-integratsiey-v-ad/">
						<img width="310" height="165" src="https://serveradmin.ru/wp-content/uploads/2017/09/samba-ad-windows-acl-310x165.png" class="attachment-tie-medium size-tie-medium wp-post-image" alt="" />						<span class="fa overlay-icon"></span>
					</a>
				</div><!-- post-thumbnail /-->
							
				<h3><a href="https://serveradmin.ru/nastroyka-samba-s-integratsiey-v-ad/" rel="bookmark">Настройка файлового сервера Samba с интеграцией в Active Directory</a></h3>
				<p class="post-meta"><span class="tie-date"><i class="fa fa-clock-o"></i>28.09.2017</span></p>
			</div>
						<div class="related-item">
							
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/ochistka-i-obsluzhivanie-pochtovoy-bazyi-postfix/">
						<img width="310" height="165" src="https://serveradmin.ru/wp-content/uploads/2017/09/postfix-mailclean-310x165.png" class="attachment-tie-medium size-tie-medium wp-post-image" alt="" />						<span class="fa overlay-icon"></span>
					</a>
				</div><!-- post-thumbnail /-->
							
				<h3><a href="https://serveradmin.ru/ochistka-i-obsluzhivanie-pochtovoy-bazyi-postfix/" rel="bookmark">Очистка и обслуживание почтовой базы postfix</a></h3>
				<p class="post-meta"><span class="tie-date"><i class="fa fa-clock-o"></i>12.09.2017</span></p>
			</div>
						<div class="related-item">
							
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/oshibka-postfix-connect-to-mysql-server-too-many-connections/">
						<img width="310" height="165" src="https://serveradmin.ru/wp-content/uploads/2016/11/error-310x165.png" class="attachment-tie-medium size-tie-medium wp-post-image" alt="" />						<span class="fa overlay-icon"></span>
					</a>
				</div><!-- post-thumbnail /-->
							
				<h3><a href="https://serveradmin.ru/oshibka-postfix-connect-to-mysql-server-too-many-connections/" rel="bookmark">Ошибка Postfix &#8212; connect to mysql server: Too many connections</a></h3>
				<p class="post-meta"><span class="tie-date"><i class="fa fa-clock-o"></i>30.08.2017</span></p>
			</div>
						<div class="clear"></div>
		</div>
	</section>
			
					
		
				
<div id="comments">

	
	<div id="comments-box">
		<div class="block-head">
			<h3 id="comments-title">123 комментария </h3><div class="stripe-line"></div>
		</div>
		<div class="post-listing">

			
					
				
			<ol class="commentlist">	<li id="comment-1292">
		<div  class="comment byuser comment-author-evi1dark even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1292">	20.03.2017 at 16:23</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Доброго времени суток!<br />
Вроде бы все делал следуя данной статьи &#8212; но до конца не дошел.<br />
Возможно есть опечатка:<br />
Дальше редактируем конфигурационный файл postfixadmin.</p>
<p># mcedit /var/www/postfixadmin/config.inc.php</p>
<p>но судя по mv &#8212; у нас нет такого каталога \ файла&#8230;. возможно имеется в виду: </p>
<p>Дальше редактируем конфигурационный файл postfixadmin.</p>
<p># mcedit /var/www/html/postfixadmin/config.inc.php</p>
<p>Так же где-то еще был нюанс &#8212; </p>
<p>debug_peer_level = 2<br />
debugger_command =<br />
PATH=/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin<br />
ddd $daemon_directory/$process_name $process_id &amp; sleep 5</p>
<p>тут понадобилось &#171;=&#187; после ddd  &#8212; то ли я что-то упустил, то ли не знаю.. </p>
<p>А так &#8212; огромное спасибо за статью &#8212; буду разбираться, но с нескольких раз &#8212; пока что не удалось поднять почтовый север (то ли где то туплю, то ли что-то не так отредактировал &#8212; где то что-то есть, ибо почта не ходит) &#8212; но будем дальше учиться 🙂</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1292#respond' onclick='return addComment.moveForm( "comment-1292", "1292", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1293">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1293">	20.03.2017 at 16:38</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо за замечание. Опечатка действительно была, забыл html добавить в путь. </p>
<p>debugger_command можно вообще не указывать, если возникает с ним ошибка, достаточно значения по-умолчанию. Не знаю, для чего он нужен именно в таком виде. Я взял пример с рабочего сервера. Там, наверно, по-умолчанию были эти значения.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1293#respond' onclick='return addComment.moveForm( "comment-1293", "1293", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1294">
		<div  class="comment byuser comment-author-evi1dark even depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1294">	20.03.2017 at 16:58</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Попробую еще раз все проделать &#8212; но вот такой небольшой нюанс&#8230; hostname &#8212; как это влияет? или как правильно отредактировать hostname и hosts, если все поднимается на VDS / VPS?<br />
Буду пробовать все проделать &#8212; но что-то пока не получилось объединить все, как минимум 3 статьи, в одно действо (настройка CentOS, вэб сервер на CentOS и данную статью&#8230; &#8212; при выполнении последовательно &#8212; мне postfixadmin выдал что нет такого URL).<br />
Но опять же &#8212; возможно туплю, ибо только не давно изучать все это (и поэтому Ваш сайт стал как энциклопедия)</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1294#respond' onclick='return addComment.moveForm( "comment-1294", "1294", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1295">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1295">	20.03.2017 at 17:19</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>hostname лучше всего сделать такое же как dns имя почтового сервера. Так меньше шансов получить где-нибудь ошибку с именем хоста. Но это не обязательно, я настраивал и с локальным именем вида mailsrv.local. </p>
<p>Почта сложный функуционал, его нахрапом не возьмешь без должной подготовки. Но упорство и труд все перетрут. Я так же начинал с огромной статьи от одного автора лет 10 назад. Повторял но не до конца понимал, что делаю. Со временем разобрался. Главное постоянно работать с этим, тогда получится.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1295#respond' onclick='return addComment.moveForm( "comment-1295", "1295", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1296">
		<div  class="comment byuser comment-author-evi1dark even thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1296">	20.03.2017 at 17:36</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Согласен)<br />
Но просто столкнулся с проблемой iRedMail &#8212; типа нельзя использовать имя как hostname &#8212; и потому не много завис. Да с iRedMail что-то не понятка &#8212; после команды reboot по ssh &#8212; сервак поднимался только после &#171;хард-ребута&#187; (через питание).. Поэтому буду применять данную статью &#8212; хоть в Инете и много страниц про postfix+dovecot и т.д. &#8212; но уж лучше Вашу статью возьму, ибо все (почти) расписано.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1296#respond' onclick='return addComment.moveForm( "comment-1296", "1296", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1297">
		<div  class="comment byuser comment-author-evi1dark odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1297">	20.03.2017 at 17:38</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Почему то не в ответ на коммент пост вставился 🙁</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1297#respond' onclick='return addComment.moveForm( "comment-1297", "1297", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1304">
		<div  class="comment byuser comment-author-evi1dark even thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1304">	21.03.2017 at 16:11</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Нашел еще одну опечатку: </p>
<p>Добавляем полученную строку в файл конфигурации postfixadmin.</p>
<p># mcedit /var/www/postfixadmin/config.inc.php</p>
<p>пропущен html</p>
<p>Добавляем полученную строку в файл конфигурации postfixadmin.</p>
<p># mcedit /var/www/html/postfixadmin/config.inc.php</p>
<p>Огромное спасибо за стать &#8212; получилось поднять почтовый сервер (пока что только не особо вдавался в подробности, но начало есть).<br />
Осталось чутка &#171;допилить&#187; &#8212; чтоб при заходе на mail.site1.ru сразу открывался roundcude (как то получалось это провернуть на iRedMail &#8212; но все равно немного не очень &#8212; открывалось что-то типа mail.site1.ri/mail&#8230; мб просто как то на отдельном IP / сервере нужно поднимать почтовый&#8230; либо просто я еще не докопался до сути).</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1304#respond' onclick='return addComment.moveForm( "comment-1304", "1304", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1306">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1306">	21.03.2017 at 16:29</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Еще заметил нюанс &#8212; в блоке </p>
<p>debug_peer_level = 2<br />
debugger_command =<br />
PATH=/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin<br />
ddd $daemon_directory/$process_name $process_id &amp; sleep 5</p>
<p>нужно прописать PATH и ddd через табуляцию: </p>
<p>debug_peer_level = 2<br />
debugger_command =<br />
    PATH=/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin<br />
    ddd $daemon_directory/$process_name $process_id &amp; sleep 5</p>
<p>тогда все норм при рестарте. А вот это </p>
<p>И небольшой штрих в завершении настройки.</p>
<p># chown vmail. /var/run/dovecot/auth-master</p>
<p>у меня не прошло, видать из-за того что Вы использовали рабочий конфиг (а может еще из-за чего то)</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1306#respond' onclick='return addComment.moveForm( "comment-1306", "1306", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1307">
		<div  class="comment even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1307">	21.03.2017 at 16:32</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>не прошла табуляция в комменте (даже через пробелы)&#8230;</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1307#respond' onclick='return addComment.moveForm( "comment-1307", "1307", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1308">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1308">	21.03.2017 at 16:39</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Да, это проблема. Табуляцию съедает движок сайта, но даже если тут изловчиться его добавить, то при копировании потеряется. Надо подумать, как объяснить этот момент. В рабочем конфиге эти две строки стоят с табуляцией. Не знал, что это имеет принципиальное значение. </p>
<p>Опечатку исправил, спасибо.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1308#respond' onclick='return addComment.moveForm( "comment-1308", "1308", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1309">
		<div  class="comment even depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1309">	21.03.2017 at 16:54</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>может что-то типа: </p>
<p>и сделать примечание &#8212; что это знак табуляции?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1309#respond' onclick='return addComment.moveForm( "comment-1309", "1309", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1310">
		<div  class="comment odd alt depth-5 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1310">	21.03.2017 at 16:56</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>хм&#8230; даже &#171;&#187; (без кавычек) не прошло&#8230;</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1310#respond' onclick='return addComment.moveForm( "comment-1310", "1310", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1311">
		<div  class="comment even depth-6 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1311">	21.03.2017 at 16:58</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>эх&#8230; только наверное четыре точки поможет )) типа: &#8230;. &#8212; типа знак табуляции)</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1311#respond' onclick='return addComment.moveForm( "comment-1311", "1311", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1312">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-7 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1312">	21.03.2017 at 17:01</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Все просто &#8212; добавил комментарий в кофниг :))</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1312#respond' onclick='return addComment.moveForm( "comment-1312", "1312", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1313">
		<div  class="comment even depth-8 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1313">	21.03.2017 at 17:04</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Четко! 🙂 </p>
<p>Правда что-то я нафлудил тут в комментах к статье&#8230;<br />
Если что &#8212; можно подчистить 🙂</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1313#respond' onclick='return addComment.moveForm( "comment-1313", "1313", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1317">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">izyk</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1317">	22.03.2017 at 11:12</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Здравствуйте.<br />
Selinux отключили?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1317#respond' onclick='return addComment.moveForm( "comment-1317", "1317", "respond", "4993" )' aria-label='Комментарий к записи izyk'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1319">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1319">	22.03.2017 at 13:40</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Да.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1319#respond' onclick='return addComment.moveForm( "comment-1319", "1319", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1325">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/b18564e138001693415b6bb16ecb0857?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/b18564e138001693415b6bb16ecb0857?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Денис</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1325">	22.03.2017 at 23:46</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Возникает ошибк:<br />
Mar 22 22:43:38 mail postfix/smtpd[2951]: NOQUEUE: reject: RCPT from localhost[::1]: 504 5.5.2 : Helo command rejected: need fully-qualified hostname; from= to= proto=ESMTP helo=</p>
<p>Все конфиги скопированы, какие нужны данные для проверки?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1325#respond' onclick='return addComment.moveForm( "comment-1325", "1325", "respond", "4993" )' aria-label='Комментарий к записи Денис'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1328">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1328">	23.03.2017 at 10:03</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>В логе же все написано. У тебя включена проверка: reject_non_fqdn_helo_hostname<br />
Тот, кто отправляет тебе письмо, не передает нормальное helo, и его футболит сервер с описанием причины &#8212; need fully-qualified hostname.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1328#respond' onclick='return addComment.moveForm( "comment-1328", "1328", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1326">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/b18564e138001693415b6bb16ecb0857?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/b18564e138001693415b6bb16ecb0857?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Денис</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1326">	22.03.2017 at 23:47</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Mar 22 22:43:38 mail postfix/smtpd[2951]: NOQUEUE: reject: RCPT from localhost[::1]: 504 5.5.2 : Helo command rejected: need fully-qualified hostname; from= to= proto=ESMTP helo=</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1326#respond' onclick='return addComment.moveForm( "comment-1326", "1326", "respond", "4993" )' aria-label='Комментарий к записи Денис'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1329">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1329">	23.03.2017 at 10:04</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Супер секретную информацию в логе можно было бы и оставить, так было бы сразу понятно, в чем причина.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1329#respond' onclick='return addComment.moveForm( "comment-1329", "1329", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1332">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/63714a9aa41ca2ff6a81041e811c860e?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Evi1dark</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1332">	23.03.2017 at 14:35</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>У меня тут вопрос небольшой возник &#8212; уже не знаю в какую сторону копать&#8230;.<br />
После того как все установил, по maillog все работает, все отлично. На *название_сайта*/postfixadmin и *название_сайта*/phpmyadmin &#8212; все открывается, и нормально происходит логин, а вот если логиниться в *название_сайта*/webmail (открывается интерфейс roundcube) &#8212; не получается залогиниться &#8212; ниже полей ввода появляется &#171;Неверный запрос! Информация не сохранена&#187;&#8230; Пробовал писать не просто логин, а логин@домен &#8212; ситуация та же&#8230; Но вот если заходить через *IP_адрес*/webmail &#8212; все нормально, и спокойно пускает в почту&#8230;<br />
*название_сайта* == *IP_адрес*<br />
Если тут данный комментарий будет лишний &#8212; попробую на форуме темку создать (а может тут вообще проблема мелочная).<br />
Заранее спасибо.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1332#respond' onclick='return addComment.moveForm( "comment-1332", "1332", "respond", "4993" )' aria-label='Комментарий к записи Evi1dark'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1529">
		<div  class="comment even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Игорь</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1529">	18.04.2017 at 17:44</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Поддерживаю, все работало нормально. Но теперь начались проблемы, возможно я начал добавлять какие то пакеты и они конфликтуют, в изначальной сборке таких ошибок не возникало, пытался прикруть webdav может что то от туда конфликтующее. Я настроил вход через 80 и 443 порт на webmail, по 443 входит без проблем, через 80 постоянно ругается на неверный запрос.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1529#respond' onclick='return addComment.moveForm( "comment-1529", "1529", "respond", "4993" )' aria-label='Комментарий к записи Игорь'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1333">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Doc</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1333">	23.03.2017 at 15:08</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Установил и при первом заходе на  постфикс вместо Ок такая муть, я в где то пропустил поддержку IMAP функции включить или что то еще?<br />
Warning: Depends on: IMAP functions &#8212; NOT FOUND<br />
To install IMAP support, install php5-imap<br />
Without IMAP support, you won&#8217;t be able to create subfolders when creating mailboxes.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1333#respond' onclick='return addComment.moveForm( "comment-1333", "1333", "respond", "4993" )' aria-label='Комментарий к записи Doc'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1334">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1334">	23.03.2017 at 15:55</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Модуль php5-imap не установлен. Не помню точно, должен ли он в какой-то зависимости установиться, или его вручную надо ставить. В общем, можно установить вручную:<br />
yum install php5-imap</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1334#respond' onclick='return addComment.moveForm( "comment-1334", "1334", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1335">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1335">	23.03.2017 at 15:58</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Это на какой системе ошибка? У меня стоит модуль php &#8212; php-imap, этого достаточно. У тебя почему-то именно php5-imap хочет.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1335#respond' onclick='return addComment.moveForm( "comment-1335", "1335", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1339">
		<div  class="comment even depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Doc</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1339">	24.03.2017 at 06:10</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>[root@mail ~]# uname -a<br />
Linux mail.eeee.ru 3.10.0-514.10.2.el7.x86_64 #1 SMP Fri Mar 3 00:04:05 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux<br />
Centos 7. я сначала на голый сервер поставил php и phpmyadmin, а потом накатил yum install httpd php phpmyadmin mariadb mariadb-server php-imap может поэтому и произошел какой то косяк, а так тоже пробовал yum install php5-imap &#8212; Пакета с названием php5-imap не найдено.<br />
В каком репозитории искать или проще откатиться и начать заново.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1339#respond' onclick='return addComment.moveForm( "comment-1339", "1339", "respond", "4993" )' aria-label='Комментарий к записи Doc'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1355">
		<div  class="comment byuser comment-author-smithy1208 odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7e09bb5adc1a0266d6b6d059dbae240a?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7e09bb5adc1a0266d6b6d059dbae240a?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">smithy1208</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1355">	27.03.2017 at 10:54</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>&gt;&gt;&gt; &#171;У некоторых может возникнуть вопрос, а зачем свой почтовый сервер? Почему бы не воспользоваться средствами корпоративной почты, которую представляют популярные почтовые сервисы бесплатно? Я планирую написать по этому поводу отдельную заметку. У меня тоже есть определенный опыт на этот счет. И если некоторое время назад я считал, что свои почтовые серверы в небольших организациях уже не актуальны, то сейчас я так не думаю, поэтому и появилась эта статья.&#187;</p>
<p>Очень хочется почитать.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1355#respond' onclick='return addComment.moveForm( "comment-1355", "1355", "respond", "4993" )' aria-label='Комментарий к записи smithy1208'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1360">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1360">	27.03.2017 at 16:59</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Половину статьи написал уже. В ближайшие дни опубликую свои рассуждения.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1360#respond' onclick='return addComment.moveForm( "comment-1360", "1360", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1356">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Dima</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1356">	27.03.2017 at 15:20</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Подскажите дураку в этом месте все колом встало</p>
<p>Создаем группу и пользователя с указанными в конфиге uid 1000.<br />
# groupadd  -g 1000 vmail  получаю GID «1000» уже существует<br />
# useradd -d /mnt/mail/ -g 1000 -u 1000 vmail  получаю UID 1000 не является уникальным<br />
# chown vmail. /mnt/mail получаю неверный пользователь: «vmail.»</p>
<p>Почему так происходит? Второй раз с самого начала делаю и в этом месте встаю.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1356#respond' onclick='return addComment.moveForm( "comment-1356", "1356", "respond", "4993" )' aria-label='Комментарий к записи Dima'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1361">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1361">	27.03.2017 at 17:01</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>В данном случае 1000 это идентификатор пользователя vmail. Если он в системе уже есть, то второй раз его создавать не надо. Если же этот идентификатор занят другим пользователем, то надо создать нового пользователя vmail с другим идентификатором и его указать в конфиге dovecot. Он используется именно там.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1361#respond' onclick='return addComment.moveForm( "comment-1361", "1361", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1368">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Dima</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1368">	28.03.2017 at 10:00</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо получилось, почта вроде ходит, но вот Roundcube не пускает на веб интерфейс, неудачная попытка входа. Базу видит. Подскажи куда смотреть?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1368#respond' onclick='return addComment.moveForm( "comment-1368", "1368", "respond", "4993" )' aria-label='Комментарий к записи Dima'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1369">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1369">	28.03.2017 at 11:39</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Даже не знаю. У Roundcube нет никаких нюансов в работе, обычно всегда встает нормально. Нужно только настроить подключение к БД, указав параметры в конфиге. Это просто набор php скриптов. У нее в папке на веб сервере есть свои логи, можно там посмотреть информацию. Ну и в лог веб сервера на всякий заглянуть, может там подсказка будет.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1369#respond' onclick='return addComment.moveForm( "comment-1369", "1369", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1390">
		<div  class="comment odd alt depth-5 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Dima</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1390">	29.03.2017 at 14:11</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>косяк не в Roundcube, почта с сервера уходит, а вот приходить не приходит, похоже косяк с IMAP, точнее с авторизацией.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1390#respond' onclick='return addComment.moveForm( "comment-1390", "1390", "respond", "4993" )' aria-label='Комментарий к записи Dima'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1393">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-6 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1393">	29.03.2017 at 15:06</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>При чем тут imap? Ты же чуть выше писал: &#171;но вот Roundcube не пускает на веб интерфейс, неудачная попытка входа&#187;.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1393#respond' onclick='return addComment.moveForm( "comment-1393", "1393", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1394">
		<div  class="comment odd alt depth-7 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Dima</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1394">	29.03.2017 at 15:15</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>ну да, но как оказалось почта только уходит,а на сервер не доходит и тондерберд тоже не хочет подключаться и тест Roundcube говорит<br />
Connecting to localhost&#8230;<br />
IMAP connect:  NOT OK какой то конфиг я видать не докурил, но какой не понятно.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1394#respond' onclick='return addComment.moveForm( "comment-1394", "1394", "respond", "4993" )' aria-label='Комментарий к записи Dima'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1395">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-8 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1395">	29.03.2017 at 15:21</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Может просто dovecot не запущен. Он является imap сервером.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1395#respond' onclick='return addComment.moveForm( "comment-1395", "1395", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1458">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Игорь</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1458">	08.04.2017 at 02:10</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо за статью.<br />
Сам настраиваю без phpmyadmin, и может быть без установки этого пакета не подтянулись нужные зависимости. В общем дополнительно при разворачивание postfixadmin, я до установил следующие пакеты yum -y install php-mbstring php-common php-pdo php-mysql</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1458#respond' onclick='return addComment.moveForm( "comment-1458", "1458", "respond", "4993" )' aria-label='Комментарий к записи Игорь'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1463">
		<div  class="comment even thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Игорь</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1463">	09.04.2017 at 11:00</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>По поводу настройки smtp на 587 порту. Т.е. при этом конфиге работает на 587? Потому что пытаясь зайти по 587 вроде ничего не выходит. Строчки в master.cf достаточно?<br />
submission inet n       &#8212;       n       &#8212;       &#8212;       smtpd<br />
 -o syslog_name=postfix/submission<br />
 -o smtpd_tls_wrappermode=no<br />
 -o smtpd_tls_security_level=encrypt<br />
 -o smtpd_sasl_auth_enable=yes<br />
 -o smtpd_recipient_restrictions=permit_mynetworks,permit_sasl_authenticated,reject<br />
 -o smtpd_relay_restrictions=permit_mynetworks,permit_sasl_authenticated,defer_unauth_desti$<br />
 -o milter_macro_daemon_name=ORIGINATING<br />
И она должна быть вместе или вместо?<br />
smtp      inet  n       &#8212;       n       &#8212;       &#8212;       smtpd</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1463#respond' onclick='return addComment.moveForm( "comment-1463", "1463", "respond", "4993" )' aria-label='Комментарий к записи Игорь'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1465">
		<div  class="comment odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Игорь</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1465">	09.04.2017 at 14:44</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Все работает, я просто опечатался в iptables, вместо 587 указал 578.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1465#respond' onclick='return addComment.moveForm( "comment-1465", "1465", "respond", "4993" )' aria-label='Комментарий к записи Игорь'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1473">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Игорь</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1473">	11.04.2017 at 01:13</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день. Не подскажите причину, по которой не доходит сообщение.<br />
&#187; Anonymous TLS connection established from unknown[80.253.*.*]: TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits)<br />
Apr 10 23:01:00 mail postfix/smtpd[39724]: NOQUEUE: reject: RCPT from unknown[80.253.*.*]: 450 4.7.1 Client host rejected: cannot find your hostname, [80.253.*.*]; from=&lt;SIS@rpa-*$<br />
Apr 10 23:01:00 mail postfix/smtpd[39724]: disconnect from unknown[80.253.*.*]&quot;<br />
Пока могу понять что от публичных (mail,gmail,yandex) все ходит правильно.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1473#respond' onclick='return addComment.moveForm( "comment-1473", "1473", "respond", "4993" )' aria-label='Комментарий к записи Игорь'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1475">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1475">	11.04.2017 at 11:55</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Срабатывает проверка имени сервера.<br />
Client host rejected: cannot find your hostname<br />
Почтовый сервер не может отрезолвить ip входящего соединения в имя домена. Это явный признак спама, либо проблем с днс.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1475#respond' onclick='return addComment.moveForm( "comment-1475", "1475", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1478">
		<div  class="comment even depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Игорь</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1478">	11.04.2017 at 18:55</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Под это правило попадает очень много ящиков, но визуально они все от спамов, и вот почта от знакомого вся попадает под это правило, со всего его домена естественно. Просто боюсь что таких серверов станет много и я просто не услежу за сообщениями. А проблема на моей стороне? Или на его?<br />
nslookup mail.rpa-***.ru<br />
Server:         193.106.92.92<br />
Address:        193.106.92.92#53</p>
<p>Non-authoritative answer:<br />
Name:   mail.rpa-***.ru<br />
Address: 80.253.***.163</p>
<p>nslookup 80.253.***.163<br />
Server:         193.106.92.92<br />
Address:        193.106.92.92#53</p>
<p>Non-authoritative answer:<br />
163.***.253.80.in-addr.arpa      name = mail.rpa-***.ru.</p>
<p>Authoritative answers can be found from:</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1478#respond' onclick='return addComment.moveForm( "comment-1478", "1478", "respond", "4993" )' aria-label='Комментарий к записи Игорь'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1480">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1480">	11.04.2017 at 22:42</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Судя по nslookup домен резолвится нормально. По какой-то причине почтовый сервер в момент приема не смог его отрезолвить. Но он ошибку выдал при этом 450, то есть не отверг письмо полностью, а предложил прийти позже. Так что не факт, что письмо в итоге не дойдет. Может через некоторое время все будет в порядке. </p>
<p>Если возникают такого рода проблемы, то можно просто отключить проверку имени домена отправителя.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1480#respond' onclick='return addComment.moveForm( "comment-1480", "1480", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1485">
		<div  class="comment even depth-5 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d91ee24c93a39852ecac842f671e7654?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Игорь</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1485">	12.04.2017 at 11:00</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо, пока добавил домен в исключение, для reception ветки и helo ветки. Просто по этому правило судя по логам, достаточно много плохих писем отсеивается.<br />
Покопался и разобрался, в общем еще раз спасибо за отличную статью, у меня скоро наверное каждая страница вашего сайта будет в избранном.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1485#respond' onclick='return addComment.moveForm( "comment-1485", "1485", "respond", "4993" )' aria-label='Комментарий к записи Игорь'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1534">
		<div  class="comment byuser comment-author-bora odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/690aef7506d0505d7c96fdc0ad218015?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/690aef7506d0505d7c96fdc0ad218015?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Bora</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1534">	18.04.2017 at 20:01</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>6,9 из 10 баллов на <a href="http://www.mail-tester.com" rel="nofollow">http://www.mail-tester.com</a><br />
-3 балла за подпись DKIM </p>
<p>буду решать )</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1534#respond' onclick='return addComment.moveForm( "comment-1534", "1534", "respond", "4993" )' aria-label='Комментарий к записи Bora'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1622">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Sasha</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1622">	30.04.2017 at 02:56</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо,за статью!!!Пробую пошагово делать,но возникают вопросы.<br />
1-myhostname = mail.zeroxzed.ru<br />
mydomain = zeroxzed.ru<br />
Ничего страшного,что  hostname моего почтового сервера ,будет совпадать с  моим почтовым domain?Или они должны быть разные?<br />
2-Некоторые строчки в Вашем конфиге у меня не было,это нормально,мне просто вставить недостающие?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1622#respond' onclick='return addComment.moveForm( "comment-1622", "1622", "respond", "4993" )' aria-label='Комментарий к записи Sasha'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1675">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/255456771843cd9cbaf49937445eb089?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/255456771843cd9cbaf49937445eb089?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Сергей</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1675">	08.05.2017 at 16:23</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день, но есть один нюанс, при использовании опции reject_unknown_helo_hostname реджектится будет и тот же yandex. У меня другой вопрос есть, имею вот такие опции:</p>
<p>smtpd_recipient_restrictions =<br />
            reject_unknown_recipient_domain,<br />
            reject_non_fqdn_recipient,<br />
            reject_unlisted_recipient,<br />
            permit_mynetworks,<br />
            permit_sasl_authenticated,<br />
            reject_unauth_destination,<br />
            check_client_access hash:/etc/postfix/whitelist,<br />
smtpd_helo_restrictions =<br />
            permit_sasl_authenticated,<br />
            reject_non_fqdn_helo_hostname,<br />
            reject_invalid_helo_hostname,<br />
            check_helo_access pcre:/etc/postfix/helo_access.pcre<br />
smtpd_sender_restrictions =<br />
            reject_unknown_sender_domain,<br />
            reject_non_fqdn_sender,<br />
            reject_unlisted_sender,<br />
            permit_mynetworks,<br />
            reject_sender_login_mismatch,<br />
            reject_unverified_sender,<br />
            permit_sasl_authenticated,<br />
            check_sender_access hash:/etc/postfix/whitelist</p>
<p>почтовый сервер, крутится на адресе mail.example.ru, обслуживает данный сервер два домена example.ru и example.com, теперь получаем вот что</p>
<p>&gt;&gt;telnet mail.example.ru 25<br />
Trying 192.168.5.5&#8230;<br />
Connected to mail.example.ru.<br />
Escape character is &#8216;^]&#8217;.<br />
220 mail.example.ru ESMTP<br />
ehlo gmail.com<br />
250-mail.example.ru<br />
250-PIPELINING<br />
250-SIZE 102400000<br />
250-ETRN<br />
250-STARTTLS<br />
250-ENHANCEDSTATUSCODES<br />
250-8BITMIME<br />
250 DSN<br />
mail from:hdspam@gmail.com<br />
250 2.1.0 Ok<br />
rcpt to:admin@example.ru<br />
250 2.1.5 Ok<br />
data<br />
354 End data with .<br />
From:hdspam@gmail.com<br />
Data: 12.02.1700<br />
Subject: test<br />
test mail from telnet<br />
.<br />
250 2.0.0 Ok: queued as 8AB525C009E<br />
^]<br />
telnet&gt;</p>
<p>сервер принял письмо, и поставил его в очередь на доставку, а этого не должно быть, так как ежу понятно что я не подключился с серверов gmail что бы писать от домена gmail.com. Естественно open relay у меня не отработает, такой номер пройдет только если я прописываю левый домен в поле &#171;mail from&#187; а в &#171;rcpt to&#187; прописать домен который обслуживает сервер (example.ru или example.com) во все остальных случаях будет либо ошибка что нет авторизации либо ошибка что relay access denied. И вот как это исправить я не понимаю.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1675#respond' onclick='return addComment.moveForm( "comment-1675", "1675", "respond", "4993" )' aria-label='Комментарий к записи Сергей'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1677">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1677">	08.05.2017 at 18:37</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>&#171;Добрый день, но есть один нюанс, при использовании опции reject_unknown_helo_hostname реджектится будет и тот же yandex.&#187;<br />
Не понял, почему яндекс будет режектиться?</p>
<p>По поводу поля mail from, я не знаю стандартных проверок, которые контролят актуальность этого поля. Думаю, это не имеет смысла, так как мне даже на gmail приходят письма с поддельным mail from и гугл его пропускает.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1677#respond' onclick='return addComment.moveForm( "comment-1677", "1677", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1679">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/255456771843cd9cbaf49937445eb089?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/255456771843cd9cbaf49937445eb089?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Сергей</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1679">	08.05.2017 at 21:50</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Не знаю, когда я включаю данную опцию, мой postfix режит все письма, хотя я только что проверил, действительно, ip yandex нормельно резолвится в dns в обе стороны, не понимаю почему postfix тогда режит письма, Юзаю Centos 6 и postfix 2.6</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1679#respond' onclick='return addComment.moveForm( "comment-1679", "1679", "respond", "4993" )' aria-label='Комментарий к записи Сергей'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1707">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/8d4bcbf9b3344d6b1944d4b6b4c104f9?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/8d4bcbf9b3344d6b1944d4b6b4c104f9?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Igor</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1707">	18.05.2017 at 11:04</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день! У меня проблема с отправкой локальной почты. Отправляю письмо с <a href="mailto:mail1@domain.com">mail1@domain.com</a> на <a href="mailto:mail2@domain.com">mail2@domain.com</a> и получаю в логах bounced user unknown. В дебаге dovecot вижу:<br />
May 18 11:02:20 auth: Debug: auth client connected (pid=0)<br />
May 18 11:02:20 auth: Debug: master in: USER    1       {recipient}     service=<br />
lda<br />
May 18 11:02:20 auth: Debug: userdb out: NOTFOUND       1<br />
May 18 11:02:21 auth: Debug: master in: USER    1       {recipient}     service=<br />
lda<br />
May 18 11:02:21 auth: Debug: userdb out: NOTFOUND       1</p>
<p>Возможно, я что-то не вижу, а так и запросы проверил к бд, и права доступа, и сравнил конфиг &#8212; не понимаю. Спасибо!</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1707#respond' onclick='return addComment.moveForm( "comment-1707", "1707", "respond", "4993" )' aria-label='Комментарий к записи Igor'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1710">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1710">	18.05.2017 at 14:34</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Похоже на то, что не настроено подключение к mysql. Довекот где-то в другом месте юзеров ищет.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1710#respond' onclick='return addComment.moveForm( "comment-1710", "1710", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1711">
		<div  class="comment even thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Player</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1711">	18.05.2017 at 17:39</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день. Подскажите в чем может быть проблема. Если posfix настроенный по вашей статье отправляет письма  но не принимает письма из вне. Письмо уходит с почты к примеру gmail без всяких ошибок но на ящик postfixa ничего не попадает. При просмотре очереди писем вижу что оно там. В логе /var/log/maillog пишет 25 connection refused postfix. Проверяю порт 25 через 2ip пишет что порт открыт.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1711#respond' onclick='return addComment.moveForm( "comment-1711", "1711", "respond", "4993" )' aria-label='Комментарий к записи Player'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1712">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1712">	18.05.2017 at 19:32</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Как проверяли очередь? Если письмо в почтовой очереди, то оно уже принято почтовым сервером и не может быть 25 connection refused. Эта запись говорит, что прием письма отклонен. Нужно разбираться внимательнее. Для этого нужен полный кусок лога maillog в момент приема письма.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1712#respond' onclick='return addComment.moveForm( "comment-1712", "1712", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1730">
		<div  class="comment even depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Player</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1730">	19.05.2017 at 16:08</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день. Извиняюсь была моя ошибка так как установив все по новой все заработало. Только чуточку пришлось с бубном пошаманить.<br />
Подскажите при подключении через Thunderbird выдает что Не удалось найти настройки для вашей учетной записи, откуда он вообще их берет и как это можно исправить?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1730#respond' onclick='return addComment.moveForm( "comment-1730", "1730", "respond", "4993" )' aria-label='Комментарий к записи Player'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1731">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1731">	19.05.2017 at 16:10</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Надо вручную ввести настройки, а не использовать те, что он предлагает настроить автоматически через какую-то свою почтовую систему.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1731#respond' onclick='return addComment.moveForm( "comment-1731", "1731", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1733">
		<div  class="comment even depth-5 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Player</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1733">	19.05.2017 at 16:22</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Так вручную и ввожу IMAP mail.domain.net 143 STARTTLS Обычный пароль<br />
                               SMTP mail.domain.net 25 STARTTLS Обычный пароль<br />
Имя пользователя <a href="mailto:root@domain.net">root@domain.net</a><br />
p.s. домен естественно заменил на domain.net</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1733#respond' onclick='return addComment.moveForm( "comment-1733", "1733", "respond", "4993" )' aria-label='Комментарий к записи Player'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1768">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Vitaly</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1768">	24.05.2017 at 10:08</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день! Можете подсказать? Я настроил DKIM по вашей инструкции, все заработало,  Единственное при проверке через Gmail выдает:<br />
DKIM:	NEUTRAL, домен domain.ru, а не PASS как у Вас. Искал в интернете, одни указывают, что неправильно запись сделал в DNS с открытым ключом, но я проверял по указанной Вами ссылке, все ОК. Другие пишут что Postfix может добавить пустую строку в тело письма после подписи, но тогда ошибка должна быть другая. Была ли у кого подобная ситуация?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1768#respond' onclick='return addComment.moveForm( "comment-1768", "1768", "respond", "4993" )' aria-label='Комментарий к записи Vitaly'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1773">
		<div  class="comment even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Vitaliy</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1773">	24.05.2017 at 17:32</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>В письме нашел, после тестовой отправке на Gmail</p>
<p>Authentication-Results: mail.mysite.ru (amavisd-new); dkim=fail (1024-bit key) reason=&#187;fail (body has been altered)&#187; header.d=mysite.ru</p>
<p>Получается тело письма изменяется. А где посмотреть почему?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1773#respond' onclick='return addComment.moveForm( "comment-1773", "1773", "respond", "4993" )' aria-label='Комментарий к записи Vitaliy'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1774">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1774">	24.05.2017 at 17:35</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>У меня в статье нет amavisd, вы не по ней настраивали.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1774#respond' onclick='return addComment.moveForm( "comment-1774", "1774", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1775">
		<div  class="comment even depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Vitaliy</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1775">	24.05.2017 at 18:11</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Вы правы мой косяк. Я по Вашей статье установил iRedMail, а по этой пытался настроить DKIM. В конфиге amavisd можно отключить настройки, чтобы не он управлял DKIM?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1775#respond' onclick='return addComment.moveForm( "comment-1775", "1775", "respond", "4993" )' aria-label='Комментарий к записи Vitaliy'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1776">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-5 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1776">	24.05.2017 at 18:22</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>В iRedMail dkim уже настроен из коробки. Надо только dns записи установить.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1776#respond' onclick='return addComment.moveForm( "comment-1776", "1776", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1777">
		<div  class="comment even depth-6 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Vitaliy</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1777">	24.05.2017 at 18:37</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Записи прописал, если я OpenDkim удалю, встроенный подхватится?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1777#respond' onclick='return addComment.moveForm( "comment-1777", "1777", "respond", "4993" )' aria-label='Комментарий к записи Vitaliy'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1769">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Player</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1769">	24.05.2017 at 11:19</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день. Еще вопросик. Я правильно понимаю если использовать несколько доменов то пункт &#171;Настройка dkim и spf&#187; необходимо повторить для каждого из них ?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1769#respond' onclick='return addComment.moveForm( "comment-1769", "1769", "respond", "4993" )' aria-label='Комментарий к записи Player'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1770">
		<div  class="comment even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/6c206f00af16509376e396ca7d53179f?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Vitaliy</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1770">	24.05.2017 at 15:19</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Можно посмотреть здесь: <a href="https://www.dr.arut.ru/nastroyka-zapisey-spf-i-dkim-dlya-servera/" rel="nofollow">https://www.dr.arut.ru/nastroyka-zapisey-spf-i-dkim-dlya-servera/</a><br />
Там есть пример с несколькими доменами</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1770#respond' onclick='return addComment.moveForm( "comment-1770", "1770", "respond", "4993" )' aria-label='Комментарий к записи Vitaliy'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1772">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Player</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1772">	24.05.2017 at 15:27</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Ну по сути так все и сделал. Т.е. повторил все действия из пункта «Настройка dkim и spf» единственное что закоментировал строку # KeyFile /etc/postfix/dkim/mail.mydomain.com.private<br />
Теперь mail-tester.com на почту с обоих доменов показывает 10/10</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1772#respond' onclick='return addComment.moveForm( "comment-1772", "1772", "respond", "4993" )' aria-label='Комментарий к записи Player'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1771">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1771">	24.05.2017 at 15:26</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Да, если доменов несколько, то надо настраивать отдельно для каждого. Но никаких сложностей с этим нет, для dkim много информации в инете, в том числе с примерами нескольких доменов.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1771#respond' onclick='return addComment.moveForm( "comment-1771", "1771", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1786">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Player</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1786">	25.05.2017 at 15:58</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день.<br />
Может кто помочь с такой бедой<br />
connect to mx.yandex.ru[93.158.134.89]:25: Connection timed out<br />
connect to mx.yandex.ru[213.180.204.89]:25: Connection timed out<br />
connect to mx.yandex.ru[213.180.193.89]:25: Connection timed out</p>
<p>Только при отправке писем на ящики Яндекса</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1786#respond' onclick='return addComment.moveForm( "comment-1786", "1786", "respond", "4993" )' aria-label='Комментарий к записи Player'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1796">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1796">	29.05.2017 at 12:05</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Могу предположить, что ты из Украины и у тебя забанили Яндекс.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1796#respond' onclick='return addComment.moveForm( "comment-1796", "1796", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1841">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1841">	04.06.2017 at 14:26</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Привет!<br />
А где у Вас написано, что postfix должне слушать 25-й порт?<br />
Вроде же как одним 587-м обойтись нельзя 😉</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1841#respond' onclick='return addComment.moveForm( "comment-1841", "1841", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1842">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1842">	04.06.2017 at 15:46</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Так он по-умолчанию на нем работает. Специально не надо указывать. Я даже не помню, где это настраивается, никогда не менял и не трогал.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1842#respond' onclick='return addComment.moveForm( "comment-1842", "1842", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1844">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1844">	04.06.2017 at 15:51</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>В &#171;Битрикс Веб Окружение&#187; (php7.0, mariadb 5.5) пришлось для круглокубика ставить постгрес, т.к. Roundcube, не работает с php-mysqlnd 🙁  Просто задача привелосипедить почтовый сервис к битриксу, вот и мучаюсь потихоньку. Спасибо за статью, пока вроде ошибок в ней не обнаружил 😀</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1844#respond' onclick='return addComment.moveForm( "comment-1844", "1844", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1845">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1845">	04.06.2017 at 15:53</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Это, кстати, известная проблема. С php-mysqlnd много чего не работает. У меня тут уже жаловались в комментариях к другим статьям.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1845#respond' onclick='return addComment.moveForm( "comment-1845", "1845", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1843">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1843">	04.06.2017 at 15:47</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Уже разобрался, вопрос снимается.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1843#respond' onclick='return addComment.moveForm( "comment-1843", "1843", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1846">
		<div  class="comment even thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1846">	04.06.2017 at 17:45</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Вроде известная ошибка, но пока ничего не нагугливается. Пароль к БД postfixadmin правильный, но все равно отказ в доступе<br />
Error: mysql(127.0.0.1): Connect failed to database (postfix): Access denied for user &#8216;postfix&#8217;@&#8217;127.0.0.1&#8217; (using password: YES) &#8212; waiting for 25 seconds before retry<br />
В чем может быть дело? Исходя из Вашего опыта.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1846#respond' onclick='return addComment.moveForm( "comment-1846", "1846", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1849">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1849">	05.06.2017 at 10:23</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Я очень много раз устанавливал postfixadmin. Никогда не было проблем с доступом к mysql, если все указано верно, все пользователи созданы и права на базы розданы. Скорее всего где-то ошибка.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1849#respond' onclick='return addComment.moveForm( "comment-1849", "1849", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1851">
		<div  class="comment even depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1851">	05.06.2017 at 10:27</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Просто у меня пароли не открытым текстом, а CRAM-MD5. По данному вопросу уже с ЛОРа помогли товарищи: оказывается для Мускуля user@127.0.0.1 и user@localhost это два разных пользователя. Как-то так. 😀<br />
 Сейчас воюю с другими ошибками в связке dovecot mysql  postfixadmin.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1851#respond' onclick='return addComment.moveForm( "comment-1851", "1851", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1852">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1852">	05.06.2017 at 10:34</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Как я и думал 🙂</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1852#respond' onclick='return addComment.moveForm( "comment-1852", "1852", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1847">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1847">	04.06.2017 at 17:46</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Лог dovecot .</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1847#respond' onclick='return addComment.moveForm( "comment-1847", "1847", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-1969">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/04c7284d1f5b5d362131b54d2390758a?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/04c7284d1f5b5d362131b54d2390758a?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">чайник</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1969">	01.07.2017 at 01:15</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Все отлично, спасибо за статью, но вот беда&#8230; на моем CentOS 6.9 пишет что:<br />
No package dovecot available.<br />
No package dovecot-mysql available.<br />
No package dovecot-pigeonhole available.<br />
Error: Nothing to do</p>
<p>И похоже такой беды ни у кого не случалось)</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1969#respond' onclick='return addComment.moveForm( "comment-1969", "1969", "respond", "4993" )' aria-label='Комментарий к записи чайник'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1971">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1971">	01.07.2017 at 09:09</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Репозиторий epel может не подключен. А в чем сейчас смысл использовать centos6? Срок поддержки уже наполовину истек. Уже семерка года три как вышла.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1971#respond' onclick='return addComment.moveForm( "comment-1971", "1971", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-1994">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1994">	06.07.2017 at 07:56</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Доброе утро!<br />
Скажите, а как Вы думаете, например, для Debian Jessie/Stretch последовательность шагов по настройке сильно будет отличаться?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1994#respond' onclick='return addComment.moveForm( "comment-1994", "1994", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-1997">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-1997">	06.07.2017 at 10:15</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Практически не будет отличаться. Все пакеты настраиваются примерно одинаково на этих системах. Разница может быть небольшая в названиях во время установки, в некоторых путях, но сами конфиги основных программ &#8212; postfix, dovecot будут одинаковые.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=1997#respond' onclick='return addComment.moveForm( "comment-1997", "1997", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2004">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/ac4caa592bb480bf472343ff3fa9c461?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac4caa592bb480bf472343ff3fa9c461?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Владимир</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2004">	07.07.2017 at 06:48</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Здравствуйте. Огромное спасибо Вам за Ваши статьи. Впервые настраиваю почтовый сервер, сделал всё как написано у Вас. Вроде всё получилось и даже есть возможность обмениваться почтой внутри моего почтовика и отправлять почту наружу. Но вот с наружи почта не приходит, письмо отправляется но до моего сервера не доходит и в ответ нечего не возвращается, в логах тоже нечего нет. Подскажите в чем может быть причина, или куда мне посмотреть. И еще вопрос должен ли проходить telnet на 25 порт с наружу на почтовый сервер.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2004#respond' onclick='return addComment.moveForm( "comment-2004", "2004", "respond", "4993" )' aria-label='Комментарий к записи Владимир'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2010">
		<div  class="comment even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2010">	08.07.2017 at 06:47</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>MX-запись у DNS-регистратора домена указана?<br />
Да, 25-й порт должен быть открыть в любом случае.<br />
Просто для TLS c 25-го происходит редирект на 465-й или 587-й, как-то так.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2010#respond' onclick='return addComment.moveForm( "comment-2010", "2010", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2014">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/ac4caa592bb480bf472343ff3fa9c461?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac4caa592bb480bf472343ff3fa9c461?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Владимир</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2014">	10.07.2017 at 05:38</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>MX прописана.<br />
Но 25 порт почему то не откликается даже если телнетится с самого себя<br />
# telnet 127.0.0.1 25<br />
Trying 127.0.0.1&#8230;<br />
telnet: connect to address 127.0.0.1: Connection refused<br />
Хотя все остольные порты (465, 993, 143, 587) работают нормально. Подскажите что может быть не так.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2014#respond' onclick='return addComment.moveForm( "comment-2014", "2014", "respond", "4993" )' aria-label='Комментарий к записи Владимир'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2015">
		<div  class="comment even depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2015">	10.07.2017 at 07:11</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Могу предположить, что коннект на 25-й порт блокирует хостер.<br />
Но лучше пусть подскажет автор блога, когда он появится 🙂</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2015#respond' onclick='return addComment.moveForm( "comment-2015", "2015", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2016">
		<div  class="comment odd alt depth-5 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/ac4caa592bb480bf472343ff3fa9c461?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/ac4caa592bb480bf472343ff3fa9c461?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Владимир</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2016">	10.07.2017 at 08:50</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Разобрался. Надо было раскомментировать строку &#171;smtp      inet  n       &#8212;       &#8212;       &#8212;       &#8212;       smtpd&#187; в /etc/postfix/master.cf Я как то упустил этот момент.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2016#respond' onclick='return addComment.moveForm( "comment-2016", "2016", "respond", "4993" )' aria-label='Комментарий к записи Владимир'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2009">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2009">	08.07.2017 at 06:45</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Приветствую!<br />
Еще такой вопрос, а почему Вы не создавали список доверенных хостов для opendkim, файл trustedhosts ?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2009#respond' onclick='return addComment.moveForm( "comment-2009", "2009", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-2012">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Andrey</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2012">	10.07.2017 at 02:03</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Хотелось бы увидеть данную развертку, на основе контейнера turnkey NGINX в proxmox. Ну в принципе можно развернуть контейнер на основе centOS, но мне больше нравится debian.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2012#respond' onclick='return addComment.moveForm( "comment-2012", "2012", "respond", "4993" )' aria-label='Комментарий к записи Andrey'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2017">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2017">	10.07.2017 at 16:09</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Основы тут расписаны, в контейнеры уже сами собирайте 🙂 У меня нет времени этим заниматься, хотя мысли такие были. Но тут либо меньше статей, но с готовыми образами/контейнерами, либо больше статей, но только с описаниями/конфигами. Мне самому интереснее второе, так как больше тем успеваю охватить.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2017#respond' onclick='return addComment.moveForm( "comment-2017", "2017", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2020">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Andrey</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2020">	10.07.2017 at 18:58</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>И на том спасибо, сейчас пытаюсь все это запихнуть в &#171;дебиане стретч&#187;, посмотрим что выйдет, как сделаю отпишусь.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2020#respond' onclick='return addComment.moveForm( "comment-2020", "2020", "respond", "4993" )' aria-label='Комментарий к записи Andrey'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2023">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/1b26ba20208f407aa57af835ac03d44b?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b26ba20208f407aa57af835ac03d44b?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">timur</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2023">	11.07.2017 at 22:38</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день, спасибо за статью. </p>
<p>Можете подсказать, почему если я пытаюсь запустить скрипт  <a href="http://172.16.0.2/postfixadmin/setup.php" rel="nofollow">http://172.16.0.2/postfixadmin/setup.php</a></p>
<p>The 172.16.0.2 page isn’t working</p>
<p>172.16.0.2 is currently unable to handle this request.<br />
HTTP ERROR 500<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br />
хотя <a href="http://172.16.0.2/index.php" rel="nofollow">http://172.16.0.2/index.php</a> отрабатывает верно. </p>
<p>PATH	/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin<br />
SERVER_SIGNATURE	no value<br />
SERVER_SOFTWARE	Apache/2.4.6 (CentOS) PHP/5.4.16<br />
SERVER_NAME	172.16.0.2<br />
SERVER_ADDR	172.16.0.2<br />
SERVER_PORT	80</p>
<p>iptables отключил, SELINUX=disabled</p>
<p>права назначены chown -R apache. /var/www/html/postfixadmin/</p>
<p>-rw-rw-r&#8212;.  1 apache apache 17103 Jun 25 21:02 setup.php</p>
<p>Заранее благодарен.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2023#respond' onclick='return addComment.moveForm( "comment-2023", "2023", "respond", "4993" )' aria-label='Комментарий к записи timur'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2024">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2024">	11.07.2017 at 22:44</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Не знаю, трудно так сказать. Но явно что-то не то. Вообще, это очень простой вопрос. Никаких особых настроек веб сервера не надо для работы postfixadmin. Достаточно просто дефолтных настроек сервера после установки и все. Работать должно без проблем, просто папку со криптами копируете в корень веб сервера.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2024#respond' onclick='return addComment.moveForm( "comment-2024", "2024", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2026">
		<div  class="comment even depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/1b26ba20208f407aa57af835ac03d44b?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b26ba20208f407aa57af835ac03d44b?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">timur</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2026">	11.07.2017 at 23:50</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо за ответ.<br />
Нашел проблему, хорошо, что есть логи..<br />
но теперь пишет такое </p>
<p>ERROR: the templates_c directory doesn&#8217;t exist or isn&#8217;t writeable for the webserver</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2026#respond' onclick='return addComment.moveForm( "comment-2026", "2026", "respond", "4993" )' aria-label='Комментарий к записи timur'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2027">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/1b26ba20208f407aa57af835ac03d44b?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b26ba20208f407aa57af835ac03d44b?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">timur</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2027">	12.07.2017 at 00:08</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Удивительно, но решилось созданием пустой папки templates_c и с правами apache<br />
возможно это проблема postfixadmin 3.1</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2027#respond' onclick='return addComment.moveForm( "comment-2027", "2027", "respond", "4993" )' aria-label='Комментарий к записи timur'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2459">
		<div  class="comment even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/c0b34e84b553f11f5897cc0b0ca26f87?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/c0b34e84b553f11f5897cc0b0ca26f87?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Stanleygoo</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2459">	22.09.2017 at 08:43</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо!<br />
Помогло.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2459#respond' onclick='return addComment.moveForm( "comment-2459", "2459", "respond", "4993" )' aria-label='Комментарий к записи Stanleygoo'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2028">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/ec7ce111bb43211f80d14892cddc8a59?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/ec7ce111bb43211f80d14892cddc8a59?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Евгений</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2028">	12.07.2017 at 13:51</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день, спасибо за статью, настроил и все почти заработало, но есть проблема, письма из вне не доходят, в логе &#171;/var/log/maillog&#187; появляется (пример от гугла, но пробовал яндкес,маил):</p>
<p>Jul 12 13:48:39 имя_сервера postfix/smtpd[2452]: connect from mail-yw0-f177.google.com[209.85.161.177]<br />
Jul 12 13:48:39 имя_сервера postfix/smtpd[2452]: lost connection after CONNECT from mail-yw0-f177.google.com[209.85.161.177]<br />
Jul 12 13:48:39 имя_сервера postfix/smtpd[2452]: disconnect from mail-yw0-f177.google.com[209.85.161.177]</p>
<p>куда смотреть, в чем может быть проблема?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2028#respond' onclick='return addComment.moveForm( "comment-2028", "2028", "respond", "4993" )' aria-label='Комментарий к записи Евгений'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2029">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2029">	12.07.2017 at 13:57</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Это похоже на сетевую проблему. Пробуйте сами из вне подключаться по телнету на 25 порт, отправлять письмо и смотреть, в какой момент возникают проблемы и разрыв соединения.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2029#respond' onclick='return addComment.moveForm( "comment-2029", "2029", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2030">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4a91179a761802d6170e6b02d508d6c0?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a91179a761802d6170e6b02d508d6c0?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">n1k</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2030">	12.07.2017 at 14:44</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>проблема: не удается подключиться по imap по внешнему адресу, только через внутренний интерфейс.<br />
всё остальное вроде бы работет: т.е. подключаюсь thunderbird&#8217;ом по адресу 192.168.*.*, вижу письма, отправляю ответ на гмейл, туда приходит, всё ок.<br />
в dovecot.conf:<br />
listen = *</p>
<p>netstat:<br />
0.0.0.0:143             0.0.0.0:*               LISTEN      1620/dovecot</p>
<p>iptables вообще Chain INPUT policy ACCEPT</p>
<p><a href="http://ping.eu/port-chk/" rel="nofollow">http://ping.eu/port-chk/</a> говорит порты открыты, а telnet снаружи или почтовый клиент по внешнему адресу не работает.<br />
помогите найти, куда копать, что проверить?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2030#respond' onclick='return addComment.moveForm( "comment-2030", "2030", "respond", "4993" )' aria-label='Комментарий к записи n1k'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2031">
		<div  class="comment even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4a91179a761802d6170e6b02d508d6c0?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a91179a761802d6170e6b02d508d6c0?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">n1k</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2031">	12.07.2017 at 15:02</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>решено, всё ок.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2031#respond' onclick='return addComment.moveForm( "comment-2031", "2031", "respond", "4993" )' aria-label='Комментарий к записи n1k'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2032">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2032">	12.07.2017 at 15:03</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>В чем была проблема?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2032#respond' onclick='return addComment.moveForm( "comment-2032", "2032", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2033">
		<div  class="comment even depth-4 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4a91179a761802d6170e6b02d508d6c0?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4a91179a761802d6170e6b02d508d6c0?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">n1k</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2033">	12.07.2017 at 15:13</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>со связкой centos+postfix+dovecot всё было в порядке. связано с кривой настройкой маршрутов.<br />
со сторонних компьютеров из внешнего мира работает как надо.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2033#respond' onclick='return addComment.moveForm( "comment-2033", "2033", "respond", "4993" )' aria-label='Комментарий к записи n1k'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2041">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/5b177ded968292f254147c2a18b789ab?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/5b177ded968292f254147c2a18b789ab?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Евгений</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2041">	15.07.2017 at 05:50</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо за статьи. Сделал все по гайду, подключаюсь через тандерберд коннект проходит, но сообщения не загружаются и при отправке почты ошибка: Sending of the message failed.<br />
An error occurred while sending mail: Unable to establish a secure link with Outgoing server (SMTP) mail.somedomain.ru using STARTTLS since it doesn&#8217;t advertise that feature. Switch off STARTTLS for that server or contact your service provider.<br />
Что я делаю не так?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2041#respond' onclick='return addComment.moveForm( "comment-2041", "2041", "respond", "4993" )' aria-label='Комментарий к записи Евгений'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2045">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2045">	15.07.2017 at 08:58</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Гуглить ошибки надо и исправлять.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2045#respond' onclick='return addComment.moveForm( "comment-2045", "2045", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2042">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2042">	15.07.2017 at 07:05</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Приветствую!<br />
А Вы не пользовались веб-интерфейсом и органайзером SOGo?<br />
Понимаю, что круглокубик прост и надёжен как АК-47, но все-таки 🙂<br />
И да, поднял по данной инструкции почтовик на Debian 8, все завелось.<br />
Нужно только учитывать, что в Центе и в Дебиане dovecot опакечен по разному.<br />
В Дебе пакетов больше 😉</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2042#respond' onclick='return addComment.moveForm( "comment-2042", "2042", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2044">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2044">	15.07.2017 at 08:57</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Пользовался. Мне у него интерфейс не нравится, хотя он предлагает некоторый дополнительный функционал.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2044#respond' onclick='return addComment.moveForm( "comment-2044", "2044", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2046">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2046">	15.07.2017 at 09:15</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Да и нужно отметить, что интерфейс у него достаточно тормозной.<br />
Не знаю, может в Хромимуме все по-другому, но у меня в Лисе так.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2046#respond' onclick='return addComment.moveForm( "comment-2046", "2046", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2067">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7211ee773acee1a934d8742b2cb0daaf?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://linux.org.ru' rel='external nofollow' class='url'>Антон</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2067">	19.07.2017 at 22:34</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Доброй ночи!<br />
А не хотите ли со временем написать подобную статью, только с использованием exim4 как MTA?!<br />
Например, как это описано здесь — <a href="http://t-machine.org/index.php/2014/06/27/webmail-on-your-debian-server-exim4-dovecot-roundcube/" rel="nofollow">http://t-machine.org/index.php/2014/06/27/webmail-on-your-debian-server-exim4-dovecot-roundcube/</a></p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2067#respond' onclick='return addComment.moveForm( "comment-2067", "2067", "respond", "4993" )' aria-label='Комментарий к записи Антон'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2069">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2069">	20.07.2017 at 09:52</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Думал об этом. Exim популярный почтовик, возможно даже более популярный, чем postfix. Но для меня это будет только трата времени. Я неплохо знаю postfix, умею на нем реализовывать все потребности почты, поэтому не вижу для себя смысла изучать еще и exim.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2069#respond' onclick='return addComment.moveForm( "comment-2069", "2069", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2094">
		<div  class="comment even thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Andrey</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2094">	25.07.2017 at 02:29</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Нужна помощь или наставление, сервак завелся все нормально, почта уходит, но входящие письма реджектятся, а реджектит их СПФ, так как сервак у меня внутри локалки, и все писма приходят от IP прокси на котором iptables, а нет от IP отправителя, перед прокси стоит маршрутизатор. Пример:<br />
1.2.3.4 &#8212; отправитель;</p>
<p>2.2.2.2 &#8212; публичный адрес на маршрутизаторе;<br />
192.168.0.1 &#8212; локальный адрес на маршрутизаторе;</p>
<p>192.168.0.2 &#8212; адрес прокси со стороны маршрутизатора;<br />
192.168.1.1 &#8212; адрес прокси со стороны локалки;</p>
<p>192.168.1.95 &#8212; адрес почтовика.</p>
<p>На прокси настроен iptables, на старый почтовик почта ходит, но тоже от 192.168.1.1, а на этом не хочет.в логе пишет:<br />
Jul 25 00:12:07 mail policyd-spf[2880]: None; identity=helo; client-ip=192.168.1.1; helo=smtp.fmail.net; envelope-from=chikisan@ex.ua; receiver=rav@agt-ua.com<br />
Jul 25 00:12:07 mail policyd-spf[2880]: Fail; identity=mailfrom; client-ip=192.168.1.1; helo=smtp.fmail.net; envelope-from=chikisan@ex.ua; receiver=rav@agt-ua.com<br />
Jul 25 00:12:07 mail postfix/smtpd[2875]: NOQUEUE: reject: RCPT from unknown[192.168.1.1]: 550 5.7.1 : Recipient address rejected: Message rejected due to: SPF fail &#8212; not authorized. Please see <a href="http://www.openspf.net/Why?s=mfrom;id=chikisan@ex.ua;ip=192.168.1.1;r=rav@agt-ua.com" rel="nofollow">http://www.openspf.net/Why?s=mfrom;id=chikisan@ex.ua;ip=192.168.1.1;r=rav@agt-ua.com</a>; from= to= proto=ESMTP helo=<br />
Jul 25 00:12:07 mail postfix/smtpd[2875]: disconnect from unknown[192.168.1.1] </p>
<p> Как настроить iptables что бы адрес был отправителя &#171;1.2.3.4&#187;?</p>
<p>iptables:<br />
# Generated by iptables-save v1.4.21 on Tue Jul  5 17:58:10 2016<br />
*filter<br />
:INPUT ACCEPT [151:84745]<br />
:FORWARD ACCEPT [974:219853]<br />
:OUTPUT ACCEPT [128:83906]<br />
-A FORWARD -d 192.168.1.95/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 465 -j ACCEPT<br />
-A FORWARD -d 192.168.1.95/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 993 -j ACCEPT<br />
-A FORWARD -d 192.168.1.95/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 110 -j ACCEPT<br />
-A FORWARD -d 192.168.1.95/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 995 -j ACCEPT<br />
-A FORWARD -d 192.168.1.95/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 143 -j ACCEPT<br />
-A FORWARD -d 192.168.1.95/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 25 -j ACCEPT<br />
-A FORWARD -d 192.168.1.88/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 80 -j ACCEPT<br />
-A FORWARD -d 192.168.1.88/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 443 -j ACCEPT<br />
-A FORWARD -d 192.168.1.150/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 3389 -j ACCEPT<br />
-A FORWARD -d 192.168.1.115/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 3389 -j ACCEPT<br />
-A FORWARD -d 192.168.1.100/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 3389 -j ACCEPT<br />
-A FORWARD -d 192.168.1.120/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 3389 -j ACCEPT<br />
-A FORWARD -d 192.168.1.95/32 -i eth0 -o eth1 -p tcp -m tcp &#8212;dport 3389 -j ACCEPT<br />
-A FORWARD -s 192.168.1.0/24 -i eth1 -o eth0 -p tcp -m multiport &#8212;dports 443,21,22 -j ACCEPT<br />
-A FORWARD -d 192.168.0.1/32 -p tcp -m tcp &#8212;dport 80 -j ACCEPT<br />
COMMIT<br />
# Completed on Tue Jul  5 17:58:10 2016<br />
# Generated by iptables-save v1.4.21 on Tue Jul  5 17:58:10 2016<br />
*nat<br />
:PREROUTING ACCEPT [1:129]<br />
:INPUT ACCEPT [0:0]<br />
:OUTPUT ACCEPT [0:0]<br />
:POSTROUTING ACCEPT [0:0]<br />
#-A PREROUTING -i eth0 -p tcp -m tcp &#8212;dport 80 -j DNAT &#8212;to-destination 192.168.1.1:3128<br />
#-A PREROUTING -i eth1 -p tcp -m tcp &#8212;dport 80 -j REDIRECT &#8212;to-ports 3128<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 40006 -j DNAT &#8212;to-destination 192.168.1.100:3389<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 40007 -j DNAT &#8212;to-destination 192.168.1.120:3389<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 40010 -j DNAT &#8212;to-destination 192.168.1.115:3389<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 40008 -j DNAT &#8212;to-destination 192.168.1.150:3389<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 40009 -j DNAT &#8212;to-destination 192.168.1.95:3389<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 25 -j DNAT &#8212;to-destination 192.168.1.95:25<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 82 -j DNAT &#8212;to-destination 192.168.1.88:80<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 443 -j DNAT &#8212;to-destination 192.168.1.88:443<br />
-A PREROUTING -d 192.168.1.1/32 -p tcp -m tcp &#8212;dport 44 -j DNAT &#8212;to-destination 192.168.0.1:80<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 465 -j DNAT &#8212;to-destination 192.168.1.95:465<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 993 -j DNAT &#8212;to-destination 192.168.1.95:993<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 143 -j DNAT &#8212;to-destination 192.168.1.95:143<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 993 -j DNAT &#8212;to-destination 192.168.1.95:995<br />
-A PREROUTING -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 143 -j DNAT &#8212;to-destination 192.168.1.95:110<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 3389 -j DNAT &#8212;to-destination 192.168.1.100<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 3389 -j DNAT &#8212;to-destination 192.168.1.115<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 3389 -j DNAT &#8212;to-destination 192.168.1.120<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 3389 -j DNAT &#8212;to-destination 192.168.1.150<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 3389 -j DNAT &#8212;to-destination 192.168.1.95<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 25 -j DNAT &#8212;to-destination 192.168.1.95<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 80 -j DNAT &#8212;to-destination 192.168.1.88<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 443 -j DNAT &#8212;to-destination 192.168.1.88<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 465 -j DNAT &#8212;to-destination 192.168.1.95<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 993 -j DNAT &#8212;to-destination 192.168.1.95<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 143 -j DNAT &#8212;to-destination 192.168.1.95<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 995 -j DNAT &#8212;to-destination 192.168.1.95<br />
-A OUTPUT -d 192.168.0.2/32 -p tcp -m tcp &#8212;dport 110 -j DNAT &#8212;to-destination 192.168.1.95<br />
-A POSTROUTING -j MASQUERADE<br />
-A POSTROUTING -d 192.168.1.100/32 -p tcp -m tcp &#8212;dport 3389 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.115/32 -p tcp -m tcp &#8212;dport 3389 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.120/32 -p tcp -m tcp &#8212;dport 3389 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.150/32 -p tcp -m tcp &#8212;dport 3389 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.95/32 -p tcp -m tcp &#8212;dport 3389 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.95/32 -p tcp -m tcp &#8212;dport 25 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.88/32 -p tcp -m tcp &#8212;dport 80 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.88/32 -p tcp -m tcp &#8212;dport 443 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.0.1/32 -p tcp -m tcp &#8212;dport 80 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.95/32 -p tcp -m tcp &#8212;dport 465 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.95/32 -p tcp -m tcp &#8212;dport 993 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.95/32 -p tcp -m tcp &#8212;dport 143 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.95/32 -p tcp -m tcp &#8212;dport 995 -j SNAT &#8212;to-source 192.168.1.1<br />
-A POSTROUTING -d 192.168.1.95/32 -p tcp -m tcp &#8212;dport 110 -j SNAT &#8212;to-source 192.168.1.1<br />
COMMIT<br />
# Completed on Tue Jul  5 17:58:10 2016</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2094#respond' onclick='return addComment.moveForm( "comment-2094", "2094", "respond", "4993" )' aria-label='Комментарий к записи Andrey'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2099">
		<div  class="comment byuser comment-author-zerox bypostauthor odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2099">	25.07.2017 at 22:12</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Суть проблемы понял, но не понял, откуда она взялась. Если просто на маршрутизаторе с iptables настроить проброс портов на почтовый сервер, то он будет видеть правильные внешние ip отправителей.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2099#respond' onclick='return addComment.moveForm( "comment-2099", "2099", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2102">
		<div  class="comment even depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Andrey</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2102">	25.07.2017 at 22:37</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Вот и я о том же, с маршрутизатора ИП идет нормальный, а вот прокся подставляет свой, в ХЕЛО письма записан норм айпи, ну а по конфиге Таблеса все норм?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2102#respond' onclick='return addComment.moveForm( "comment-2102", "2102", "respond", "4993" )' aria-label='Комментарий к записи Andrey'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-2103">
		<div  class="comment odd alt depth-3 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/4b59995da6ef1f63955f59723acbce19?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Andrey</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2103">	25.07.2017 at 23:14</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Подменил не на долго сервак, почта доходит но только с более менее нормальных сервисов, может вообще проксю вырежу с цепи, она особо свою роль и не выполняет, все равно все лазят где хотят, а все компы в АД, без пароля никто и так не зайдет</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2103#respond' onclick='return addComment.moveForm( "comment-2103", "2103", "respond", "4993" )' aria-label='Комментарий к записи Andrey'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2104">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7f96f9c2333a1c68fc15497a2d32e2ce?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Player</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2104">	26.07.2017 at 10:27</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Добрый день.<br />
Подскажите как можно заблокировать прием всей почты из определенной зоны? Сейчас сильно активизировался спам из зоны *.bid Хотелось письма из этой зоны вообще не принимать.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2104#respond' onclick='return addComment.moveForm( "comment-2104", "2104", "respond", "4993" )' aria-label='Комментарий к записи Player'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-2154">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/3d05024d1a2724f36157b84e05b71ede?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d05024d1a2724f36157b84e05b71ede?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Владимир</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2154">	08.08.2017 at 10:59</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Здравствуйте Подскажите пожалуйста. Все сделал по мануалу но выдает ошибку Aug 08 10:37:35  dovecot[14244]: Fatal: service(auth) Group doesn&#8217;t exist: vmail (See service auth { unix_listener /var/run/dovecot/auth-userdb {&#8230;} setting) Спасибо)</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2154#respond' onclick='return addComment.moveForm( "comment-2154", "2154", "respond", "4993" )' aria-label='Комментарий к записи Владимир'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-2155">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/3d05024d1a2724f36157b84e05b71ede?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/3d05024d1a2724f36157b84e05b71ede?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Владимир</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2155">	08.08.2017 at 12:39</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Спасибо разобрался )))</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2155#respond' onclick='return addComment.moveForm( "comment-2155", "2155", "respond", "4993" )' aria-label='Комментарий к записи Владимир'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-2173">
		<div  class="comment odd alt thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo avatar-default' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Дим</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2173">	11.08.2017 at 21:11</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>ДВС.<br />
Упёрся в<br />
&#171;chown vmail. /mnt/mail&#187;.<br />
ЧТО эта команда делает?<br />
У меня фря 10,3, точка в конце vmail вызывает<br />
illegal user name<br />
Голову уже сломал&#8230;</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2173#respond' onclick='return addComment.moveForm( "comment-2173", "2173", "respond", "4993" )' aria-label='Комментарий к записи Дим'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2174">
		<div  class="comment byuser comment-author-zerox bypostauthor even depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/021a5c3751266898c63b1b4431985d02?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Zerox</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2174">	11.08.2017 at 21:12</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Это аналог:<br />
chown vmail:vmail /mnt/mail<br />
Просто писать короче 🙂</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2174#respond' onclick='return addComment.moveForm( "comment-2174", "2174", "respond", "4993" )' aria-label='Комментарий к записи Zerox'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2201">
		<div  class="comment odd alt thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/7fdd9117b4b012101cd8a01d3f6395e0?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/7fdd9117b4b012101cd8a01d3f6395e0?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn">Сергей</cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2201">	17.08.2017 at 17:52</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>У нас почему-то раньше всех затык. Веб-сервер работает нормально &#8212; страница-заглушка отображается.<br />
phpmyadmin &#8212; работает. postfixadmin работать отказывается, в браузере &#8212; внутренняя ошибка сайта &#8212; HTTP 500.<br />
Уже пробовали копировать все команды с сайта, но старницу setup.php не открывает. Все каталоги и расположения &#8212; стандартные.<br />
В конфиге httpd действительно нигде не нужно указывать каких-то настроек связанных с postfixadmin?</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2201#respond' onclick='return addComment.moveForm( "comment-2201", "2201", "respond", "4993" )' aria-label='Комментарий к записи Сергей'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li id="comment-2211">
		<div  class="comment even thread-odd thread-alt depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d5b9790fb91bad79b0f256a53625e66a?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5b9790fb91bad79b0f256a53625e66a?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://elektron.lv' rel='external nofollow' class='url'>Aleksey K</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2211">	22.08.2017 at 01:28</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Полагаю, что вместо :<br />
    # chown vmail. /var/run/dovecot/auth-master<br />
нужно бы сделать так:<br />
    #mkdir /var/run/dovecot/auth-master &amp;&amp; chown vmail. /var/run/dovecot/auth-master</p>
<p>Так-же, на CentOS7 со включенным SELinux, перед # systemctl start dovecot нужно бы выполнить # restorecon -v /var/log/dovecot, иначе получим dovecot[6800]: Can&#8217;t open log file /var/log/dovecot/main.log: Permission denied</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2211#respond' onclick='return addComment.moveForm( "comment-2211", "2211", "respond", "4993" )' aria-label='Комментарий к записи Aleksey K'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li id="comment-2212">
		<div  class="comment odd alt depth-2 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d5b9790fb91bad79b0f256a53625e66a?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5b9790fb91bad79b0f256a53625e66a?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://elektron.lv' rel='external nofollow' class='url'>Aleksey K</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2212">	22.08.2017 at 02:08</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>Ошибся:<br />
    #mkdir /var/run/dovecot/auth-master &amp;&amp; chown vmail. /var/run/dovecot/auth-master &#8212; Не верно!<br />
/var/run/dovecot/auth-master &#8212; это файл, он создается автоматически при запуске dovecot</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2212#respond' onclick='return addComment.moveForm( "comment-2212", "2212", "respond", "4993" )' aria-label='Комментарий к записи Aleksey K'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li id="comment-2213">
		<div  class="comment even thread-even depth-1 comment-wrap" >
			<div class="comment-avatar"><img alt='' src='https://secure.gravatar.com/avatar/d5b9790fb91bad79b0f256a53625e66a?s=65&#038;d=identicon&#038;r=g' srcset='https://secure.gravatar.com/avatar/d5b9790fb91bad79b0f256a53625e66a?s=130&amp;d=identicon&amp;r=g 2x' class='avatar avatar-65 photo' height='65' width='65' /></div>

			<div class="comment-content">
				<div class="author-comment">
					<cite class="fn"><a href='http://elektron.lv' rel='external nofollow' class='url'>Aleksey K</a></cite> 					<div class="comment-meta commentmetadata"><a href="https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/#comment-2213">	22.08.2017 at 04:03</a></div><!-- .comment-meta .commentmetadata -->
					<div class="clear"></div>
				</div>
			
									
				<p>И так, после часов мучений новая заметочка. Если вы столкнулись со следующим:<br />
   Error: user ххх: Initialization failed: Namespace &#187;: mkdir(/mnt/mail/ддд/ххх) failed: Permission denied (euid=1000(vmail) egid=1000(vmail) missing +w perm: /mnt/mail/ддд, UNIX perms appear ok (ACL/MAC wrong?))</p>
<p>Нужно выполнить следующее:<br />
    # semanage fcontext -a -t mail_home_rw_t &#8216;/mnt/mail(/.*)?&#8217;<br />
    # restorecon -v /mnt/mail</p>
<p>Выключать СЕЛинукс считаю профанацией.</p>
			</div>
			<div class="reply"><a rel='nofollow' class='comment-reply-link' href='https://serveradmin.ru/nastroyka-postfix-dovecot-centos-7/?replytocom=2213#respond' onclick='return addComment.moveForm( "comment-2213", "2213", "respond", "4993" )' aria-label='Комментарий к записи Aleksey K'>Ответить</a></div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ol>
				
		 

			
					
			
		</div>
	</div><!-- #comments-box -->
			

<div class="clear"></div>
	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Добавить комментарий <small><a rel="nofollow" id="cancel-comment-reply-link" href="/nastroyka-postfix-dovecot-centos-7/#respond" style="display:none;">Отменить ответ</a></small></h3>			<form action="https://serveradmin.ru/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
				<p class="comment-notes"><span id="email-notes">Ваш e-mail не будет опубликован.</span></p><p class="comment-form-comment"><label for="comment">Комментарий</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p><div  id="g-recaptcha-0" class="g-recaptcha" data-sitekey="6Lf-awsUAAAAANpq5nIhOaMMW6KOoPLtqoNqzHjw" data-theme="light"></div><noscript>Пожалуйста, разрешите JavaScript чтобы отправить эту форму.<br></noscript></p><p class="comment-form-author"><label for="author">Имя</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" /></p>
<p class="comment-form-email"><label for="email">E-mail</label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" /></p>
<p class="comment-form-url"><label for="url">Сайт</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Отправить комментарий" /> <input type='hidden' name='comment_post_ID' value='4993' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><!-- BEGIN: Email notification plugin by Elance360 --><p><label for='subscribe-reloaded'> Подписка на новые комментарии:<br /><select name='subscribe-reloaded' id='subscribe-reloaded'><option value='none'>Не отправлять уведомлений</option><option value='yes' selected='selected'>Отправить уведомление только при ответе на мой комментарий</option><option value='replies'>Отправить уведомление при появлении любого комментария</option></select></label></p><!-- END: Email notification plugin by Elance360 -->			</form>
			</div><!-- #respond -->
	

</div><!-- #comments -->
		
	</div><!-- .content -->
<aside id="sidebar">
	<div class="theiaStickySidebar">
<div id="text-html-widget-21" class="widget text-html"><div class="widget-top"><h4> </h4><div class="stripe-line"></div></div>
						<div class="widget-container"><div style="text-align:center;"><div id="kwork-widget"></div>
            <script type="text/javascript">
                (function() {
                    widgetOptions = {
                        width: 350,
                        catType:'42',    
                        count:'5',
                        ref:249810};

                    var script = document.createElement('script');
                    script.type = 'text/javascript';
                    script.async = true;
                    script.src = "https://kwork.ru/js/kwork_widget.js";
                    document.getElementsByTagName('head')[0].appendChild(script);
                })();
            </script>
				</div><div class="clear"></div></div></div><!-- .widget /--><div id="text-html-widget-8" class="widget text-html"><div class="widget-top"><h4>Хостинг</h4><div class="stripe-line"></div></div>
						<div class="widget-container"><div style="text-align:center;"><table style="width: 330px; height: 70px;" cellspacing="3">
<tbody>
<tr>
<td width="120"><a href="https://www.ihor.ru/?from=84981" onclick="trackOutboundLink('https://www.ihor.ru/?from=84981'); return false;" target="_blank"><img class="alignleft wp-image-2659 size-full" title="Надежный и быстрый хостинг на SSD за небольшие деньги" src="https://serveradmin.ru/wp-content/uploads/2016/01/hosting.gif" alt="Быстрый хостинг" width="120" height="60" /></a></td>
<td style="line-height:20px;padding:.4em;text-align: left;">Надежный и быстрый хостинг на SSD за небольшие деньги. Рекомендую, использую сам.</td>
</tr>
</tbody>
</table>
				</div><div class="clear"></div></div></div><!-- .widget /--><div id="text-html-widget-13" class="widget text-html"><div class="widget-top"><h4>Группа Вконтакте</h4><div class="stripe-line"></div></div>
						<div class="widget-container"><div ><script type="text/javascript" src="//vk.com/js/api/openapi.js?126"></script>

<!-- VK Widget -->
<div id="vk_groups"></div>
<script type="text/javascript">
VK.Widgets.Group("vk_groups", {redesign: 1, mode: 1, width: "350", height: "400", color1: 'FFFFFF', color2: '000000', color3: '5E81A8'}, 95686747);
</script>
				</div><div class="clear"></div></div></div><!-- .widget /--><div id="text-html-widget-20" class="widget text-html"><div class="widget-top"><h4>Чат в Telegram</h4><div class="stripe-line"></div></div>
						<div class="widget-container"><div style="text-align:center;"><a href="https://t.me/joinchat/AAAAAD_H1pmIcX3yfRlG_Q" target="_blank"><img class="aligncenter wp-image-4864 size-full" src="https://serveradmin.ru/wp-content/uploads/2017/02/chat-2.png" alt="Чат системных администраторов" width="330" height="45" /></a>
				</div><div class="clear"></div></div></div><!-- .widget /--><div id="text-html-widget-6" class="widget text-html"><div class="widget-top"><h4>Прикольная игра</h4><div class="stripe-line"></div></div>
						<div class="widget-container"><div ><a href="https://serveradmin.ru/igra-sistemnyiy-administrator/"><img class="aligncenter wp-image-2248 size-full" title="Симулятор системного администратора" src="https://serveradmin.ru/wp-content/uploads/2015/10/sysadmin-game.png" alt="Игра Системный администратор" width="330" height="245" />
				</div><div class="clear"></div></div></div><!-- .widget /--><div id="posts-list-widget-2" class="widget posts-list"><div class="widget-top"><h4>Популярное		</h4><div class="stripe-line"></div></div>
						<div class="widget-container">				<ul>
								<li >
						
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/vault-virus/" title="Как расшифровать файл с расширением vault после вируса шифровальщика" rel="bookmark"><img width="110" height="75" src="https://serveradmin.ru/wp-content/uploads/2015/04/virus-110x75.png" class="attachment-tie-small size-tie-small wp-post-image" alt="" /><span class="fa overlay-icon"></span></a>
				</div><!-- post-thumbnail /-->
							<h3><a href="https://serveradmin.ru/vault-virus/">Как расшифровать файл с расширением vault после вируса шифровальщика</a></h3>
				 <span class="tie-date"><i class="fa fa-clock-o"></i>12.08.2015</span>									<span class="post-views-widget"><span class="post-views"><i class="fa fa-eye"></i>264,176 </span> <span>
							</li>
				<li >
						
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/bazovaya-nastroyka-routera-mikrotik/" title="Как настроить микротик routerboard RB951G-2HnD" rel="bookmark"><img width="110" height="75" src="https://serveradmin.ru/wp-content/uploads/2015/12/mikrotik-settings-110x75.png" class="attachment-tie-small size-tie-small wp-post-image" alt="" /><span class="fa overlay-icon"></span></a>
				</div><!-- post-thumbnail /-->
							<h3><a href="https://serveradmin.ru/bazovaya-nastroyka-routera-mikrotik/">Как настроить микротик routerboard RB951G-2HnD</a></h3>
				 <span class="tie-date"><i class="fa fa-clock-o"></i>20.12.2015</span>									<span class="post-views-widget"><span class="post-views"><i class="fa fa-eye"></i>222,193 </span> <span>
							</li>
				<li >
						
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/centos-7-nastroyka-servera/" title="CentOS 7 настройка сервера" rel="bookmark"><img width="110" height="75" src="https://serveradmin.ru/wp-content/uploads/2015/03/centos-configure-110x75.png" class="attachment-tie-small size-tie-small wp-post-image" alt="Centos настройка" /><span class="fa overlay-icon"></span></a>
				</div><!-- post-thumbnail /-->
							<h3><a href="https://serveradmin.ru/centos-7-nastroyka-servera/">CentOS 7 настройка сервера</a></h3>
				 <span class="tie-date"><i class="fa fa-clock-o"></i>20.12.2015</span>									<span class="post-views-widget"><span class="post-views"><i class="fa fa-eye"></i>208,304 </span> <span>
							</li>
				<li >
						
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/nastroyka-seti-v-centos/" title="Сетевые настройки в CentOS 7" rel="bookmark"><img width="110" height="75" src="https://serveradmin.ru/wp-content/uploads/2015/09/network-logo-110x75.png" class="attachment-tie-small size-tie-small wp-post-image" alt="Настройка сети в CentOS" /><span class="fa overlay-icon"></span></a>
				</div><!-- post-thumbnail /-->
							<h3><a href="https://serveradmin.ru/nastroyka-seti-v-centos/">Сетевые настройки в CentOS 7</a></h3>
				 <span class="tie-date"><i class="fa fa-clock-o"></i>23.08.2015</span>									<span class="post-views-widget"><span class="post-views"><i class="fa fa-eye"></i>171,821 </span> <span>
							</li>
				<li >
						
				<div class="post-thumbnail">
					<a href="https://serveradmin.ru/mikrotik-nastroyka-prostogo-firewall/" title="Mikrotik настройка простого Firewall" rel="bookmark"><img width="110" height="75" src="https://serveradmin.ru/wp-content/uploads/2015/02/firewall-110x75.jpg" class="attachment-tie-small size-tie-small wp-post-image" alt="" /><span class="fa overlay-icon"></span></a>
				</div><!-- post-thumbnail /-->
							<h3><a href="https://serveradmin.ru/mikrotik-nastroyka-prostogo-firewall/">Mikrotik настройка простого Firewall</a></h3>
				 <span class="tie-date"><i class="fa fa-clock-o"></i>28.02.2015</span>									<span class="post-views-widget"><span class="post-views"><i class="fa fa-eye"></i>112,583 </span> <span>
							</li>
		
				</ul>
		<div class="clear"></div>
	</div></div><!-- .widget /--><div id="categories-4" class="widget widget_categories"><div class="widget-top"><h4>Рубрики</h4><div class="stripe-line"></div></div>
						<div class="widget-container">		<ul>
	<li class="cat-item cat-item-174"><a href="https://serveradmin.ru/category/1c/" >1C</a> (6)
</li>
	<li class="cat-item cat-item-133"><a href="https://serveradmin.ru/category/asterisk/" >Asterisk</a> (12)
</li>
	<li class="cat-item cat-item-65"><a href="https://serveradmin.ru/category/freebsd/" >Freebsd</a> (19)
</li>
	<li class="cat-item cat-item-31"><a href="https://serveradmin.ru/category/linux/" >Linux</a> (68)
<ul class='children'>
	<li class="cat-item cat-item-67"><a href="https://serveradmin.ru/category/linux/centos/" >CentOS</a> (39)
</li>
	<li class="cat-item cat-item-68"><a href="https://serveradmin.ru/category/linux/debian/" >Debian</a> (19)
</li>
</ul>
</li>
	<li class="cat-item cat-item-66"><a href="https://serveradmin.ru/category/mikrotik/" >Mikrotik</a> (9)
</li>
	<li class="cat-item cat-item-33"><a href="https://serveradmin.ru/category/synology/" >Synology</a> (3)
</li>
	<li class="cat-item cat-item-30"><a href="https://serveradmin.ru/category/windows/" >Windows</a> (15)
</li>
	<li class="cat-item cat-item-117"><a href="https://serveradmin.ru/category/zabbix/" >Zabbix</a> (27)
</li>
	<li class="cat-item cat-item-69"><a href="https://serveradmin.ru/category/virtual/" >Виртуализация</a> (22)
<ul class='children'>
	<li class="cat-item cat-item-70"><a href="https://serveradmin.ru/category/virtual/hyperv/" >Hyper-V</a> (9)
</li>
	<li class="cat-item cat-item-175"><a href="https://serveradmin.ru/category/virtual/kvm/" >KVM</a> (1)
</li>
	<li class="cat-item cat-item-146"><a href="https://serveradmin.ru/category/virtual/proxmox/" >Proxmox</a> (1)
</li>
	<li class="cat-item cat-item-72"><a href="https://serveradmin.ru/category/virtual/vmware/" >VMware</a> (2)
</li>
	<li class="cat-item cat-item-71"><a href="https://serveradmin.ru/category/virtual/xenserver/" >XenServer</a> (11)
</li>
</ul>
</li>
	<li class="cat-item cat-item-138"><a href="https://serveradmin.ru/category/lichnoe/" >Личное</a> (5)
</li>
	<li class="cat-item cat-item-91"><a href="https://serveradmin.ru/category/virus/" >Осторожно, вирус!</a> (8)
</li>
	<li class="cat-item cat-item-129"><a href="https://serveradmin.ru/category/errors/" >Ошибки</a> (18)
</li>
	<li class="cat-item cat-item-95"><a href="https://serveradmin.ru/category/poleznyie-sovetyi/" >Полезные советы</a> (24)
</li>
	<li class="cat-item cat-item-20"><a href="https://serveradmin.ru/category/raznoe/" >Разное</a> (9)
</li>
		</ul>
</div></div><!-- .widget /--><div id="text-html-widget-4" class="widget text-html"><div class="widget-top"><h4>Новости сайта на почту</h4><div class="stripe-line"></div></div>
						<div class="widget-container"><div style="text-align:center;"><form style="border:0px solid #ccc;padding:3px;text-align:center;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=serveradmin_ru', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
<input type="text" style="width:200px;margin:6px;" name="email" value=" Введите Ваш E-mail"/>
<input type="hidden" value="serveradmin_ru" name="uri"/>
<input type="hidden" name="loc" value="ru_RU"/><input type="submit"  style="width:100px;margin:6px;"value="Подписаться" /></form>
				</div><div class="clear"></div></div></div><!-- .widget /-->			<div id="text-html-widget-18" class="text-html-box" >
			<table class=" aligncenter" style="width: 310px; height: 255px;">
<tbody>
<tr>
<td>
<!-- Yandex.RTB R-A-184428-4 -->
<div id="yandex_rtb_R-A-184428-4"></div>
<script type="text/javascript">
    (function(w, d, n, s, t) {
        w[n] = w[n] || [];
        w[n].push(function() {
            Ya.Context.AdvManager.render({
                blockId: "R-A-184428-4",
                renderTo: "yandex_rtb_R-A-184428-4",
                async: true
            });
        });
        t = d.getElementsByTagName("script")[0];
        s = d.createElement("script");
        s.type = "text/javascript";
        s.src = "//an.yandex.ru/system/context.js";
        s.async = true;
        t.parentNode.insertBefore(s, t);
    })(this, this.document, "yandexContextAsyncCallbacks");
</script>
</td>
</tr>
</tbody>
</table>			</div>
			</div><!-- .theiaStickySidebar /-->
</aside><!-- #sidebar /-->	<div class="clear"></div>
</div><!-- .container /-->

<footer id="theme-footer">
	<div id="footer-widget-area" class="footer-2c">

			<div id="footer-first" class="footer-widgets-box">
			<div id="login-widget-2" class="footer-widget login-widget"><div class="footer-widget-top"><h4>Вход/Регистрация</h4></div>
						<div class="footer-widget-container">		<div id="login-form">
			<form name="loginform" id="loginform" action="https://serveradmin.ru/wp-login.php" method="post">
				<p id="log-username"><input type="text" name="log" id="log" title="Username" value="Username" onfocus="if (this.value == 'Username') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Username';}"  size="33" /></p>
				<p id="log-pass"><input type="password" name="pwd" id="pwd" title="Password" value="Password" onfocus="if (this.value == 'Password') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Password';}" size="33" /></p>
				<input type="submit" name="submit" value="Log in" class="login-button" />
				<label for="rememberme"><input name="rememberme" id="rememberme" type="checkbox" checked="checked" value="forever" /> Remember Me</label>
				<input type="hidden" name="redirect_to" value="/nastroyka-postfix-dovecot-centos-7/"/>
			</form>
			<ul class="login-links">
				<li><a rel="nofollow" href="https://serveradmin.ru/wp-login.php?action=register">Регистрация</a></li>				<li><a href="https://serveradmin.ru/wp-login.php?action=lostpassword&redirect_to=https://serveradmin.ru">Lost your password?</a></li>
			</ul>
		</div>
	</div></div><!-- .widget /-->		</div>
	
			<div id="footer-second" class="footer-widgets-box">
			<div id="text-2" class="footer-widget widget_text"><div class="footer-widget-top"><h4>Статистика</h4></div>
						<div class="footer-widget-container">			<div class="textwidget"><!-- Yandex.Metrika informer -->
<a href="https://metrika.yandex.ru/stat/?id=23506456&amp;from=informer"
target="_blank" rel="nofollow"><img src="https://informer.yandex.ru/informer/23506456/3_0_FFB953FF_FF9933FF_0_pageviews"
style="width:88px; height:31px; border:0;" alt="Яндекс.Метрика" title="Яндекс.Метрика: данные за сегодня (просмотры, визиты и уникальные посетители)" class="ym-advanced-informer" data-cid="23506456" data-lang="ru" /></a>
<!-- /Yandex.Metrika informer -->

<!-- begin of Top100 code -->
<script id="top100Counter" type="text/javascript" src="https://counter.rambler.ru/top100.jcn?3152045"></script>
<noscript>
<a href="http://top100.rambler.ru/navi/3152045/">
<img src="http://counter.rambler.ru/top100.cnt?3152045" alt="Rambler's Top100" border="0" />
</a>
</noscript>
<!-- end of Top100 code -->

<!-- Rating@Mail.ru logo -->
<a href="http://top.mail.ru/jump?from=2722258" target="_blank">
<img src="//top-fwz1.mail.ru/counter?id=2722258;t=494;l=1" 
style="border:0;" height="31" width="88" alt="Рейтинг@Mail.ru" /></a>
<!-- //Rating@Mail.ru logo --></div>
		</div></div><!-- .widget /-->		</div><!-- #second .widget-area -->
	

	
		
	</div><!-- #footer-widget-area -->
	<div class="clear"></div>
</footer><!-- .Footer /-->
				
<div class="clear"></div>
<div class="footer-bottom">
	<div class="container">
		<div class="alignright">
					</div>
				
		<div class="alignleft">
					</div>
		<div class="clear"></div>
	</div><!-- .Container -->
</div><!-- .Footer bottom -->

</div><!-- .inner-Wrapper -->
</div><!-- #Wrapper -->
</div><!-- .Wrapper-outer -->
	<div id="topcontrol" class="fa fa-angle-up" title="Scroll To Top"></div>
<div id="fb-root"></div>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-N32MZXJ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --><!-- Rating@Mail.ru counter -->
<script type="text/javascript">
var _tmr = window._tmr || (window._tmr = []);
_tmr.push({id: "2722258", type: "pageView", start: (new Date()).getTime()});
(function (d, w, id) {
  if (d.getElementById(id)) return;
  var ts = d.createElement("script"); ts.type = "text/javascript"; ts.async = true; ts.id = id;
  ts.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//top-fwz1.mail.ru/js/code.js";
  var f = function () {var s = d.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ts, s);};
  if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); }
})(document, window, "topmailru-code");
</script><noscript><div style="position:absolute;left:-10000px;">
<img src="//top-fwz1.mail.ru/counter?id=2722258;js=na" style="border:0;" height="1" width="1" alt="Рейтинг@Mail.ru" />
</div></noscript>
<!-- //Rating@Mail.ru counter --><div id="reading-position-indicator"></div>
<!-- BEGIN recaptcha, injected by plugin wp-recaptcha-integration  -->
<script type="text/javascript">
		var recaptcha_widgets={};
		function wp_recaptchaLoadCallback(){ 
			try {
				grecaptcha;
			} catch(err){
				return;
			}
			var e = document.querySelectorAll ? document.querySelectorAll('.g-recaptcha:not(.wpcf7-form-control)') : document.getElementsByClassName('g-recaptcha'),
				form_submits;

			for (var i=0;i<e.length;i++) {
				(function(el){
					var wid;
					// check if captcha element is unrendered
					if ( ! el.childNodes.length) {
						wid = grecaptcha.render(el,{
							'sitekey':'6Lf-awsUAAAAANpq5nIhOaMMW6KOoPLtqoNqzHjw',
							'theme':el.getAttribute('data-theme') || 'light'
						});
						el.setAttribute('data-widget-id',wid);
					} else {
						wid = el.getAttribute('data-widget-id');
						grecaptcha.reset(wid);
					}
				})(e[i]);
			}
		}
		
		// if jquery present re-render jquery/ajax loaded captcha elements 
		if ( typeof jQuery !== 'undefined' )
			jQuery(document).ajaxComplete( function(evt,xhr,set){
				if( xhr.responseText && xhr.responseText.indexOf('6Lf-awsUAAAAANpq5nIhOaMMW6KOoPLtqoNqzHjw') !== -1)
					wp_recaptchaLoadCallback();
			} );
		
		</script><script src="https://www.google.com/recaptcha/api.js?onload=wp_recaptchaLoadCallback&#038;render=explicit&#038;hl=ru" async defer></script>
<!-- END recaptcha -->
<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter23506456 = new Ya.Metrika({
                    id:23506456,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/23506456" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter --><script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"smooth_scroll":"1"};
var tocplus = {"smooth_scroll":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://serveradmin.ru/wp-content/plugins/table-of-contents-plus/front.min.js'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var tie = {"mobile_menu_active":"true","mobile_menu_top":"","lightbox_all":"true","lightbox_gallery":"","woocommerce_lightbox":"","lightbox_skin":"dark","lightbox_thumb":"vertical","lightbox_arrows":"","sticky_sidebar":"1","is_singular":"1","SmothScroll":"","reading_indicator":"true","lang_no_results":"No Results","lang_results_found":"Results Found"};
var tie = {"mobile_menu_active":"true","mobile_menu_top":"","lightbox_all":"true","lightbox_gallery":"","woocommerce_lightbox":"","lightbox_skin":"dark","lightbox_thumb":"vertical","lightbox_arrows":"","sticky_sidebar":"1","is_singular":"1","SmothScroll":"","reading_indicator":"true","lang_no_results":"No Results","lang_results_found":"Results Found"};
/* ]]> */
</script>
<script type='text/javascript' src='https://serveradmin.ru/wp-content/themes/sahifa/js/tie-scripts.js'></script>
<script type='text/javascript' src='https://serveradmin.ru/wp-content/themes/sahifa/js/ilightbox.packed.js'></script>
<script type='text/javascript' src='https://serveradmin.ru/wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='https://serveradmin.ru/wp-includes/js/wp-embed.min.js'></script>
<script type='text/javascript' src='https://serveradmin.ru/wp-content/themes/sahifa/js/tabs.min.js'></script>
</body>
</html>
<!-- Dynamic page generated in 1.414 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2017-10-07 18:29:35 -->

<!-- Compression = gzip -->