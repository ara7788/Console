(function(n){function t(t,i){this.element=t;this.settings=n.extend({},n.fn.rate.settings,i);this.set_faces={};this.build()}n.fn.textWidth=function(){var t=n("<span>"+n(this).html()+"<\/span>"),i,r;return(t.css("font-size",n(this).css("font-size")).hide(),t.prependTo("body"),i=t.width(),t.remove(),i==0)?(r=0,n(this).eq(0).children().each(function(){r+=n(this).textWidth()}),r):i};n.fn.textHeight=function(){var t=n("<span>"+n(this).html()+"<\/span>");return t.css("font-size",n(this).css("font-size")).hide(),t.prependTo("body"),t.remove(),height};Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"};String.prototype.getCodePointLength=function(){return this.length-this.split(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g).length+1};String.fromCodePoint=function(){for(var t,n=Array.prototype.slice.call(arguments),i=n.length;i-->0;)t=n[i]-65536,t>=0&&n.splice(i,1,55296+(t>>10),56320+(t&1023));return String.fromCharCode.apply(null,n)};n.fn.rate=function(i){if(i===undefined||typeof i=="object")return this.each(function(){n.data(this,"rate")||n.data(this,"rate",new t(this,i))});if(typeof i=="string"){var u=arguments,r;return this.each(function(){var f=n.data(this,"rate");f instanceof t&&typeof f[i]=="function"&&(r=f[i].apply(f,Array.prototype.slice.call(u,1)));i==="destroy"&&(n(f.element).off(),n.data(this,"rate",null))}),r!==undefined?r:this}};t.prototype.build=function(){var i,t;this.layers={};this.value=0;this.raise_select_layer=!1;this.settings.initial_value&&(this.value=this.settings.initial_value);n(this.element).attr("data-rate-value")&&(this.value=n(this.element).attr("data-rate-value"));i=this.value/this.settings.max_value*100;typeof this.settings.symbols[this.settings.selected_symbol_type]=="string"&&(t=this.settings.symbols[this.settings.selected_symbol_type],this.settings.symbols[this.settings.selected_symbol_type]={},this.settings.symbols[this.settings.selected_symbol_type].base=t,this.settings.symbols[this.settings.selected_symbol_type].selected=t,this.settings.symbols[this.settings.selected_symbol_type].hover=t);var r=this.addLayer("base-layer",100,"☆",!0),u=this.addLayer("select-layer",i,"★",!0),f=this.addLayer("hover-layer",0,"★",!1);this.layers.base_layer=r;this.layers.select_layer=u;this.layers.hover_layer=f;n(this.element).on("mousemove",n.proxy(this.hover,this));n(this.element).on("click",n.proxy(this.select,this));n(this.element).on("mouseleave",n.proxy(this.mouseout,this));n(this.element).css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"});this.value=this.toValue(i*n(r).textWidth());this.settings.hasOwnProperty("update_input_field_name")&&this.settings.update_input_field_name.val(this.value)};t.prototype.addLayer=function(t,i,r,u){for(var f,e="<div>",o=0;o<this.settings.max_value;o++)Array.isArray(r)?(this.settings.convert_to_utf8&&(r[o]=String.fromCodePoint(r[o])),e+="<span class='fa fa-star'><\/span>"):(this.settings.convert_to_utf8&&(r=String.fromCodePoint(r)),e+="<span class='fa fa-star'><\/span>");return e+="<\/div>",f=n(e).addClass("rate-"+t).appendTo(this.element),n(f).css({width:i+"%",height:34,overflow:"hidden",position:"absolute",top:0,display:u?"block":"none","white-space":"nowrap"}),n(this.element).css({width:n(f).textWidth()+"px",height:n(f).height(),position:"relative",cursor:this.settings.cursor}),f};t.prototype.updateServer=function(){if(this.settings.url!=undefined){var t={HelpTechTitle:this.settings.additional_data,Rate:this.getValue()};n.ajax({url:this.settings.url,type:this.settings.ajax_method,data:t,success:n.proxy(function(t){n(this.element).trigger("updateSuccess",[t])},this),error:n.proxy(function(t,i,r){n(this.element).trigger("updateError",[t,i,r])},this)})}};t.prototype.getValue=function(){return this.value};t.prototype.hover=function(t){var f=parseInt(n(this.element).css("padding-left").replace("px","")),e=t.pageX-n(this.element).offset().left-f,i=this.toValue(e,!0),u,r;i!=this.value&&(this.raise_select_layer=!1);this.raise_select_layer||this.settings.readonly||(u=this.toWidth(i),this.layers.select_layer.css({display:"none"}),this.settings.only_select_one_symbol?(r=Math.floor(i),this.layers.hover_layer.css({width:"100%",display:"block"}),this.layers.hover_layer.children("span").css({visibility:"hidden"}),this.layers.hover_layer.children("span").eq(r!=0?r-1:0).css({visibility:"visible"})):this.layers.hover_layer.css({width:u+"%",display:"block"}))};t.prototype.select=function(t){if(!this.settings.readonly){var f=this.getValue(),i=parseInt(n(this.element).css("padding-left").replace("px","")),r=t.pageX-n(this.element).offset().left-i,u=this.toWidth(this.toValue(r,!0));this.setValue(this.toValue(u));this.raise_select_layer=!0}};t.prototype.mouseout=function(){this.layers.hover_layer.css({display:"none"});this.layers.select_layer.css({display:"block"})};t.prototype.toWidth=function(n){return n/this.settings.max_value*100};t.prototype.toValue=function(n,t){var i,r;return i=t?n/this.layers.base_layer.textWidth()*this.settings.max_value:n/100*this.settings.max_value,r=i/this.settings.step_size,r-Math.floor(r)<5e-5&&(i=Math.round(i/this.settings.step_size)*this.settings.step_size),i=Math.ceil(i/this.settings.step_size)*this.settings.step_size,i>this.settings.max_value?this.settings.max_value:i};t.prototype.getElement=function(t,i){return n(this.element).find(".rate-"+t+" span").eq(i-1)};t.prototype.getLayers=function(){return this.layers};t.prototype.setFace=function(n,t){this.set_faces[n]=t};t.prototype.setAdditionalData=function(n){this.settings.additional_data=n};t.prototype.getAdditionalData=function(){return this.settings.additional_data};t.prototype.removeFace=function(n){delete this.set_faces[n]};t.prototype.setValue=function(t){var u,i,r,e;if(!this.settings.readonly){if(t<0?t=0:t>this.settings.max_value&&(t=this.settings.max_value),u=this.getValue(),this.value=t,e=n(this.element).trigger("change",{from:u,to:this.value}),n(this.element).find(".rate-face").remove(),n(this.element).find("span").css({visibility:"visible"}),i=Math.ceil(this.value),this.set_faces.hasOwnProperty(i)){var o="<div>"+this.set_faces[i]+"<\/div>",f=this.getElement("base-layer",i),s=this.getElement("select-layer",i),h=this.getElement("hover-layer",i),c=f.textWidth()*(i-1)+(f.textWidth()-n(o).textWidth())/2;n(o).appendTo(this.element).css({display:"inline-block",position:"absolute",left:c}).addClass("rate-face");f.css({visibility:"hidden"});s.css({visibility:"hidden"});h.css({visibility:"hidden"})}this.settings.only_select_one_symbol?(r=this.toWidth(this.settings.max_value),this.layers.select_layer.css({display:"block",width:r+"%",height:this.layers.base_layer.css("height")}),this.layers.hover_layer.css({display:"none",height:this.layers.base_layer.css("height")}),this.layers.select_layer.children("span").css({visibility:"hidden"}),this.layers.select_layer.children("span").eq(i!=0?i-1:0).css({visibility:"visible"})):(r=this.toWidth(this.value),this.layers.select_layer.css({display:"block",width:r+"%",height:this.layers.base_layer.css("height")}),this.layers.hover_layer.css({display:"none",height:this.layers.base_layer.css("height")}));n(this.element).attr("data-rate-value",this.value);this.settings.change_once&&(this.settings.readonly=!0);this.updateServer();e=n(this.element).trigger("afterChange",{from:u,to:this.value});this.settings.hasOwnProperty("update_input_field_name")&&this.settings.update_input_field_name.val(this.value)}};t.prototype.increment=function(){this.setValue(this.getValue()+this.settings.step_size)};t.prototype.decrement=function(){this.setValue(this.getValue()-this.settings.step_size)};n.fn.rate.settings={max_value:5,step_size:.5,initial_value:0,symbols:{utf8_star:{base:"☆",hover:"★",selected:"★"},utf8_hexagon:{base:"⬡",hover:"⬢",selected:"⬢"},hearts:"&hearts;",fontawesome_beer:'<i class="fa fa-beer"><\/i>',fontawesome_star:{base:'<i class="fa fa-star-o"><\/i>',hover:'<i class="fa fa-star"><\/i>',selected:'<i class="fa fa-star"><\/i>'},utf8_emoticons:{base:[128549,128531,128530,128516],hover:[128549,128531,128530,128516],selected:[128549,128531,128530,128516]}},selected_symbol_type:"utf8_star",convert_to_utf8:!1,cursor:"default",readonly:!1,change_once:!1,only_select_one_symbol:!1,ajax_method:"POST",additional_data:{}}})(jQuery,window);$(function(){var n={max_value:5,step_size:1,initial_value:5,symbols:{},selected_symbol_type:"utf8_star",convert_to_utf8:!1,cursor:"pointer",readonly:!1,change_once:!1,ajax_method:"POST",url:urlSendRating,additional_data:techTitle,only_select_one_symbol:!1};$(".rating").rate(n);$(".rating").on("updateSuccess",function(){$("#rating-success").removeClass("hidden");$("#rating-average").addClass("hidden");$(".rating").remove()});$(".rating").on("updateError",function(){$("#rating-error").removeClass("hidden")})})