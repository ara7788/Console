!function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return i(n?n:e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};t.exports=r},{}],2:[function(e,t,n){!function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(t){for(var n=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],a=0;a<4;a++)8*r+6*a<=8*t.length?n.push(e.charAt(i>>>6*(3-a)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&n.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|e.indexOf(t.charAt(r))>>>6-2*i);return n}};t.exports=n}()},{}],3:[function(e,t,n){var r=function(){var e=this;e.installed=!1,e.raw="",e.major=-1,e.minor=-1,e.revision=-1,e.revisionStr="";var t=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(e){return n(e)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(e){var t="6,0,21";try{e.AllowScriptAccess="always",t=n(e)}catch(r){}return t}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(e){return n(e)}}],n=function(e){var t=-1;try{t=e.GetVariable("$version")}catch(n){}return t},r=function(e){var t=-1;try{t=new ActiveXObject(e)}catch(n){t={activeXError:!0}}return t},a=function(e){var t=e.split(",");return{raw:e,major:parseInt(t[0].split(" ")[1],10),minor:parseInt(t[1],10),revision:parseInt(t[2],10),revisionStr:t[2]}},o=function(e){var t=e.split(/ +/),n=t[2].split(/\./),r=t[3];return{raw:e,major:parseInt(n[0],10),minor:parseInt(n[1],10),revisionStr:r,revision:s(r)}},s=function(t){return parseInt(t.replace(/[a-zA-Z]/g,""),10)||e.revision};e.majorAtLeast=function(t){return e.major>=t},e.minorAtLeast=function(t){return e.minor>=t},e.revisionAtLeast=function(t){return e.revision>=t},e.versionAtLeast=function(t){var n=[e.major,e.minor,e.revision],r=Math.min(n.length,arguments.length);for(i=0;i<r;i++){if(n[i]>=arguments[i]){if(i+1<r&&n[i]==arguments[i])continue;return!0}return!1}},e.FlashDetect=function(){if(navigator.plugins&&navigator.plugins.length>0){var n="application/x-shockwave-flash",i=navigator.mimeTypes;if(i&&i[n]&&i[n].enabledPlugin&&i[n].enabledPlugin.description){var s=i[n].enabledPlugin.description,l=o(s);e.raw=l.raw,e.major=l.major,e.minor=l.minor,e.revisionStr=l.revisionStr,e.revision=l.revision,e.installed=!0}}else if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript)for(var s=-1,u=0;u<t.length&&s==-1;u++){var c=r(t[u].name);if(!c.activeXError&&(e.installed=!0,s=t[u].version(c),s!=-1)){var l=a(s);e.raw=l.raw,e.major=l.major,e.minor=l.minor,e.revision=l.revision,e.revisionStr=l.revisionStr}}}()};r.JS_RELEASE="1.0.4",t.exports=r},{}],4:[function(e,t,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(e){"use strict";function t(e){var t=e.charCodeAt(0);return t===o||t===d?62:t===s||t===f?63:t<l?-1:t<l+10?t-l+26+26:t<c+26?t-c:t<u+26?t-u+26:void 0}function n(e){function n(e){u[d++]=e}var r,i,o,s,l,u;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=e.length;l="="===e.charAt(c-2)?2:"="===e.charAt(c-1)?1:0,u=new a(3*e.length/4-l),o=l>0?e.length-4:e.length;var d=0;for(r=0,i=0;r<o;r+=4,i+=3)s=t(e.charAt(r))<<18|t(e.charAt(r+1))<<12|t(e.charAt(r+2))<<6|t(e.charAt(r+3)),n((16711680&s)>>16),n((65280&s)>>8),n(255&s);return 2===l?(s=t(e.charAt(r))<<2|t(e.charAt(r+1))>>4,n(255&s)):1===l&&(s=t(e.charAt(r))<<10|t(e.charAt(r+1))<<4|t(e.charAt(r+2))>>2,n(s>>8&255),n(255&s)),u}function i(e){function t(e){return r.charAt(e)}function n(e){return t(e>>18&63)+t(e>>12&63)+t(e>>6&63)+t(63&e)}var i,a,o,s=e.length%3,l="";for(i=0,o=e.length-s;i<o;i+=3)a=(e[i]<<16)+(e[i+1]<<8)+e[i+2],l+=n(a);switch(s){case 1:a=e[e.length-1],l+=t(a>>2),l+=t(a<<4&63),l+="==";break;case 2:a=(e[e.length-2]<<8)+e[e.length-1],l+=t(a>>10),l+=t(a>>4&63),l+=t(a<<2&63),l+="="}return l}var a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="+".charCodeAt(0),s="/".charCodeAt(0),l="0".charCodeAt(0),u="a".charCodeAt(0),c="A".charCodeAt(0),d="-".charCodeAt(0),f="_".charCodeAt(0);e.toByteArray=n,e.fromByteArray=i}("undefined"==typeof n?this.base64js={}:n)},{}],5:[function(e,t,n){function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);var i=typeof e;if("base64"===t&&"string"===i)for(e=O(e);e.length%4!==0;)e+="=";var a;if("number"===i)a=C(e);else if("string"===i)a=r.byteLength(e,t);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");a=C(e.length)}var o;r._useTypedArrays?o=r._augment(new Uint8Array(a)):(o=this,o.length=a,o._isBuffer=!0);var s;if(r._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else if(P(e))for(s=0;s<a;s++)r.isBuffer(e)?o[s]=e.readUInt8(s):o[s]=e[s];else if("string"===i)o.write(e,0,t);else if("number"===i&&!r._useTypedArrays&&!n)for(s=0;s<a;s++)o[s]=0;return o}function i(e,t,n,i){n=Number(n)||0;var a=e.length-n;i?(i=Number(i),i>a&&(i=a)):i=a;var o=t.length;H(o%2===0,"Invalid hex string"),i>o/2&&(i=o/2);for(var s=0;s<i;s++){var l=parseInt(t.substr(2*s,2),16);H(!isNaN(l),"Invalid hex string"),e[n+s]=l}return r._charsWritten=2*s,s}function a(e,t,n,i){var a=r._charsWritten=U(N(t),e,n,i);return a}function o(e,t,n,i){var a=r._charsWritten=U(M(t),e,n,i);return a}function s(e,t,n,r){return o(e,t,n,r)}function l(e,t,n,i){var a=r._charsWritten=U(F(t),e,n,i);return a}function u(e,t,n,i){var a=r._charsWritten=U(x(t),e,n,i);return a}function c(e,t,n){return 0===t&&n===e.length?W.fromByteArray(e):W.fromByteArray(e.slice(t,n))}function d(e,t,n){var r="",i="";n=Math.min(e.length,n);for(var a=t;a<n;a++)e[a]<=127?(r+=B(i)+String.fromCharCode(e[a]),i=""):i+="%"+e[a].toString(16);return r+B(i)}function f(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;i++)r+=String.fromCharCode(e[i]);return r}function p(e,t,n){return f(e,t,n)}function h(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;a++)i+=I(e[a]);return i}function g(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function m(e,t,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==t&&null!==t,"missing offset"),H(t+1<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var a;return n?(a=e[t],t+1<i&&(a|=e[t+1]<<8)):(a=e[t]<<8,t+1<i&&(a|=e[t+1])),a}}function v(e,t,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==t&&null!==t,"missing offset"),H(t+3<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var a;return n?(t+2<i&&(a=e[t+2]<<16),t+1<i&&(a|=e[t+1]<<8),a|=e[t],t+3<i&&(a+=e[t+3]<<24>>>0)):(t+1<i&&(a=e[t+1]<<16),t+2<i&&(a|=e[t+2]<<8),t+3<i&&(a|=e[t+3]),a+=e[t]<<24>>>0),a}}function y(e,t,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==t&&null!==t,"missing offset"),H(t+1<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var a=m(e,t,n,!0),o=32768&a;return o?(65535-a+1)*-1:a}}function _(e,t,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==t&&null!==t,"missing offset"),H(t+3<e.length,"Trying to read beyond buffer length"));var i=e.length;if(!(t>=i)){var a=v(e,t,n,!0),o=2147483648&a;return o?(4294967295-a+1)*-1:a}}function E(e,t,n,r){return r||(H("boolean"==typeof n,"missing or invalid endian"),H(t+3<e.length,"Trying to read beyond buffer length")),Y.read(e,t,n,23,4)}function b(e,t,n,r){return r||(H("boolean"==typeof n,"missing or invalid endian"),H(t+7<e.length,"Trying to read beyond buffer length")),Y.read(e,t,n,52,8)}function T(e,t,n,r,i){i||(H(void 0!==t&&null!==t,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+1<e.length,"trying to write beyond buffer length"),j(t,65535));var a=e.length;if(!(n>=a))for(var o=0,s=Math.min(a-n,2);o<s;o++)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function w(e,t,n,r,i){i||(H(void 0!==t&&null!==t,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<e.length,"trying to write beyond buffer length"),j(t,4294967295));var a=e.length;if(!(n>=a))for(var o=0,s=Math.min(a-n,4);o<s;o++)e[n+o]=t>>>8*(r?o:3-o)&255}function A(e,t,n,r,i){i||(H(void 0!==t&&null!==t,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+1<e.length,"Trying to write beyond buffer length"),G(t,32767,-32768));var a=e.length;n>=a||(t>=0?T(e,t,n,r,i):T(e,65535+t+1,n,r,i))}function R(e,t,n,r,i){i||(H(void 0!==t&&null!==t,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<e.length,"Trying to write beyond buffer length"),G(t,2147483647,-2147483648));var a=e.length;n>=a||(t>=0?w(e,t,n,r,i):w(e,4294967295+t+1,n,r,i))}function S(e,t,n,r,i){i||(H(void 0!==t&&null!==t,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<e.length,"Trying to write beyond buffer length"),V(t,3.4028234663852886e38,-3.4028234663852886e38));var a=e.length;n>=a||Y.write(e,t,n,r,23,4)}function k(e,t,n,r,i){i||(H(void 0!==t&&null!==t,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+7<e.length,"Trying to write beyond buffer length"),V(t,1.7976931348623157e308,-1.7976931348623157e308));var a=e.length;n>=a||Y.write(e,t,n,r,52,8)}function O(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function L(e,t,n){return"number"!=typeof e?n:(e=~~e,e>=t?t:e>=0?e:(e+=t,e>=0?e:0))}function C(e){return e=~~Math.ceil(+e),e<0?0:e}function D(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function P(e){return D(e)||r.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function I(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else{var i=n;r>=55296&&r<=57343&&n++;for(var a=encodeURIComponent(e.slice(i,n+1)).substr(1).split("%"),o=0;o<a.length;o++)t.push(parseInt(a[o],16))}}return t}function M(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function x(e){for(var t,n,r,i=[],a=0;a<e.length;a++)t=e.charCodeAt(a),n=t>>8,r=t%256,i.push(r),i.push(n);return i}function F(e){return W.toByteArray(e)}function U(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);i++)t[i+n]=e[i];return i}function B(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function j(e,t){H("number"==typeof e,"cannot write a non-number as a number"),H(e>=0,"specified a negative value for writing an unsigned value"),H(e<=t,"value is larger than maximum value for type"),H(Math.floor(e)===e,"value has a fractional component")}function G(e,t,n){H("number"==typeof e,"cannot write a non-number as a number"),H(e<=t,"value larger than maximum allowed value"),H(e>=n,"value smaller than minimum allowed value"),H(Math.floor(e)===e,"value has a fractional component")}function V(e,t,n){H("number"==typeof e,"cannot write a non-number as a number"),H(e<=t,"value larger than maximum allowed value"),H(e>=n,"value smaller than minimum allowed value")}function H(e,t){if(!e)throw new Error(t||"Failed assertion")}var W=e("base64-js"),Y=e("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192,r._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(n){return!1}}(),r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(e){return!(null===e||void 0===e||!e._isBuffer)},r.byteLength=function(e,t){var n;switch(e+="",t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=N(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=F(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*e.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(e,t){if(H(D(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new r(0);if(1===e.length)return e[0];var n;if("number"!=typeof t)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var i=new r(t),a=0;for(n=0;n<e.length;n++){var o=e[n];o.copy(i,a),a+=o.length}return i},r.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var c=r;r=t,t=n,n=c}t=Number(t)||0;var d=this.length-t;n?(n=Number(n),n>d&&(n=d)):n=d,r=String(r||"utf8").toLowerCase();var f;switch(r){case"hex":f=i(this,e,t,n);break;case"utf8":case"utf-8":f=a(this,e,t,n);break;case"ascii":f=o(this,e,t,n);break;case"binary":f=s(this,e,t,n);break;case"base64":f=l(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":f=u(this,e,t,n);break;default:throw new Error("Unknown encoding")}return f},r.prototype.toString=function(e,t,n){var r=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,n=void 0!==n?Number(n):n=r.length,n===t)return"";var i;switch(e){case"hex":i=h(r,t,n);break;case"utf8":case"utf-8":i=d(r,t,n);break;case"ascii":i=f(r,t,n);break;case"binary":i=p(r,t,n);break;case"base64":i=c(r,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=g(r,t,n);break;default:throw new Error("Unknown encoding")}return i},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.copy=function(e,t,n,i){var a=this;if(n||(n=0),i||0===i||(i=this.length),t||(t=0),i!==n&&0!==e.length&&0!==a.length){H(i>=n,"sourceEnd < sourceStart"),H(t>=0&&t<e.length,"targetStart out of bounds"),H(n>=0&&n<a.length,"sourceStart out of bounds"),H(i>=0&&i<=a.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o=i-n;if(o<100||!r._useTypedArrays)for(var s=0;s<o;s++)e[s+t]=this[s+n];else e._set(this.subarray(n,n+o),t)}},r.prototype.slice=function(e,t){var n=this.length;if(e=L(e,n,0),t=L(t,n,n),r._useTypedArrays)return r._augment(this.subarray(e,t));for(var i=t-e,a=new r(i,(void 0),(!0)),o=0;o<i;o++)a[o]=this[o+e];return a},r.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},r.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},r.prototype.readUInt8=function(e,t){if(t||(H(void 0!==e&&null!==e,"missing offset"),H(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},r.prototype.readUInt16LE=function(e,t){return m(this,e,!0,t)},r.prototype.readUInt16BE=function(e,t){return m(this,e,!1,t)},r.prototype.readUInt32LE=function(e,t){return v(this,e,!0,t)},r.prototype.readUInt32BE=function(e,t){return v(this,e,!1,t)},r.prototype.readInt8=function(e,t){if(t||(H(void 0!==e&&null!==e,"missing offset"),H(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length)){var n=128&this[e];return n?(255-this[e]+1)*-1:this[e]}},r.prototype.readInt16LE=function(e,t){return y(this,e,!0,t)},r.prototype.readInt16BE=function(e,t){return y(this,e,!1,t)},r.prototype.readInt32LE=function(e,t){return _(this,e,!0,t)},r.prototype.readInt32BE=function(e,t){return _(this,e,!1,t)},r.prototype.readFloatLE=function(e,t){return E(this,e,!0,t)},r.prototype.readFloatBE=function(e,t){return E(this,e,!1,t)},r.prototype.readDoubleLE=function(e,t){return b(this,e,!0,t)},r.prototype.readDoubleBE=function(e,t){return b(this,e,!1,t)},r.prototype.writeUInt8=function(e,t,n){n||(H(void 0!==e&&null!==e,"missing value"),H(void 0!==t&&null!==t,"missing offset"),H(t<this.length,"trying to write beyond buffer length"),j(e,255)),t>=this.length||(this[t]=e)},r.prototype.writeUInt16LE=function(e,t,n){T(this,e,t,!0,n)},r.prototype.writeUInt16BE=function(e,t,n){T(this,e,t,!1,n)},r.prototype.writeUInt32LE=function(e,t,n){w(this,e,t,!0,n)},r.prototype.writeUInt32BE=function(e,t,n){w(this,e,t,!1,n)},r.prototype.writeInt8=function(e,t,n){n||(H(void 0!==e&&null!==e,"missing value"),H(void 0!==t&&null!==t,"missing offset"),H(t<this.length,"Trying to write beyond buffer length"),G(e,127,-128)),t>=this.length||(e>=0?this.writeUInt8(e,t,n):this.writeUInt8(255+e+1,t,n))},r.prototype.writeInt16LE=function(e,t,n){A(this,e,t,!0,n)},r.prototype.writeInt16BE=function(e,t,n){A(this,e,t,!1,n)},r.prototype.writeInt32LE=function(e,t,n){R(this,e,t,!0,n)},r.prototype.writeInt32BE=function(e,t,n){R(this,e,t,!1,n)},r.prototype.writeFloatLE=function(e,t,n){S(this,e,t,!0,n)},r.prototype.writeFloatBE=function(e,t,n){S(this,e,t,!1,n)},r.prototype.writeDoubleLE=function(e,t,n){k(this,e,t,!0,n)},r.prototype.writeDoubleBE=function(e,t,n){k(this,e,t,!1,n)},r.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),H("number"==typeof e&&!isNaN(e),"value is not a number"),H(n>=t,"end < start"),n!==t&&0!==this.length){H(t>=0&&t<this.length,"start out of bounds"),H(n>=0&&n<=this.length,"end out of bounds");for(var r=t;r<n;r++)this[r]=e}},r.prototype.inspect=function(){for(var e=[],t=this.length,r=0;r<t;r++)if(e[r]=I(this[r]),r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}return"<Buffer "+e.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r._useTypedArrays)return new r(this).buffer;for(var e=new Uint8Array(this.length),t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var q=r.prototype;r._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=q.get,e.set=q.set,e.write=q.write,e.toString=q.toString,e.toLocaleString=q.toString,e.toJSON=q.toJSON,e.copy=q.copy,e.slice=q.slice,e.readUInt8=q.readUInt8,e.readUInt16LE=q.readUInt16LE,e.readUInt16BE=q.readUInt16BE,e.readUInt32LE=q.readUInt32LE,e.readUInt32BE=q.readUInt32BE,e.readInt8=q.readInt8,e.readInt16LE=q.readInt16LE,e.readInt16BE=q.readInt16BE,e.readInt32LE=q.readInt32LE,e.readInt32BE=q.readInt32BE,e.readFloatLE=q.readFloatLE,e.readFloatBE=q.readFloatBE,e.readDoubleLE=q.readDoubleLE,e.readDoubleBE=q.readDoubleBE,e.writeUInt8=q.writeUInt8,e.writeUInt16LE=q.writeUInt16LE,e.writeUInt16BE=q.writeUInt16BE,e.writeUInt32LE=q.writeUInt32LE,e.writeUInt32BE=q.writeUInt32BE,e.writeInt8=q.writeInt8,e.writeInt16LE=q.writeInt16LE,e.writeInt16BE=q.writeInt16BE,e.writeInt32LE=q.writeInt32LE,e.writeInt32BE=q.writeInt32BE,e.writeFloatLE=q.writeFloatLE,e.writeFloatBE=q.writeFloatBE,e.writeDoubleLE=q.writeDoubleLE,e.writeDoubleBE=q.writeDoubleBE,e.fill=q.fill,e.inspect=q.inspect,e.toArrayBuffer=q.toArrayBuffer,e}},{"base64-js":4,ieee754:17}],6:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,a,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=new Array(r-1),l=1;l<r;l++)a[l-1]=arguments[l];n.apply(this,a)}else if(o(n)){for(r=arguments.length,a=new Array(r-1),l=1;l<r;l++)a[l-1]=arguments[l];for(u=n.slice(),r=u.length,l=0;l<r;l++)u[l].apply(this,a)}return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var n;n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],7:[function(e,t,n){function r(){}var i=t.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],8:[function(e,t,n){function r(e){return this instanceof r?(s.call(this,e),l.call(this,e),e&&e.readable===!1&&(this.readable=!1),e&&e.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,e&&e.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(e)}function i(){if(!this.allowHalfOpen&&!this._writableState.ended){var e=this;o(function(){e.end()})}}t.exports=r;var a=e("inherits"),o=e("process/browser.js").nextTick,s=e("./readable.js"),l=e("./writable.js");a(r,s),r.prototype.write=l.prototype.write,r.prototype.end=l.prototype.end,r.prototype._write=l.prototype._write},{"./readable.js":12,"./writable.js":14,inherits:18,"process/browser.js":10}],9:[function(e,t,n){function r(){i.call(this)}t.exports=r;var i=e("events").EventEmitter,a=e("inherits");a(r,i),r.Readable=e("./readable.js"),r.Writable=e("./writable.js"),r.Duplex=e("./duplex.js"),r.Transform=e("./transform.js"),r.PassThrough=e("./passthrough.js"),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&u.pause&&u.pause()}function r(){u.readable&&u.resume&&u.resume()}function a(){c||(c=!0,e.end())}function o(){c||(c=!0,"function"==typeof e.destroy&&e.destroy())}function s(e){if(l(),0===i.listenerCount(this,"error"))throw e}function l(){u.removeListener("data",n),e.removeListener("drain",r),u.removeListener("end",a),u.removeListener("close",o),u.removeListener("error",s),e.removeListener("error",s),u.removeListener("end",l),u.removeListener("close",l),e.removeListener("close",l)}var u=this;u.on("data",n),e.on("drain",r),e._isStdio||t&&t.end===!1||(u.on("end",a),u.on("close",o));var c=!1;return u.on("error",s),e.on("error",s),u.on("end",l),u.on("close",l),e.on("close",l),e.emit("pipe",u),e}},{"./duplex.js":8,"./passthrough.js":11,"./readable.js":12,"./transform.js":13,"./writable.js":14,events:6,inherits:18}],10:[function(e,t,n){var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],11:[function(e,t,n){function r(e){return this instanceof r?void i.call(this,e):new r(e)}t.exports=r;var i=e("./transform.js"),a=e("inherits");a(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},{"./transform.js":13,inherits:18}],12:[function(e,t,n){(function(n){function r(t,n){t=t||{};var r=t.highWaterMark;this.highWaterMark=r||0===r?r:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!t.objectMode,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(w||(w=e("string_decoder").StringDecoder),this.decoder=new w(t.encoding),this.encoding=t.encoding)}function i(e){return this instanceof i?(this._readableState=new r(e,this),this.readable=!0,void R.call(this)):new i(e)}function a(e,t,n,r,i){var a=u(t,n);if(a)e.emit("error",a);else if(null===n||void 0===n)t.reading=!1,t.ended||c(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&i){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else!t.decoder||i||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&d(e),p(e,t);else i||(t.reading=!1);return o(t)}function o(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function s(e){if(e>=L)e=L;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function l(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||null===e?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=s(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function u(e,t){var n=null;return S.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||n||(n=new TypeError("Invalid non-string/buffer chunk")),n}function c(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?d(e):E(e)}function d(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?k(function(){f(e)}):f(e))}function f(e){e.emit("readable")}function p(e,t){t.readingMore||(t.readingMore=!0,k(function(){h(e,t)}))}function h(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function g(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&m(e)}}function m(e){function t(e,t,i){var a=e.write(n);!1===a&&r.awaitDrain++}var n,r=e._readableState;for(r.awaitDrain=0;r.pipesCount&&null!==(n=e.read());)if(1===r.pipesCount?t(r.pipes,0,null):b(r.pipes,t),e.emit("data",n),r.awaitDrain>0)return;return 0===r.pipesCount?(r.flowing=!1,void(A.listenerCount(e,"data")>0&&y(e))):void(r.ranOut=!0)}function v(){this._readableState.ranOut&&(this._readableState.ranOut=!1,m(this))}function y(e,t){var n=e._readableState;if(n.flowing)throw new Error("Cannot switch to old mode now.");var r=t||!1,i=!1;e.readable=!0,e.pipe=R.prototype.pipe,e.on=e.addListener=R.prototype.on,e.on("readable",function(){i=!0;for(var t;!r&&null!==(t=e.read());)e.emit("data",t);null===t&&(i=!1,e._readableState.needReadable=!0)}),e.pause=function(){r=!0,this.emit("pause")},e.resume=function(){r=!1,i?k(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function _(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,o=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(o)n=r.shift();else if(!e||e>=i)n=a?r.join(""):S.concat(r,i),r.length=0;else if(e<r[0].length){var s=r[0];n=s.slice(0,e),r[0]=s.slice(e)}else if(e===r[0].length)n=r.shift();else{n=a?"":new S(e);for(var l=0,u=0,c=r.length;u<c&&l<e;u++){var s=r[0],d=Math.min(e-l,s.length);a?n+=s.slice(0,d):s.copy(n,l,0,d),d<s.length?r[0]=s.slice(d):r.shift(),l+=d}}return n}function E(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,k(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function b(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function T(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}t.exports=i,i.ReadableState=r;var w,A=e("events").EventEmitter,R=e("./index.js"),S=e("buffer").Buffer,k=e("process/browser.js").nextTick,O=e("inherits");O(i,R),i.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding,
t!==n.encoding&&(e=new S(e,t),t="")),a(this,n,e,t,!1)},i.prototype.unshift=function(e){var t=this._readableState;return a(this,t,e,"",!0)},i.prototype.setEncoding=function(t){w||(w=e("string_decoder").StringDecoder),this._readableState.decoder=new w(t),this._readableState.encoding=t};var L=8388608;i.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d(this),null;if(e=l(e,t),0===e&&t.ended)return 0===t.length&&E(this),null;var r=t.needReadable;t.length-e<=t.highWaterMark&&(r=!0),(t.ended||t.reading)&&(r=!1),r&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=l(n,t));var i;return i=e>0?_(e,t):null,null===i&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&E(this),i},i.prototype._read=function(e){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(e,t){function r(e){e===c&&a()}function i(){e.end()}function a(){e.removeListener("close",s),e.removeListener("finish",l),e.removeListener("drain",h),e.removeListener("error",o),e.removeListener("unpipe",r),c.removeListener("end",i),c.removeListener("end",a),e._writableState&&!e._writableState.needDrain||h()}function o(t){u(),0===y&&0===A.listenerCount(e,"error")&&e.emit("error",t)}function s(){e.removeListener("finish",l),u()}function l(){e.removeListener("close",s),u()}function u(){c.unpipe(e)}var c=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=e;break;case 1:d.pipes=[d.pipes,e];break;default:d.pipes.push(e)}d.pipesCount+=1;var f=(!t||t.end!==!1)&&e!==n.stdout&&e!==n.stderr,p=f?i:a;d.endEmitted?k(p):c.once("end",p),e.on("unpipe",r);var h=g(c);e.on("drain",h);var y=A.listenerCount(e,"error");return e.once("error",o),e.once("close",s),e.once("finish",l),e.emit("pipe",c),d.flowing||(this.on("readable",v),d.flowing=!0,k(function(){m(c)})),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",v),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",v),t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var i=T(t.pipes,e);return i===-1?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,t){var n=R.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||y(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&d(this,r):this.read(0))}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){y(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){y(this,!0),this.emit("pause")},i.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){var a=r.push(i);a||(n=!0,e.pause())}});for(var i in e)"function"==typeof e[i]&&"undefined"==typeof this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));var a=["error","close","destroy","pause","resume"];return b(a,function(t){e.on(t,function(e){return r.emit.apply(r,t,e)})}),r._read=function(t){n&&(n=!1,e.resume())},r},i._fromList=_}).call(this,e("7YKIPe"))},{"./index.js":9,"7YKIPe":7,buffer:5,events:6,inherits:18,"process/browser.js":10,string_decoder:15}],13:[function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return i(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),i&&i(t);var a=e._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&e._read(a.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);s.call(this,e);var t=(this._transformState=new r(e,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){o(t,e)}):o(t)})}function o(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=(e._readableState,e._transformState);if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}t.exports=a;var s=e("./duplex.js"),l=e("inherits");l(a,s),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,n){throw new Error("not implemented")},a.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},{"./duplex.js":8,inherits:18}],14:[function(e,t,n){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function i(e,t){e=e||{};var n=e.highWaterMark;this.highWaterMark=n||0===n?n:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=e.decodeStrings===!1;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){p(t,e)},this.writecb=null,this.writelen=0,this.buffer=[]}function a(e){return this instanceof a||this instanceof w.Duplex?(this._writableState=new i(e,this),this.writable=!0,void w.call(this)):new a(e)}function o(e,t,n){var r=new Error("write after end");e.emit("error",r),A(function(){n(r)})}function s(e,t,n,r){var i=!0;if(!R.isBuffer(n)&&"string"!=typeof n&&null!==n&&void 0!==n&&!t.objectMode){var a=new TypeError("Invalid non-string/buffer chunk");e.emit("error",a),A(function(){r(a)}),i=!1}return i}function l(e,t,n){return e.objectMode||e.decodeStrings===!1||"string"!=typeof t||(t=new R(t,n)),t}function u(e,t,n,i,a){n=l(t,n,i);var o=t.objectMode?1:n.length;t.length+=o;var s=t.length<t.highWaterMark;return t.needDrain=!s,t.writing?t.buffer.push(new r(n,i,a)):c(e,t,o,n,i,a),s}function c(e,t,n,r,i,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,e._write(r,i,t.onwrite),t.sync=!1}function d(e,t,n,r,i){n?A(function(){i(r)}):i(r),e.emit("error",r)}function f(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function p(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(f(n),t)d(e,n,r,t,i);else{var a=v(e,n);a||n.bufferProcessing||!n.buffer.length||m(e,n),r?A(function(){h(e,n,a,i)}):h(e,n,a,i)}}function h(e,t,n,r){n||g(e,t),r(),n&&y(e,t)}function g(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function m(e,t){t.bufferProcessing=!0;for(var n=0;n<t.buffer.length;n++){var r=t.buffer[n],i=r.chunk,a=r.encoding,o=r.callback,s=t.objectMode?1:i.length;if(c(e,t,s,i,a,o),t.writing){n++;break}}t.bufferProcessing=!1,n<t.buffer.length?t.buffer=t.buffer.slice(n):t.buffer.length=0}function v(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function y(e,t){var n=v(e,t);return n&&(t.finished=!0,e.emit("finish")),n}function _(e,t,n){t.ending=!0,y(e,t),n&&(t.finished?A(n):e.once("finish",n)),t.ended=!0}t.exports=a,a.WritableState=i;var E="undefined"!=typeof Uint8Array?function(e){return e instanceof Uint8Array}:function(e){return e&&e.constructor&&"Uint8Array"===e.constructor.name},b="undefined"!=typeof ArrayBuffer?function(e){return e instanceof ArrayBuffer}:function(e){return e&&e.constructor&&"ArrayBuffer"===e.constructor.name},T=e("inherits"),w=e("./index.js"),A=e("process/browser.js").nextTick,R=e("buffer").Buffer;T(a,w),a.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},a.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return"function"==typeof t&&(n=t,t=null),!R.isBuffer(e)&&E(e)&&(e=new R(e)),b(e)&&"undefined"!=typeof Uint8Array&&(e=new R(new Uint8Array(e))),R.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=function(){}),r.ended?o(this,r,n):s(this,r,e,n)&&(i=u(this,r,e,t,n)),i},a.prototype._write=function(e,t,n){n(new Error("not implemented"))},a.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),"undefined"!=typeof e&&null!==e&&this.write(e,t),r.ending||r.finished||_(this,r,n)}},{"./index.js":9,buffer:5,inherits:18,"process/browser.js":10}],15:[function(e,t,n){function r(e){if(e&&!s.isEncoding(e))throw new Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function a(e){var t=this.charReceived=e.length%2;return this.charLength=t?2:0,t}function o(e){var t=this.charReceived=e.length%3;return this.charLength=t?3:0,t}var s=e("buffer").Buffer,l=n.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=a;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=o;break;default:return void(this.write=i)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};l.prototype.write=function(e){for(var t="",n=0;this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,n,r),this.charReceived+=r-n,n=r,this.charReceived<this.charLength)return"";t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var i=t.charCodeAt(t.length-1);if(!(i>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,r==e.length)return t;e=e.slice(r,e.length);break}this.charLength+=this.surrogateSize,t=""}var a=this.detectIncompleteChar(e),o=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-a,o),this.charReceived=a,o-=a),t+=e.toString(this.encoding,0,o);var o=t.length-1,i=t.charCodeAt(o);if(i>=55296&&i<=56319){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),this.charBuffer.write(t.charAt(t.length-1),this.encoding),t.substring(0,o)}return t},l.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}return t},l.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},{buffer:5}],16:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.Hls=e()}}(function(){var t;return function n(t,r,i){function a(s,l){if(!r[s]){if(!t[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return a(n?n:e)},d,d.exports,n,t,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,a,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(n=this._events[e],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(o(n))for(a=Array.prototype.slice.call(arguments,1),u=n.slice(),r=u.length,l=0;l<r;l++)u[l].apply(this,a);return!0},r.prototype.addListener=function(e,t){var n;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,r=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],i(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,n,r){!function(e){var i={buildAbsoluteURL:function(e,t){if(t=t.trim(),/^[a-z]+:/i.test(t))return t;var n=null,r=null,a=/^([^#]*)(.*)$/.exec(t);a&&(r=a[2],t=a[1]);var o=/^([^\?]*)(.*)$/.exec(t);o&&(n=o[2],t=o[1]);var s=/^([^#]*)(.*)$/.exec(e);s&&(e=s[1]);var l=/^([^\?]*)(.*)$/.exec(e);l&&(e=l[1]);var u=/^(([a-z]+:)?\/\/[a-z0-9\.\-_~]+(:[0-9]+)?)?(\/.*)$/i.exec(e);if(!u)throw new Error("Error trying to parse base URL.");var c=u[2]||"",d=u[1]||"",f=u[4],p=null;return p=/^\/\//.test(t)?c+"//"+i.buildAbsolutePath("",t.substring(2)):/^\//.test(t)?d+"/"+i.buildAbsolutePath("",t.substring(1)):i.buildAbsolutePath(d+f,t),n&&(p+=n),r&&(p+=r),p},buildAbsolutePath:function(e,t){for(var n,r,i=t,a="",o=e.replace(/[^\/]*$/,i.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),s=0;r=o.indexOf("/../",s),r>-1;s=r+n)n=/^\/(?:\.\.\/)*/.exec(o.slice(r))[0].length,a=(a+o.substring(s,r)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(n-1)/3+"}$"),"/");return a+o.substr(s)}};"object"==typeof r&&"object"==typeof n?n.exports=i:"function"==typeof t&&t.amd?t([],function(){return i}):"object"==typeof r?r.URLToolkit=i:e.URLToolkit=i}(this)},{}],3:[function(e,t,n){var r=arguments[3],i=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){function n(e){m[e]=!0;for(var t in i[e][1]){var r=i[e][1][t];m[r]||n(r)}}for(var s,l=Object.keys(a),u=0,c=l.length;u<c;u++){var d=l[u],f=a[d].exports;if(f===e||f&&f["default"]===e){s=d;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var p={},u=0,c=l.length;u<c;u++){var d=l[u];p[d]=d}i[s]=[Function(["require","module","exports"],"("+e+")(self)"),p]}var h=Math.floor(Math.pow(16,8)*Math.random()).toString(16),g={};g[s]=s,i[h]=[Function(["require"],"var f = require("+o(s)+");(f.default ? f.default : f)(self);"),g];var m={};n(h);var v="("+r+")({"+Object.keys(m).map(function(e){return o(e)+":["+i[e][0]+","+o(i[e][1])+"]"}).join(",")+"},{},["+o(h)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,_=new Blob([v],{type:"text/javascript"});if(t&&t.bare)return _;var E=y.createObjectURL(_),b=new Worker(E);return b.objectURL=E,b}},{}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(30),p=r(f),h=e(26),g=e(45),m=e(9),v=r(m),y=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].FRAG_LOADING,u["default"].FRAG_LOADED,u["default"].FRAG_BUFFERED,u["default"].ERROR));return n.lastLoadedFragLevel=0,n._autoLevelCapping=-1,n._nextAutoLevel=-1,n.hls=e,n.onCheck=n.abandonRulesCheck.bind(n),n}return o(t,e),s(t,[{key:"destroy",value:function(){this.clearTimer(),d["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this.bwEstimator){var n=this.hls,r=e.frag.level,i=n.levels[r].details.live,a=n.config,o=void 0,s=void 0;i?(o=a.abrEwmaFastLive,s=a.abrEwmaSlowLive):(o=a.abrEwmaFastVoD,s=a.abrEwmaSlowVoD),this.bwEstimator=new v["default"](n,s,o,a.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"abandonRulesCheck",value:function(){var e=this.hls,t=e.media,n=this.fragCurrent,r=n.loader;if(!r||r.stats&&r.stats.aborted)return g.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var i=r.stats;if(t&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&n.autoLevel&&n.level){var a=performance.now()-i.trequest,o=Math.abs(t.playbackRate);if(a>500*n.duration/o){var s=e.levels,l=Math.max(1,i.bw?i.bw/8:1e3*i.loaded/a),c=i.total?i.total:Math.max(i.loaded,Math.round(n.duration*s[n.level].bitrate/8)),d=t.currentTime,f=(c-i.loaded)/l,h=(p["default"].bufferInfo(t,d,e.config.maxBufferHole).end-d)/o;if(h<2*n.duration/o&&f>h){var m=void 0,v=void 0;for(v=n.level-1;v>=0&&(m=n.duration*s[v].bitrate/(6.4*l),!(m<h));v--);m<f&&(v=Math.max(0,v),g.logger.warn("loading too slow, abort fragment loading and switch to level "+v+":fragLoadedDelay["+v+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+m.toFixed(1)+"<"+f.toFixed(1)+":"+h.toFixed(1)),e.nextLoadLevel=v,this.bwEstimator.sample(a,i.loaded),r.abort(),this.clearTimer(),e.trigger(u["default"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:i}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,e.frag.bitrateTest)){var n=e.stats;n.tparsed=n.tbuffered=n.tload,this.onFragBuffered(e)}}},{key:"onFragBuffered",value:function(e){var t=e.stats,n=e.frag;if(t.aborted!==!0&&1===n.loadCounter&&"main"===n.type&&(!n.bitrateTest||t.tload===t.tbuffered)){var r=t.tbuffered-t.trequest;g.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this.bwEstimator.sample(r,t.loaded),n.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"findBestLevel",value:function(e,t,n,r,i,a,o,s,l){for(var u=i;u>=r;u--){var c=l[u],d=c.details,f=d?d.totalduration/d.fragments.length:t,p=!!d&&d.live,h=void 0;h=u<=e?o*n:s*n;var m=l[u].bitrate,v=m*f/h;if(g.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(h)+"/"+m+"/"+f+"/"+a+"/"+v),h>m&&(!v||p||v<a))return u}return-1}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator,n=this.hls,r=n.levels,i=n.config.minAutoBitrate;if(!(e===-1||t&&t.canEstimate()))return Math.min(e,this.maxAutoLevel);var a=this.nextABRAutoLevel;if(e!==-1&&(a=Math.min(e,a)),void 0!==i)for(;r[a].bitrate<i;)a++;return a},set:function(e){this._nextAutoLevel=e}},{key:"minAutoLevel",get:function(){for(var e=this.hls,t=e.levels,n=e.config.minAutoBitrate,r=0;r<t.length;r++)if(t[r].bitrate>n)return r;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.hls.levels,n=this._autoLevelCapping;return e=n===-1&&t&&t.length?t.length-1:n}},{key:"nextABRAutoLevel",get:function(){var e=this.hls,t=this.maxAutoLevel,n=e.levels,r=e.config,i=this.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this.bwEstimator?this.bwEstimator.getEstimate():r.abrEwmaDefaultEstimate,d=(p["default"].bufferInfo(a,l,r.maxBufferHole).end-l)/u,f=this.findBestLevel(o,s,c,i,t,d,r.abrBandWidthFactor,r.abrBandWidthUpFactor,n);if(f>=0)return f;g.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var h=r.maxStarvationDelay,m=r.abrBandWidthFactor,v=r.abrBandWidthUpFactor;if(0===d){var y=this.bitrateTestDelay;y&&(h=r.maxLoadingDelay-y,g.logger.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),m=v=1)}return f=this.findBestLevel(o,s,c,i,t,d+h,m,v,n),Math.max(f,0)}}]),t}(d["default"]);n["default"]=y},{26:26,27:27,28:28,30:30,45:45,9:9}],5:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(41),u=r(l),c=e(30),d=r(c),f=e(22),p=r(f),h=e(28),g=r(h),m=e(27),v=r(m),y=e(31),_=r(y),E=e(47),b=r(E),T=e(26),w=e(45),A={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR"},R=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,g["default"].MEDIA_ATTACHED,g["default"].MEDIA_DETACHING,g["default"].AUDIO_TRACKS_UPDATED,g["default"].AUDIO_TRACK_SWITCH,g["default"].AUDIO_TRACK_LOADED,g["default"].KEY_LOADED,g["default"].FRAG_LOADED,g["default"].FRAG_PARSING_INIT_SEGMENT,g["default"].FRAG_PARSING_DATA,g["default"].FRAG_PARSED,g["default"].ERROR,g["default"].BUFFER_CREATED,g["default"].BUFFER_APPENDED,g["default"].BUFFER_FLUSHED));return n.config=e.config,n.audioCodecSwap=!1,n.ticks=0,n.ontick=n.tick.bind(n),n}return o(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),v["default"].prototype.destroy.call(this),this.state=A.STOPPED}},{key:"startLoad",value:function(e){if(this.tracks){var t=this.media,n=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,t&&n?(w.logger.log("configure startPosition @"+n),this.state=A.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=A.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=A.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=A.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,n,r=this.hls,i=r.config;switch(this.state){case A.ERROR:case A.PAUSED:break;case A.STARTING:this.state=A.WAITING_TRACK,this.loadedmetadata=!1;break;case A.IDLE:if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;e=this.loadedmetadata?this.media.currentTime:this.nextLoadPosition;var a=this.mediaBuffer?this.mediaBuffer:this.media,o=d["default"].bufferInfo(a,e,i.maxBufferHole),s=o.len,l=o.end,c=this.fragPrevious,f=i.maxMaxBufferLength;if(s<f&&this.trackId<this.tracks.length){if(n=this.tracks[this.trackId].details,"undefined"==typeof n){this.state=A.WAITING_TRACK;break}if(!n.live&&c&&c.sn===n.endSN&&(!this.media.seeking||this.media.duration-l<c.duration/2)){this.hls.trigger(g["default"].BUFFER_EOS,{type:"audio"}),this.state=A.ENDED;break}var p=n.fragments,h=p.length,m=p[0].start,v=p[h-1].start+p[h-1].duration,y=void 0;if(l<m?y=p[0]:!function(){var e=void 0,t=i.maxFragLookUpTolerance;l<v?(l>v-t&&(t=0),e=u["default"].search(p,function(e){return e.start+e.duration-t<=l?1:e.start-t>l?-1:0})):e=p[h-1],e&&(y=e,m=e.start,c&&y.level===c.level&&y.sn===c.sn&&(y.sn<n.endSN?(y=p[y.sn+1-n.startSN],w.logger.log("SN just loaded, load next one: "+y.sn)):y=null))}(),y)if(null!=y.decryptdata.uri&&null==y.decryptdata.key)w.logger.log("Loading key for "+y.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+this.trackId),this.state=A.KEY_LOADING,r.trigger(g["default"].KEY_LOADING,{frag:y});else{if(w.logger.log("Loading "+y.sn+" of ["+n.startSN+" ,"+n.endSN+"],track "+this.trackId+", currentTime:"+e+",bufferEnd:"+l.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,y.loadCounter){y.loadCounter++;var _=i.fragLoadingLoopThreshold;if(y.loadCounter>_&&Math.abs(this.fragLoadIdx-y.loadIdx)<_)return void r.trigger(g["default"].ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:y})}else y.loadCounter=1;y.loadIdx=this.fragLoadIdx,this.fragCurrent=y,this.startFragRequested=!0,r.trigger(g["default"].FRAG_LOADING,{frag:y}),this.state=A.FRAG_LOADING}}break;case A.WAITING_TRACK:t=this.tracks[this.trackId],t&&t.details&&(this.state=A.IDLE);break;case A.FRAG_LOADING_WAITING_RETRY:var E=performance.now(),b=this.retryDate;a=this.media;var R=a&&a.seeking;(!b||E>=b||R)&&(w.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=A.IDLE);break;case A.STOPPED:case A.FRAG_LOADING:case A.PARSING:case A.PARSED:case A.ENDED:}}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var n=this.config;this.tracks&&n.autoStartLoad&&this.startLoad(n.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(w.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.tracks;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===A.ENDED&&(this.state=A.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(e){w.logger.log("audio tracks updated"),this.tracks=e.audioTracks}},{key:"onAudioTrackSwitch",value:function(e){var t=!!e.url;this.trackId=e.id,this.state=A.IDLE,this.fragCurrent=null,this.state=A.PAUSED,t?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.hls.trigger(g["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),this.tick()}},{key:"onAudioTrackLoaded",value:function(e){var t=e.details,n=e.id,r=this.tracks[n],i=t.totalduration;if(w.logger.log("track "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.PTSKnown=!1,r.details=t,!this.startFragRequested){if(this.startPosition===-1){var a=t.startTimeOffset;isNaN(a)?this.startPosition=0:(w.logger.log("start time offset found in playlist, adjust startPosition to "+a),this.startPosition=a)}this.nextLoadPosition=this.startPosition}this.state===A.WAITING_TRACK&&(this.state=A.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===A.KEY_LOADING&&(this.state=A.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent;if(this.state===A.FRAG_LOADING&&t&&"audio"===e.frag.type&&e.frag.level===t.level&&e.frag.sn===t.sn){this.state=A.PARSING,this.stats=e.stats;var n=this.tracks[this.trackId],r=n.details,i=r.totalduration,a=t.start,o=t.level,s=t.sn,l=this.config.defaultAudioCodec||n.audioCodec;this.pendingAppending=0,this.demuxer||(this.demuxer=new p["default"](this.hls,"audio")),w.logger.log("Demuxing "+s+" of ["+r.startSN+" ,"+r.endSN+"],track "+o);
var u=r.PTSKnown||!r.live;this.demuxer.push(e.payload,l,null,a,t.cc,o,s,i,t.decryptdata,u)}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===A.PARSING){var n=e.tracks,r=void 0;if(r=n.audio){r.levelCodec="mp4a.40.2",r.id=e.id,this.hls.trigger(g["default"].BUFFER_CODECS,n),w.logger.log("audio track:audio,container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var i=r.initSegment;i&&(this.pendingAppending++,this.hls.trigger(g["default"].BUFFER_APPENDING,{type:"audio",data:i,parent:"audio",content:"initSegment"})),this.tick()}}}},{key:"onFragParsingData",value:function(e){var t=this,n=this.fragCurrent;if(n&&"audio"===e.id&&e.sn===n.sn&&e.level===n.level&&this.state===A.PARSING){var r=this.tracks[this.trackId],i=this.fragCurrent;w.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),_["default"].updateFragPTSDTS(r.details,i.sn,e.startPTS,e.endPTS),[e.data1,e.data2].forEach(function(n){n&&(t.pendingAppending++,t.hls.trigger(g["default"].BUFFER_APPENDING,{type:e.type,data:n,parent:"audio",content:"data"}))}),this.nextLoadPosition=e.endPTS,this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===A.PARSING&&(this.stats.tparsed=performance.now(),this.state=A.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(e){if("audio"===e.parent)switch(this.state){case A.PARSING:case A.PARSED:this.pendingAppending--,this._checkAppendedParsed()}}},{key:"_checkAppendedParsed",value:function(){if(this.state===A.PARSED&&0===this.pendingAppending){var e=this.fragCurrent,t=this.stats;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),this.hls.trigger(g["default"].FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;w.logger.log("audio buffered : "+b["default"].toString(n.buffered)),this.state=A.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case T.ErrorDetails.FRAG_LOAD_ERROR:case T.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var r=this.config;if(n<=r.fragLoadingMaxRetry){this.fragLoadError=n,t.loadCounter=0;var i=Math.min(Math.pow(2,n-1)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);w.logger.warn("audioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.state=A.FRAG_LOADING_WAITING_RETRY}else w.logger.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(g["default"].ERROR,e),this.state=A.ERROR}break;case T.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case T.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case T.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case T.ErrorDetails.KEY_LOAD_ERROR:case T.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==A.ERROR&&(this.state=e.fatal?A.ERROR:A.IDLE,w.logger.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."))}}},{key:"onBufferFlushed",value:function(){this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=A.IDLE,this.fragPrevious=null,this.tick()}}]),t}(v["default"]);n["default"]=R},{22:22,26:26,27:27,28:28,30:30,31:31,41:41,45:45,47:47}],6:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(45),p=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].MANIFEST_LOADING,u["default"].MANIFEST_LOADED,u["default"].AUDIO_TRACK_LOADED))}return o(t,e),s(t,[{key:"destroy",value:function(){d["default"].prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,n=e.audioTracks||[],r=!1;this.tracks=n,this.hls.trigger(u["default"].AUDIO_TRACKS_UPDATED,{audioTracks:n});var i=0;n.forEach(function(e){return e["default"]?(t.audioTrack=i,void(r=!0)):void i++}),r===!1&&n.length&&(f.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(e){e.id<this.tracks.length&&(f.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setAudioTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,f.logger.log("switching to audioTrack "+e);var t=this.tracks[e],n=t.type,r=t.url;this.hls.trigger(u["default"].AUDIO_TRACK_SWITCH,{id:e,type:n,url:r});var i=t.details;!r||void 0!==i&&i.live!==!0||(f.logger.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(u["default"].AUDIO_TRACK_LOADING,{url:r,id:e}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(d["default"]);n["default"]=p},{27:27,28:28,45:45}],7:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(45),p=e(26),h=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].MEDIA_ATTACHING,u["default"].MEDIA_DETACHING,u["default"].MANIFEST_PARSED,u["default"].BUFFER_RESET,u["default"].BUFFER_APPENDING,u["default"].BUFFER_CODECS,u["default"].BUFFER_EOS,u["default"].BUFFER_FLUSHING,u["default"].LEVEL_UPDATED));return n._msDuration=null,n._levelDuration=null,n.onsbue=n.onSBUpdateEnd.bind(n),n.onsbe=n.onSBUpdateError.bind(n),n.pendingTracks={},n}return o(t,e),s(t,[{key:"destroy",value:function(){d["default"].prototype.destroy.call(this)}},{key:"onManifestParsed",value:function(e){var t=e.audio,n=e.video,r=0;e.altAudio&&(t||n)&&(r=(t?1:0)+(n?1:0),f.logger.log(r+" sourceBuffer(s) expected")),this.sourceBufferNb=r}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var n=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener("sourceopen",this.onmso),n.addEventListener("sourceended",this.onmse),n.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(n)}}},{key:"onMediaDetaching",value:function(){f.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(t){f.logger.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(u["default"].MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){f.logger.log("media source opened"),this.hls.trigger(u["default"].MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){f.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){f.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1,this.hls.trigger(u["default"].BUFFER_APPENDED,{parent:this.parent}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){f.logger.error("sourceBuffer error:"+e),this.hls.trigger(u["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var n=e[t];try{this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this.onsbue),n.removeEventListener("error",this.onsbe)}catch(r){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var n=this.mediaSource;n&&"open"===n.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,n=this.mediaSource;for(var r in e)if(!t[r]){var i=e[r],a=i.levelCodec||i.codec,o=i.container+";codecs="+a;f.logger.log("creating sourceBuffer("+o+")");try{var s=t[r]=n.addSourceBuffer(o);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),i.buffer=s}catch(l){f.logger.error("error while trying to add sourceBuffer:"+l.message),this.hls.trigger(u["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:l,mimeType:o})}}this.hls.trigger(u["default"].BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){f.logger.error("sourceBuffer error:"+e.event),this.hls.trigger(u["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1,frag:this.fragCurrent})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,n=e.type;for(var r in t)n&&r!==n||t[r].ended||(t[r].ended=!0,f.logger.log(r+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this._needsEos=!1);for(var n in e){if(!e[n].ended)return;if(e[n].updating)return void(this._needsEos=!0)}f.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment"),t.endOfStream(),this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,n=this.sourceBuffer,r=this._levelDuration;if(null!==r&&e&&t&&n&&0!==e.readyState&&"open"===t.readyState){for(var i in n)if(n[i].updating)return;null===this._msDuration&&(this._msDuration=t.duration),r>this._msDuration&&r>e.duration&&(f.logger.log("Updating mediasource duration to "+r.toFixed(3)),this._msDuration=t.duration=r)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,n=this.sourceBuffer;for(var r in n)t+=n[r].buffered.length;this.appended=t,this.hls.trigger(u["default"].BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,n=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void f.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(n&&n.length){var r=n.shift();try{var i=r.type;t[i]?(t[i].ended=!1,this.parent=r.parent,t[i].appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(a){f.logger.error("error while trying to append buffer:"+a.message),n.unshift(r);var o={type:p.ErrorTypes.MEDIA_ERROR};if(22===a.code)return this.segments=[],o.details=p.ErrorDetails.BUFFER_FULL_ERROR,void e.trigger(u["default"].ERROR,o);if(this.appendError?this.appendError++:this.appendError=1,o.details=p.ErrorDetails.BUFFER_APPEND_ERROR,o.frag=this.fragCurrent,this.appendError>e.config.appendErrorMaxRetry)return f.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),n=[],o.fatal=!0,void e.trigger(u["default"].ERROR,o);o.fatal=!1,e.trigger(u["default"].ERROR,o)}}}}},{key:"flushBuffer",value:function(e,t,n){var r,i,a,o,s,l,u=this.sourceBuffer;if(Object.keys(u).length){if(f.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var c in u)if(!n||c===n){if(r=u[c],r.ended=!1,r.updating)return f.logger.warn("cannot flush, sb updating in progress"),!1;for(i=0;i<r.buffered.length;i++)if(a=r.buffered.start(i),o=r.buffered.end(i),navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&t===Number.POSITIVE_INFINITY?(s=e,l=t):(s=Math.max(a,e),l=Math.min(o,t)),Math.min(l,o)-s>.5)return this.flushBufferCounter++,f.logger.log("flush "+c+" ["+s+","+l+"], of ["+a+","+o+"], pos:"+this.media.currentTime),r.remove(s,l),!1}}else f.logger.warn("abort flushing too many retries");f.logger.log("buffer flushed")}return!0}}]),t}(d["default"]);n["default"]=h},{26:26,27:27,28:28,45:45}],8:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].FPS_DROP_LEVEL_CAPPING,u["default"].MEDIA_ATTACHING,u["default"].MANIFEST_PARSED))}return o(t,e),s(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){this.restrictedLevels||(this.restrictedLevels=[]),this.isLevelRestricted(e.droppedLevel)||this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){this.hls.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,this.hls.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;e&&(this.hls.autoLevelCapping=this.getMaxLevel(e-1),this.hls.autoLevelCapping>this.autoLevelCapping&&this.hls.streamController.nextLevelSwitch(),this.autoLevelCapping=this.hls.autoLevelCapping)}}},{key:"getMaxLevel",value:function(e){var t=0,n=void 0,r=void 0,i=this.mediaWidth,a=this.mediaHeight,o=0,s=0;for(n=0;n<=e&&(r=this.levels[n],!this.isLevelRestricted(n))&&(t=n,o=r.width,s=r.height,!(i<=o||a<=s));n++);return t}},{key:"isLevelRestricted",value:function(e){return!(!this.restrictedLevels||this.restrictedLevels.indexOf(e)===-1)}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(t){}return e}},{key:"mediaWidth",get:function(){var e=void 0;return this.media&&(e=this.media.width||this.media.clientWidth||this.media.offsetWidth,e*=this.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0;return this.media&&(e=this.media.height||this.media.clientHeight||this.media.offsetHeight,e*=this.contentScaleFactor),e}}]),t}(d["default"]);n["default"]=f},{27:27,28:28}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(44),s=r(o),l=function(){function e(t,n,r,a){i(this,e),this.hls=t,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new s["default"](n),this.fast_=new s["default"](r)}return a(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var n=8e3*t/e,r=e/1e3;this.fast_.sample(r,n),this.slow_.sample(r,n)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();n["default"]=l},{44:44}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(45),p=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].MEDIA_ATTACHING))}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){this.hls.config.capLevelOnFPSDrop&&(this.video=e.media instanceof HTMLVideoElement?e.media:null,"function"==typeof this.video.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),this.hls.config.fpsDroppedMonitoringPeriod))}},{key:"checkFPS",value:function(e,t,n){var r=performance.now();if(t){if(this.lastTime){var i=r-this.lastTime,a=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*a/i;if(this.hls.trigger(u["default"].FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:n}),s>0&&a>this.hls.config.fpsDroppedMonitoringThreshold*o){var l=this.hls.currentLevel;f.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+l),l>0&&(this.hls.autoLevelCapping===-1||this.hls.autoLevelCapping>=l)&&(l-=1,this.hls.trigger(u["default"].FPS_DROP_LEVEL_CAPPING,{level:l,droppedLevel:this.hls.currentLevel}),this.hls.autoLevelCapping=l,this.hls.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){if(this.video)if(this.isVideoPlaybackQualityAvailable){var e=this.video.getVideoPlaybackQuality();this.checkFPS(this.video,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(this.video,this.video.webkitDecodedFrameCount,this.video.webkitDroppedFrameCount)}}]),t}(d["default"]);n["default"]=p},{27:27,28:28,45:45}],11:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(45),p=e(26),h=e(30),g=r(h),m=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].MANIFEST_LOADED,u["default"].LEVEL_LOADED,u["default"].ERROR));return n.ontick=n.tick.bind(n),n._manualLevel=n._autoLevelCapping=-1,n}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0,this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,n,r=[],i=[],a={},o=!1,s=!1,l=this.hls;if(e.levels.forEach(function(e){e.videoCodec&&(o=!0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(s=!0);var t=a[e.bitrate];void 0===t?(a[e.bitrate]=r.length,e.url=[e.url],e.urlId=0,r.push(e)):r[t].url.push(e.url)}),o&&s?r.forEach(function(e){e.videoCodec&&i.push(e)}):i=r,i=i.filter(function(e){var t=function(e){return MediaSource.isTypeSupported("audio/mp4;codecs="+e)},n=function(e){return MediaSource.isTypeSupported("video/mp4;codecs="+e)},r=e.audioCodec,i=e.videoCodec;return(!r||t(r))&&(!i||n(i))}),i.length){for(t=i[0].bitrate,i.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=i,n=0;n<i.length;n++)if(i[n].bitrate===t){this._firstLevel=n,f.logger.log("manifest loaded,"+i.length+" level(s) found, first bitrate:"+t);break}l.trigger(u["default"].MANIFEST_PARSED,{levels:this._levels,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:o,altAudio:e.audioTracks.length>0})}else l.trigger(u["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:l.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels;if(e>=0&&e<t.length){this.timer&&(clearTimeout(this.timer),this.timer=null),this._level!==e&&(f.logger.log("switching to level "+e),this._level=e),this.hls.trigger(u["default"].LEVEL_SWITCH,{level:e});var n=t[e],r=n.details;if(!r||r.live===!0){var i=n.urlId;this.hls.trigger(u["default"].LEVEL_LOADING,{url:n.url[i],level:e,id:i})}}else this.hls.trigger(u["default"].ERROR,{type:p.ErrorTypes.OTHER_ERROR,details:p.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(!e.fatal){var t=e.details,n=this.hls,r=void 0,i=void 0,a=!1;switch(t){case p.ErrorDetails.FRAG_LOAD_ERROR:case p.ErrorDetails.FRAG_LOAD_TIMEOUT:case p.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case p.ErrorDetails.KEY_LOAD_ERROR:case p.ErrorDetails.KEY_LOAD_TIMEOUT:r=e.frag.level;break;case p.ErrorDetails.LEVEL_LOAD_ERROR:case p.ErrorDetails.LEVEL_LOAD_TIMEOUT:r=e.context.level,a=!0}if(void 0!==r)if(i=this._levels[r],i.urlId<i.url.length-1)i.urlId++,i.details=void 0,f.logger.warn("level controller,"+t+" for level "+r+": switching to redundant stream id "+i.urlId);else{var o=this._manualLevel===-1&&r;if(o)f.logger.warn("level controller,"+t+": emergency switch-down for next fragment"),n.abrController.nextAutoLevel=0;else if(i&&i.details&&i.details.live)f.logger.warn("level controller,"+t+" on live stream, discard"),a&&(this._level=void 0);else if(t===p.ErrorDetails.LEVEL_LOAD_ERROR||t===p.ErrorDetails.LEVEL_LOAD_TIMEOUT){var s=this.hls,l=s.media,c=l&&g["default"].isBuffered(l,l.currentTime)&&g["default"].isBuffered(l,l.currentTime+.5);if(c){var d=s.config.levelLoadingRetryDelay;f.logger.warn("level controller,"+t+", but media buffered, retry in "+d+"ms"),this.timer=setTimeout(this.ontick,d)}else f.logger.error("cannot recover "+t+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),e.fatal=!0,s.trigger(u["default"].ERROR,e)}}}}},{key:"onLevelLoaded",value:function(e){if(e.level===this._level){var t=e.details;if(t.live){var n=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),r=this._levels[e.level],i=r.details;i&&t.endSN===i.endSN&&(n/=2,f.logger.log("same live playlist, reload twice faster")),n-=performance.now()-e.stats.trequest,n=Math.max(1e3,Math.round(n)),f.logger.log("live playlist, reload in "+n+" ms"),this.timer=setTimeout(this.ontick,n)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e],n=t.urlId;this.hls.trigger(u["default"].LEVEL_LOADING,{url:t.url[n],level:e,id:n})}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),e!==-1&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return this._manualLevel!==-1?this._manualLevel:this.hls.abrController.nextAutoLevel},set:function(e){this.level=e,this._manualLevel===-1&&(this.hls.abrController.nextAutoLevel=e)}}]),t}(d["default"]);n["default"]=m},{26:26,27:27,28:28,30:30,45:45}],12:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(41),u=r(l),c=e(30),d=r(c),f=e(22),p=r(f),h=e(28),g=r(h),m=e(27),v=r(m),y=e(31),_=r(y),E=e(47),b=r(E),T=e(26),w=e(45),A={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},R=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,g["default"].MEDIA_ATTACHED,g["default"].MEDIA_DETACHING,g["default"].MANIFEST_LOADING,g["default"].MANIFEST_PARSED,g["default"].LEVEL_LOADED,g["default"].KEY_LOADED,g["default"].FRAG_LOADED,g["default"].FRAG_LOAD_EMERGENCY_ABORTED,g["default"].FRAG_PARSING_INIT_SEGMENT,g["default"].FRAG_PARSING_DATA,g["default"].FRAG_PARSED,g["default"].ERROR,g["default"].AUDIO_TRACK_SWITCH,g["default"].BUFFER_CREATED,g["default"].BUFFER_APPENDED,g["default"].BUFFER_FLUSHED));return n.config=e.config,n.audioCodecSwap=!1,n.ticks=0,n.ontick=n.tick.bind(n),n}return o(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),v["default"].prototype.destroy.call(this),this.state=A.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.media,n=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,t&&n>0?(w.logger.log("configure startPosition @"+n.toFixed(3)),this.lastPaused||(w.logger.log("resuming video"),t.play())):this.lastCurrentTime=this.startPosition?this.startPosition:e,!this.startFragRequested){var i=r.startLevel;i===-1&&(i=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}this.state=A.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else w.logger.warn("cannot start loading as manifest not parsed yet"),this.state=A.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=A.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){
switch(this.state){case A.ERROR:break;case A.BUFFER_FLUSHING:this.fragLoadError=0;break;case A.IDLE:if(!this._doTickIdle())return;break;case A.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=A.IDLE);break;case A.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),n=this.retryDate;(!n||t>=n||this.media&&this.media.seeking)&&(w.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=A.IDLE);break;case A.ERROR:case A.PAUSED:case A.STOPPED:case A.FRAG_LOADING:case A.PARSING:case A.PARSED:case A.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,n=this.media;if(void 0!==this.levelLastLoaded&&!n&&(this.startFragRequested||!t.startFragPrefetch))return!0;var r=void 0;r=this.loadedmetadata?n.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,a=this.levels[i],o=a.bitrate,s=void 0;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=d["default"].bufferInfo(this.mediaBuffer?this.mediaBuffer:n,r,t.maxBufferHole),u=l.len;if(u>=s)return!0;w.logger.trace("buffer length of "+u.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var c=a.details;if("undefined"==typeof c||c.live&&this.levelLastLoaded!==i)return this.state=A.WAITING_LEVEL,!0;var f=this.fragPrevious;if(!c.live&&f&&f.sn===c.endSN&&(!n.seeking&&l.len||n.duration-l.end<=f.duration/2)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(g["default"].BUFFER_EOS,p),this.state=A.ENDED,!0}return this._fetchPayloadOrEos({pos:r,bufferInfo:l,levelDetails:c})}},{key:"_fetchPayloadOrEos",value:function(e){var t=e.pos,n=e.bufferInfo,r=e.levelDetails,i=this.fragPrevious,a=this.level,o=r.fragments,s=o.length;if(0===s)return!1;var l=o[0].start,u=o[s-1].start+o[s-1].duration,c=n.end,d=void 0;if(r.live){var f=this.config.initialLiveManifestSize;if(s<f)return w.logger.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+f),!1;if(d=this._ensureFragmentAtLivePoint({levelDetails:r,bufferEnd:c,start:l,end:u,fragPrevious:i,fragments:o,fragLen:s}),null===d)return!1}else c<l&&(d=o[0]);return d||(d=this._findFragment({start:l,fragPrevious:i,fragLen:s,fragments:o,bufferEnd:c,end:u,levelDetails:r})),!d||this._loadFragmentOrKey({frag:d,level:a,levelDetails:r,pos:t,bufferEnd:c})}},{key:"_ensureFragmentAtLivePoint",value:function(e){var t=e.levelDetails,n=e.bufferEnd,r=e.start,i=e.end,a=e.fragPrevious,o=e.fragments,s=e.fragLen,l=this.hls.config,u=this.media,c=void 0,d=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*t.targetduration;if(n<Math.max(r,i-d)){var f=this.liveSyncPosition=this.computeLivePosition(r,t);w.logger.log("buffer end: "+n.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),n=f,u&&u.readyState&&u.duration>f&&(u.currentTime=f)}if(t.PTSKnown&&n>i&&u&&u.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(a){var p=a.sn+1;p>=t.startSN&&p<=t.endSN&&(c=o[p-t.startSN],w.logger.log("live playlist, switching playlist, load frag with next SN: "+c.sn))}c||(c=o[Math.min(s-1,Math.round(s/2))],w.logger.log("live playlist, switching playlist, unknown, load middle frag : "+c.sn))}return c}},{key:"_findFragment",value:function(e){var t=e.start,n=e.fragPrevious,r=e.fragLen,i=e.fragments,a=e.bufferEnd,o=e.end,s=e.levelDetails,l=this.hls.config,c=void 0,d=void 0,f=l.maxFragLookUpTolerance;if(a<o?(a>o-f&&(f=0),d=u["default"].search(i,function(e){return e.start+e.duration-f<=a?1:e.start-f>a&&e.start?-1:0})):d=i[r-1],d&&(c=d,t=d.start,n&&c.level===n.level&&c.sn===n.sn))if(c.sn<s.endSN){var p=n.deltaPTS,h=c.sn-s.startSN;p&&p>l.maxBufferHole&&n.dropped&&h?(c=i[h-1],w.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),n.loadCounter--):(c=i[h+1],w.logger.log("SN just loaded, load next one: "+c.sn))}else c=null;return c}},{key:"_loadFragmentOrKey",value:function(e){var t=e.frag,n=e.level,r=e.levelDetails,i=e.pos,a=e.bufferEnd,o=this.hls,s=o.config;if(null==t.decryptdata.uri||null!=t.decryptdata.key){if(w.logger.log("Loading "+t.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n+", currentTime:"+i.toFixed(3)+",bufferEnd:"+a.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,t.loadCounter){t.loadCounter++;var l=s.fragLoadingLoopThreshold;if(t.loadCounter>l&&Math.abs(this.fragLoadIdx-t.loadIdx)<l)return o.trigger(g["default"].ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:t}),!1}else t.loadCounter=1;return t.loadIdx=this.fragLoadIdx,this.fragCurrent=t,this.startFragRequested=!0,t.autoLevel=o.autoLevelEnabled,t.bitrateTest=this.bitrateTest,o.trigger(g["default"].FRAG_LOADING,{frag:t}),this.state=A.FRAG_LOADING,!0}w.logger.log("Loading key for "+t.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n),this.state=A.KEY_LOADING,o.trigger(g["default"].KEY_LOADING,{frag:t})}},{key:"getBufferRange",value:function(e){var t,n,r=this.bufferRange;if(r)for(t=r.length-1;t>=0;t--)if(n=r[t],e>=n.start&&e<=n.end)return n;return null}},{key:"followingBufferRange",value:function(e){return e?this.getBufferRange(e.end+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,n=this.media;if(n&&n.readyState&&n.seeking===!1&&(t=n.currentTime,t>n.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),d["default"].isBuffered(n,t)?e=this.getBufferRange(t):d["default"].isBuffered(n,t+.1)&&(e=this.getBufferRange(t+.1)),e)){var r=e.frag;r!==this.fragPlaying&&(this.fragPlaying=r,this.hls.trigger(g["default"].FRAG_CHANGED,{frag:r}))}}},{key:"immediateLevelSwitch",value:function(){if(w.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var n=this.fragCurrent;n&&n.loader&&n.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=A.BUFFER_FLUSHING,this.hls.trigger(g["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY})}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,d["default"].isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,n=void 0,r=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,n=this.getBufferRange(e.currentTime),n&&n.start>1&&(this.state=A.BUFFER_FLUSHING,this.hls.trigger(g["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:n.start-1})),e.paused)t=0;else{var i=this.hls.nextLoadLevel,a=this.levels[i],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*o)+1:0}if(r=this.getBufferRange(e.currentTime+t),r&&(r=this.followingBufferRange(r))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.state=A.BUFFER_FLUSHING,this.hls.trigger(g["default"].BUFFER_FLUSHING,{startOffset:r.start,endOffset:Number.POSITIVE_INFINITY})}}}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.hls.startLoad(n.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(w.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,n=this.config;if(w.logger.log("media seeking to "+t.toFixed(3)),this.state===A.FRAG_LOADING){var r=d["default"].bufferInfo(e,t,this.config.maxBufferHole),i=this.fragCurrent;if(0===r.len&&i){var a=n.maxFragLookUpTolerance,o=i.start-a,s=i.start+i.duration+a;t<o||t>s?(i.loader&&(w.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=A.IDLE):w.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===A.ENDED&&(this.state=A.IDLE);e&&(this.lastCurrentTime=t),this.state!==A.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*n.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaSeeked",value:function(){w.logger.log("media seeked to "+this.media.currentTime.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){w.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){w.logger.log("trigger BUFFER_RESET"),this.hls.trigger(g["default"].BUFFER_RESET),this.bufferRange=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,n=!1,r=!1;e.levels.forEach(function(e){t=e.audioCodec,t&&(t.indexOf("mp4a.40.2")!==-1&&(n=!0),t.indexOf("mp4a.40.5")!==-1&&(r=!0))}),this.audioCodecSwitch=n&&r,this.audioCodecSwitch&&w.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var i=this.config;i.autoStartLoad&&this.hls.startLoad(i.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,n=e.level,r=this.levels[n],i=t.totalduration,a=0;if(w.logger.log("level "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),this.levelLastLoaded=n,t.live){var o=r.details;o&&t.fragments.length>0?(_["default"].mergeDetails(o,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),t.PTSKnown?w.logger.log("live playlist sliding:"+a.toFixed(3)):w.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,w.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(r.details=t,this.hls.trigger(g["default"].LEVEL_UPDATED,{details:t,level:n}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(a,t),w.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(w.logger.log("negative start time offset "+s+", count from end of last fragment"),s=a+i+s),w.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===A.WAITING_LEVEL&&(this.state=A.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===A.KEY_LOADING&&(this.state=A.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,n=e.frag;if(this.state===A.FRAG_LOADING&&t&&"main"===n.type&&n.level===t.level&&n.sn===t.sn){var r=e.stats,i=this.levels[t.level],a=i.details;if(w.logger.log("Loaded  "+t.sn+" of ["+a.startSN+" ,"+a.endSN+"],level "+t.level),this.bitrateTest=!1,n.bitrateTest===!0&&this.hls.nextLoadLevel)this.state=A.IDLE,this.startFragRequested=!1,r.tparsed=r.tbuffered=performance.now(),this.hls.trigger(g["default"].FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.tick();else{this.state=A.PARSING,this.stats=r;var o=a.totalduration,s=isNaN(t.startDTS)?t.start:t.startDTS,l=t.level,u=t.sn,c=this.config.defaultAudioCodec||i.audioCodec;this.audioCodecSwap&&(w.logger.log("swapping playlist audio codec"),void 0===c&&(c=this.lastAudioCodec),c&&(c=c.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5")),this.pendingAppending=0,w.logger.log("Parsing "+u+" of ["+a.startSN+" ,"+a.endSN+"],level "+l+", cc "+t.cc);var d=this.demuxer;d||(d=this.demuxer=new p["default"](this.hls,"main"));var f=a.PTSKnown||!a.live;d.push(e.payload,c,i.videoCodec,s,t.cc,l,u,o,t.decryptdata,f)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===A.PARSING){var n,r,i=e.tracks;if(i.audio&&this.altAudio&&delete i.audio,r=i.audio){var a=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(w.logger.log("swapping playlist audio codec"),a=a.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&o.indexOf("firefox")===-1&&(a="mp4a.40.5"),o.indexOf("android")!==-1&&(a="mp4a.40.2",w.logger.log("Android: force audio codec to"+a)),r.levelCodec=a,r.id=e.id}if(r=i.video,r&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=e.id),e.unique){var s={codec:"",levelCodec:""};for(n in e.tracks)r=i[n],s.container=r.container,s.codec&&(s.codec+=",",s.levelCodec+=","),r.codec&&(s.codec+=r.codec),r.levelCodec&&(s.levelCodec+=r.levelCodec);i={audiovideo:s}}this.hls.trigger(g["default"].BUFFER_CODECS,i);for(n in i){r=i[n],w.logger.log("main track:"+n+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var l=r.initSegment;l&&(this.pendingAppending++,this.hls.trigger(g["default"].BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,n=this.fragCurrent;if(n&&"main"===e.id&&e.sn===n.sn&&e.level===n.level&&("audio"!==e.type||!this.altAudio)&&this.state===A.PARSING){var r=this.levels[this.level],i=this.fragCurrent;w.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0));var a=_["default"].updateFragPTSDTS(r.details,i.sn,e.startPTS,e.endPTS,e.startDTS,e.endDTS),o=this.hls;o.trigger(g["default"].LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:a}),"video"===e.type&&(i.dropped=e.dropped),[e.data1,e.data2].forEach(function(n){n&&(t.pendingAppending++,o.trigger(g["default"].BUFFER_APPENDING,{type:e.type,data:n,parent:"main",content:"data"}))}),this.nextLoadPosition=e.endPTS,this.bufferRange.push({type:e.type,start:e.startPTS,end:e.endPTS,frag:i}),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===A.PARSING&&(this.stats.tparsed=performance.now(),this.state=A.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitch",value:function(e){var t=!!e.url;if(t)this.videoBuffer&&this.mediaBuffer!==this.videoBuffer&&(w.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=this.videoBuffer);else if(this.mediaBuffer!==this.media){w.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(w.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=A.IDLE}this.altAudio=t}},{key:"onBufferCreated",value:function(e){var t=e.tracks,n=void 0,r=void 0,i=!1;for(var a in t){var o=t[a];"main"===o.id?(r=a,n=o,"video"===a&&(this.videoBuffer=t[a].buffer)):i=!0}i&&n?(w.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=n.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent)switch(this.state){case A.PARSING:case A.PARSED:this.pendingAppending--,this._checkAppendedParsed()}}},{key:"_checkAppendedParsed",value:function(){if(this.state===A.PARSED&&0===this.pendingAppending){var e=this.fragCurrent,t=this.stats;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*t.total/(t.tbuffered-t.tfirst)),this.hls.trigger(g["default"].FRAG_BUFFERED,{stats:t,frag:e,id:"main"});var n=this.mediaBuffer?this.mediaBuffer:this.media;w.logger.log("main buffered : "+b["default"].toString(n.buffered)),this.state=A.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var n=this.media,r=n&&d["default"].isBuffered(n,n.currentTime)&&d["default"].isBuffered(n,n.currentTime+.5);switch(e.details){case T.ErrorDetails.FRAG_LOAD_ERROR:case T.ErrorDetails.FRAG_LOAD_TIMEOUT:case T.ErrorDetails.KEY_LOAD_ERROR:case T.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var a=this.config;if(i<=a.fragLoadingMaxRetry||r||t.autoLevel&&t.level){this.fragLoadError=i,t.loadCounter=0;var o=Math.min(Math.pow(2,i-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);w.logger.warn("mediaController: frag loading failed, retry in "+o+" ms"),this.retryDate=performance.now()+o,this.state=A.FRAG_LOADING_WAITING_RETRY}else w.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(g["default"].ERROR,e),this.state=A.ERROR}break;case T.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(r?(this._reduceMaxBufferLength(t.duration),this.state=A.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.hls.trigger(g["default"].ERROR,e),this.state=A.ERROR));break;case T.ErrorDetails.LEVEL_LOAD_ERROR:case T.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==A.ERROR&&(e.fatal?(this.state=A.ERROR,w.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):this.state===A.WAITING_LEVEL&&(this.state=A.IDLE));break;case T.ErrorDetails.BUFFER_FULL_ERROR:this.state!==A.PARSING&&this.state!==A.PARSED||(r?(this._reduceMaxBufferLength(t.duration),this.state=A.IDLE):(w.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.state=A.PAUSED,this.hls.trigger(g["default"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY})))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,w.logger.warn("reduce max buffer length to "+t.maxMaxBufferLength+"s and switch to IDLE state"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media;if(e&&e.readyState){var t=e.currentTime,n=e.buffered;if(!this.loadedmetadata&&n.length){this.loadedmetadata=!0;var r=this.startPosition,i=d["default"].isBuffered(e,r);t===r&&i||(w.logger.log("target start position:"+r),i||(r=n.start(0),w.logger.log("target start position not buffered, seek to buffered.start(0) "+r)),w.logger.log("adjust currentTime from "+t+" to "+r),e.currentTime=r)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var a=d["default"].bufferInfo(e,t,0),o=!(e.paused||e.ended||0===e.buffered.length),s=.5,l=t>e.playbackRate*this.lastCurrentTime,u=this.config;if(this.stalled&&l&&(this.stalled=!1,w.logger.log("playback not stuck anymore @"+t)),o&&a.len<=s&&(l?(s=0,this.seekHoleNudgeDuration=0):this.stalled?this.seekHoleNudgeDuration+=u.seekHoleNudgeDuration:(this.seekHoleNudgeDuration=0,w.logger.log("playback seems stuck @"+t),this.hls.trigger(g["default"].ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1}),this.stalled=!0),a.len<=s)){var c=a.nextStart,f=c-t;if(c&&f<u.maxSeekHole&&f>0){w.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+c+" + nudge "+this.seekHoleNudgeDuration);var p=c+this.seekHoleNudgeDuration-e.currentTime;e.currentTime=c+this.seekHoleNudgeDuration,this.hls.trigger(g["default"].ERROR,{type:T.ErrorTypes.MEDIA_ERROR,details:T.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:p})}}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=A.IDLE,this.loadedmetadata||(this.startFragRequested=!1),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media,t=this.bufferRange,n=[],r=void 0,i=void 0;for(i=0;i<t.length;i++)r=t[i],d["default"].isBuffered(e,(r.start+r.end)/2)&&n.push(r);this.bufferRange=n,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=A.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var n=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-n)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,w.logger.log("engine state transition from "+t+" to "+e),this.hls.trigger(g["default"].STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferRange(e.currentTime);if(t)return t.frag.level}return-1}},{key:"nextBufferRange",get:function(){var e=this.media;return e?this.followingBufferRange(this.getBufferRange(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferRange;return e?e.frag.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(v["default"]);n["default"]=R},{22:22,26:26,27:27,28:28,30:30,31:31,41:41,45:45,47:47}],13:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(42),p=r(f),h=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].MEDIA_ATTACHING,u["default"].MEDIA_DETACHING,u["default"].FRAG_PARSING_USERDATA,u["default"].MANIFEST_LOADING,u["default"].FRAG_LOADED,u["default"].LEVEL_SWITCH));if(n.hls=e,n.config=e.config,n.enabled=!0,n.Cues=e.config.cueHandler,n.config.enableCEA708Captions){var r=n,o={newCue:function(e,t,n){if(!r.textTrack1){var i=r.getExistingTrack("1");if(i){r.textTrack1=i,r.clearCurrentCues(r.textTrack1);var a=new window.Event("addtrack");a.track=r.textTrack1,r.media.dispatchEvent(a)}else r.textTrack1=r.createTextTrack("captions","English","en"),r.textTrack1.textTrack1=!0}r.Cues.newCue(r.textTrack1,e,t,n)}},s={newCue:function(e,t,n){if(!r.textTrack2){var i=r.getExistingTrack("2");if(i){r.textTrack2=i,r.clearCurrentCues(r.textTrack2);var a=new window.Event("addtrack");a.track=r.textTrack2,r.media.dispatchEvent(a)}else r.textTrack2=r.createTextTrack("captions","Spanish","es"),r.textTrack2.textTrack2=!0}r.Cues.newCue(r.textTrack2,e,t,n)}};n.cea608Parser=new p["default"](0,o,s)}return n}return o(t,e),s(t,[{key:"clearCurrentCues",value:function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},{key:"getExistingTrack",value:function(e){var t=this.media;if(t)for(var n=0;n<t.textTracks.length;n++){var r=t.textTracks[n],i="textTrack"+e;if(r[i]===!0)return r}return null}},{key:"createTextTrack",value:function(e,t,n){if(this.media)return this.media.addTextTrack(e,t,n)}},{key:"destroy",value:function(){d["default"].prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){this.media=e.media}},{key:"onMediaDetaching",value:function(){}},{key:"onManifestLoading",value:function(){this.lastPts=Number.NEGATIVE_INFINITY}},{key:"onLevelSwitch",value:function(){"NONE"===this.hls.currentLevel.closedCaptions?this.enabled=!1:this.enabled=!0}},{key:"onFragLoaded",value:function(e){if("main"===e.frag.type){var t=e.frag.start;t<=this.lastPts&&(this.clearCurrentCues(this.textTrack1),this.clearCurrentCues(this.textTrack2)),this.lastPts=t}}},{key:"onFragParsingUserdata",value:function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var n=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,n)}}},{key:"extractCea608Data",value:function(e){for(var t,n,r,i,a,o=31&e[0],s=2,l=[],u=0;u<o;u++)t=e[s++],n=127&e[s++],r=127&e[s++],i=0!==(4&t),a=3&t,0===n&&0===r||i&&0===a&&(l.push(n),l.push(r));return l}}]),t}(d["default"]);n["default"]=h},{27:27,28:28,42:42}],14:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this.aesIV=t}return i(e,[{key:"decrypt",value:function(e,t){return window.crypto.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();n["default"]=a},{}],15:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[],this.subMix[0]=new Uint32Array(256),this.subMix[1]=new Uint32Array(256),this.subMix[2]=new Uint32Array(256),this.subMix[3]=new Uint32Array(256),this.invSubMix=[],this.invSubMix[0]=new Uint32Array(256),this.invSubMix[1]=new Uint32Array(256),this.invSubMix[2]=new Uint32Array(256),this.invSubMix[3]=new Uint32Array(256),this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return i(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),n=new Uint32Array(4),r=0;r<n.length;r++)n[r]=t.getUint32(4*r);return n}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,n=this.subMix[0],r=this.subMix[1],i=this.subMix[2],a=this.subMix[3],o=this.invSubMix[0],s=this.invSubMix[1],l=this.invSubMix[2],u=this.invSubMix[3],c=new Uint32Array(256),d=0,f=0,p=0;for(p=0;p<256;p++)p<128?c[p]=p<<1:c[p]=p<<1^283;for(p=0;p<256;p++){var h=f^f<<1^f<<2^f<<3^f<<4;h=h>>>8^255&h^99,e[d]=h,t[h]=d;var g=c[d],m=c[g],v=c[m],y=257*c[h]^16843008*h;n[d]=y<<24|y>>>8,r[d]=y<<16|y>>>16,i[d]=y<<8|y>>>24,a[d]=y,y=16843009*v^65537*m^257*g^16843008*d,o[h]=y<<24|y>>>8,s[h]=y<<16|y>>>16,l[h]=y<<8|y>>>24,u[h]=y,d?(d=g^c[c[c[v^g]]],f^=c[c[f]]):d=f=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;r<t.length&&n;)n=t[r]===this.key[r],r++;if(!n){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a=this.ksRows=4*(i+6+1),o=void 0,s=void 0,l=this.keySchedule=new Uint32Array(this.ksRows).fill(0),u=this.invKeySchedule=new Uint32Array(this.ksRows).fill(0),c=this.sBox,d=this.rcon,f=this.invSubMix[0],p=this.invSubMix[1],h=this.invSubMix[2],g=this.invSubMix[3],m=void 0,v=void 0;for(o=0;o<a;o++)o<i?m=l[o]=t[o]:(v=m,o%i===0?(v=v<<8|v>>>24,v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v],v^=d[o/i|0]<<24):i>6&&o%i===4&&(v=c[v>>>24]<<24|c[v>>>16&255]<<16|c[v>>>8&255]<<8|c[255&v]),l[o]=m=(l[o-i]^v)>>>0);for(s=0;s<a;s++)o=a-s,v=3&s?l[o]:l[o-4],s<4||o<=4?u[s]=v:u[s]=f[c[v>>>24]]^p[c[v>>>16&255]]^h[c[v>>>8&255]]^g[c[255&v]],u[s]=u[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,n){for(var r,i,a=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,l=this.invSubMix[0],u=this.invSubMix[1],c=this.invSubMix[2],d=this.invSubMix[3],f=this.uint8ArrayToUint32Array_(n),p=f[0],h=f[1],g=f[2],m=f[3],v=new Int32Array(e),y=new Int32Array(v.length),_=void 0,E=void 0,b=void 0,T=void 0,w=void 0,A=void 0,R=void 0,S=void 0,k=void 0,O=void 0,L=void 0,C=void 0;t<v.length;){for(k=this.networkToHostOrderSwap(v[t]),O=this.networkToHostOrderSwap(v[t+1]),L=this.networkToHostOrderSwap(v[t+2]),C=this.networkToHostOrderSwap(v[t+3]),w=k^o[0],A=C^o[1],R=L^o[2],S=O^o[3],r=4,i=1;i<a;i++)_=l[w>>>24]^u[A>>16&255]^c[R>>8&255]^d[255&S]^o[r],E=l[A>>>24]^u[R>>16&255]^c[S>>8&255]^d[255&w]^o[r+1],b=l[R>>>24]^u[S>>16&255]^c[w>>8&255]^d[255&A]^o[r+2],T=l[S>>>24]^u[w>>16&255]^c[A>>8&255]^d[255&R]^o[r+3],w=_,A=E,R=b,S=T,r+=4;_=s[w>>>24]<<24^s[A>>16&255]<<16^s[R>>8&255]<<8^s[255&S]^o[r],E=s[A>>>24]<<24^s[R>>16&255]<<16^s[S>>8&255]<<8^s[255&w]^o[r+1],b=s[R>>>24]<<24^s[S>>16&255]<<16^s[w>>8&255]<<8^s[255&A]^o[r+2],T=s[S>>>24]<<24^s[w>>16&255]<<16^s[A>>8&255]<<8^s[255&R]^o[r+3],r+=3,y[t]=this.networkToHostOrderSwap(_^p),y[t+1]=this.networkToHostOrderSwap(T^h),y[t+2]=this.networkToHostOrderSwap(b^g),y[t+3]=this.networkToHostOrderSwap(E^m),p=k,h=O,g=L,m=C,t+=4}return y.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();n["default"]=a},{}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(14),s=r(o),l=e(17),u=r(l),c=e(15),d=r(c),f=e(26),p=e(45),h=function(){function e(t){i(this,e),this.hls=t;try{var n=window?window.crypto:crypto;this.subtle=n.subtle||n.webkitSubtle}catch(r){}this.disableWebCrypto=!this.supportsWebCrypto()}return a(e,[{key:"supportsWebCrypto",value:function(){return this.subtle&&"https:"===window.location.protocol}},{key:"decrypt",value:function(e,t,n,r){var i=this;this.disableWebCrypto&&this.hls.config.enableSoftwareAES?(p.logger.log("decrypting by JavaScript Implementation"),this.decryptor||(this.decryptor=new d["default"]),this.decryptor.expandKey(t),r(this.decryptor.decrypt(e,0,n))):(p.logger.log("decrypting by WebCrypto API"),this.key!==t&&(this.key=t,this.fastAesKey=new u["default"](t)),this.fastAesKey.expandKey().then(function(t){var i=new s["default"](n);i.decrypt(e,t).then(function(e){r(e)})})["catch"](function(a){i.onWebCryptoError(a,e,t,n,r)}))}},{key:"onWebCryptoError",value:function(e,t,n,r,i){this.hls.config.enableSoftwareAES?(p.logger.log("disabling to use WebCrypto API"),this.disableWebCrypto=!0,this.decrypt(t,n,r,i)):(p.logger.error("decrypting error : "+e.message),this.hls.trigger(Event.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){this.decryptor&&(this.decryptor.destroy(),this.decryptor=void 0)}}]),e}();n["default"]=h},{14:14,15:15,17:17,26:26,45:45}],17:[function(e,t,n){"use strict";
function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this.key=t}return i(e,[{key:"expandKey",value:function(){return window.crypto.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();n["default"]=a},{}],18:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(19),s=r(o),l=e(45),u=e(24),c=r(u),d=function(){function e(t,n,r,a){i(this,e),this.observer=t,this.id=n,this.remuxerClass=r,this.config=a,this.remuxer=new this.remuxerClass(t,n,a),this.insertDiscontinuity()}return a(e,[{key:"insertDiscontinuity",value:function(){this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0}}},{key:"push",value:function(e,t,n,r,i,a,o,u,d){var f,p,h,g,m,v,y,_,E,b,T=new c["default"](e),w=90*T.timeStamp,A=!1;for(i!==this.lastCC?(l.logger.log(this.id+" discontinuity detected"),this.lastCC=i,this.insertDiscontinuity(),this.remuxer.switchLevel(),this.remuxer.insertDiscontinuity()):a!==this.lastLevel?(l.logger.log("audio track switch detected"),this.lastLevel=a,this.remuxer.switchLevel(),this.insertDiscontinuity()):o===this.lastSN+1&&(A=!0),f=this._aacTrack,this.lastSN=o,this.lastLevel=a,v=T.length,E=e.length;v<E-1&&(255!==e[v]||240!==(240&e[v+1]));v++);for(f.audiosamplerate||(p=s["default"].getAudioConfig(this.observer,e,v,t),f.config=p.config,f.audiosamplerate=p.samplerate,f.channelCount=p.channelCount,f.codec=p.codec,f.duration=u,l.logger.log("parsed codec:"+f.codec+",rate:"+p.samplerate+",nb channel:"+p.channelCount)),m=0,g=9216e4/f.audiosamplerate;v+5<E&&(y=1&e[v+1]?7:9,h=(3&e[v+3])<<11|e[v+4]<<3|(224&e[v+5])>>>5,h-=y,h>0&&v+y+h<=E);)for(_=w+m*g,b={unit:e.subarray(v+y,v+y+h),pts:_,dts:_},f.samples.push(b),f.len+=h,v+=h+y,m++;v<E-1&&(255!==e[v]||240!==(240&e[v+1]));v++);this.remuxer.remux(a,o,this._aacTrack,{samples:[]},{samples:[{pts:w,dts:w,unit:T.payload}]},{samples:[]},r,A,d)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,n,r=new c["default"](e);if(r.hasTimeStamp)for(t=r.length,n=e.length;t<n-1;t++)if(255===e[t]&&240===(240&e[t+1]))return!0;return!1}}]),e}();n["default"]=d},{19:19,24:24,45:45}],19:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=e(26),s=function(){function e(){r(this,e)}return i(e,null,[{key:"getAudioConfig",value:function(e,t,n,r){var i,s,l,u,c,d=navigator.userAgent.toLowerCase(),f=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return i=((192&t[n+2])>>>6)+1,s=(60&t[n+2])>>>2,s>f.length-1?void e.trigger(Event.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(u=(1&t[n+2])<<2,u|=(192&t[n+3])>>>6,a.logger.log("manifest codec:"+r+",ADTS data:type:"+i+",sampleingIndex:"+s+"["+f[s]+"Hz],channelConfig:"+u),/firefox|OPR/i.test(d)?s>=6?(i=5,c=new Array(4),l=s-3):(i=2,c=new Array(2),l=s):d.indexOf("android")!==-1?(i=2,c=new Array(2),l=s):(i=5,c=new Array(4),r&&(r.indexOf("mp4a.40.29")!==-1||r.indexOf("mp4a.40.5")!==-1)||!r&&s>=6?l=s-3:((r&&r.indexOf("mp4a.40.2")!==-1&&s>=6&&1===u||!r&&1===u)&&(i=2,c=new Array(2)),l=s)),c[0]=i<<3,c[0]|=(14&s)>>1,c[1]|=(1&s)<<7,c[1]|=u<<3,5===i&&(c[1]|=(14&l)>>1,c[2]=(1&l)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:f[s],channelCount:u,codec:"mp4a.40."+i})}}]),e}();n["default"]=s},{26:26,45:45}],20:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),l=e(26),u=e(18),c=r(u),d=e(25),f=r(d),p=e(38),h=r(p),g=e(39),m=r(g),v=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i(this,e),this.hls=t,this.id=n,this.config=this.hls.config||a,this.typeSupported=r}return a(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,n,r,i,a,o,u,d){var p=this.demuxer;if(!p){var g=this.hls,v=this.id;if(f["default"].probe(e))p=this.typeSupported.mp2t===!0?new f["default"](g,v,m["default"],this.config):new f["default"](g,v,h["default"],this.config);else{if(!c["default"].probe(e))return void g.trigger(s["default"].ERROR,{type:l.ErrorTypes.MEDIA_ERROR,id:v,details:l.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});p=new c["default"](g,v,h["default"],this.config)}this.demuxer=p}p.push(e,t,n,r,i,a,o,u,d)}}]),e}();n["default"]=v},{18:18,25:25,26:26,28:28,38:38,39:39}],21:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e(20),a=r(i),o=e(28),s=r(o),l=e(45),u=e(1),c=r(u),d=function(e){var t=new c["default"];t.trigger=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(r))},t.off=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(r))};var n=function(t,n){e.postMessage({event:t,data:n})};e.addEventListener("message",function(r){var i=r.data;switch(i.cmd){case"init":var o=JSON.parse(i.config);e.demuxer=new a["default"](t,i.id,i.typeSupported,o);try{(0,l.enableLogs)(o.debug)}catch(s){console.warn("demuxerWorker: unable to enable logs")}n("init",null);break;case"demux":e.demuxer.push(new Uint8Array(i.data),i.audioCodec,i.videoCodec,i.timeOffset,i.cc,i.level,i.sn,i.duration,i.accurateTimeOffset)}}),t.on(s["default"].FRAG_PARSING_INIT_SEGMENT,n),t.on(s["default"].FRAG_PARSED,n),t.on(s["default"].ERROR,n),t.on(s["default"].FRAG_PARSING_METADATA,n),t.on(s["default"].FRAG_PARSING_USERDATA,n),t.on(s["default"].FRAG_PARSING_DATA,function(t,n){var r=n.data1.buffer,i=n.data2.buffer;delete n.data1,delete n.data2,e.postMessage({event:t,data:n,data1:r,data2:i},[r,i])})};n["default"]=d},{1:1,20:20,28:28,45:45}],22:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),l=e(20),u=r(l),c=e(21),d=r(c),f=e(45),p=e(16),h=r(p),g=e(26),m=function(){function t(n,r){i(this,t),this.hls=n,this.id=r;var a={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:n.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t")};if(n.config.enableWorker&&"undefined"!=typeof Worker){f.logger.log("demuxing in webworker");var o=void 0;try{var l=e(3);o=this.w=l(d["default"]),this.onwmsg=this.onWorkerMessage.bind(this),o.addEventListener("message",this.onwmsg),o.onerror=function(e){n.trigger(s["default"].ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},o.postMessage({cmd:"init",typeSupported:a,id:r,config:JSON.stringify(n.config)})}catch(c){f.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),o&&URL.revokeObjectURL(o.objectURL),this.demuxer=new u["default"](n,r,a)}}else this.demuxer=new u["default"](n,r,a);this.demuxInitialized=!0}return a(t,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var n=this.decrypter;n&&(n.destroy(),this.decrypter=null)}},{key:"pushDecrypted",value:function(e,t,n,r,i,a,o,s,l){var u=this.w;if(u)u.postMessage({cmd:"demux",data:e,audioCodec:t,videoCodec:n,timeOffset:r,cc:i,level:a,sn:o,duration:s,accurateTimeOffset:l},[e]);else{var c=this.demuxer;c&&c.push(new Uint8Array(e),t,n,r,i,a,o,s,l)}}},{key:"push",value:function(e,t,n,r,i,a,o,l,u,c){if(e.byteLength>0&&null!=u&&null!=u.key&&"AES-128"===u.method){null==this.decrypter&&(this.decrypter=new h["default"](this.hls));var d=this,f=performance.now();this.decrypter.decrypt(e,u.key.buffer,u.iv.buffer,function(e){d.hls.trigger(s["default"].FRAG_DECRYPTED,{level:a,sn:o,stats:{tstart:f,tdecrypt:performance.now()}}),d.pushDecrypted(e,t,n,r,i,a,o,l,c)})}else this.pushDecrypted(e,t,n,r,i,a,o,l,c)}},{key:"onWorkerMessage",value:function(e){var t=e.data,n=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case s["default"].FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data.data2=new Uint8Array(t.data2);default:n.trigger(t.event,t.data)}}}]),t}();n["default"]=m},{16:16,20:20,21:21,26:26,28:28,3:3,45:45}],23:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(t){r(this,e),this.data=t,this.bytesAvailable=this.data.byteLength,this.word=0,this.bitsAvailable=0}return i(e,[{key:"loadWord",value:function(){var e=this.data.byteLength-this.bytesAvailable,t=new Uint8Array(4),n=Math.min(4,this.bytesAvailable);if(0===n)throw new Error("no bytes available");t.set(this.data.subarray(e,e+n)),this.word=new DataView(t.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;return e>32&&a.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,n,r=8,i=8;for(t=0;t<e;t++)0!==i&&(n=this.readEG(),i=(r+n+256)%256),r=0===i?r:i}},{key:"readSPS",value:function(){var e,t,n,r,i,a,o,s,l,u=0,c=0,d=0,f=0,p=1;if(this.readUByte(),e=this.readUByte(),t=this.readBits(5),this.skipBits(3),n=this.readUByte(),this.skipUEG(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var h=this.readUEG();if(3===h&&this.skipBits(1),this.skipUEG(),this.skipUEG(),this.skipBits(1),this.readBoolean())for(s=3!==h?8:12,l=0;l<s;l++)this.readBoolean()&&(l<6?this.skipScalingList(16):this.skipScalingList(64))}this.skipUEG();var g=this.readUEG();if(0===g)this.readUEG();else if(1===g)for(this.skipBits(1),this.skipEG(),this.skipEG(),r=this.readUEG(),l=0;l<r;l++)this.skipEG();if(this.skipUEG(),this.skipBits(1),i=this.readUEG(),a=this.readUEG(),o=this.readBits(1),0===o&&this.skipBits(1),this.skipBits(1),this.readBoolean()&&(u=this.readUEG(),c=this.readUEG(),d=this.readUEG(),f=this.readUEG()),this.readBoolean()&&this.readBoolean()){var m=void 0,v=this.readUByte();switch(v){case 1:m=[1,1];break;case 2:m=[12,11];break;case 3:m=[10,11];break;case 4:m=[16,11];break;case 5:m=[40,33];break;case 6:m=[24,11];break;case 7:m=[20,11];break;case 8:m=[32,11];break;case 9:m=[80,33];break;case 10:m=[18,11];break;case 11:m=[15,11];break;case 12:m=[64,33];break;case 13:m=[160,99];break;case 14:m=[4,3];break;case 15:m=[3,2];break;case 16:m=[2,1];break;case 255:m=[this.readUByte()<<8|this.readUByte(),this.readUByte()<<8|this.readUByte()]}m&&(p=m[0]/m[1])}return{width:Math.ceil((16*(i+1)-2*u-2*c)*p),height:(2-o)*(a+1)*16-(o?2:4)*(d+f)}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();n["default"]=o},{45:45}],24:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(t){r(this,e),this._hasTimeStamp=!1;for(var n,i,o,s,l,u,c,d,f=0;;)if(c=this.readUTF(t,f,3),f+=3,"ID3"===c)f+=3,n=127&t[f++],i=127&t[f++],o=127&t[f++],s=127&t[f++],l=(n<<21)+(i<<14)+(o<<7)+s,u=f+l,this._parseID3Frames(t,f,u),f=u;else{if("3DI"!==c)return f-=3,d=f,void(d&&(this.hasTimeStamp||a.logger.warn("ID3 tag found, but no timestamp"),this._length=d,this._payload=t.subarray(0,d)));f+=7,a.logger.log("3DI footer found, end: "+f)}}return i(e,[{key:"readUTF",value:function(e,t,n){var r="",i=t,a=t+n;do r+=String.fromCharCode(e[i++]);while(i<a);return r}},{key:"_parseID3Frames",value:function(e,t,n){for(var r,i,o,s,l;t+8<=n;)switch(r=this.readUTF(e,t,4),t+=4,i=e[t++]<<24+e[t++]<<16+e[t++]<<8+e[t++],s=e[t++]<<8+e[t++],o=t,r){case"PRIV":if("com.apple.streaming.transportStreamTimestamp"===this.readUTF(e,t,44)){t+=44,t+=4;var u=1&e[t++];this._hasTimeStamp=!0,l=((e[t++]<<23)+(e[t++]<<15)+(e[t++]<<7)+e[t++])/45,u&&(l+=47721858.84),l=Math.round(l),a.logger.trace("ID3 timestamp found: "+l),this._timeStamp=l}}}},{key:"hasTimeStamp",get:function(){return this._hasTimeStamp}},{key:"timeStamp",get:function(){return this._timeStamp}},{key:"length",get:function(){return this._length}},{key:"payload",get:function(){return this._payload}}]),e}();n["default"]=o},{45:45}],25:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(19),s=r(o),l=e(28),u=r(l),c=e(23),d=r(c),f=e(45),p=e(26),h=function(){function e(t,n,r,a){i(this,e),this.observer=t,this.id=n,this.remuxerClass=r,this.config=a,this.lastCC=0,this.remuxer=new this.remuxerClass(t,n,a)}return a(e,[{key:"switchLevel",value:function(){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,sequenceNumber:0,samples:[],len:0,dropped:0},this._aacTrack={container:"video/mp2t",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0},this._id3Track={type:"id3",id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.remuxer.switchLevel()}},{key:"insertDiscontinuity",value:function(){this.switchLevel(),this.remuxer.insertDiscontinuity()}},{key:"push",value:function(e,t,n,r,i,a,o,s,l){var c,d,h,g,m,v,y=e.length,_=this.remuxer.passthrough,E=!1;this.audioCodec=t,this.videoCodec=n,this._duration=s,this.contiguous=!1,this.accurateTimeOffset=l,i!==this.lastCC&&(f.logger.log("discontinuity detected"),this.insertDiscontinuity(),this.lastCC=i),a!==this.lastLevel?(f.logger.log("level switch detected"),this.switchLevel(),this.lastLevel=a):o===this.lastSN+1&&(this.contiguous=!0),this.lastSN=o;var b=this.pmtParsed,T=this._avcTrack,w=this._aacTrack,A=this._id3Track,R=T.id,S=w.id,k=A.id,O=this._pmtId,L=T.pesData,C=w.pesData,D=A.pesData,P=this._parsePAT,I=this._parsePMT,N=this._parsePES,M=this._parseAVCPES.bind(this),x=this._parseAACPES.bind(this),F=this._parseID3PES.bind(this);for(y-=y%188,c=0;c<y;c+=188)if(71===e[c]){if(d=!!(64&e[c+1]),h=((31&e[c+1])<<8)+e[c+2],g=(48&e[c+3])>>4,g>1){if(m=c+5+e[c+4],m===c+188)continue}else m=c+4;switch(h){case R:if(d){if(L&&(v=N(L))&&(M(v,!1),_&&T.codec&&(S===-1||w.codec)))return void this.remux(a,o,e,r);L={data:[],size:0}}L&&(L.data.push(e.subarray(m,c+188)),L.size+=c+188-m);break;case S:if(d){if(C&&(v=N(C))&&(x(v),_&&w.codec&&(R===-1||T.codec)))return void this.remux(a,o,e,r);C={data:[],size:0}}C&&(C.data.push(e.subarray(m,c+188)),C.size+=c+188-m);break;case k:d&&(D&&(v=N(D))&&F(v),D={data:[],size:0}),D&&(D.data.push(e.subarray(m,c+188)),D.size+=c+188-m);break;case 0:d&&(m+=e[m]+1),O=this._pmtId=P(e,m);break;case O:d&&(m+=e[m]+1);var U=I(e,m);R=U.avc,R>0&&(T.id=R),S=U.aac,S>0&&(w.id=S),k=U.id3,k>0&&(A.id=k),E&&!b&&(f.logger.log("reparse from beginning"),E=!1,c=-188),b=this.pmtParsed=!0;break;case 17:case 8191:break;default:E=!0}}else this.observer.trigger(u["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,id:this.id,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});L&&(v=N(L))?(M(v,!0),T.pesData=null):T.pesData=L,C&&(v=N(C))?(x(v),w.pesData=null):(C&&C.size&&f.logger.log("last AAC PES packet truncated,might overlap between fragments"),w.pesData=C),D&&(v=N(D))?(F(v),A.pesData=null):A.pesData=D,this.remux(a,o,null,r)}},{key:"remux",value:function(e,t,n,r){var i=this._avcTrack,a=i.samples,o=a.reduce(function(e,t){var n=t.units.units.reduce(function(e,t){return{len:e.len+t.data.length,nbNalu:e.nbNalu+1}},{len:0,nbNalu:0});return t.length=n.len,{len:e.len+n.len,nbNalu:e.nbNalu+n.nbNalu}},{len:0,nbNalu:0});i.len=o.len,i.nbNalu=o.nbNalu,this.remuxer.remux(e,t,this._aacTrack,this._avcTrack,this._id3Track,this._txtTrack,r,this.contiguous,this.accurateTimeOffset,n)}},{key:"destroy",value:function(){this.switchLevel(),this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t){var n,r,i,a,o={aac:-1,avc:-1,id3:-1};for(n=(15&e[t+1])<<8|e[t+2],r=t+3+n-4,i=(15&e[t+10])<<8|e[t+11],t+=12+i;t<r;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 15:o.aac===-1&&(o.aac=a);break;case 21:o.id3===-1&&(o.id3=a);break;case 27:o.avc===-1&&(o.avc=a);break;case 36:f.logger.warn("HEVC stream type found, not supported for now");break;default:f.logger.log("unkown stream type:"+e[t])}t+=((15&e[t+3])<<8|e[t+4])+5}return o}},{key:"_parsePES",value:function(e){var t,n,r,i,a,o,s,l,u,c=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var f=new Uint8Array(d[0].length+d[1].length);f.set(d[0]),f.set(d[1],d[0].length),d[0]=f,d.splice(1,1)}if(t=d[0],r=(t[0]<<16)+(t[1]<<8)+t[2],1===r){if(i=(t[4]<<8)+t[5],i&&i>e.size-6)return null;for(n=t[7],192&n&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,s>4294967295&&(s-=8589934592),64&n?(l=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,l>4294967295&&(l-=8589934592)):l=s),a=t[8],u=a+9,e.size-=u,o=new Uint8Array(e.size);d.length;){t=d.shift();var p=t.byteLength;if(u){if(u>p){u-=p;continue}t=t.subarray(u),p-=u,u=0}o.set(t,c),c+=p}return i&&(i-=a+3),{data:o,pts:s,dts:l,len:i}}return null}},{key:"pushAccesUnit",value:function(e,t){e.units.units.length&&(!this.config.forceKeyFrameOnDiscontinuity||e.key===!0||t.sps&&(t.samples.length||this.contiguous)?t.samples.push(e):t.dropped++),e.debug.length&&f.logger.log(e.pts+"/"+e.dts+":"+e.debug+","+e.units.length)}},{key:"_parseAVCPES",value:function(e,t){var n,r,i,a=this,o=this._avcTrack,s=this._parseAVCNALu(e.data),l=!1,u=this.avcSample;e.data=null,s.forEach(function(t){switch(t.type){case 1:r=!0,l&&u&&(u.debug+="NDR ");break;case 5:r=!0,u||(u=a.avcSample=a._createAVCSample(!0,e.pts,e.dts,"")),l&&(u.debug+="IDR "),u.key=!0;break;case 6:r=!0,l&&u&&(u.debug+="SEI "),n=new d["default"](a.discardEPB(t.data)),n.readUByte();for(var s=0,c=0,f=!1,p=0;!f&&n.bytesAvailable>1;){s=0;do p=n.readUByte(),s+=p;while(255===p);c=0;do p=n.readUByte(),c+=p;while(255===p);if(4===s&&0!==n.bytesAvailable){f=!0;var h=n.readUByte();if(181===h){var g=n.readUShort();if(49===g){var m=n.readUInt();if(1195456820===m){var v=n.readUByte();if(3===v){var y=n.readUByte(),_=n.readUByte(),E=31&y,b=[y,_];for(i=0;i<E;i++)b.push(n.readUByte()),b.push(n.readUByte()),b.push(n.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}}}}else if(c<n.bytesAvailable)for(i=0;i<c;i++)n.readUByte()}break;case 7:if(r=!0,l&&u&&(u.debug+="SPS "),!o.sps){n=new d["default"](t.data);var T=n.readSPS();o.width=T.width,o.height=T.height,o.sps=[t.data],o.duration=a._duration;var w=t.data.subarray(1,4),A="avc1.";for(i=0;i<3;i++){var R=w[i].toString(16);R.length<2&&(R="0"+R),A+=R}o.codec=A}break;case 8:r=!0,l&&u&&(u.debug+="PPS "),o.pps||(o.pps=[t.data]);break;case 9:r=!1,u&&a.pushAccesUnit(u,o),u=a.avcSample=a._createAVCSample(!1,e.pts,e.dts,l?"AUD ":"");break;case 12:r=!1;break;default:r=!1,u&&(u.debug+="unknown NAL "+t.type+" ")}if(u&&r){var S=u.units;S.units.push(t)}}),t&&u&&(this.pushAccesUnit(u,o),this.avcSample=null)}},{key:"_createAVCSample",value:function(e,t,n,r){return{key:e,pts:t,dts:n,units:{units:[],length:0},debug:r}}},{key:"_insertSampleInOrder",value:function(e,t){var n=e.length;if(n>0){if(t.pts>=e[n-1].pts)e.push(t);else for(var r=n-1;r>=0;r--)if(t.pts<e[r].pts){e.splice(r,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.units.length){var n=this._avcTrack,r=n.samples;e=r[r.length-1]}if(e){var i=e.units.units;t=i[i.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){for(var t,n,r,i,a,o=0,s=e.byteLength,l=this._avcTrack,u=l.naluState||0,c=u,d=[],f=-1;o<s;)switch(t=e[o++],u){case 0:0===t&&(u=1);break;case 1:u=0===t?2:0;break;case 2:case 3:if(0===t)u=3;else if(1===t){if(f>=0)r={data:e.subarray(f,o-u-1),type:a},d.push(r);else{var p=this._getLastNalUnit();if(p&&(c&&o<=4-c&&p.state&&(p.data=p.data.subarray(0,p.data.byteLength-c)),n=o-u-1,n>0)){var h=new Uint8Array(p.data.byteLength+n);h.set(p.data,0),h.set(e.subarray(0,n),p.data.byteLength),p.data=h}}o<s?(i=31&e[o],f=o,a=i,u=0):u=-1}else u=0;break;case-1:f=0,a=31&t,u=0}if(f>=0&&u>=0&&(r={data:e.subarray(f,s),type:a,state:u},d.push(r)),0===d.length){var g=this._getLastNalUnit();if(g){var m=new Uint8Array(g.data.byteLength+e.byteLength);m.set(g.data,0),m.set(e,g.data.byteLength),g.data=m}}return l.naluState=u,d}},{key:"discardEPB",value:function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n}},{key:"_parseAACPES",value:function(e){var t,n,r,i,a,o,l,c,d,h=this._aacTrack,g=e.data,m=e.pts,v=0,y=this.aacOverFlow,_=this.aacLastPTS;if(y){var E=new Uint8Array(y.byteLength+g.byteLength);E.set(y,0),E.set(g,y.byteLength),g=E}for(a=v,c=g.length;a<c-1&&(255!==g[a]||240!==(240&g[a+1]));a++);if(a){var b,T;if(a<c-1?(b="AAC PES did not start with ADTS header,offset:"+a,T=!1):(b="no ADTS header found in AAC PES",T=!0),f.logger.warn("parsing error:"+b),this.observer.trigger(u["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,id:this.id,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:T,reason:b}),T)return}if(h.audiosamplerate||(t=s["default"].getAudioConfig(this.observer,g,a,this.audioCodec),h.config=t.config,h.audiosamplerate=t.samplerate,h.channelCount=t.channelCount,h.codec=t.codec,h.duration=this._duration,f.logger.log("parsed codec:"+h.codec+",rate:"+t.samplerate+",nb channel:"+t.channelCount)),i=0,r=9216e4/h.audiosamplerate,y&&_){var w=_+r;Math.abs(w-m)>1&&(f.logger.log("AAC: align PTS for overlapping frames by "+Math.round((w-m)/90)),m=w)}for(;a+5<c&&(o=1&g[a+1]?7:9,n=(3&g[a+3])<<11|g[a+4]<<3|(224&g[a+5])>>>5,n-=o,n>0&&a+o+n<=c);)for(l=m+i*r,d={unit:g.subarray(a+o,a+o+n),pts:l,dts:l},h.samples.push(d),h.len+=n,a+=n+o,i++;a<c-1&&(255!==g[a]||240!==(240&g[a+1]));a++);y=a<c?g.subarray(a,c):null,this.aacOverFlow=y,this.aacLastPTS=l}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();n["default"]=h},{19:19,23:23,26:26,28:28,45:45}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",OTHER_ERROR:"otherError"},n.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",INTERNAL_EXCEPTION:"internalException"}},{}],27:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e(45),l=e(26),u=e(28),c=r(u),d=function(){function e(t){i(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}return o(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===a(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){var n=function(e,t){var n="on"+e.replace("hls","");if("function"!=typeof this[n])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+n+")");return this[n].bind(this,t)};try{n.call(this,e,t).call()}catch(r){s.logger.error("internal error happened while processing "+e+":"+r.message),this.hls.trigger(c["default"].ERROR,{type:l.ErrorTypes.OTHER_ERROR,details:l.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:r})}}}]),e}();n["default"]=d},{26:26,28:28,45:45}],28:[function(e,t,n){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],29:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"getSilentFrame",value:function(e){return 1===e?new Uint8Array([0,200,0,128,35,128]):2===e?new Uint8Array([33,0,73,144,2,25,0,35,128]):3===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]):4===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]):5===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]):6===e?new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]):null}}]),e}();n["default"]=a},{}],30:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"isBuffered",value:function(e,t){if(e)for(var n=e.buffered,r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0;return!1}},{key:"bufferInfo",value:function(e,t,n){if(e){var r,i=e.buffered,a=[];for(r=0;r<i.length;r++)a.push({start:i.start(r),end:i.end(r)});return this.bufferedInfo(a,t,n)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"bufferedInfo",value:function(e,t,n){var r,i,a,o,s,l=[];for(e.sort(function(e,t){var n=e.start-t.start;return n?n:t.end-e.end}),s=0;s<e.length;s++){var u=l.length;if(u){var c=l[u-1].end;e[s].start-c<n?e[s].end>c&&(l[u-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,r=0,i=a=t;s<l.length;s++){var d=l[s].start,f=l[s].end;if(t+n>=d&&t<f)i=d,a=f,r=a-t;else if(t+n<d){o=d;break}}return{len:r,start:i,end:a,nextStart:o}}}]),e}();n["default"]=a},{}],31:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(){r(this,e)}return i(e,null,[{key:"mergeDetails",value:function(t,n){var r,i=Math.max(t.startSN,n.startSN)-n.startSN,o=Math.min(t.endSN,n.endSN)-n.startSN,s=n.startSN-t.startSN,l=t.fragments,u=n.fragments,c=0;if(o<i)return void(n.PTSKnown=!1);for(var d=i;d<=o;d++){var f=l[s+d],p=u[d];p&&f&&(c=f.cc-p.cc,isNaN(f.startPTS)||(p.start=p.startPTS=f.startPTS,p.endPTS=f.endPTS,p.duration=f.duration,r=p))}if(c)for(a.logger.log("discontinuity sliding from playlist, take drift into account"),d=0;d<u.length;d++)u[d].cc+=c;if(r)e.updateFragPTSDTS(n,r.sn,r.startPTS,r.endPTS,r.startDTS,r.endDTS);else if(s>=0&&s<l.length){var h=l[s].start;for(d=0;d<u.length;d++)u[d].start+=h}n.PTSKnown=t.PTSKnown}},{key:"updateFragPTSDTS",value:function(t,n,r,i,a,o){var s,l,u,c;if(n<t.startSN||n>t.endSN)return 0;if(s=n-t.startSN,l=t.fragments,u=l[s],!isNaN(u.startPTS)){var d=Math.abs(u.startPTS-r);isNaN(u.deltaPTS)?u.deltaPTS=d:u.deltaPTS=Math.max(d,u.deltaPTS),r=Math.min(r,u.startPTS),i=Math.max(i,u.endPTS),a=Math.min(a,u.startDTS),o=Math.max(o,u.endDTS)}var f=r-u.start;for(u.start=u.startPTS=r,u.endPTS=i,u.startDTS=a,u.endDTS=o,u.duration=i-r,c=s;c>0;c--)e.updatePTS(l,c,c-1);for(c=s;c<l.length-1;c++)e.updatePTS(l,c,c+1);return t.PTSKnown=!0,f}},{key:"updatePTS",value:function(e,t,n){var r=e[t],i=e[n],o=i.startPTS;isNaN(o)?n>t?i.start=r.start+r.duration:i.start=r.start-i.duration:n>t?(r.duration=o-r.start,r.duration<0&&a.logger.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):(i.duration=r.start-o,i.duration<0&&a.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"))}}]),e}();n["default"]=o},{45:45}],32:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),l=e(26),u=e(36),c=r(u),d=e(34),f=r(d),p=e(4),h=r(p),g=e(7),m=r(g),v=e(8),y=r(v),_=e(5),E=r(_),b=e(12),T=r(b),w=e(11),A=r(w),R=e(13),S=r(R),k=e(10),O=r(k),L=e(6),C=r(L),D=e(45),P=e(48),I=r(P),N=e(1),M=r(N),x=e(35),F=r(x),U=e(43),B=r(U),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=e.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var r in n)r in t||(t[r]=n[r]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,D.enableLogs)(t.debug),this.config=t;var a=this.observer=new M["default"];a.trigger=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];a.emit.apply(a,[e,e].concat(n))},a.off=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];a.removeListener.apply(a,[e].concat(n))},this.on=a.on.bind(a),this.off=a.off.bind(a),this.trigger=a.trigger.bind(a),this.playlistLoader=new c["default"](this),this.fragmentLoader=new f["default"](this),this.levelController=new A["default"](this),this.abrController=new t.abrController(this),this.bufferController=new t.bufferController(this),this.capLevelController=new t.capLevelController(this),this.fpsController=new t.fpsController(this),this.streamController=new t.streamController(this),this.audioStreamController=new t.audioStreamController(this),this.timelineController=new t.timelineController(this),this.audioTrackController=new C["default"](this),this.keyLoader=new F["default"](this)}return a(e,null,[{key:"isSupported",value:function(){return window.MediaSource=window.MediaSource||window.WebKitMediaSource,window.MediaSource&&"function"==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"version",get:function(){return"0.6.10"}},{key:"Events",get:function(){return s["default"]}},{key:"ErrorTypes",get:function(){return l.ErrorTypes}},{key:"ErrorDetails",get:function(){return l.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,seekHoleNudgeDuration:.01,stalledInBufferedNudgeThreshold:10,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:I["default"],fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:h["default"],bufferController:m["default"],capLevelController:y["default"],fpsController:O["default"],streamController:T["default"],audioStreamController:E["default"],timelineController:S["default"],cueHandler:B["default"],enableCEA708Captions:!0,enableMP2TPassThrough:!1,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),a(e,[{key:"destroy",value:function(){D.logger.log("destroy"),this.trigger(s["default"].DESTROYING),this.detachMedia(),this.playlistLoader.destroy(),this.fragmentLoader.destroy(),this.levelController.destroy(),this.abrController.destroy(),this.bufferController.destroy(),this.capLevelController.destroy(),this.fpsController.destroy(),this.streamController.destroy(),this.audioStreamController.destroy(),this.timelineController.destroy(),this.audioTrackController.destroy(),this.keyLoader.destroy(),this.url=null,this.observer.removeAllListeners()}},{key:"attachMedia",value:function(e){D.logger.log("attachMedia"),this.media=e,this.trigger(s["default"].MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){D.logger.log("detachMedia"),this.trigger(s["default"].MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){D.logger.log("loadSource:"+e),this.url=e,this.trigger(s["default"].MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;D.logger.log("startLoad"),this.levelController.startLoad(),this.streamController.startLoad(e),this.audioStreamController.startLoad(e)}},{key:"stopLoad",value:function(){D.logger.log("stopLoad"),this.levelController.stopLoad(),this.streamController.stopLoad(),this.audioStreamController.stopLoad()}},{key:"swapAudioCodec",value:function(){D.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){D.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){D.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){D.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){D.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return this.levelController.firstLevel},set:function(e){D.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){D.logger.log("set startLevel:"+e),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this.abrController.autoLevelCapping},set:function(e){D.logger.log("set autoLevelCapping:"+e),this.abrController.autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"audioTracks",get:function(){return this.audioTrackController.audioTracks}},{key:"audioTrack",get:function(){return this.audioTrackController.audioTrack},set:function(e){this.audioTrackController.audioTrack=e}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}}]),e}();n["default"]=j},{1:1,10:10,11:11,12:12,13:13,26:26,28:28,34:34,35:35,36:36,4:4,43:43,45:45,48:48,5:5,6:6,7:7,8:8}],33:[function(e,t,n){"use strict";t.exports=e(32)["default"]},{32:32}],34:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(26),p=e(45),h=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].FRAG_LOADING));return n.loaders={},n}return o(t,e),s(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var n=e[t];n&&n.destroy()}this.loaders={},d["default"].prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,n=t.type,r=this.loaders[n],i=this.hls.config;t.loaded=0,r&&(p.logger.warn("abort previous fragment loader for type:"+n),r.abort()),r=this.loaders[n]=t.loader="undefined"!=typeof i.fLoader?new i.fLoader(i):new i.loader(i);var a=void 0,o=void 0,s=void 0;a={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,u=t.byteRangeEndOffset;isNaN(l)||isNaN(u)||(a.rangeStart=l,a.rangeEnd=u),o={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},r.load(a,o,s)}},{key:"loadsuccess",value:function(e,t,n){var r=e.data,i=n.frag;i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(u["default"].FRAG_LOADED,{payload:r,frag:i,stats:t})}},{key:"loaderror",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(u["default"].ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e})}},{key:"loadtimeout",value:function(e,t){var n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(u["default"].ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag})}},{key:"loadprogress",value:function(e,t,n){var r=t.frag;r.loaded=e.loaded,this.hls.trigger(u["default"].FRAG_LOAD_PROGRESS,{frag:r,stats:e})}}]),t}(d["default"]);n["default"]=h},{26:26,27:27,28:28,45:45}],35:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(28),u=r(l),c=e(27),d=r(c),f=e(26),p=e(45),h=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,u["default"].KEY_LOADING));return n.loaders={},n.decryptkey=null,n.decrypturl=null,n}return o(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},d["default"].prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,n=t.type,r=this.loaders[n],i=t.decryptdata,a=i.uri;if(a!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;r&&(p.logger.warn("abort previous key loader for type:"+n),r.abort()),t.loader=this.loaders[n]=new o.loader(o),this.decrypturl=a,this.decryptkey=null;var s=void 0,l=void 0,c=void 0;s={url:a,frag:t,responseType:"arraybuffer"},l={timeout:o.fragLoadingTimeOut,maxRetry:o.fragLoadingMaxRetry,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,l,c)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(u["default"].KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,n){var r=n.frag;this.decryptkey=r.decryptdata.key=new Uint8Array(e.data),r.loader=void 0,this.loaders[r.type]=void 0,this.hls.trigger(u["default"].KEY_LOADED,{frag:r})}},{key:"loaderror",value:function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(u["default"].ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:n,response:e})}},{key:"loadtimeout",value:function(e,t){var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(u["default"].ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:n})}}]),t}(d["default"]);n["default"]=h},{26:26,27:27,28:28,45:45}],36:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e(2),u=r(l),c=e(28),d=r(c),f=e(27),p=r(f),h=e(26),g=e(40),m=r(g),v=e(45),y=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d["default"].MANIFEST_LOADING,d["default"].LEVEL_LOADING,d["default"].AUDIO_TRACK_LOADING));return n.loaders={},n}return o(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},p["default"].prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"load",value:function(e,t){var n=this.loaders[t.type];if(n){var r=n.context;if(r&&r.url===e)return void v.logger.trace("playlist request ongoing");v.logger.warn("abort previous loader for type:"+t.type),n.abort()}var i=this.hls.config,a=void 0,o=void 0,s=void 0,l=void 0;"manifest"===t.type?(a=i.manifestLoadingMaxRetry,o=i.manifestLoadingTimeOut,s=i.manifestLoadingRetryDelay,l=i.manifestLoadingMaxRetryTimeOut):(a=i.levelLoadingMaxRetry,o=i.levelLoadingTimeOut,s=i.levelLoadingRetryDelay,l=i.levelLoadingMaxRetryTimeOut,v.logger.log("loading playlist for level "+t.level)),n=this.loaders[t.type]=t.loader="undefined"!=typeof i.pLoader?new i.pLoader(i):new i.loader(i),t.url=e,t.responseType="";var u=void 0,c=void 0;u={timeout:o,maxRetry:a,retryDelay:s,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},n.load(t,u,c)}},{key:"resolve",value:function(e,t){return u["default"].buildAbsoluteURL(t,e)}},{key:"parseMasterPlaylist",value:function(e,t){for(var n=[],r=void 0,i=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g;null!=(r=i.exec(e));){var a={},o=a.attrs=new m["default"](r[1]);a.url=this.resolve(r[2],t);var s=o.decimalResolution("RESOLUTION");s&&(a.width=s.width,a.height=s.height),a.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),a.name=o.NAME;var l=o.CODECS;if(l){l=l.split(/[ ,]+/);for(var u=0;u<l.length;u++){var c=l[u];c.indexOf("avc1")!==-1?a.videoCodec=this.avc1toavcoti(c):a.audioCodec=c}}n.push(a)}return n}},{key:"parseMasterPlaylistMedia",value:function(e,t,n){for(var r=void 0,i=[],a=/#EXT-X-MEDIA:(.*)/g;null!=(r=a.exec(e));){var o={},s=new m["default"](r[1]);s.TYPE===n&&(o.groupId=s["GROUP-ID"],o.name=s.NAME,o.type=n,o["default"]="YES"===s.DEFAULT,o.autoselect="YES"===s.AUTOSELECT,o.forced="YES"===s.FORCED,s.URI&&(o.url=this.resolve(s.URI,t)),o.lang=s.LANGUAGE,o.name||(o.name=o.lang),i.push(o))}return i}},{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),n=12;n<16;n++)t[n]=e>>8*(15-n)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var n=e;return e&&e.method&&e.uri&&!e.iv&&(n=this.cloneObj(e),n.iv=this.createInitializationVector(t)),n}},{key:"avc1toavcoti",value:function(e){var t,n=e.split(".");return n.length>2?(t=n.shift()+".",t+=parseInt(n.shift()).toString(16),t+=("000"+parseInt(n.shift()).toString(16)).substr(-4)):t=e,t}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"parseLevelPlaylist",value:function(e,t,n,r){var i,a,o,s=0,l=0,u={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},c={method:null,key:null,iv:null,uri:null},d=0,f=null,p=null,h=null,g=null,y=null,_=null,E=[];for(o=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT(INF): *(\d+(?:\.\d+)?)(?:,(.*))?)|(?:(?!#)()(\S.+))|(?:#EXT-X-(BYTERANGE): *(\d+(?:@\d+(?:\.\d+)?)?)|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(PROGRAM-DATE-TIME):(.+))|(?:#EXT-X-(VERSION):(\d+))|(?:(#)(.*):(.*))|(?:(#)(.*)))(?:.*)\r?\n?/g;null!==(a=o.exec(e));)switch(a.shift(),a=a.filter(function(e){return void 0!==e}),a[0]){case"PLAYLIST-TYPE":u.type=a[1].toUpperCase();break;case"MEDIA-SEQUENCE":s=u.startSN=parseInt(a[1]);break;case"TARGETDURATION":u.targetduration=parseFloat(a[1]);break;case"VERSION":u.version=parseInt(a[1]);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":d++,E.push(a);break;case"DISCONTINUITY-SEQ":d=parseInt(a[1]);break;case"BYTERANGE":var b=a[1].split("@");_=1===b.length?y:parseInt(b[1]),y=parseInt(b[0])+_;break;case"INF":h=parseFloat(a[1]),g=a[2]?a[2]:null,E.push(a);break;case"":if(!isNaN(h)){var T=s++;i=this.fragmentDecryptdataFromLevelkey(c,T);var w=a[1]?this.resolve(a[1],t):null;p={url:w,type:r,duration:h,title:g,start:l,sn:T,level:n,cc:d,decryptdata:i,programDateTime:f,tagList:E},null!==_&&(p.byteRangeStartOffset=_,p.byteRangeEndOffset=y),u.fragments.push(p),l+=h,h=null,g=null,_=null,f=null,E=[]}break;case"KEY":var A=a[1],R=new m["default"](A),S=R.enumeratedString("METHOD"),k=R.URI,O=R.hexadecimalInteger("IV");S&&(c={method:null,key:null,iv:null,uri:null},k&&"AES-128"===S&&(c.method=S,c.uri=this.resolve(k,t),c.key=null,c.iv=O));break;case"START":var L=a[1],C=new m["default"](L),D=C.decimalFloatingPoint("TIME-OFFSET");isNaN(D)||(u.startTimeOffset=D);break;case"PROGRAM-DATE-TIME":f=new Date(Date.parse(a[1])),E.push(a);break;case"#":a.shift(),E.push(a);break;default:v.logger.warn("line parsed but not handled: "+a)}return p&&!p.url&&(u.fragments.pop(),l-=p.duration),u.totalduration=l,u.averagetargetduration=l/u.fragments.length,u.endSN=s-1,u}},{key:"loadsuccess",value:function(e,t,n){var r=e.data,i=e.url,a=n.type,o=n.id,s=n.level,l=this.hls;if(this.loaders[a]=void 0,void 0!==i&&0!==i.indexOf("data:")||(i=n.url),t.tload=performance.now(),0===r.indexOf("#EXTM3U"))if(r.indexOf("#EXTINF:")>0){var u="audioTrack"!==a,c=this.parseLevelPlaylist(r,i,(u?s:o)||0,u?"main":"audio");"manifest"===a&&l.trigger(d["default"].MANIFEST_LOADED,{levels:[{url:i,details:c}],audioTracks:[],url:i,stats:t}),t.tparsed=performance.now(),c.targetduration?u?l.trigger(d["default"].LEVEL_LOADED,{details:c,level:s||0,id:o||0,stats:t}):l.trigger(d["default"].AUDIO_TRACK_LOADED,{details:c,id:o,stats:t}):l.trigger(d["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"invalid targetduration"})}else{var f=this.parseMasterPlaylist(r,i);if(f.length){var p=this.parseMasterPlaylistMedia(r,i,"AUDIO");if(p.length){var g=!1;p.forEach(function(e){e.url||(g=!0)}),g===!1&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(v.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main"}))}l.trigger(d["default"].MANIFEST_LOADED,{levels:f,audioTracks:p,url:i,stats:t})}else l.trigger(d["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no level found in manifest"})}else l.trigger(d["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:h.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no EXTM3U delimiter"})}},{key:"loaderror",value:function(e,t){var n,r,i=t.loader;switch(t.type){case"manifest":n=h.ErrorDetails.MANIFEST_LOAD_ERROR,r=!0;break;case"level":n=h.ErrorDetails.LEVEL_LOAD_ERROR,r=!1;break;case"audioTrack":n=h.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,r=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(d["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:n,fatal:r,url:i.url,loader:i,response:e,context:t})}},{key:"loadtimeout",value:function(e,t){var n,r,i=t.loader;switch(t.type){case"manifest":n=h.ErrorDetails.MANIFEST_LOAD_TIMEOUT,r=!0;break;case"level":n=h.ErrorDetails.LEVEL_LOAD_TIMEOUT,r=!1;break;case"audioTrack":n=h.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,r=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(d["default"].ERROR,{type:h.ErrorTypes.NETWORK_ERROR,details:n,fatal:r,url:i.url,loader:i,context:t})}}]),t}(p["default"]);n["default"]=y},{2:2,26:26,27:27,28:28,40:40,45:45}],37:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"init",value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:n,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){for(var t,n=Array.prototype.slice.call(arguments,1),r=8,i=n.length,a=i;i--;)r+=n[i].byteLength;for(t=new Uint8Array(r),t[0]=r>>24&255,t[1]=r>>16&255,t[2]=r>>8&255,t[3]=255&r,t.set(e,4),i=0,r=8;i<a;i++)t.set(n[i],r),r+=n[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,n){return n*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,n,r){return e.box(e.types.moof,e.mfhd(t),e.traf(r,n))}},{key:"moov",value:function(t){for(var n=t.length,r=[];n--;)r[n]=e.trak(t[n]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var n=t.length,r=[];n--;)r[n]=e.trex(t[n]);return e.box.apply(null,[e.types.mvex].concat(r))}},{key:"mvhd",value:function(t,n){n*=t;var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,r)}},{key:"sdtp",value:function(t){var n,r,i=t.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,a)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var n,r,i,a=[],o=[];for(n=0;n<t.sps.length;n++)r=t.sps[n],i=r.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));for(n=0;n<t.pps.length;n++)r=t.pps[n],i=r.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(r));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),l=t.width,u=t.height;return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var n=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,255&n,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"stsd",value:function(t){return"audio"===t.type?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var n=t.id,r=t.duration*t.timescale,i=t.width,a=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>24&255,n>>16&255,n>>8&255,255&n,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(t,n){var r=e.sdtp(t),i=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),e.trun(t,r.length+16+16+8+16+8+8),r);
}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var n=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,n){var r,i,a,o,s,l,u=t.samples||[],c=u.length,d=12+16*c,f=new Uint8Array(d);for(n+=8+d,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0),r=0;r<c;r++)i=u[r],a=i.duration,o=i.size,s=i.flags,l=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*r);return e.box(e.types.trun,f)}},{key:"initSegment",value:function(t){e.types||e.init();var n,r=e.moov(t);return n=new Uint8Array(e.FTYP.byteLength+r.byteLength),n.set(e.FTYP),n.set(r,e.FTYP.byteLength),n}}]),e}();n["default"]=a},{}],38:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(29),s=r(o),l=e(28),u=r(l),c=e(45),d=e(37),f=r(d),p=e(26);e(46);var h=function(){function e(t,n,r){i(this,e),this.observer=t,this.id=n,this.config=r,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}return a(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,n,r,i,a,o,s,l){if(this.level=e,this.sn=t,this.ISGenerated||this.generateIS(n,r,o),this.ISGenerated)if(n.samples.length){var c=this.remuxAudio(n,o,s,l);if(r.samples.length){var d=void 0;c&&(d=c.endPTS-c.startPTS),this.remuxVideo(r,o,s,d)}}else{var f=void 0;r.samples.length&&(f=this.remuxVideo(r,o,s)),f&&n.codec&&this.remuxEmptyAudio(n,o,s,f)}i.samples.length&&this.remuxID3(i,o),a.samples.length&&this.remuxText(a,o),this.observer.trigger(u["default"].FRAG_PARSED,{id:this.id,level:this.level,sn:this.sn})}},{key:"generateIS",value:function(e,t,n){var r,i,a=this.observer,o=e.samples,s=t.samples,l=this.PES_TIMESCALE,d={},h={id:this.id,level:this.level,sn:this.sn,tracks:d,unique:!1},g=void 0===this._initPTS;g&&(r=i=1/0),e.config&&o.length&&(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)&&!function(){var t=function n(e,t){return t?n(t,e%t):e};e.timescale=e.audiosamplerate/t(e.audiosamplerate,1024)}(),c.logger.log("audio mp4 timescale :"+e.timescale),d.audio={container:"audio/mp4",codec:e.codec,initSegment:f["default"].initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(r=i=o[0].pts-l*n)),t.sps&&t.pps&&s.length&&(t.timescale=this.MP4_TIMESCALE,d.video={container:"video/mp4",codec:t.codec,initSegment:f["default"].initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(r=Math.min(r,s[0].pts-l*n),i=Math.min(i,s[0].dts-l*n))),Object.keys(d).length?(a.trigger(u["default"].FRAG_PARSING_INIT_SEGMENT,h),this.ISGenerated=!0,g&&(this._initPTS=r,this._initDTS=i)):a.trigger(u["default"].ERROR,{type:p.ErrorTypes.MEDIA_ERROR,id:this.id,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,n,r){var i,a,o,s,l,d,p,h,g=8,m=this.PES_TIMESCALE,v=this.PES2MP4SCALEFACTOR,y=e.samples,_=[],E=y.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(E<0){c.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(E/90)+" ms to overcome this issue");for(var b=0;b<y.length;b++)y[b].dts+=E}var T=void 0;T=n?this.nextAvcDts:t*m;var w=y[0];l=Math.max(this._PTSNormalize(w.dts-this._initDTS,T),0),s=Math.max(this._PTSNormalize(w.pts-this._initDTS,T),0);var A=Math.round((l-T)/90);n&&A&&(A>1?c.logger.log("AVC:"+A+" ms hole between fragments detected,filling it"):A<-1&&c.logger.log("AVC:"+-A+" ms overlapping between fragments detected"),l=T,y[0].dts=l+this._initDTS,s=Math.max(s-A,T),y[0].pts=s+this._initDTS,c.logger.log("Video/PTS/DTS adjusted: "+Math.round(s/90)+"/"+Math.round(l/90)+",delta:"+A+" ms")),d=l,w=y[y.length-1],h=Math.max(this._PTSNormalize(w.dts-this._initDTS,T),0),p=Math.max(this._PTSNormalize(w.pts-this._initDTS,T),0),p=Math.max(p,h);var R=navigator.vendor,S=navigator.userAgent,k=R&&R.indexOf("Apple")>-1&&S&&!S.match("CriOS");k&&(i=Math.round((h-l)/(v*(y.length-1))));for(var O=0;O<y.length;O++){var L=y[O];k?L.dts=l+O*v*i:(L.dts=Math.max(this._PTSNormalize(L.dts-this._initDTS,T),l),L.dts=Math.round(L.dts/v)*v),L.pts=Math.max(this._PTSNormalize(L.pts-this._initDTS,T),L.dts),L.pts=Math.round(L.pts/v)*v}a=new Uint8Array(e.len+4*e.nbNalu+8);var C=new DataView(a.buffer);C.setUint32(0,a.byteLength),a.set(f["default"].types.mdat,4);for(var D=0;D<y.length;D++){for(var P=y[D],I=0,N=void 0;P.units.units.length;){var M=P.units.units.shift();C.setUint32(g,M.data.byteLength),g+=4,a.set(M.data,g),g+=M.data.byteLength,I+=4+M.data.byteLength}if(k)N=Math.max(0,i*Math.round((P.pts-P.dts)/(v*i)));else{if(D<y.length-1)i=y[D+1].dts-P.dts;else{var x=this.config,F=P.dts-y[D>0?D-1:D].dts;if(x.stretchShortVideoTrack){var U=x.maxBufferHole,B=x.maxSeekHole,j=Math.floor(Math.min(U,B)*m),G=(r?s+r*m:this.nextAacPts)-P.pts;G>j?(i=G-F,i<0&&(i=F),c.logger.log("It is approximately "+G/90+" ms to the next segment; using duration "+i/90+" ms for the last video frame.")):i=F}else i=F}i/=v,N=Math.round((P.pts-P.dts)/v)}_.push({size:I,duration:i,cts:N,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:P.key?2:1,isNonSync:P.key?0:1}})}this.nextAvcDts=h+i*v;var V=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,_.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var H=_[0].flags;H.dependsOn=2,H.isNonSync=0}e.samples=_,o=f["default"].moof(e.sequenceNumber++,l/v,e),e.samples=[];var W={id:this.id,level:this.level,sn:this.sn,data1:o,data2:a,startPTS:s/m,endPTS:(p+v*i)/m,startDTS:l/m,endDTS:this.nextAvcDts/m,type:"video",nb:_.length,dropped:V};return this.observer.trigger(u["default"].FRAG_PARSING_DATA,W),W}},{key:"remuxAudio",value:function(e,t,n,r){var i,a,o,l,d,p,h,g,m,v,y,_,E,b,T,w,A=this.PES_TIMESCALE,R=e.timescale,S=A/R,k=1024*e.timescale/e.audiosamplerate,O=k*S,L=8,C=[],D=[];if(e.samples.sort(function(e,t){return e.pts-t.pts}),D=e.samples,w=this.nextAacPts,n|=D.length&&w&&(Math.abs(t-w/A)<.1||Math.abs(D[0].pts-w-this._initDTS)<20*O),n||(w=t*A),r)for(var P=0,I=w;P<D.length;){var N=D[P],M=this._PTSNormalize(N.pts-this._initDTS,w),x=M-I;if(x<=-O)c.logger.warn("Dropping 1 audio frame @ "+Math.round(I/90)/1e3+"s due to "+Math.round(Math.abs(x/90))+" ms overlap."),D.splice(P,1),e.len-=N.unit.length;else if(x>=O){var F=Math.round(x/O);c.logger.warn("Injecting "+F+" audio frame @ "+Math.round(I/90)/1e3+"s due to "+Math.round(x/90)+" ms gap.");for(var U=0;U<F;U++)T=I+this._initDTS,T=Math.max(T,this._initDTS),b=s["default"].getSilentFrame(e.channelCount),b||(c.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),b=N.unit.slice(0)),D.splice(P,0,{unit:b,pts:T,dts:T}),e.len+=b.length,I+=O,P+=1;N.pts=N.dts=I+this._initDTS,I+=O,P+=1}else Math.abs(x)>.1*O,I+=O,0===P?N.pts=N.dts=this._initDTS+w:N.pts=N.dts=D[P-1].pts+O,P+=1}for(;D.length;){if(a=D.shift(),l=a.unit,v=a.pts-this._initDTS,y=a.dts-this._initDTS,void 0!==m)_=this._PTSNormalize(v,m),E=this._PTSNormalize(y,m),o.duration=Math.round((E-m)/S);else{_=this._PTSNormalize(v,w),E=this._PTSNormalize(y,w);var B=Math.round(1e3*(_-w)/A),j=0;if(n&&B){if(B>0)j=Math.round((_-w)/O),c.logger.log(B+" ms hole between AAC samples detected,filling it"),j>0&&(b=s["default"].getSilentFrame(e.channelCount),b||(b=l.slice(0)),e.len+=j*b.length);else if(B<-12){c.logger.log(-B+" ms overlapping between AAC samples detected, drop frame"),e.len-=l.byteLength;continue}_=E=w}if(h=Math.max(0,_),g=Math.max(0,E),!(e.len>0))return;d=new Uint8Array(e.len+8),i=new DataView(d.buffer),i.setUint32(0,d.byteLength),d.set(f["default"].types.mdat,4);for(var G=0;G<j;G++)T=_-(j-G)*O,b=s["default"].getSilentFrame(e.channelCount),b||(c.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),b=l.slice(0)),d.set(b,L),L+=b.byteLength,o={size:b.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},C.push(o)}d.set(l,L),L+=l.byteLength,o={size:l.byteLength,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},C.push(o),m=E}var V=0,H=C.length;if(H>=2&&(V=C[H-2].duration,o.duration=V),H){this.nextAacPts=_+S*V,e.len=0,e.samples=C,p=f["default"].moof(e.sequenceNumber++,g/S,e),e.samples=[];var W={id:this.id,level:this.level,sn:this.sn,data1:p,data2:d,startPTS:h/A,endPTS:this.nextAacPts/A,startDTS:g/A,endDTS:(E+S*V)/A,type:"audio",nb:H};return this.observer.trigger(u["default"].FRAG_PARSING_DATA,W),W}return null}},{key:"remuxEmptyAudio",value:function(e,t,n,r){var i=this.PES_TIMESCALE,a=e.timescale?e.timescale:e.audiosamplerate,o=i/a,l=this.nextAacPts,u=(void 0!==l?l:r.startDTS*i)+this._initDTS,d=r.endDTS*i+this._initDTS,f=1024,p=o*f,h=Math.ceil((d-u)/p),g=s["default"].getSilentFrame(e.channelCount);if(c.logger.warn("remux empty Audio"),!g)return void c.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var m=[],v=0;v<h;v++){var y=u+v*p;m.push({unit:g.slice(0),pts:y,dts:y}),e.len+=g.length}e.samples=m,this.remuxAudio(e,t,n)}},{key:"remuxID3",value:function(e,t){var n,r=e.samples.length;if(r){for(var i=0;i<r;i++)n=e.samples[i],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE,n.dts=(n.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(u["default"].FRAG_PARSING_METADATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var n,r=e.samples.length;if(r){for(var i=0;i<r;i++)n=e.samples[i],n.pts=(n.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(u["default"].FRAG_PARSING_USERDATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var n;if(void 0===t)return e;for(n=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=n;return e}},{key:"passthrough",get:function(){return!1}}]),e}();n["default"]=h},{26:26,28:28,29:29,37:37,45:45,46:46}],39:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e(28),s=r(o),l=function(){function e(t,n){i(this,e),this.observer=t,this.id=n,this.ISGenerated=!1}return a(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,n,r,i,a){var o=this.observer;if(!this.ISGenerated){var l={},u={id:this.id,tracks:l,unique:!0},c=t,d=c.codec;d&&(u.tracks.video={container:c.container,codec:d,metadata:{width:c.width,height:c.height}}),c=e,d=c.codec,d&&(u.tracks.audio={container:c.container,codec:d,metadata:{channelCount:c.channelCount}}),this.ISGenerated=!0,o.trigger(s["default"].FRAG_PARSING_INIT_SEGMENT,u)}o.trigger(s["default"].FRAG_PARSING_DATA,{id:this.id,data1:a,startPTS:i,startDTS:i,type:"audiovideo",nb:1,dropped:0})}},{key:"passthrough",get:function(){return!0}}]),e}();n["default"]=l},{28:28}],40:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var n in t)t.hasOwnProperty(n)&&(this[n]=t[n])}return i(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=/^(\d+)x(\d+)$/.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){for(var t,n=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,r={};null!==(t=n.exec(e));){var i=t[2],a='"';0===i.indexOf(a)&&i.lastIndexOf(a)===i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r}}]),e}();n["default"]=a},{}],41:[function(e,t,n){"use strict";var r={search:function(e,t){for(var n=0,r=e.length-1,i=null,a=null;n<=r;){i=(n+r)/2|0,a=e[i];var o=t(a);if(o>0)n=i+1;else{if(!(o<0))return a;r=i-1}}return null}};t.exports=r},{}],42:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(e){var t=e;return a.hasOwnProperty(e)&&(t=a[e]),String.fromCharCode(t)},s=15,l=32,u={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},c={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},p=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},g=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},m=function(){function e(t,n,i,a,o){r(this,e),this.foreground=t||"white",this.underline=n||!1,this.italics=i||!1,this.background=a||"black",this.flash=o||!1}return i(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),v=function(){function e(t,n,i,a,o,s){r(this,e),this.uchar=t||" ",this.penState=new m(n,i,a,o,s)}return i(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),y=function(){function e(){r(this,e),this.chars=[];for(var t=0;t<l;t++)this.chars.push(new v);this.pos=0,this.currPenState=new m}return i(e,[{key:"equals",value:function(e){for(var t=!0,n=0;n<l;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<l;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<l;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(h.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>l&&(h.log("ERROR","Too large cursor position "+this.pos),this.pos=l)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){e>=144&&this.backSpace();var t=o(e);return this.pos>=l?void h.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),void this.moveCursor(1))}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<l;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,n=0;n<l;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e);var t=this.chars[this.pos];t.setPenState(this.currPenState)}}]),e}(),_=function(){function e(){r(this,e),this.rows=[];for(var t=0;t<s;t++)this.rows.push(new y);this.currRow=s-1,this.nrRollUpRows=null,this.reset()}return i(e,[{key:"reset",value:function(){for(var e=0;e<s;e++)this.rows[e].clear();this.currRow=s-1}},{key:"equals",value:function(e){for(var t=!0,n=0;n<s;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<s;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<s;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){var e=this.rows[this.currRow];e.backSpace()}},{key:"clearToEndOfRow",value:function(){var e=this.rows[this.currRow];e.clearToEndOfRow()}},{key:"insertChar",value:function(e){var t=this.rows[this.currRow];t.insertChar(e)}},{key:"setPen",value:function(e){var t=this.rows[this.currRow];t.setPenStyles(e)}},{key:"moveCursor",value:function(e){var t=this.rows[this.currRow];t.moveCursor(e)}},{key:"setCursor",value:function(e){h.log("INFO","setCursor: "+e);var t=this.rows[this.currRow];t.setCursor(e)}},{key:"setPAC",value:function(e,t){h.log("INFO","pacData = "+JSON.stringify(e));var n=e.row-1;if(this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==n){for(var r=0;r<s;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,a=t.rows[i].cueStartTime;if(a&&a<h.time)for(r=0;r<this.nrRollUpRows;r++)this.rows[n-this.nrRollUpRows+r+1].copy(t.rows[i+r])}this.currRow=n;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[u].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)}},{key:"setBkgData",value:function(e){h.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){if(null===this.nrRollUpRows)return void h.log("DEBUG","roll_up but nrRollUpRows not set yet");h.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),h.log("INFO","Rolling up")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<s;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),E=function(){function e(t,n){r(this,e),this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new _,this.nonDisplayedMemory=new _,this.lastOutputScreen=new _,this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return i(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e,this.lastOutputScreen)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,h.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset(),this.lastOutputScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";h.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(h.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){h.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){h.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){h.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){h.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){h.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){h.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){h.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){h.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){h.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){h.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){h.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(h.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,h.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(e){h.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}h.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=h.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),b=function(){function e(t,n,i){r(this,e),this.field=t||1,this.outputs=[n,i],this.channels=[new E(1,n),new E(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,"char":0,cmd:0,other:0}}return i(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var n,r,i,a=!1;this.lastTime=e,h.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],0!==r||0!==i){if(h.log("DATA","["+g([t[o],t[o+1]])+"] -> ("+g([r,i])+")"),n=this.parseCmd(r,i),n||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n&&(a=this.parseChars(r,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else h.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters["char"]+=2:(this.dataCounters.other+=2,h.log("WARNING","Couldn't parse cleaned data "+g([r,i])+" orig: "+g([t[o],t[o+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(e,t){var n=null,r=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!r&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,h.log("DEBUG","Repeated command ("+g([e,t])+") is dropped"),!0;n=20===e||23===e?1:2;var a=this.channels[n-1];return 20===e||28===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0}},{key:"parseMidrow",value:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if(n=17===e?1:2,n!==this.currChNr)return h.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.ccMIDROW(t),h.log("DEBUG","MIDROW ("+g([e,t])+")"),!0}return!1}},{key:"parsePAC",value:function(e,t){var n=null,r=null,i=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,a=(16===e||24===e)&&64<=t&&t<=95;if(!i&&!a)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;n=e<=23?1:2,r=64<=t&&t<=95?1===n?u[e]:d[e]:1===n?c[e]:f[e];var o=this.interpretPAC(r,t),s=this.channels[n-1];return s.setPAC(o),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0}},{key:"interpretPAC",value:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1===(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r}},{key:"parseChars",value:function(e,t){var n=null,r=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),17<=i&&i<=19){var a=t;a=17===i?t+80:18===i?t+112:t+144,h.log("INFO","Special char '"+o(a)+"' in channel "+n),r=[a]}else 32<=e&&e<=127&&(r=0===t?[e]:[e,t]);if(r){var s=g(r);h.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return r}},{key:"parseBackgroundAttributes",value:function(e,t){var n,r,i,a,o=(16===e||24===e)&&32<=t&&t<=47,s=(23===e||31===e)&&45<=t&&t<=47;return!(!o&&!s)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=p[r],t%2===1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,a=this.channels[i-1],a.setBkgData(n),this.lastCmdA=null,this.lastCmdB=null,!0)}},{key:"reset",value:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}}]),e}();n["default"]=b},{}],43:[function(e,t,n){"use strict";var r={newCue:function(e,t,n,r){for(var i,a,o,s,l,u=window.VTTCue||window.TextTrackCue,c=0;c<r.rows.length;c++)if(i=r.rows[c],o=!0,s=0,l="",!i.isEmpty()){for(var d=0;d<i.chars.length;d++)i.chars[d].uchar.match(/\s/)&&o?s++:(l+=i.chars[d].uchar,o=!1);i.cueStartTime=t,a=new u(t,n,l.trim()),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?a.line=c+1:a.line=c>7?c-2:c+1,a.align="left",a.position=Math.max(0,Math.min(100,100*(s/32)+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(a)}}};t.exports=r},{}],44:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return i(e,[{key:"sample",value:function(e,t){var n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();n["default"]=a},{}],45:[function(e,t,n){"use strict";function r(){}function i(e,t){return t="["+e+"] > "+t}function a(e){var t=self.console[e];return t?function(){for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];r[0]&&(r[0]=i(e,r[0])),t.apply(self.console,r)}:r}function o(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach(function(t){
u[t]=e[t]?e[t].bind(e):a(t)})}Object.defineProperty(n,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l={trace:r,debug:r,log:r,warn:r,info:r,error:r},u=l;n.enableLogs=function(e){if(e===!0||"object"===("undefined"==typeof e?"undefined":s(e))){o(e,"debug","log","info","warn","error");try{u.log()}catch(t){u=l}}else u=l},n.logger=u},{}],46:[function(e,t,n){"use strict";"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){var n=new Uint8Array(this);void 0===t&&(t=n.length);for(var r=new ArrayBuffer(t-e),i=new Uint8Array(r),a=0;a<i.length;a++)i[a]=n[a+e];return r})},{}],47:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"toString",value:function(e){for(var t="",n=e.length,r=0;r<n;r++)t+="["+e.start(r).toFixed(3)+","+e.end(r).toFixed(3)+"]";return t}}]),e}();n["default"]=a},{}],48:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e(45),o=function(){function e(t){r(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return i(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",t.url,!0),t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.responseType=t.responseType;var n=this.stats;n.tfirst=0,n.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,n=t.readyState,r=this.stats,i=this.context,o=this.config;if(!r.aborted&&(window.clearTimeout(this.requestTimeout),n>=2&&(0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout-(r.tfirst-r.trequest))),4===n))){var s=t.status;if(s>=200&&s<300){r.tload=Math.max(r.tfirst,performance.now());var l=void 0,u=void 0;"arraybuffer"===i.responseType?(l=t.response,u=l.byteLength):(l=t.responseText,u=l.length),r.loaded=r.total=u;var c={url:t.responseURL,data:l};this.callbacks.onSuccess(c,r,i)}else r.retry>=o.maxRetry||s>=400&&s<499?(a.logger.error(s+" while loading "+i.url),this.callbacks.onError({code:s,text:t.statusText},i)):(a.logger.warn(s+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),r.retry++)}}},{key:"loadtimeout",value:function(){a.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context)}},{key:"loadprogress",value:function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var n=this.callbacks.onProgress;n&&n(t,this.context,null)}}]),e}();n["default"]=o},{45:45}]},{},[33])(33)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(e,t,n){n.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?i-1:0,f=n?-1:1,p=e[t+d];for(d+=f,a=p&(1<<-c)-1,p>>=-c,c+=s;c>0;a=256*a+e[t+d],d+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+d],d+=f,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:(p?-1:1)*(1/0);o+=Math.pow(2,r),a-=u}return(p?-1:1)*o*Math.pow(2,a-r)},n.write=function(e,t,n,r,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,d=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,h=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),t+=o+d>=1?f/l:f*Math.pow(2,1-d),t*l>=2&&(o++,l/=2),o+d>=c?(s=0,o=c):o+d>=1?(s=(t*l-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[n+p]=255&o,p+=h,o/=256,u-=8);e[n+p-h]|=128*g}},{}],18:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],19:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},{}],20:[function(e,t,n){!function(){var n=e("crypt"),r=e("charenc").utf8,i=e("is-buffer"),a=e("charenc").bin,o=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?a.stringToBytes(e):r.stringToBytes(e):i(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var s=n.bytesToWords(e),l=8*e.length,u=1732584193,c=-271733879,d=-1732584194,f=271733878,p=0;p<s.length;p++)s[p]=16711935&(s[p]<<8|s[p]>>>24)|4278255360&(s[p]<<24|s[p]>>>8);s[l>>>5]|=128<<l%32,s[(l+64>>>9<<4)+14]=l;for(var h=o._ff,g=o._gg,m=o._hh,v=o._ii,p=0;p<s.length;p+=16){var y=u,_=c,E=d,b=f;u=h(u,c,d,f,s[p+0],7,-680876936),f=h(f,u,c,d,s[p+1],12,-389564586),d=h(d,f,u,c,s[p+2],17,606105819),c=h(c,d,f,u,s[p+3],22,-1044525330),u=h(u,c,d,f,s[p+4],7,-176418897),f=h(f,u,c,d,s[p+5],12,1200080426),d=h(d,f,u,c,s[p+6],17,-1473231341),c=h(c,d,f,u,s[p+7],22,-45705983),u=h(u,c,d,f,s[p+8],7,1770035416),f=h(f,u,c,d,s[p+9],12,-1958414417),d=h(d,f,u,c,s[p+10],17,-42063),c=h(c,d,f,u,s[p+11],22,-1990404162),u=h(u,c,d,f,s[p+12],7,1804603682),f=h(f,u,c,d,s[p+13],12,-40341101),d=h(d,f,u,c,s[p+14],17,-1502002290),c=h(c,d,f,u,s[p+15],22,1236535329),u=g(u,c,d,f,s[p+1],5,-165796510),f=g(f,u,c,d,s[p+6],9,-1069501632),d=g(d,f,u,c,s[p+11],14,643717713),c=g(c,d,f,u,s[p+0],20,-373897302),u=g(u,c,d,f,s[p+5],5,-701558691),f=g(f,u,c,d,s[p+10],9,38016083),d=g(d,f,u,c,s[p+15],14,-660478335),c=g(c,d,f,u,s[p+4],20,-405537848),u=g(u,c,d,f,s[p+9],5,568446438),f=g(f,u,c,d,s[p+14],9,-1019803690),d=g(d,f,u,c,s[p+3],14,-187363961),c=g(c,d,f,u,s[p+8],20,1163531501),u=g(u,c,d,f,s[p+13],5,-1444681467),f=g(f,u,c,d,s[p+2],9,-51403784),d=g(d,f,u,c,s[p+7],14,1735328473),c=g(c,d,f,u,s[p+12],20,-1926607734),u=m(u,c,d,f,s[p+5],4,-378558),f=m(f,u,c,d,s[p+8],11,-2022574463),d=m(d,f,u,c,s[p+11],16,1839030562),c=m(c,d,f,u,s[p+14],23,-35309556),u=m(u,c,d,f,s[p+1],4,-1530992060),f=m(f,u,c,d,s[p+4],11,1272893353),d=m(d,f,u,c,s[p+7],16,-155497632),c=m(c,d,f,u,s[p+10],23,-1094730640),u=m(u,c,d,f,s[p+13],4,681279174),f=m(f,u,c,d,s[p+0],11,-358537222),d=m(d,f,u,c,s[p+3],16,-722521979),c=m(c,d,f,u,s[p+6],23,76029189),u=m(u,c,d,f,s[p+9],4,-640364487),f=m(f,u,c,d,s[p+12],11,-421815835),d=m(d,f,u,c,s[p+15],16,530742520),c=m(c,d,f,u,s[p+2],23,-995338651),u=v(u,c,d,f,s[p+0],6,-198630844),f=v(f,u,c,d,s[p+7],10,1126891415),d=v(d,f,u,c,s[p+14],15,-1416354905),c=v(c,d,f,u,s[p+5],21,-57434055),u=v(u,c,d,f,s[p+12],6,1700485571),f=v(f,u,c,d,s[p+3],10,-1894986606),d=v(d,f,u,c,s[p+10],15,-1051523),c=v(c,d,f,u,s[p+1],21,-2054922799),u=v(u,c,d,f,s[p+8],6,1873313359),f=v(f,u,c,d,s[p+15],10,-30611744),d=v(d,f,u,c,s[p+6],15,-1560198380),c=v(c,d,f,u,s[p+13],21,1309151649),u=v(u,c,d,f,s[p+4],6,-145523070),f=v(f,u,c,d,s[p+11],10,-1120210379),d=v(d,f,u,c,s[p+2],15,718787259),c=v(c,d,f,u,s[p+9],21,-343485551),u=u+y>>>0,c=c+_>>>0,d=d+E>>>0,f=f+b>>>0}return n.endian([u,c,d,f])};o._ff=function(e,t,n,r,i,a,o){var s=e+(t&n|~t&r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._gg=function(e,t,n,r,i,a,o){var s=e+(t&r|n&~r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._hh=function(e,t,n,r,i,a,o){var s=e+(t^n^r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._ii=function(e,t,n,r,i,a,o){var s=e+(n^(t|~r))+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._blocksize=16,o._digestsize=16,t.exports=function(e,t){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(o(e,t));return t&&t.asBytes?r:t&&t.asString?a.bytesToString(r):n.bytesToHex(r)}}()},{charenc:1,crypt:2,"is-buffer":19}],21:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPlayer=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";var r=t.exports=function(){var e={},t=[],n=[],r=new i,o=null,s=null,l={},u=["play","pause","togglePlayPause","seekTo","mute","unMute","setVolume","setQuality","setAudioTrack","setSubtitles"];e.on=e.addEventListener=r.on,e.off=e.removeEventListener=r.off,e.emit=e.dispatchEvent=r.emit,e.init=function(t,n,r,i){if(e.id=t,e.parentContainer=n,e.config=r,e.use(i),1==e.config.singleVideoInstance){var a=[];a.push(d("ad:vendor:video",document.getElementById("mggp-ad-container"))),a.push(d("player:video")),e.registerProperty("videoInstances",null,!0),e.set("videoInstances",a)}e.emit("player:ready")},e.use=function(r){r.forEach(function(r){r.hasOwnProperty("default")&&(r=r["default"]),r.hasOwnProperty("mimeTypes")?t.push(r):n.push(new r(e,e.config))})},u.forEach(function(t){e[t]=function(){o&&o[t]&&o[t].apply(o,arguments)}}),e.canPlay=function(t){return null!=e.getVendor(t)},e.load=function(t,r,i){e.utils.log("MggpPlayer.load():"),e.set("vendorOptions",i||{}),e.set("src",t||null),e.set("videoInfo",r||null),s||(e.utils.log("MggpPlayer.load:Create timer"),s=setInterval(c,e.config&&e.config.hasOwnProperty("timeInterval")?e.config.timeInterval:1e3/3)),n.forEach(function(e){"function"==typeof e.load&&e.load(t,r,i)});var l=e.get("preroll")||!1;if(1==l)return void e.emit("ads:load");var u,d,f;if(!t&&!r.src)return u=a.errorTypes.INTERNAL_ERROR,d=a.errorCodes[u].SRC_IS_NOT_FOUND,f=a.errorMessages[d],void new a(e,u,d,f,(!0));var p=e.utils.getExtension(t||r.src);if(!e.canPlay(p))return u=a.errorTypes.PLAYBACK_ERROR,d=a.errorCodes[u].MEDIA_FILE_IS_NOT_SUPPORTED,f=a.errorMessages[d],void new a(e,u,d,f,(!0));if(o&&o.constructor.mimeTypes.indexOf(p)==-1&&(o.stop(),o=null),!o){var h=e.getVendor(p);if(!h)return u=a.errorTypes.PLAYBACK_ERROR,d=a.errorCodes[u].MEDIA_FILE_IS_NOT_SUPPORTED,f=a.errorMessages[d],void new a(e,u,d,f,(!0));o=new h(e,e.config)}o.load(t,r,i)},e.showAnotherAd=function(t,n){s||(e.utils.log("MggpPlayer.showAnotherAd:Create timer"),s=setInterval(c,e.config&&e.config.hasOwnProperty("timeInterval")?e.config.timeInterval:1e3/3)),e.emit("ad:showAnotherAd",{url:t,type:n})},e.get=function(t){return l.hasOwnProperty(t)?l[t].value:(e.utils.log("MggpPlayer:get: Property "+t+" not found"),null)},e.set=function(t,n){l[t]||e.registerProperty(t),l[t]&&l[t].value!=n&&(l[t].value=n,e.emit("property:"+t,n))},e.registerProperty=function(t,n,r){return l.hasOwnProperty(t)?void e.utils.log("MggpPlayer:registerProperty: Property "+t+" already registered"):(l[t]={},l[t].resetable=r!==!0,void(l[t].value=l[t]["default"]=n))},e.reset=function(){for(var e in l)l[e].resetable&&(l[e].value=l[e]["default"])},e.stop=function(){e.emit("player:stop"),window.clearInterval(s),o&&(o.stop(),o=null),e.reset(),s=null},e.dispose=function(){e.stop(),n.forEach(function(e){e.dispose()}),r.dispose(),t=null,n=null,r=null,o=null,s=null,l=null},e.getVendor=function(n){if("mp4"==n&&o&&1==e.config.maxVendorInstances)return null;if(1==t.length)return t[0];for(var r=null,i=0;i<t.length;i++)t[i]&&t[i].mimeTypes.indexOf(n)>=0&&t[i].canPlay(n,e.config)&&(!r||t[i].priority<r.priority)&&(r=t[i]);return r},e.getPlayableElement=function(){var e=null;return o&&(e=o.getPlayableElement()),e},e.utils={},e.utils.getExtension=function(e){var t="",n=e.lastIndexOf("?");n!=-1&&(e=e.slice(0,n));var r=e.lastIndexOf(".");return r!=-1&&(t=e.slice(r+1)),t},e.utils.merge=function(e,t){e=Object.create(e);for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},e.utils.log=function(t){if(e.config&&e.config.hasOwnProperty("debug")&&e.config.debug===!0){var n=new Date;console.log(n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()+":"+n.getMilliseconds()+" -> ",t)}};var c=function(){e.emit("player:timeUpdate")},d=function(t,n){var r=document.createElement("video");return n?n.appendChild(r):e.parentContainer.appendChild(r),r.className=t,r.style.position="absolute",e.registerProperty(t,r,!0),r};return e.registerProperty("volume",60,!0),e.registerProperty("position",0),e.registerProperty("duration",0),e.registerProperty("state",-1),e.registerProperty("loadedFraction",0),e.registerProperty("muted",!1,!0),e.registerProperty("videoInfo",{},!0),e.registerProperty("src",null),e.registerProperty("vendorOptions",{}),e.registerProperty("advertisement",!1),e.registerProperty("quality",-1),e.registerProperty("qualityList",[],!0),e.registerProperty("audioTrack",0),e.registerProperty("audioTrackList",[],!0),e.registerProperty("subtitles","off"),e.registerProperty("subtitlesList",[],!0),e.on("property:state",function(t){if(0==t.data){var n=e.get("postroll")||!1;1==n?(o&&(o.stop(),o=null),e.emit("ad:playerEnded")):e.emit("player:completed")}}),e},i=function(){var e=this;e.listeners={};var t=!1,n=[],r=[],i=function(){};this.dispose=function(){e.listeners=null,n=null,r=null},this.on=function(t,n){if(e.listeners.hasOwnProperty(t)){if(e.listeners[t].indexOf(n)>=0)return}else e.listeners[t]=[];e.listeners[t].push(n)},this.off=function(r,a){if(e.listeners.hasOwnProperty(r)){var o,s;for(o=0,s=e.listeners[r].length;o<s;o+=1)e.listeners[r][o]===a&&(t?(e.listeners[r][o]=i,n.push(r)):(e.listeners[r].splice(o,1),0==e.listeners[r].length&&delete e.listeners[r]))}},this.emit=function(a,o){if(a&&"undefined"!=a){if(t)return void r.push({evt:a,data:o});t=!0;var s;if(e.listeners.hasOwnProperty(a))for(s=0;s<e.listeners[a].length;s++)e.listeners[a][s]({name:a,data:o});if(e.listeners.hasOwnProperty(a.slice(0,a.lastIndexOf(":"))+":*")){var l=a.slice(0,a.lastIndexOf(":"))+":*";for(s=0;s<e.listeners[l].length;s++)e.listeners[l][s]({name:a,data:o})}for(t=!1;n.length>0;){var u=n.shift();e.off(u,i)}if(r.length>0){var c=r.shift();e.emit(c.evt,c.data)}}},this.isExist=function(t,n){var r=!1;return r="function"==typeof n?e.listeners[t]&&e.listeners[t].indexOf!=-1:e.listeners[t]&&e.listeners.length>0}},a=r.AddonError=function(e,t,n,r,i){var a=new Date,o=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()+":"+a.getMilliseconds()+" -> "+t+"->"+n+"->"+r;i?console.error(o):console.warn(o),e&&e.emit("mediaError",{name:this.constructor.name,type:t,code:n,message:r||"Player Addon Error",fatal:i||!1})};a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.errorTypes={NETWORK_ERROR:"networkError",PLAYBACK_ERROR:"playbackError",INTERNAL_ERROR:"internalError",PARSING_ERROR:"parsingError"},a.errorCodes={networkError:{PLAYLIST_LOADING_ERROR:"playlistLoadingError",CHUNKLIST_LOADING_ERROR:"chunklistLoadingError",CHUNK_LOADING_ERROR:"chunkLoadingError",KEY_LOADING_ERROR:"keyLoadingError",MEDIA_FILE_LOADING_ERROR:"mediaFileLoadingError",FILE_LOADING_ERROR:"fileLoadingError"},playbackError:{MEDIA_FILE_IS_NOT_SUPPORTED:"mediaFileIsNotSupported",PARSING_ERROR:"parsingError",DECODING_ERROR:"decodingError",LEVEL_SWITCH_ERROR:"levelSwitchError"},internalError:{SRC_IS_NOT_FOUND:"srcIsNotFound",CANNOT_INJECT_PLAYABLE_ELEMENT:"cannotInjectPlayableElement",BUFFER_APPEND_ERROR:"bufferAppendError"},parsingError:{PARSING_ERROR:"parsingError"}},a.errorMessages={playlistLoadingError:"Cannot load playlist from url: ",chunklistLoadingError:"Cannot load chunklist from url: ",chunkLoadingError:"Cannot load chunk from url: ",mediaFileLoadingError:"Cannot load media file from url: ",fileLoadingError:"Cannot load file from url: ",mediaFileIsNotSupported:"Unable to play file. Format is not supported. Url: ",parsingError:"Error on playlist or chunklist parsing. Url: ",decodingError:"Error on video decoding. Url: ",levelSwitchError:"Error while trying to switch level",srcIsNotFound:"Src field is undefined or it is an empty string",cannotInjectPlayableElement:"Cannot inject playable element in DOM",bufferAppendError:"Cannot append data to source buffer",cannotParse:"Cannot parse data from url:"};var o=r.Plugin=function(e,t){this.config=t||{},this.player=e||{},this.container=this.player.parentContainer||document.body,this.namespace="plugin:"};o.prototype.dispose=function(){},o.prototype.emit=function(e,t){this.player.emit&&this.player.emit(this.namespace+e,t)},o.prototype.log=function(e){this.player.utils?this.player.utils.log(e):console.log(e)};var s=r.Vendor=function(e,t){this.DEFAULT_NAMESPACE="player:",this.config=t||{},this.player=e||{},this.container=this.player.parentContainer||document.body,this.namespace=this.DEFAULT_NAMESPACE,this.STREAM_ERROR="STREAM_ERROR"};s.prototype.canPlay=function(e){return!0},s.prototype.setQuality=function(e){this.emit("qualityNeedChange",e)},s.prototype.setAudioTrack=function(e){this.emit("audioTackNeedChange",e)},s.prototype.setSubtitles=function(e){this.emit("subtitlesNeedChange",e)},s.prototype.emit=function(e,t){this.player&&this.player.emit(this.namespace+e,t)},s.prototype.set=function(e,t){this.player&&this.player.set(this.namespace!=this.DEFAULT_NAMESPACE?this.namespace+e:e,t)},s.prototype.get=function(e){return this.player&&this.player.get?this.player.get(this.namespace!=this.DEFAULT_NAMESPACE?this.namespace+e:e):null},s.prototype.checkOptions=function(e){if(e.hasOwnProperty("container")&&(this.container=e.container),e.hasOwnProperty("namespace")&&(this.namespace=e.namespace,this.player&&this.namespace!=this.DEFAULT_NAMESPACE&&(this.player.registerProperty(this.namespace+"volume",60,!0),this.player.registerProperty(this.namespace+"position",0),this.player.registerProperty(this.namespace+"duration",0),this.player.registerProperty(this.namespace+"state",-1),this.player.registerProperty(this.namespace+"loadedFraction",0),this.player.registerProperty(this.namespace+"muted",!1,!0))),e.hasOwnProperty("defaultAudioTrack")){var t=parseInt(e.defaultAudioTrack);return isNaN(t)&&(t=String(e.defaultAudioTrack)),delete e.defaultAudioTrack,this.setAudioTrack(t),!1}if(e.hasOwnProperty("defaultQuality")){var n=parseInt(e.defaultQuality);if(delete e.defaultQuality,0!=n)return this.setQuality(n),!1}return e.hasOwnProperty("defaultSubtitles")&&(this.setSubtitles(e.defaultSubtitles),delete e.defaultSubtitles),!0},s.prototype.log=function(e){this.player&&this.player.utils?this.player.utils.log(e):console.log(e)},s.prototype.getPlayableElement=function(){return null}},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(e,t,n){function r(e,t){function n(){C=-1,P&&E(),F.set("postroll",!1),N?(N.playlist.dispose(),x=null):N=new a,F.set("ad:timeLabels",null)}w.apply(this,arguments),this.dispose=function(){N.dispose(),x=null,C=-1,g.off([T.BLOCK_STARTED,T.BLOCK_STARTING_NEW_ELEMENT,T.BLOCK_ENDED],p),g.off([T.AD_SKIN_VOLUME_CHANGED,T.AD_SKIN_MUTE_CHANGED,T.AD_SKIN_RESUME,T.AD_SKIN_PAUSE,T.AD_SKIN_CLICK_ON_BG,T.AD_SKIN_CLICK_ON_MESSAGE,T.AD_SKIN_SKIP_BUTTON,T.AD_SKIN_SKIP_MESSAGE],o),g.off([T.MODEL_READY,T.MODEL_PLAYLIST_IS_EMPTY,T.MODEL_PLAYLIST_LOADING_ERROR,T.MODEL_PLAYLIST_PARSING_ERROR],u),F.off(T.AD_SHOW_ANOTHER_AD,r),F.off(T.AD_PLAYER_ENDED,y),F.off(T.PLAYER_EVENT_PROPERTY_POSITION,i),F.off(T.PLAYER_EVENT_STATE_CHANGE,i),F.off(T.PLAYER_EVENT_STOP,i),window.removeEventListener("unload",S),F.set("ad:showing",!1),F.set("ad:timeLabels",null),F.set("postroll",!1),M=null,P&&E()},this.load=function(e,t,r){return!t||t.rebinfo||M&&(M.video_id===t.video_id||M.src===t.src)?void(d&&d.isLiveAd&&d.resetStartTimestamp()):(M=t,n(),M.advert_data||M.advert_url?(F.set("preroll",!0),void N.beginProcessAd(M.advert_data,M.advert_url)):void F.set("preroll",!1))},this.setAdlist=function(e){n(),F.set("preroll",!1),N.beginProcessAd(e)};var r=function(e){if(e.data){var t=e.data.url,n=e.data.type;P&&E(),N?N.playlist.dispose():N=new a,F.set("postroll",!1),x=n,N.beginProcessAd(null,t)}},i=function(e){var t,n,r;switch(e.name){case T.PLAYER_EVENT_STOP:P&&E(),N&&N.playlist.dispose(),F.set("postroll",!1),F.set("ad:showing",!1),F.set("ad:timeLabels",null),M=null;break;case T.PLAYER_EVENT_PROPERTY_POSITION:t=F.get("position"),n=F.get("duration");var i=F.get("state");r=i===T.PLAYER_STATE_PLAYING?T.STATE_PLAY:i===T.PLAYER_STATE_PAUSED?T.STATE_PAUSE:null,r&&s(r,t,n),P&&!P.linear&&n-t<=5&&E();break;case T.PLAYER_EVENT_STATE_CHANGE:N.playlist.currentBlock||e.data!=T.PLAYER_STATE_PLAYING&&e.data!=T.PLAYER_STATE_PAUSED||(t=F.get("position"),n=F.get("duration"),e.data==T.PLAYER_STATE_PLAYING&&C==T.PLAYER_STATE_PAUSED?r=T.STATE_RESUME:e.data==T.PLAYER_STATE_PAUSED&&C==T.PLAYER_STATE_PLAYING&&(r=T.STATE_PAUSE),r&&s(r,t,n),C=e.data)}},o=function(t){if(L)switch(t.name){case T.AD_SKIN_VOLUME_CHANGED:L.setVolume(t.data),F.set("volume",t.data),F.setVolume(t.data),t.data>0&&(F.set("muted",!1),F.unMute());break;case T.AD_SKIN_MUTE_CHANGED:t.data===!0?(L.mute(),F.set("volume",0),F.mute(),P&&P.track("mute")):t.data===!1&&(L.unMute(),F.set("volume",F.get("ad:vendor:volume")),F.unMute(),P&&P.track("unmute")),F.set("muted",t.data);break;case T.AD_SKIN_RESUME:1!==F.get("ad:vendor:state")&&(L.play(),P&&P.track("resume"));break;case T.AD_SKIN_PAUSE:2!==F.get("ad:vendor:state")&&(L.pause(),P&&P.track("pause"));break;case T.AD_SKIN_CLICK_ON_BG:2!==F.get("ad:vendor:state")&&L.pause(),P&&(P.track("click"),P.track("pause")),e.config&&"tv"===e.config.deviceType&&E();break;case T.AD_SKIN_CLICK_ON_MESSAGE:2!==F.get("ad:vendor:state")&&L.pause(),P&&(P.track("click2"),P.track("pause")),e.config&&"tv"===e.config.deviceType&&E();break;case T.AD_SKIN_SKIP_MESSAGE:P&&P.track("skip"),_();break;case T.AD_SKIN_SKIP_BUTTON:P&&P.track("skip2"),_()}},s=function(e,t,n){N.run(e,t,n)},l=function(){F.set("preroll",!1),F.load(F.get("src"),F.get("videoInfo"),F.get("vendorOptions"))},u=function(e){switch(e.name){case T.MODEL_READY:g.on([T.BLOCK_STARTED,T.BLOCK_STARTING_NEW_ELEMENT,T.BLOCK_ENDED],p);for(var t=N.playlist.getBlockByType(T.POSTROLL),n=0,r=t.length;n<r;++n)if(t[n]&&t[n].videoState==T.STATE_COMPLETE){F.set("postroll",!0);break}if(x){x==T.START_SCREEN&&N.playlist.run(T.STATE_PLAY,0,1,T.START_SCREEN);break}O(),F.get("position")<1&&(N.hasPreroll?s(T.STATE_PLAY,0,1):l());break;case T.MODEL_PLAYLIST_IS_EMPTY:case T.MODEL_PLAYLIST_LOADING_ERROR:case T.MODEL_PLAYLIST_PARSING_ERROR:l()}},p=function(e){switch(e.name){case T.BLOCK_STARTED:I=!1;break;case T.BLOCK_STARTING_NEW_ELEMENT:if(N&&N.playlist&&N.playlist.currentBlock&&N.playlist.currentBlock.currentMember){P=N.playlist.currentBlock.currentMember;var t=P.mediaFileExtension;if(P.element&&P.element.vastData&&P.element.vastData.mediaFile){var n=P.element.vastData.mediaFile;n.length>0&&(n=n[0],"VPAID"==n.apiFramework&&"js"!=t&&(t="vpaid"))}var r=F.getVendor(t);if(r){L=new r(F,{}),g.on([T.VENDOR_STATE_CHANGE,T.VENDOR_MEDIA_ERROR,T.VENDOR_ERROR,T.VENDOR_EVENT_PROPERTY_POSITION],m);var i=k(P);if(F.set("ad:showing",!0),F.set("ad:vendor:volume",F.get("muted")?0:F.get("volume")),F.set("ad:vendor:muted",!1),P.element&&P.element.vastDocument){var a=P.element.apiFramework&&"VPAID"===P.element.apiFramework.toUpperCase();a||P.element.vastDocument.sendReadyEvents()}L.load(P.mediaFileUrl,null,i),null!=D&&clearTimeout(D),g.emit(T.MEDIA_BEGINS_LOADING),D=setTimeout(b,15e3)}else{var o=P.mediaFileUrl;if(A){var s=A.errorTypes.PLAYBACK_ERROR,u=A.errorCodes[s].MEDIA_FILE_IS_NOT_SUPPORTED,c=A.errorMessages[u]+o;new A(g.getObserverInstance(),s,u,c)}g.emit(T.CANNOT_FIND_VENDOR),v.track(R.PLAYER_CANNOT_DISPLAY),_(!0,"cannot find vendor")}}break;case T.BLOCK_ENDED:e.data&&(e.data.type===T.PREROLL&&N&&N.playlist&&!N.playlist.disposed?l():e.data.type===T.START_SCREEN||(e.data.linear&&e.data.type!=T.PAUSE_ROLL&&e.data.videoState!=T.STATE_COMPLETE?F.play():e.data.videoState==T.STATE_COMPLETE&&F.emit("player:completed"))),F.set("ad:showing",!1)}},m=function(e){switch(e.name){case T.VENDOR_STATE_CHANGE:var t,n=F.get("ad:vendor:state");switch(n){case T.PLAYER_STATE_PLAYING:D&&(clearTimeout(D),D=null,P&&P.element&&P.element.vastDocument&&(t=P.element.apiFramework&&"VPAID"===P.element.apiFramework.toUpperCase(),t||P.element.vastDocument.sendStartEvent()),I||(g.emit(T.BLOCK_STARTED_DE_FACTO,P),I=!0),g.emit(T.MEMBER_STARTED_DE_FACTO,P),P&&P.linear&&F.pause());break;case T.PLAYER_STATE_ENDED:_();break;case T.PLAYER_STATE_BUFFERING:P&&P.element&&P.element.vastDocument&&(t=P.element.apiFramework&&"VPAID"===P.element.apiFramework.toUpperCase(),t||P.element.vastDocument.sendStartEvent())}break;case T.VENDOR_EVENT_PROPERTY_POSITION:if(P){t=P.element&&P.element.apiFramework&&"VPAID"===P.element.apiFramework.toUpperCase();var r=Math.round(F.get("ad:vendor:position")),i=Math.round(F.get("ad:vendor:duration"));t||P.track("onTime",[r,i])}break;case T.VENDOR_MEDIA_ERROR:case T.VENDOR_ERROR:D&&clearTimeout(D),v.track(R.COUDNT_DISPLAY_MEDIAFILE),g.emit(T.MEDIAFILE_VENDOR_ERROR),_(!0,"vendor error")}},y=function(e){N.playlist.run(T.STATE_COMPLETE,0,0,T.POSTROLL)},_=function(e,t){g.off([T.VENDOR_STATE_CHANGE,T.VENDOR_MEDIA_ERROR,T.VENDOR_ERROR,T.VENDOR_EVENT_PROPERTY_POSITION],m),j.removeCurrentContainer();var n="";try{e&&(n=L.__proto__.constructor.name)}catch(r){}L&&(L.stop(),L=null),e&&P&&(P.failed=!0,P.element&&P.element.vastDocument&&P.element.vastDocument.error()),N.currentMemberCompleted(),P=null},E=function(){g.off([T.VENDOR_STATE_CHANGE,T.VENDOR_MEDIA_ERROR,T.VENDOR_ERROR,T.VENDOR_EVENT_PROPERTY_POSITION],m),j.removeCurrentContainer(),L&&(L.stop(),L=null),N&&N.stopCurrentBlock(),P=null},b=function(){D=null,g.emit(T.MEDIAFILE_TIMEOUT,P),v.track(R.MEDIAFILE_URI_TIMEOUT),_(!0,"timeout")},S=function(e){g.emit(T.PAGE_CLOSING)},k=function(e){var t={namespace:"ad:vendor:",autoplay:!0},n=e.mediaFileExtension;return"ima"===n?(t.container=j.createIMAContainer(),t.vastDocument=P.element.vastDocument):(e.linear?t.container=j.parentContainer:t.container=j.createOverlayContainer(e),["jpg","jpeg","gif","png","html","htm"].indexOf(n)!=-1?t.duration=P.vastDataDuration||10:["swf","vpaid"].indexOf(n)!=-1?t.vastDocument=P.element.vastDocument:"js"==n&&(P.element.vastDocument.vastData.adparameters&&P.element.vastDocument.vastData.adparameters.length>0&&(t.adParameters=P.element.vastDocument.vastData.adparameters[0]),t.vastDocument=P.element.vastDocument,t.container=j.parentContainer)),t},O=function(){function e(){0==n&&(n=F.get("duration"));var e=[],r=N.playlist.blocks;if(r)for(var i=0,a=r.length;i<a;++i)r[i].type!==T.OVERLAY&&r[i].type!==T.MIDROLL&&r[i].type!==T.POSTROLL||e.push({type:r[i].type,time:t(r[i])});F.set("ad:timeLabels",e)}function t(e){var t=-1;return e&&(e.timeUnit===T.PERCENT?t=n*e.timeStart/100:e.timeUnit===T.SECONDS&&(t=e.timeStart)),t}var n=F.get("duration");0==n?F.on("property:duration",e):e()};T.DEVICE_TYPE=e.config.deviceType,T.PROTOCOL=e.config.protocol,T.APP_VERSION=e.config.appVersion;var L=null,C=-1,D=null,P=null,I=!1,N=null,M=null,x=null,F=e,U=[];"tv"!=T.DEVICE_TYPE&&U.push(new d(this));var B;B=t&&t.adContainer?t.adContainer:e.parentContainer;var j=new c(B);e&&(h.initialize(e.utils.log),f.initialize(e.config.href),g.initialize(e),g.on([T.MODEL_READY,T.MODEL_PLAYLIST_IS_EMPTY,T.MODEL_PLAYLIST_LOADING_ERROR,T.MODEL_PLAYLIST_PARSING_ERROR],u),g.on([T.AD_SKIN_VOLUME_CHANGED,T.AD_SKIN_MUTE_CHANGED,T.AD_SKIN_RESUME,T.AD_SKIN_PAUSE,T.AD_SKIN_CLICK_ON_BG,T.AD_SKIN_CLICK_ON_MESSAGE,T.AD_SKIN_SKIP_BUTTON,T.AD_SKIN_SKIP_MESSAGE],o),e.on(T.AD_SHOW_ANOTHER_AD,r),e.on(T.AD_PLAYER_ENDED,y),e.on(T.PLAYER_EVENT_PROPERTY_POSITION,i),e.on(T.PLAYER_EVENT_STATE_CHANGE,i),e.on(T.PLAYER_EVENT_STOP,i)),window.addEventListener("unload",S,!1),F.set("ad:showing",!1),F.registerProperty(T.SKIP_AD,!1,!0)}function i(){}function a(){var e=!1,t=null,n=null,r=new u,i=new l(r);this.dispose=function(){r.dispose(),i.dispose()},this.beginProcessAd=function(r,i){if(t=r,n=i,"string"==typeof t)try{t=JSON.parse(t)}catch(s){t=null}t?o(t):n?(e=!0,a(n)):g.emit(T.MODEL_PLAYLIST_LOADING_ERROR)},this.run=function(e,t,n){r.run(e,t,n)},this.currentMemberCompleted=function(){r.currentMemberCompleted()},this.stopCurrentBlock=function(){r.stopCurrentBlock()};var a=function(e){function t(e){g.emit(T.MODEL_PLAYLIST_LOADING_ERROR)}if(m.isStringWithData(e)){var n=new p;n.load(e,p.RESPONSE_TYPE_JSON,function(e){if(n.response){var t=n.response;if("string"==typeof t)try{t=JSON.parse(t)}catch(r){g.emit(T.MODEL_PLAYLIST_PARSING_ERROR)}o(t)}else g.emit(T.MODEL_PLAYLIST_IS_EMPTY)},t,t,1e4)}},o=function(e){g.on([T.PLAYLIST_READY,T.PLAYLIST_ERROR],s),r.processPlaylistData(e)},s=function(t){switch(t.name){case T.PLAYLIST_READY:g.emit(T.MODEL_READY);break;case T.PLAYLIST_ERROR:e?g.emit(T.MODEL_PLAYLIST_PARSING_ERROR):(e=!0,a(n))}g.off([T.PLAYLIST_READY,T.PLAYLIST_ERROR],s)};Object.defineProperties(this,{playlist:{enumerable:!0,configurable:!1,get:function(){return r}},hasPreroll:{enumerable:!0,configurable:!1,get:function(){return r.hasPreroll}}})}function o(e,t,n,r,i,a){function s(){P=!1}function l(){O=setInterval(j,1e3),g.on("property:state",u)}function u(e){e.data!=T.PLAYER_STATE_PLAYING?O&&(clearInterval(O),L=!0):L&&x&&(L=!1,O=setInterval(j,1e3))}function c(e){var t=Math.round(((new Date).getTime()-M)/1e3),n=d.getCurrentTimestamp()+t;n>=A&&(M=0,g.off("player:timeUpdate",c),B())}var f=this,p=[],h=t,m=e,v=n,y=r,_=i,b=a,w=void 0,A=-1,R=0,S=t!=T.OVERLAY,k=0,O=null,L=!1,C=0,D=-1,P=!1,I=null,N=!1,M=0,x=null;this.dispose=function(){if(g.off([T.MEMBER_ERROR,T.MEMBER_READY_TO_SHOW,T.MEMBER_COMPLETE],U),x&&U({name:T.MEMBER_COMPLETE,data:x}),D=-1,P=!1,x=null,O=null,C=0,N=!1,I&&clearTimeout(I),O&&(clearInterval(O),O=null,g.off("property:state",u)),p){for(var e=0;e<p.length;++e)p[e].dispose();p.length=0,p=null}};var F=function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0};this.addAdPlaylistElement=function(e){p.push(e),p.sort(F),b=p[0].timeout,m=p[0].videoState,_=p[0].timeUnit,w=p[0].repeatInterval,A=p[0].blockEnd||-1},this.show=function(){D=-1,g.on([T.MEMBER_ERROR,T.MEMBER_READY_TO_SHOW,T.MEMBER_COMPLETE],U),0==R&&(k=0,g.emit(T.BLOCK_STARTED,f),d&&d.isLiveAd&&A>0&&(M=(new Date).getTime(),g.on("player:timeUpdate",c))),x=p[R++],x&&(N=!1,x.show())},this.currentMemberCompleted=function(){x&&x.completed()},this.stopBlock=function(){N=!0,f.currentMemberCompleted()},this.getMemberNumber=function(e){var t,n,r=-1,i=0;for(t=0,
n=p.length;t<n;++t){if(e==p[t]){r=t+1-i;break}p[t].failed&&++i}return r},this.getMembersCount=function(e){var t=0;return t=D!=-1?D+1:f.membersCount-k};var U=function(t){if(!x)return void B();switch(t.name){case T.MEMBER_READY_TO_SHOW:x.element instanceof E||(S=x.linear);var n=x.getExtensionValue(T.ALLOW_BLOCK),r=!0;try{if(Array.isArray(n)&&n.length>0){for(var i=0,a=n.length;i<a;++i)r&=parseInt(n[i]);r=!!r}else r="string"!=typeof n||1==parseInt(n)}catch(o){r=!0}r||(D=p.indexOf(t.data)),h!=T.MIDROLL&&h!=T.POSTROLL||O||e==T.STATE_COMPLETE||1!=f.getMemberNumber(x)?h==T.OVERLAY&&x.element.vastData&&"string"==typeof x.element.vastData.mediaFile[0].type&&x.element.vastData.mediaFile[0].type.indexOf("video")!=-1?U({name:T.MEMBER_ERROR,data:x}):g.emit(T.BLOCK_STARTING_NEW_ELEMENT,f):(l(),j());break;case T.MEMBER_COMPLETE:case T.MEMBER_ERROR:O&&(clearInterval(O),O=null),t.type==T.MEMBER_ERROR&&(x.failed=!0),x=null,t.name==T.MEMBER_ERROR&&++k,!N&&R<p.length&&R!=D+1?(h!=T.MIDROLL&&h!=T.POSTROLL||(O=1),f.show(),O&&(O=null)):B()}},B=function(){h!=T.PAUSE_ROLL&&h!=T.AFTER_PAUSE_ROLL&&(w>0&&(I&&clearTimeout(I),I=setTimeout(s,w)),P=!0),R=0,M=0,g.off("player:timeUpdate",c),g.off([T.MEMBER_ERROR,T.MEMBER_READY_TO_SHOW,T.MEMBER_COMPLETE],U),g.emit(T.BLOCK_ENDED,f)},j=function(){var e=o.SECONDS_TO_START-C++;e>0?g.emit(T.AD_WILL_START_IN,e):(g.off("property:state",u),clearInterval(O),O=null,C=0,g.emit(T.BLOCK_STARTING_NEW_ELEMENT,f))};Object.defineProperties(this,{currentMember:{enumerable:!0,configurable:!0,get:function(){return x}},errorInBlock:{enumerable:!0,configurable:!0,get:function(){return k>=p.length}},type:{enumerable:!0,configurable:!0,get:function(){return h}},videoState:{enumerable:!0,configurable:!0,get:function(){return m}},linear:{enumerable:!0,configurable:!0,get:function(){return S}},timeStart:{enumerable:!0,configurable:!0,get:function(){return v}},timeEnd:{enumerable:!0,configurable:!0,get:function(){return y}},timeUnit:{enumerable:!0,configurable:!0,get:function(){return _}},timeout:{enumerable:!0,configurable:!0,get:function(){return b}},blockEnd:{enumerable:!0,configurable:!0,get:function(){return A}},currentIndex:{enumerable:!0,configurable:!0,get:function(){return R-1}},membersCount:{enumerable:!0,configurable:!0,get:function(){return p.length}},members:{enumerable:!0,configurable:!0,get:function(){return p}},showed:{enumerable:!0,configurable:!0,get:function(){return P}}})}function s(e,t,n,r,a,o,s,l,u,c){function d(e){p.track(e.data)}this.timeStart=e||-1,this.timeEnd=t||-1,this.videoState=n||null,this.timeout=r||-1,this.timeUnit=a||null,this.priority=o||-1,this.type=s||null,this.urls=l||null,this.minPauseDuration=c||null,this.repeatinterval=u||-1,this.blockEnd=-1,this.failed=!1;var p=this,h=0,m=null,v=null;g.on("ad:forceTrackingEvent",d),this.dispose=function(){g.off([T.ELEMENT_CREATING_SUCCESS,T.ELEMENT_CREATING_FAIL,T.GOOGLE_IN_VAST],_),g.off("ad:forceTrackingEvent",d),m=null},this.show=function(){y(p.urls[h].url,p.urls[h].analytics_tag)},this.completed=function(){g.emit(T.MEMBER_COMPLETE,p)},this.track=function(e,t){m&&"function"==typeof m.track&&m.track.call(m,e,t)},this.getExtensionValue=function(e){var t=null;return m&&m.vastData&&e in m.vastData&&(t=m.vastData[e]),t};var y=function(e,t){v=t,g.on([T.ELEMENT_CREATING_SUCCESS,T.ELEMENT_CREATING_FAIL,T.GOOGLE_IN_VAST],_),e=f.getInstance().modifyURL(e),m=i.createElement(e),m?(m.load(),g.emit(T.MEMBER_BEGIN_LOADING,p)):_({name:T.ELEMENT_CREATING_FAIL,data:{message:"AdFactory cannot create element",url:e}})},_=function(e){switch(e.name){case T.ELEMENT_CREATING_SUCCESS:g.off([T.ELEMENT_CREATING_SUCCESS,T.ELEMENT_CREATING_FAIL,T.GOOGLE_IN_VAST],_),g.emit(T.MEMBER_READY_TO_SHOW,p);break;case T.ELEMENT_CREATING_FAIL:v=null,h<p.urls.length-1?(++h,y(p.urls[h].url,p.urls[h].analytics_tag)):(h=0,p.failed=!0,g.off([T.ELEMENT_CREATING_SUCCESS,T.ELEMENT_CREATING_FAIL,T.GOOGLE_IN_VAST],_),g.emit(T.MEMBER_ERROR,p));break;case T.GOOGLE_IN_VAST:m=new E(e.data.url,e.data.vastDocument),m.load()}};Object.defineProperties(this,{mediaFileExtension:{enumerable:!0,configurable:!0,get:function(){var e=null;if(m&&m.vastData&&m.vastData.mediaFile&&m.vastData.mediaFile.length>0)if(m instanceof E)e="ima";else{var t=m.vastData.mediaFile[0].url,n=t.lastIndexOf("?");n===-1&&(n=t.lastIndexOf("#")),n!==-1&&(t=t.substring(0,n)),e=t.slice(t.lastIndexOf(".")+1)}return e}},mediaFileUrl:{enumerable:!0,configurable:!0,get:function(){var e=null;return m&&m.vastData&&m.vastData.mediaFile&&m.vastData.mediaFile.length>0?e=m.vastData.mediaFile[0].url:m instanceof E&&(e=m.url),e}},mediaFileName:{enumerable:!0,configurable:!0,get:function(){var e=null;if(m&&m.vastData&&m.vastData.mediaFile&&m.vastData.mediaFile.length>0){var t=m.vastData.mediaFile[0].url,n=t.lastIndexOf("?");n!=-1&&(t=t.substring(0,n)),n=t.lastIndexOf("/"),n!=-1&&(t=t.slice(n+1)),e=t}return e}},mediaFileDimensions:{enumerable:!0,configurable:!0,get:function(){var e={};return m&&m.vastData&&m.vastData.mediaFile&&m.vastData.mediaFile.length>0&&(e.width=m.vastData.mediaFile[0].width,e.height=m.vastData.mediaFile[0].height),e}},loadedXMLURL:{enumerable:!0,configurable:!0,get:function(){return m?p.urls[h]:null}},vastDataDuration:{enumerable:!0,configurable:!0,get:function(){var e=0;return m&&m.vastData&&m.vastData.duration&&m.vastData.duration.length>0?e=m.vastData.duration[0]:m&&m.vastData&&m.vastData.mediaFile&&m.vastData.mediaFile.length>0&&m.vastData.mediaFile[0].duration&&(e=m.vastData.mediaFile[0].duration),e}},linear:{enumerable:!0,configurable:!0,get:function(){var e=null;return m&&(e=m.linear),e}},element:{enumerable:!0,configurable:!0,get:function(){return m}},analyticsTag:{enumerable:!0,configurable:!0,get:function(){return v}}})}function l(e){var t=e;this.dispose=function(){t=null,g.off(r,n)};var n=function(e){var n,r,i,a;switch(n=t.currentBlock?t.currentBlock.currentMember:null,n?(r=t.getMembersCount(n),i=t.getMemberNumber(n),a={count:r,number:i,type:n.type,mediaURL:n.mediaFileUrl,xmlURL:n.loadedXMLURL,linear:n.linear,analyticsTag:n.analyticsTag,elementURL:null,vastData:null},n.element&&(a.elementURL=n.element.url,a.vastData=n.element.vastData)):(a={},t.currentBlock&&(a.type=t.currentBlock.type,a.linear=t.currentBlock.linear)),e.name){case T.PLAYLIST_READY:g.emit(T.AD_PLAYLIST_LOADING_COMPLETE,a);break;case T.PLAYLIST_ERROR:g.emit(T.AD_PLAYLIST_LOADING_ERROR,a);break;case T.MEMBER_STARTED_DE_FACTO:g.emit(T.AD_MEMBER_STARTED_PLAYING,a);break;case T.MEMBER_BEGIN_LOADING:g.emit(T.AD_MEMBER_STARTED_LOADING_NEW_URL,a);break;case T.MEDIAFILE_TIMEOUT:g.emit(T.AD_MEDIA_LOADING_TIMEOUT,a);break;case T.XML_TIMEOUT:g.emit(T.AD_XML_LOADING_TIMEOUT,a);break;case T.NOBANNER:g.emit(T.AD_NOBANNER,a);break;case T.DUPLICATE_MEDIAFILE:g.emit(T.AD_DUPLICATE_MEDIA,a);break;case T.ELEMENT_CREATING_SUCCESS:e.data&&e.data.vastData&&(a.vastData=e.data.vastData,g.emit(T.AD_VAST_DATA,a));break;case T.XML_LOADED:a.loadingTime=e.data,g.emit(T.AD_XML_LOADING_TIME,a);break;case T.BLOCK_STARTED:var o=t.currentBlock;o&&o.extended===!1&&g.emit(T.AD_BLOCK_STARTED,a);break;case T.PAGE_CLOSING:n&&g.emit(T.AD_CLOSING_ON_RUNNING_AD,a);break;case T.VAST_EVENT:a.vastEvent=e.data,g.emit(T.AD_VAST_EVENT,a);break;case T.XML_INVALID:g.emit(T.AD_VAST_XML_INVALID,a);break;case T.MEDIA_BEGINS_LOADING:g.emit(T.AD_MEDIA_BEGINS_LOADING,a);break;case T.BLOCK_ENDED:g.emit(T.AD_COMPLETE,a);break;case T.XML_LOADING_ERROR:g.emit(T.AD_XML_LOADING_ERROR,a);break;case T.XML_PARSING_ERROR:g.emit(T.AD_VAST_XML_INVALID,a);break;case T.MEDIAFILE_VENDOR_ERROR:g.emit(T.AD_MEDIAFILE_VENDOR_ERROR,a);break;case T.CANNOT_FIND_VENDOR:g.emit(T.AD_CANNOT_DISPLAY_MEDIAFILE,a);break;case T.GOOGLE_IN_VAST:g.emit(T.AD_GOOGLE_IN_VAST,a)}},r=[T.PLAYLIST_READY,T.PLAYLIST_ERROR,T.MEDIAFILE_TIMEOUT,T.XML_TIMEOUT,T.NOBANNER,T.DUPLICATE_MEDIAFILE,T.ELEMENT_CREATING_SUCCESS,T.MEMBER_STARTED_DE_FACTO,T.XML_LOADED,T.MEMBER_BEGIN_LOADING,T.BLOCK_STARTED,T.PAGE_CLOSING,T.VAST_EVENT,T.XML_INVALID,T.MEDIA_BEGINS_LOADING,T.BLOCK_ENDED,T.XML_LOADING_ERROR,T.XML_PARSING_ERROR,T.MEDIAFILE_VENDOR_ERROR,T.CANNOT_FIND_VENDOR,T.GOOGLE_IN_VAST];g.on(r,n)}function u(){function e(e){u=!!e.data}function t(e,t){return e.type==t.type&&e.timeStart==t.timeStart&&e.timeEnd==t.timeEnd&&e.videoState==t.videoState&&e.timeUnit==t.timeUnit}var n=[],r=null,i=null,a=0,l=!1,u=!1;g.on("property:"+T.SKIP_AD,e),this.dispose=function(){g.off([T.BLOCK_STARTED,T.BLOCK_ENDED],p);for(var e=0,t=n.length;e<t;++e)n[e].dispose();n=[],r=null,i=null,l=!0},this.processPlaylistData=function(e){if(l=!1,e){var t=null;e.Adlist?t=e.Adlist:"ok"===e.result&&e.data?t=e.data:g.emit(T.PLAYLIST_ERROR),t&&(c(t),g.emit(T.PLAYLIST_READY))}else g.emit(T.PLAYLIST_ERROR)},this.run=function(e,t,i,s){if(!r&&!u){var l,c,h=d&&d.isLiveAd;h&&0!=t&&1!=i&&(l=d.startTimestamp+t,g._observer&&g._observer.config.debug&&console.log("%c"+new Date(1e3*l),"color: red")),e===T.STATE_PAUSE&&(a=(new Date).getTime()/1e3);for(var m,v,y,_=0,E=n.length;_<E;++_)if(m=n[_],e===m.videoState&&(!s||s===m.type)){if(m.timeUnit===T.PERCENT?(v=m.timeStart*i/100,y=m.timeEnd*i/100):(v=m.timeStart,y=m.timeEnd),m.type!=T.MIDROLL&&m.type!=T.POSTROLL||e==T.STATE_COMPLETE||v>o.SECONDS_TO_START&&(v-=o.SECONDS_TO_START),c=h&&m.timeUnit===T.SECONDS?l:t,v<=c&&y>=c&&!m.showed){if(m.type===T.AFTER_PAUSE_ROLL){var b=(new Date).getTime()/1e3;if(m.minPauseDuration>0&&b-a<m.minPauseDuration)break}f(m)||(r=m,g.on([T.BLOCK_STARTED,T.BLOCK_ENDED],p),m.show());break}e==T.STATE_COMPLETE&&m.type==T.POSTROLL&&(r=m,g.on([T.BLOCK_STARTED,T.BLOCK_ENDED],p),m.show())}}},this.currentMemberCompleted=function(){r&&r.currentMemberCompleted()},this.stopCurrentBlock=function(){r&&r.stopBlock()},this.getMembersCount=function(e){for(var t=0,r=0,i=n.length;r<i;++r)if(n[r].type==e.type&&n[r].timeStart==e.timeStart){t=n[r].getMembersCount(e);break}return t},this.getMemberNumber=function(e){for(var t=-1,r=0,i=n.length;r<i;++r)if(n[r].type==e.type&&n[r].timeStart==e.timeStart){t=n[r].getMemberNumber(e);break}return t},this.getBlockByType=function(e){for(var t=[],r=0,i=n.length;r<i;++r)n[r].type===e&&t.push(n[r]);return t};var c=function(e){for(var r,i,a,s,l=0,u=e.length;l<u;++l){for(r=h(e[l]),s=!1,i=0,a=n.length;i<a;++i)if(t(n[i],r)){n[i].addAdPlaylistElement(r),s=!0;break}s||(n.push(new o(r.videoState,r.type,r.timeStart,r.timeEnd,r.timeUnit,r.timeout)),n[n.length-1].addAdPlaylistElement(r))}},f=function(e){var t=!0,n=(new Date).getTime();return 0==e.timeout?t=!1:e.type==T.OVERLAY||e.type==T.PAUSE_ROLL?t=!1:i?n-i.getTime()>1e3*e.timeout&&(t=!1):t=!1,t},p=function(e){switch(e.name){case T.BLOCK_STARTED:break;case T.BLOCK_ENDED:g.off([T.BLOCK_STARTED,T.BLOCK_ENDED],p),r.errorInBlock||(i=new Date),r=null}};Object.defineProperties(this,{blocks:{enumerable:!0,configurable:!0,get:function(){return n}},currentBlock:{enumerable:!0,configurable:!0,get:function(){return r}},hasPreroll:{enumerable:!0,configurable:!0,get:function(){for(var e=!1,t=0,r=n.length;t<r;++t)if(n[t].type==T.PREROLL){e=n[t].membersCount>0&&0==n[t].timeStart;break}return e}},disposed:{enumerable:!0,configurable:!1,get:function(){return l}}});var h=function(e){var t=new s;return t.timeStart=parseInt(e.time_start),t.timeEnd=parseInt(e.time_end),t.timeUnit=e.time_unit?e.time_unit.toUpperCase():T.SECONDS,t.videoState=e.video_state?e.video_state.toUpperCase():e.video_state,t.priority=parseInt(e.priority)||1,t.timeout=parseInt(e.timeout)||0,t.type=e.type?e.type.toLowerCase():e.type,t.urls=e.urls,t.minPauseDuration=e.min_pause_duration,t.repeatinterval=e.repeat_interval,t.blockEnd=e.block_end||-1,t}}function c(e){var t=e,n=null;this.createOverlayContainer=function(e){var r=document.createElement("div");r.id="ad:overlay";var i=e.mediaFileDimensions,a=0,o=0;try{a=parseInt(i.width),o=parseInt(i.height)}catch(s){console.warn("Bad overlay's dimensions parsing in mggp-plugin-ad::View.createOverlayContainer")}return a&&(r.style.width=i.width+"px"),o&&(r.style.height=i.height+"px"),t.appendChild(r),n=r,r},this.createIMAContainer=function(){return n=document.createElement("div"),n.id="ad:imaContainer",n.style.width="100%",n.style.height="100%",t.appendChild(n),n},this.removeCurrentContainer=function(){n&&n.parentNode&&n.parentNode.removeChild(n)},Object.defineProperty(this,"parentContainer",{enumerable:!0,get:function(){return t}})}function d(e){function t(n){e.player.off("player:hls:chunkLoaded",t);var a=n.data.frag.url,o=a.lastIndexOf("?"),s=Math.round((new Date).getTime()/1e3);if(o!=-1&&(a=a.substring(0,o)),o=a.lastIndexOf("/"),o!=-1&&(a=a.slice(o+1)),a){var l=a.match(/_\d+/);if(l&&l.length>0){var u=l[0];u=u.substr(1);try{u=parseInt(u)}catch(c){u=s}e.player&&e.player.config&&e.player.config.debug&&console.log("TIMESTAMP FROM NAME",new Date(1e3*u)),d.startTimestamp=u}}u||(d.startTimestamp=s),i&&(e.setAdlist({Adlist:r(i)}),i=null)}function n(t){d.isLiveAd=!0,i=t.data,void 0!==d.startTimestamp&&(e.setAdlist({Adlist:r(i)}),i=null)}function r(t){for(var n,r=d.startTimestamp,i=[],a=0,o=t.length;a<o;++a)t[a].time_end>1e6&&(e.player&&e.player.config&&e.player.config.debug&&console.log("%c"+new Date(1e3*t[a].time_start)+" | "+new Date(1e3*t[a].time_end),"background: black; color: white"),n=t[a].time_end-r,n<=0)||i.push(t[a]);return i}var i;d.startTimestamp=void 0,d.isLiveAd=!1,d.getCurrentTimestamp=function(){return d.startTimestamp+e.player.get("position")},d.resetStartTimestamp=function(){e.player.on("player:hls:chunkLoaded",t)},d.resetStartTimestamp(),e.player.on("property:"+T.MNS_ADLIST,n)}function f(e){function t(e){i()?(e+="&puid39=0",e+="&puid10=0"):(e+="&puid39=1",e+="&puid10=1"),r("dl",e)&&(o=r("dl",e));var t=new Date;e+="&pt=b",e+="&pd="+t.getDate(),e+="&pw="+t.getDay(),e+="&pv="+t.getHours();var n=r("puid42");if(""==n){var a=/&puid42=/g;e.search(a)!=-1&&(e=e.replace(/&puid42=/g,""))}var s,l,u=document.getElementById("playerContainer");u&&(u.offsetWidth/u.offsetHeight>16/9?(l=u.offsetHeight,s=l*(16/9)):(s=u.offsetWidth,l=s/(16/9)));var c=4;s<400&&l<225?c=5:s>=400&&l>=225&&s<639&&l<359?c=0:s>=640&&l>=360&&s<959&&l<539?c=1:s>=960&&l>=540&&s<1279&&l<719?c=2:s>=1280&&l>=720&&(c=3),""==n&&(e+="&puid42="+c);var d=r("puid9",e);""==d&&(e+="&puid9="+c);var f,p=r("eid2",e),h="flash";try{f=readVClicks()}catch(g){}return f&&(h=f,e.indexOf("eid2")!=-1?e=e.replace("eid2="+p,"eid2=vc"+h):e+="&eid2=vc"+h),e}function n(e){r("dl",e)&&(o=r("dl",e));var t,n,a=document.getElementById("playerContainer");a&&(a.offsetWidth/a.offsetHeight>16/9?(n=a.offsetHeight,t=n*(16/9)):(t=a.offsetWidth,n=t/(16/9)));var s=4;t<400&&n<225?s=5:t>=400&&n>=225&&t<639&&n<359?s=0:t>=640&&n>=360&&t<959&&n<539?s=1:t>=960&&n>=540&&t<1279&&n<719?s=2:t>=1280&&n>=720&&(s=3),e.indexOf("puid10")!=-1?""==r("puid10",e)&&(e=e.replace(/puid10=/,"puid10="+s)):e+="&puid10="+s;var l=i()?0:1;e.indexOf("puid11")!=-1?""==r("puid11",e)&&(e=e.replace(/puid11=/,"puid11="+l)):e+="&puid11="+l;var u,c=r("eid2",e),d="flash";try{u=readVClicks()}catch(f){}return u&&(d=u,e.indexOf("eid2")!=-1?e=e.replace("eid2="+c,"eid2=vc"+d):e+="&eid2=vc"+d),e}function r(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\?&]"+e+"=([^&#]*)",r=new RegExp(n),i=r.exec(t);return null==i?"":i[1]}function i(){return document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement}function a(){var e=Math.random();return e=Math.floor(1e11*e),e=e<0?-e:e}var o,s=e,l=this;this.modifyURL=function(e){if(e)return e.indexOf(".xml")==-1&&(e=e.substr(e.indexOf("http"))),e.indexOf("ads.adfox.ru")==-1&&e.indexOf("adv.gpm-digital.com")==-1||(e=t(e)),e.indexOf("ad.mail.ru")!=-1&&(e=n(e)),e.indexOf("bs-meta.yandex.ru")!=-1&&(e=l.replaceEventURL(e).url),e},this.replaceEventURL=function(e){if(e){var t;try{t=getAfReferrer()}catch(n){}if(e=e.replace("![rnd]",a()),e=e.replace("[TIMESTAMP]",(new Date).getTime()),e=e.replace("[RANDOM]",a()),e=e.replace("[CACHEBUSTING]",a()),s&&(e=e.replace("[REFERER]",s)),(s||t)&&(e=e.replace("[REFERERER]","undefined"!=t?t:s)),e=e.replace("{random}",a()),s&&(e=e.replace("{referer}",s)),(s||t)&&(e=e.replace("{rereferer}","undefined"!=t?t:s)),e.indexOf("ads.adfox.ru")!=-1||e.indexOf("adv.gpm-digital.com")!=-1){var i=r("dl",e);""==i&&o&&""!=o&&(e=e+"&dl="+o)}return e}}}function p(){var e,t=this;this.destroy=function(){t.abort(),e=null},this.abort=function(){e&&4!==e.readyState&&(t.stats.aborted=!0,e.abort()),t.timeoutHandle&&window.clearTimeout(t.timeoutHandle)},this.load=function(e,r,i,o,s,l,u){"tv"!==T.DEVICE_TYPE&&"https:"===T.PROTOCOL&&(e=e.replace(/http[s]?:/,"")),t.url=e,t.responseType=r||p.RESPONSE_TYPE_TEXT,t.onSuccess=i,t.onTimeout=s||null,t.onError=o,t.timeout=l,t.useCredentials=u||!1,t.maxRetry=0,t._response=null,l&&(t.timeoutHandle=window.setTimeout(a,l)),t.stats={trequest:new Date,retry:0},n()},Object.defineProperty(this,"response",{enumerable:!0,get:function(){return t._response}});var n=function(){var n=e=new XMLHttpRequest;n.onload=r,n.onerror=i,n.onprogress=o,n.open("GET",t.url,!0);try{n.responseType=t.responseType}catch(a){}try{t.useCredentials&&(n.withCredentials=!0)}catch(a){}t.stats.tfirst=null,t.stats.loaded=0;try{n.send()}catch(a){t.onError&&t.onError(a)}},r=function(e){t.timeoutHandle&&window.clearTimeout(t.timeoutHandle),200==e.target.status?(t.stats.tload=new Date,t._response=e.currentTarget.response,t.onSuccess&&t.onSuccess(e,t.stats)):i(e)},i=function(e){if(t.maxRetry===-1||t.stats.retry<t.maxRetry)t.destroy(),t.timeoutHandle&&window.clearTimeout(t.timeoutHandle),window.setTimeout(n,t.retryDelay),t.retryDelay=Math.min(2*t.retryDelay,64e3),t.stats.retry++;else{t.timeoutHandle&&window.clearTimeout(t.timeoutHandle),t.onError&&t.onError(e,t.stats);var r=A.errorTypes.NETWORK_ERROR,i=A.errorCodes[r].FILE_LOADING_ERROR,a=A.errorMessages[i]+t.url;new A(g.getObserverInstance(),r,i,a)}},a=function(e){t.timeoutHandle=null,t.abort(),t.onTimeout&&t.onTimeout(e,t.stats)},o=function(e){var n=t.stats;null===n.tfirst&&(n.tfirst=new Date),n.loaded=e.loaded,t.onProgress&&t.onProgress(e,n)}}function h(){}function g(){}function m(){}function v(){}function y(e){_.apply(this,arguments),this._vastDocument=null;var t=this;this.load=function(){t._vastDocument=new b,t._vastDocument.getMedia(t._url,n)},this.track=function(e,n){t._vastDocument&&"function"==typeof t._vastDocument[e]&&(Array.isArray(n)||(n=[n]),t._vastDocument[e].apply(t._vastDocument,n))},Object.defineProperties(this,{trackingData:{enumerable:!0,configurable:!0,get:function(){var e=null;return t._vastDocument&&(e=t._vastDocument.isLinear?t._vastDocument.trackingData:t._vastDocument.trackingDataNonLinear),e}},vastData:{enumerable:!0,configurable:!0,get:function(){var e=null;return t._vastDocument&&(e=t._vastDocument.vastData),e}},linear:{enumerable:!0,configurable:!0,get:function(){return t._vastDocument?t._vastDocument.isLinear:null}},vastDocument:{enumerable:!0,configurable:!0,get:function(){return t._vastDocument}},apiFramework:{enumerable:!0,configurable:!0,get:function(){var e="";return t._vastDocument&&t._vastDocument.vastData&&t._vastDocument.vastData.mediaFile&&t._vastDocument.vastData.mediaFile.length>0&&t._vastDocument.vastData.mediaFile[0].apiFramework&&(e=t._vastDocument.vastData.mediaFile[0].apiFramework),e}}});var n=function(e){if(e.isError===!1){if(t.vastData){var n=t.vastData.mediaFile;if(n.length>0&&(n=n[0],n.apiFramework&&"VPAID"==n.apiFramework.toUpperCase())){var r=g.getObserverInstance();r&&r.config&&r.config.vpaidAllow===!1&&(t.vastData[T.ALLOW_BLOCK]=["0"])}}g.emit(T.ELEMENT_CREATING_SUCCESS,t)}else if(e.isError===!0){if(e.error&&e.error.length>0)for(var i=0,a=e.error.length;i<a;++i)if(m.isStringWithData(e.error[i]))try{document.createElement("img").src=e.error[i]}catch(o){}g.emit(T.ELEMENT_CREATING_FAIL,t)}else T.GOOGLE_IN_VAST in e&&g.emit(T.GOOGLE_IN_VAST,{url:e[T.GOOGLE_IN_VAST],vastDocument:t._vastDocument})}}function _(e){var t=this;this._url=e,this.dispose=function(){},this.load=function(){},this.track=function(){},Object.defineProperties(this,{url:{enumerable:!0,configurable:!0,get:function(){return t._url},set:function(e){t._url=e}},trackingData:{writable:!1,enumerable:!0,configurable:!0,value:null},vastData:{writable:!1,enumerable:!0,configurable:!0,value:null},linear:{writable:!1,enumerable:!0,configurable:!0,value:null}})}function E(e,t){function n(e){g.off("ad:vendor:imaIsLinear",n),g.off("ad:vendor:mediaError",r),a=e.data,o._vastDocument&&(o._vastDocument.isLinear=a)}function r(e){g.off("ad:vendor:imaIsLinear",n),g.off("ad:vendor:mediaError",r)}_.apply(this,arguments),this._vastDocument=t;var i={mediaFile:[{url:e,type:""}],controls:[0]},a=null,o=this;this._vastDocument&&(this._vastDocument.vastData||(this._vastDocument.vastData={}),this._vastDocument.vastData=Object.assign(this._vastDocument.vastData,i)),this.load=function(){g.on("ad:vendor:imaIsLinear",n),g.on("ad:vendor:mediaError",r),g.emit(T.ELEMENT_CREATING_SUCCESS,o)},this.track=function(e,t){o._vastDocument&&"function"==typeof o._vastDocument[e]&&(Array.isArray(t)||(t=[t]),o._vastDocument[e].apply(o._vastDocument,t))},Object.defineProperties(this,{trackingData:{enumerable:!0,configurable:!0,get:function(){var e=null;return o._vastDocument&&(e=o._vastDocument.isLinear?o._vastDocument.trackingData:o._vastDocument.trackingDataNonLinear),e}},vastData:{enumerable:!0,configurable:!0,get:function(){var e=i;return o._vastDocument&&(e=o._vastDocument.vastData),e}},linear:{enumerable:!0,configurable:!0,get:function(){return a}},vastDocument:{enumerable:!0,configurable:!0,get:function(){return o._vastDocument}}})}function b(){this.ERROR="error",this.NOBANNER="nobanner",this.COMPLETE="complete",this.LOADING="loading",this.currentType=null,this.currentURL=null,this.showed=!1,this.currentState=null,this.prevState=null,this.lastStatus=null,this.isLinear=!0,this.trackingData={},this.trackingDataNonLinear={},this.vastData={},this.callback=null,this.logging=!1,this.logElement=null;var e=/^\s+|\s+$/gm,t=this,n=!1,r=1;this.getMedia=function(e,n,r){return t.currentURL=e,t.currentType=r||"",t.callback=n,t.trackingData={},t.trackingDataNonLinear={},t.vastData={},t.isLinear=!0,t.trackStarted=!1,t.trackFirstQuartile=!1,t.trackMidpoint=!1,t.trackThirdQuertile=!1,t.trackEnd=!1,o(e)};var i=function(e){return t.lastStatus={isError:t.currentState==t.ERROR||t.currentState==t.NOBANNER,state:t.currentState,prevState:t.prevState,message:e,vastDocument:t},t.lastStatus.isError&&(t.lastStatus.error=t.trackingData.error),t.logging&&console._log(t.lastStatus),t.lastStatus},a=function(e){e!=t.currentState&&(t.prevState=t.currentState,t.currentState=e)},o=function(e){v.reset(),a(t.LOADING),i("Load "+t.currentType+" from "+t.currentURL),t.showed=!0;var r=new p;return r.load(e,p.RESPONSE_TYPE_DOCUMENT,function(t,n){L("loader success: "+e),l(t.currentTarget.responseXML,n.tload.getTime()-n.trequest.getTime())},function(t){L("loader error: "+e),g.emit(T.XML_LOADING_ERROR),s(t)},function(e){n&&v.track(R.VAST_TAG_URI_TIMEOUT),g.emit(T.XML_TIMEOUT),s(e)},1e4,!0),t.lastStatus},s=function(e){O(),a(t.ERROR),"function"==typeof t.callback&&(e?t.callback(i("Error loading xml. Status: "+e.status+" "+e.statusText)):t.callback(i("Timeout on loading xml")))},l=function(e,r){var s=null;g.emit(T.XML_LOADED,r);try{"nobanner"==e.firstChild.nodeName?(L("vast: nobanner"),a(t.NOBANNER),s=i(t.NOBANNER),O(),g.emit(T.NOBANNER)):"VAST"!=e.firstChild.nodeName&&(L("vast: 0"),a(t.ERROR),s=i("VAST tag not found!"),O(),g.emit(T.XML_INVALID),n&&v.track(R.NO_VAST_IN_WRAPPERS));for(var l=0,d=e.childNodes.length;l<d;l++)c(e.childNodes[l])}catch(f){O(),a(t.ERROR),s=i(f),g.emit(T.XML_PARSING_ERROR)}if(null!=s&&"function"==typeof t.callback)return void t.callback(s);if(t.vastData.vastadtaguri){var p=t.vastData.vastadtaguri[0];if(t.vastData.vastadtaguri=null,n=!0,m.isURLisIMA(p)){if("function"==typeof t.callback){var h={};h[T.GOOGLE_IN_VAST]=p,t.callback(h)}}else o(p)}else n=!1,t.trackingData.error&&v.initialize(t.trackingData.error),t.vastData.mediaFile&&t.vastData.mediaFile.length?s=u():(a(t.ERROR),s=i("Media file is null"),O()),"function"==typeof t.callback&&t.callback(s)},u=function(){var e,n,r,o=!1;a(t.COMPLETE);var s=i("Received video "+t.vastData.mediaFile[0].url);if(s.isClickable=!1,s.clickURL=null,t.vastData.mediaFile[0].duration?s.duration=t.vastData.mediaFile[0].duration:t.vastData.duration?s.duration=t.vastData.duration[0]:s.duration=30,s.skipTime=t.vastData.skipTime?t.vastData.skipTime[0]:0,s.skipTime2=t.vastData.skipTime2?t.vastData.skipTime2[0]:0,s.mediaFile=t.vastData.mediaFile?t.vastData.mediaFile[0]:"",s.linkText=t.vastData.linkTxt?t.vastData.linkTxt[0]:"",t.vastData.isClickable)for(r=t.vastData.isClickable,e=0,n=r.length;e<n;e++)r[e]&&o===!1&&(o=!0);return o&&(t.vastData.clickthrough&&(s.isClickable=!0,s.clickURL=t.vastData.clickthrough[0]),t.vastData.nonlinearclickthrough&&(s.isClickable=!0,s.clickURL=t.vastData.nonlinearclickthrough[0])),s},c=function(e){d(e);for(var t=0;t<e.childNodes.length;t++)c(e.childNodes[t])},d=function(n){if(n.localName){var r=n.textContent.replace(e,""),i=n.localName.toLowerCase();if("ad"==i){var a=n.getAttribute("id");E(i,a)}else if("adtitle"==i)E(i,r);else if("adsystem"==i)E(i,r);else if("vastadtaguri"==i)E(i,r);else if("tracking"==i||"clicktracking"==i){var o=n.parentNode.parentNode.nodeName;"NonLinearAds"==o?w(n):b(n)}else"duration"==i?E(i,k(r)):"clickthrough"==i?E(i,r):"nonlinearclickthrough"==i?E(i,r):"extension"==i?A(n):"impression"==i?(t.trackingData.impression||(t.trackingData.impression=[]),t.trackingDataNonLinear.impression||(t.trackingDataNonLinear.impression=[]),t.trackingData.impression.push(r),t.trackingDataNonLinear.impression.push(r)):"mediafile"==i?y(n):"nonlinearads"==i?_(n):"error"==i?(t.trackingData.error||(t.trackingData.error=[]),t.trackingDataNonLinear.error||(t.trackingDataNonLinear.error=[]),t.trackingData.error.push(r),t.trackingDataNonLinear.error.push(r)):"adparameters"==i&&E(i,r)}},y=function(t){for(var n=t.attributes,r={},i=0;i<n.length;i++)r[n[i].localName]=n[i].value;r.url=t.textContent.replace(e,""),"tv"!==T.DEVICE_TYPE&&"https:"===T.PROTOCOL&&(r.url=r.url.replace(/http[s]?:/,"")),E("mediaFile",r)},_=function(n){var r,i,a,o,s,l,u,c,d;if(i=n.getElementsByTagName("StaticResource")[0]){t.isLinear=!1,c=i.textContent.replace(e,""),a=i.attributes;var f,p;for(p=0,f=a.length;p<f;p++)switch(a[p].nodeName){case"creativeType":u=a[p].nodeValue}for(o=n.getElementsByTagName("NonLinear")[0].attributes,p=0,f=o.length;p<f;p++)switch(o[p].nodeName){case"width":d=o[p].nodeValue;break;case"height":s=o[p].nodeValue;break;case"scalable":l=o[p].nodeValue;break;case"minSuggestedDuration":var h=o[p].nodeValue.split(":");r=60*+h[0]*60+60*+h[1]+ +h[2]}E("mediaFile",{url:c,type:u,duration:r,width:d,height:s,scalable:l})}},E=function(e,n){t.vastData[e]||(t.vastData[e]=[]),t.vastData[e].push(n)},b=function(n){var r,i;r="ClickTracking"==n.nodeName?"clicktracking":n.attributes[0].value;var a=n.textContent.replace(e,"");i="progress"==r&&n.attributes[1]&&"offset"==n.attributes[1].name?{offset:n.attributes[1].value,url:a}:a,t.trackingData[r]||(t.trackingData[r]=[]),t.trackingData[r].push(i)},w=function(n){var r,i;r="ClickTracking"==n.nodeName?"clicktracking":n.attributes[0].value;var a=n.textContent.replace(e,"");i="progress"==r&&n.attributes[1]&&"offset"==n.attributes[1].name?{offset:n.attributes[1].value,url:a}:a,t.trackingDataNonLinear[r]||(t.trackingDataNonLinear[r]=[]),t.trackingDataNonLinear[r].push(i)},A=function(n){if(0!=n.attributes.length&&n.attributes[0].value){var r=n.attributes[0].value,i=n.textContent.replace(e,"");if("skipAd"==r||"addClick"==r)return void b(n);t.vastData[r]||(t.vastData[r]=[]);var a;"startTime"==r||"skipTime"==r||"skipTime2"==r?a=k(i):"isClickable"==r?a=parseInt(i):"linkTxt"==r?i.indexOf("#")!=-1?a=S(i):i.indexOf("%")!=-1?(a=decodeURI(i),a=a.charAt(0).toUpperCase()+a.substr(1)):a=i:a=i,t.vastData[r].push(a)}},S=function(e){e=e.replace(/&amp;/g,"");for(var t=e.split(" ",10),n="",r=0;r<t.length;r++){for(var i=t[r].split("#",100),a=0;a<i.length;a++)"&"!==i[a]&&(n+=1==a&&0==r?String.fromCharCode(parseInt(i[a])).toUpperCase():String.fromCharCode(parseInt(i[a])));r<t.length-1&&(n+=" ")}return n},k=function(e){var t=e.split(":",3);return 3==t.length?3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2]):60*parseInt(t[0])+parseInt(t[1])},O=function(){t.trackingData={},t.vastData={},t.showed=!1},L=function(e){h.log(e),t.logElement&&(document.getElementById(t.logElement).style.display="block",document.getElementById(t.logElement).innerHTML+=e+"\r\n")},C=function(e,n){try{if(t.trackingData[e]||t.trackingDataNonLinear[e]){g.emit(T.VAST_EVENT,e);for(var r=t.isLinear?t.trackingData:t.trackingDataNonLinear,i=0;i<r[e].length;i++){L("adt_"+e);var a=f.getInstance().replaceEventURL(r[e][i].replace(/amp;/g,"")),o=document.createElement("img");o.src=a}}}catch(s){}!n&&r&&r[e]&&(r[e]=null)},D=function(){try{if(t.vastData){var e,n,r;if(t.isLinear&&t.vastData.clickthrough&&t.vastData.clickthrough.length>0)for(g.emit(T.VAST_EVENT,"clickthrough"),e=0;e<t.vastData.clickthrough.length;++e)L("adt_clickthrough"),n=f.getInstance().replaceEventURL(t.vastData.clickthrough[e].replace(/amp;/g,"")),r=document.createElement("img"),r.src=n;else if(!t.isLinear&&t.vastData.nonlinearclickthrough&&t.vastData.nonlinearclickthrough.length>0)for(g.emit(T.VAST_EVENT,"clickthrough"),e=0;e<t.vastData.nonlinearclickthrough.length;++e)L("adt_nonlinearclickthrough"),n=f.getInstance().replaceEventURL(t.vastData.nonlinearclickthrough[e].replace(/amp;/g,"")),r=document.createElement("img"),r.src=n}}catch(i){}};this.sendReadyEvents=function(){C("impression"),C("creativeView")},this.sendStartEvent=function(){t.trackStarted||(C("start"),t.trackStarted=!0);var e=g.getObserverInstance();e&&e.config&&"adSpeed"in e.config&&(r=e.config.adSpeed/100,r<1?r=1:r>2&&(r=2))},this.onTime=function(e,n){if(!(!t.showed||n<=0||isNaN(n))){e*=r,!t.trackFirstQuartile&&e>=Math.round(25*n/100)&&(C("firstQuartile"),t.trackFirstQuartile=!0),!t.trackMidpoint&&e>=Math.round(50*n/100)&&(C("midpoint"),t.trackMidpoint=!0),!t.trackThirdQuertile&&e>=Math.round(75*n/100)&&(C("thirdQuartile"),t.trackThirdQuertile=!0),!t.trackEnd&&e>=Math.round(99*n/100)&&(C("complete"),t.trackEnd=!0);var i=t.isLinear?t.trackingData.progress:t.trackingDataNonLinear.progress;if(i&&i.length>0)for(var a,o=0,s=i.length;o<s;++o)if(a=k(i[o].offset),a==e&&i[o].url){i[o].url=f.getInstance().replaceEventURL(i[o].url);var l=document.createElement("img");l.src=i[o].url}}},this.click=function(){C("clicktracking",!0),D()},this.click2=function(){C("addClick",!0),C("clicktracking",!0),D()},this.mute=function(){C("mute",!0)},this.unmute=function(){C("unmute",!0)},this.pause=function(){C("pause",!0)},this.resume=function(){C("resume",!0)},this.skip=function(){C("skipAd"),C("closeLinear")},this.skip2=function(){C("close"),C("closeLinear")},this.error=function(){C("error")},this.close=function(){t.skip2()},this.collapse=function(){C("collapse",!0)},this.creativeView=function(){C("creativeView")},this.fullscreen=function(){C("fullscreen",!0)},this.expand=function(){C("expand",!0)},this.impression=function(){C("impression")},this.start=function(){C("start")},this.stop=function(){C("stop")},this.acceptInvitation=function(){C("acceptInvitation",!0)},this.firstQuartile=function(){C("firstQuartile")},this.midpoint=function(){C("midpoint")},this.thirdQuartile=function(){C("thirdQuartile")},this.complete=function(){C("complete")}}var T={AFTER_PAUSE_ROLL:"afterpauseroll",OVERLAY:"overlay",PAUSE_ROLL:"pauseroll",POSTROLL:"postroll",PREROLL:"preroll",MIDROLL:"midroll",START_SCREEN:"startscreen",PERCENT:"PERCENT",SECONDS:"SECONDS",GOOGLE_IN_VAST:"googleInVast",ALLOW_BLOCK:"Allowblock",STATE_PLAY:"PLAY",STATE_PAUSE:"PAUSE",STATE_RESUME:"RESUME",STATE_COMPLETE:"COMPLETE",BLOCK_STARTED:"ad:block:started",BLOCK_STARTING_NEW_ELEMENT:"ad:block:startingNewElement",BLOCK_ENDED:"ad:block:ended",MEMBER_READY_TO_SHOW:"ad:blockMember:readyToShow",MEMBER_ERROR:"ad:blockMember:error",MEMBER_COMPLETE:"ad:blockMember:complete",PLAYLIST_READY:"ad:playlist:ready",PLAYLIST_ERROR:"ad:playlist:error",
MODEL_READY:"ad:model:ready",MODEL_PLAYLIST_IS_EMPTY:"ad:model:playlistError",MODEL_PLAYLIST_LOADING_ERROR:"ad:model:playlistLoadingError",MODEL_PLAYLIST_PARSING_ERROR:"ad:model:playlistParsingError",ELEMENT_CREATING_SUCCESS:"ad:element:creatingSuccess",ELEMENT_CREATING_FAIL:"ad:element:creatingFail",VENDOR_STATE_CHANGE:"ad:vendor:stateChange",VENDOR_MEDIA_ERROR:"ad:vendor:mediaError",VENDOR_ERROR:"ad:vendor:error",VENDOR_EVENT_PROPERTY_POSITION:"property:ad:vendor:position",PLAYER_EVENT_PROPERTY_VIDEO_INFO:"property:videoInfo",PLAYER_EVENT_PROPERTY_POSITION:"property:position",PLAYER_EVENT_STATE_CHANGE:"player:stateChange",PLAYER_EVENT_STOP:"player:stop",PLAYER_EVENT_MEDIA_BEFORE_COMPLETE:"player:mediaBeforeComplete",PLAYER_STATE_ENDED:0,PLAYER_STATE_PLAYING:1,PLAYER_STATE_PAUSED:2,PLAYER_STATE_BUFFERING:3,AD_PLAYLIST_LOADING_COMPLETE:"ad:external:playlistLoadingComplete",AD_PLAYLIST_LOADING_ERROR:"ad:external:playlistLoadingError",AD_MEMBER_STARTED_PLAYING:"ad:external:memberStartedPlaying",AD_NOBANNER:"ad:external:nobanner",AD_XML_LOADING_TIMEOUT:"ad:external:xmlLoadingTimeout",AD_MEDIA_LOADING_TIMEOUT:"ad:external:mediaLoadingTimeout",AD_DUPLICATE_MEDIA:"ad:external:duplicateMedia",AD_VAST_DATA:"ad:external:vastData",AD_BLOCK_STARTED:"ad:external:blockStarted",AD_MEMBER_STARTED_LOADING_NEW_URL:"ad:external:startedLoadingNewURL",AD_XML_LOADING_TIME:"ad:external:xmlLoadingTime",AD_CLOSING_ON_RUNNING_AD:"ad:external:closingOnRunningAd",AD_VAST_EVENT:"ad:external:vastEvent",AD_VAST_XML_INVALID:"ad:external:vastXMLInvalid",AD_MEDIA_BEGINS_LOADING:"ad:external:mediaBeginsLoading",AD_COMPLETE:"ad:external:adComplete",AD_XML_LOADING_ERROR:"ad:external:xmlLoadingError",AD_MEDIAFILE_VENDOR_ERROR:"ad:external:mediaFileVendorError",AD_CANNOT_DISPLAY_MEDIAFILE:"ad:external:cannotDisplayMediafile",AD_WILL_START_IN:"ad:external:adWillStartIn",AD_GOOGLE_IN_VAST:"ad:external:googleInVast",AD_SHOW_ANOTHER_AD:"ad:showAnotherAd",AD_SKIN_VOLUME_CHANGED:"ad:skin:volumeChanged",AD_SKIN_MUTE_CHANGED:"ad:skin:muteChanged",AD_SKIN_RESUME:"ad:skin:resume",AD_SKIN_PAUSE:"ad:skin:pause",AD_SKIN_CLICK_ON_BG:"ad:skin:clickOnBg",AD_SKIN_CLICK_ON_MESSAGE:"ad:skin:clickOnMessage",AD_SKIN_SKIP_BUTTON:"ad:skin:skipButton",AD_SKIN_SKIP_MESSAGE:"ad:skin:skipMessage",AD_PLAYER_ENDED:"ad:playerEnded",MEDIAFILE_TIMEOUT:"ad:internal:mediafileTimeout",MEDIAFILE_VENDOR_ERROR:"ad:internal:mediaFileVendorError",NOBANNER:"ad:internal:nobanner",XML_TIMEOUT:"ad:internal:xmlTimeout",XML_LOADED:"ad:internal:xmlLoaded",XML_LOADING_ERROR:"ad:internal:xmlLoadingError",XML_PARSING_ERROR:"ad:internal:xmlParsingError",BLOCK_STARTED_DE_FACTO:"ad:internal:blockStarted",MEMBER_STARTED_DE_FACTO:"ad:internal:memberStarted",MEMBER_BEGIN_LOADING:"ad:internal:memberBeginLoading",DUPLICATE_MEDIAFILE:"ad:internal:duplicateMediaFile",PAGE_CLOSING:"ad:internal:pageClosing",VAST_EVENT:"ad:internal:vastEvent",XML_INVALID:"ad:internal:xmlInvalid",MEDIA_BEGINS_LOADING:"ad:internal:mediaBeginsLoading",CANNOT_FIND_VENDOR:"ad:internal:cannotFindVendor",DEVICE_TYPE:"web",PROTOCOL:"http:",APP_VERSION:"",MNS_ADLIST:"mns:adlist",SKIP_AD:"ad:skipAd"},w=e("mggp-player").Plugin,A=e("mggp-player").AddonError;r.prototype.constructor=r,t.exports=r,i.createElement=function(e){var t;return m.isURLisIMA(e)?t=new E(e):m.isStringWithData(e)&&(t=new y(e)),t},i.prototype.constructor=i,a.prototype.constructor=a,o.prototype.constructor=o,o.SECONDS_TO_START=5,s.prototype.constructor=s,l.prototype.constructor=l,u.prototype.constructor=u,c.prototype.constructor=c,f._instance=null,f.initialize=function(e){f._instance=new f(e)},f.getInstance=function(){if(f._instance)return f._instance;throw new Error("AdURLModificator not initialized. Call AdURLModificator.initialize(refferer)")},p.prototype.constructor=p,p.RESPONSE_TYPE_JSON="json",p.RESPONSE_TYPE_TEXT="text",p.RESPONSE_TYPE_DOCUMENT="document",p.RESPONSE_TYPE_BLOB="blob",p.RESPONSE_TYPE_ARRAYBUFFER="arraybuffer",h.log=function(e){h._logCallback&&h._logCallback(e)},h.initialize=function(e){"function"==typeof e&&(h._logCallback=e)},h._logCallback=null,g.initialize=function(e){e&&(g._observer=e,g._initialized=!0)},g.emit=function(e,t){g._initialized&&g._observer.emit(e,t)},g.on=function(e,t){g._initialized&&(Array.isArray(e)?g._onEventsFromArray(e,t):g._observer.on(e,t))},g.off=function(e,t){g._initialized&&(Array.isArray(e)?g._offEventsFromArray(e,t):g._observer.off(e,t))},g.getObserverInstance=function(){return g._observer},g._onEventsFromArray=function(e,t){for(var n=0,r=e.length;n<r;++n)g.on(e[n],t)},g._offEventsFromArray=function(e,t){for(var n=0,r=e.length;n<r;++n)g.off(e[n],t)},g._initialized=!1,g._observer=null,m.isStringWithData=function(e){return e&&"string"==typeof e&&e.length>0},m.isURLisIMA=function(e){return!!e&&e.indexOf(".doubleclick")!=-1};var R={XML_PARSING_ERROR:100,VAST_VALIDATION_ERROR:101,VAST_NOT_SUPPORTED:102,PLAYER_CANNOT_DISPLAY:200,EXPECTING_DIFFERENT_LINEARITY:201,EXPECTING_DIFFERENT_DURATION:202,EXPECTING_DIFFERENT_SIZE:203,GENERAL_WRAPPER_ERROR:300,VAST_TAG_URI_TIMEOUT:301,WRAPPER_LIMIT_REACHED:302,NO_VAST_IN_WRAPPERS:303,UNABLE_TO_DISPLAY_LINEAR_AD:400,MEDIAFILE_URI_404:401,MEDIAFILE_URI_TIMEOUT:402,COUDNT_FIND_SUPPORTED_MEDIAFILE:403,COUDNT_DISPLAY_MEDIAFILE:405,GENERAL_NONLINEAR_ADS_ERROR:500,NONLINEAR_CREATIVE_TOO_LARGE:501,UNABLE_TO_FETCH_NONLINEAR_ADS:502,COUDNT_FIND_SUPPORTED_NONLINEAR_RESOURCE:503,GENERAL_COMPANION_AD:600,NO_AVAILABLE_SPACE_FOR_COMPANION_ADS:601,UNABLE_TO_DISPLAY_COMPANION:602,UNABLE_TO_FETCH_COMPANION:603,COUDNT_FIND_SUPPORTED_COMPANION_RESOURCE_TYPE:604,UNDEFINED_ERROR:900,GENERAL_VPAID_ERROR:901};v.initialize=function(e){v._errorURLs=e},v.track=function(e){if(v._errorURLs&&v._errorURLs.length)for(var t,n=0,r=v._errorURLs.length;n<r;++n){for(t=v._errorURLs[n];t.indexOf("[ERRORCODE]")!=-1;)t=t.replace("[ERRORCODE]",e);if(m.isStringWithData(t)){var i=document.createElement("img");i.src=t}}},v.reset=function(){v._errorURLs=null},v._errorURLs=null,y.prototype.constructor=y,_.prototype.constructor=_,E.prototype.constructor=E,b.prototype.constructor=b},{"mggp-player":21}],23:[function(e,t,n){function r(e,t){function n(e){m&&(m.addEventListener("webkitcurrentplaybacktargetiswireless",o),m.webkitShowPlaybackTargetPicker(),c.player.on("player:timeUpdate",s))}function r(e){1===e.data?v&&(v=!1,l()):0===e.data&&(c.player.off(d,n),u(h))}function a(e){switch(e.isTrusted&&m.removeEventListener("webkitplaybacktargetavailabilitychanged",a),e.availability){case"available":c.player.on(d,n),u(p);break;case"not-available":u(h),c.player.off(d,n)}}function o(e){m?(m.removeEventListener("webkitcurrentplaybacktargetiswireless",o),u(m.webkitCurrentPlaybackTargetIsWireless?g:p)):u(h),c.player.off("player:timeUpdate",s)}function s(e){m?y!==g&&m.webkitCurrentPlaybackTargetIsWireless?(u(g),c.player.off("player:timeUpdate",s)):y!==g||m.webkitCurrentPlaybackTargetIsWireless||(u(p),c.player.off("player:timeUpdate",s)):(u(h),c.player.off("player:timeUpdate",s))}function l(){window.WebKitPlaybackTargetAvailabilityEvent?(m=c.player.getPlayableElement(),m?m.addEventListener("webkitplaybacktargetavailabilitychanged",a):a({availability:!1})):a({availability:!1})}function u(e){y=e,c.player.set(f,e)}i.apply(this,arguments);var c=this,d="airplay:event:buttonClick",f="airplay:state",p="available",h="notAvailable",g="connected",m=null,v=!0,y=h;c.player.registerProperty(f,h,!0),c.player.on("player:stateChange",r),this.dispose=function(){c.player.off(d,n),c.player.off("player:stateChange",r),c.player.off("player:timeUpdate",s),m&&(m.removeEventListener("webkitplaybacktargetavailabilitychanged",a),m.removeEventListener("webkitcurrentplaybacktargetiswireless",o)),u(h),v=!1,m=null},this.load=function(e,t,n){v=!0}}var i=e("mggp-player").Plugin;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"mggp-player":21}],24:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginAudio=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){var r=e("mggp-player").Plugin,i=function(){function e(e){var t=null;if(o&&o.length>0)for(var n=0,r=o.length;n<r;++n)if(o[n].index==e){t=o[n];break}return t}function t(e){var t=-1;if(o&&o.length>0)for(var n=0,r=o.length;n<r;++n)if(o[n].id==e){t=o[n].index;break}return t}r.apply(this,arguments);var n=this,i=n.player,a=null,o=[],s=0,l=!1,u=!1;this.dispose=function(){n.log("MggpPluginAudio.dispose()"),E(!1),i=null,a=null,o=null};var c=function(){n.log("MggpPluginAudio.onPlayerStop()"),l=!0,u=!1,i.on("property:videoInfo",f),a=null,o=[]},d=function(e){u||1!=e.data||(u=!0)},f=function(t){if(n.log("MggpPluginAudio.onVideoInfoChange()"),a=t.data||{},s=0,o=a.audio_tracks||[],i.set("audioTrackList",o),l&&(l=!1,E(!0)),!u){var r=e(y());r&&i.set("audioTrack",r.id)}},p=function(e){n.log("MggpPluginAudio.onSrcChange("+e.data+")"),i.off("property:src",p);i.get("vendorOptions")},h=function(e){if(n.log("MggpPluginAudio.changeByName("+e+")"),o.length>0){for(var t=0;t<o.length;t++)if(o[t].lang==e)return void m({data:o[t].id});m({data:s})}else m({data:s})},g=function(){n.log("MggpPluginAudio.onQualityNeedChange()"),i.on("property:src",p)},m=function(r){if(n.log("MggpPluginAudio.onAudioTrackNeedChange("+r.data+")"),"string"==typeof r.data)return void h(r.data);var l=parseInt(r.data)||0,u=t(l),c=e(y());if(c&&l!=c.id&&u!=-1){for(var d=0;d<o.length;d++){var f=o[d];if(f.id==l){s=l;var p=i.get("vendorOptions")||{};p.startSeconds=p.startSeconds||i.get("position");var g=i.get("src")||a.src;return i.load(_(g,u),i.get("videoInfo"),p),void i.set("audioTrack",f.id)}}v()}else v()},v=function(){n.log("MggpPluginAudio.loadDefault()"),i.load(i.get("src"),i.get("videoInfo"),i.get("vendorOptions"))},y=function(){var e=0,t=i.get("src")||a.src;if(t&&t.indexOf("/a/")!=-1)for(var n=t.split("/"),r=0;r<n.length;r++)if("a"==n[r]&&n[r+1]){e=parseInt(n[r+1]);break}return e},_=function(e,t){return e&&e.indexOf("/a/")!=-1?e.replace("/a/"+y(),"/a/"+t):(n.log("MggpPluginAudio.loadDefault("+e+")"),e)},E=function(e){n.log("MggpPluginAudio.tooggleEvents("+e+")"),e?(i.on("property:videoInfo",f),i.on("property:state",d),i.on("player:audioTackNeedChange",m),i.on("player:qualityNeedChange",g),i.on("player:stop",c)):(i.off("property:videoInfo:",f),i.off("player:qualityNeedChange",g),i.off("player:audioTackNeedChange",m),i.off("player:stop",c))};E(!0)};i.prototype=Object.create(r.prototype),i.prototype.constructor=i,t.exports=i},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],25:[function(e,t,n){function r(e,t){function n(){u.player.on("player:timeUpdate",s)}function a(){u.player.off("player:timeUpdate",s)}function o(e){"connected"!==u.player.get("airplay:state")&&3===e.data&&n()}function s(){if(c.seeking)return d&&(d=!1,c.play()),void a();if(c.duration>=r.MIN_ACCEPTED_DURATION&&c.duration-c.currentTime>r.MIN_BUFFER){c.paused||(d=!0,c.pause());var e=l(c);e>=r.MIN_BUFFER&&(a(),d&&(d=!1,c.play()))}else a()}function l(e){var t=-1;if(e&&e.buffered)for(var n=e.buffered,r=0,i=n.length;r<i;++r)if(n.start(r)-3<=e.currentTime&&n.end(r)>=e.currentTime){t=n.end(r)-e.currentTime;break}return t}i.apply(this,arguments);var u=this,c=null,d=!1;this.dispose=function(){u.player.off("property:state",o),u.player.off("player:timeUpdate",s),c=null,d=!1},this.setVideo=function(e){c=e,c&&u.player.on("property:state",o)}}var i=e("mggp-player").Plugin;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.MIN_BUFFER=10,r.MIN_ACCEPTED_DURATION=60,t.exports=r},{"mggp-player":21}],26:[function(e,t,n){"use strict";function r(t,n){function r(e){e.data&&e.data.levels&&e.data.levels.length>1&&(w.player.set("hlsBitrates",e.data.levels),w.player.get(g)===y&&s(R)),w.player.off("player:hls:manifestParsed",r)}function i(e){if(e.data===b)R?(w.player.set(g,_),s(R)):d();else if(e.data===T){var t=w.player.get("src").replace(".cast","");if(t){var n=w.player.get("audioTrack"),r=-1,i=w.player.get("qualityList"),a=w.player.get("quality");if(a!=-1)for(var o=0,l=i.length;o<l;++o)if(i[o].bitrate==a){r=i[o].index;break}w.player.load(t,w.player.get("videoInfo"),Object.assign({},w.player.get("vendorOptions"),{startSeconds:w.player.get("position"),quality:r,defaultAudioTrack:n}))}R&&(R.stop(),R=null),w.player.set(g,m)}}function a(e){if(e.data){var t=w.player.utils.getExtension(e.data);"m3u8"===t&&f(e.data)}}function o(e){w.player.set(E,null),w.player.set(g,v),console.log(w.namespace,e)}function s(e){R=e;var t=w.player.get("src").replace(/\.cast$/,""),n=w.player.get("quality");if(n!=-1&&w.player.get("hlsBitrates")){var r=w.player.get("hlsBitrates");if(r&&r.length>1)for(var i,a=0,o=r.length;a<o;++a){try{i=parseInt(r[a].name)}catch(s){}if(n===i){t=r[a].url[0];break}}}f(t)}function l(e){console.log(w.namespace,"session request error:",e.code),w.player.set(g,m)}function u(e){A=e,w.player.set(E,A),w.player.set(g,y);var t;t="cast"!==w.player.utils.getExtension(w.player.get("src"))?w.player.get("src")+".cast":w.player.get("src"),w.player.load(t,w.player.get("videoInfo"),Object.assign({},w.player.get("vendorOptions")))}function c(){function e(){var e=new chrome.cast.SessionRequest(chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID),t=new chrome.cast.ApiConfig(e,function(e){console.log(w.namespace,"receiver info: success")},function(e){e===chrome.cast.ReceiverAvailability.AVAILABLE});chrome.cast.initialize(t,function(){console.log(w.namespace,"api initialized"),S=!0,w.player.set(g,m)},function(e){o(e)})}chrome.cast.isAvailable?e():window.__onGCastApiAvailable=function(t,n){t?e():o()}}function d(){w.player.set(g,_),chrome.cast.requestSession(s,l)}function f(e){var t=new chrome.cast.media.MediaInfo(e);t.contentType=n.mimeType||w.player.utils.getExtension(e),t.metadata=new chrome.cast.media.GenericMediaMetadata,t.metadata.title=w.player.get("videoInfo").title;var r=new chrome.cast.media.LoadRequest(t);r.currentTime=w.player.get("position"),r.autoplay=1===w.player.get("state")||w.player.get(g)===y,R.loadMedia(r,u,function(e){w.player.set(g,m)})}var p=e("mggp-player").Plugin,h=["mp4","webm","bmp","gif","jpeg","png","webp","m3u8","cast"];p.apply(this,arguments),this.namespace="chromecast:";var g="chromecastState",m="available",v="notAvailable",y="connected",_="connecting",E="chromecastMedia",b="needToConnect",T="needToDisconnect",w=this,A=null,R=null,S=!1;this.player.registerProperty(g,v,!0),this.player.on("chromecast",i),this.player.on("chromecastQualityChange",a),this.dispose=function(){R&&(R.stop(),R=null),A=null,w.player.set(E,null),w.player.set(g,v)},this.load=function(e,t){var n=e||t.src;if(!n||t&&t.is_live||w.player.get("epg:currentChannel"))return void w.player.set(g,v);var i=w.player.utils.getExtension(n);"m3u8"===i?w.player.on("player:hls:manifestParsed",r):w.player.off("player:hls:manifestParsed",r),S||(h.indexOf(i)!==-1&&window.chrome&&window.chrome.cast?c():w.player.set(g,v))}}r.prototype.constructor=r,t.exports=r},{"mggp-player":21}],27:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginComscore=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("mggp-player"),l="https://s9.vcdn.biz/static/47558161/comscore.streaming.6.1.0.170130.min.js",u=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s.config.comscore&&(s._streamingAnalytics=null,s.namespace="comscore:",s._memberStarted=!1,s._onAdMemberComplete=s._onAdMemberComplete.bind(s),s._onAdStarted=s._onAdStarted.bind(s),s._onStateChange=s._onStateChange.bind(s),s._load()),s}return a(t,e),o(t,[{key:"dispose",value:function(){this._toggleListeners(!1),this._memberStarted=!1}},{key:"_load",value:function(){if("ns_"in window)this._init();else{var e=document.createElement("script");e.addEventListener("error",this._error.bind(this)),e.addEventListener("load",this._init.bind(this)),e.src=l,document.head.appendChild(e)}}},{key:"_init",value:function(){this._streamingAnalytics=new ns_.ReducedRequirementsStreamingAnalytics({publisherId:this.player.config.comscore.id}),this._toggleListeners(!0)}},{key:"_toggleListeners",value:function(e){e?(this.player.on("ad:external:memberStartedPlaying",this._onAdStarted),this.player.on("ad:blockMember:complete",this._onAdMemberComplete),this.player.on("player:stateChange",this._onStateChange)):(this.player.off("ad:external:memberStartedPlaying",this._onAdStarted),this.player.off("ad:blockMember:complete",this._onAdMemberComplete),this.player.off("player:stateChange",this._onStateChange))}},{key:"_onAdMemberComplete",value:function(e){this._memberStarted&&(this._memberStarted=!1,this._streamingAnalytics.stop())}},{key:"_onStateChange",value:function(){var e=this.player.get("state"),t=this.player.get("videoInfo"),n={ns_st_ci:t.video_id,ns_st_cl:0,ns_st_pu:"mgg",ns_st_pr:t.title,ns_st_ep:"",ns_st_sn:0,ns_st_en:0,ns_st_ge:"",ns_st_ddt:"",ns_st_st:""};switch(e){case 1:this._streamingAnalytics.playVideoContentPart(n,ns_.ReducedRequirementsStreamingAnalytics.ContentType.LongFormOnDemand);break;case 2:case 0:this._streamingAnalytics.stop()}}},{key:"_onAdStarted",value:function(e){this._memberStarted=!0,this._fire(e.data.type.toLowerCase())}},{key:"_fire",value:function(e){var t="";switch(e){case"preroll":t=ns_.ReducedRequirementsStreamingAnalytics.AdType.LinearOnDemandPreRoll;break;case"midroll":t=ns_.ReducedRequirementsStreamingAnalytics.AdType.LinearOnDemandMidRoll;break;case"postroll":t=ns_.ReducedRequirementsStreamingAnalytics.AdType.LinearOnDemandPostRoll;break;default:t=ns_.ReducedRequirementsStreamingAnalytics.AdType.Other}this._streamingAnalytics.playVideoAdvertisement({ns_st_cl:1e3*this.player.get("ad:vendor:duration")||0},t)}},{key:"_error",value:function(e){e instanceof Error&&(e=e.message),this.emit("error",new s.AddonError(this.player,"","","Cannot load comscore script from url "+l))}}]),t}(s.Plugin);n["default"]=u},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],28:[function(e,t,n){function r(e,t){function n(e){if(2===e.data)D===E?(M=L.player.get(PROPERTY_CURRENT_PROGRAM_TIME),F=!0,p(b)):D===b&&(F=!0);else if(0===e.data){if(D===T){var t=P.getNextProgram(L.player.get(A));t&&t.endTimestamp<=P.currentProgram.startTimestamp?(L.player.set(A,t),s({data:t})):(L.player.set(A,P.currentProgram),l(null,!0))}}else if(1===e.data){var n=(new Date).getTime()/1e3;if(D===b&&F){F=!1;var r=Math.round(L.player.get(PROPERTY_CURRENT_PROGRAM_TIME)-M);c(N,r)}void 0!==M&&(x=n)}}function r(e){P=e.data,P&&L.player.off("property:epg:currentChannel",r),P&&"dvrChannel"===P.type?(p(_),P.currentProgram&&(L.player.set(A,P.currentProgram),L.player.set(R,P.currentProgram.endTimestamp-P.currentProgram.startTimestamp),a({data:P}))):h()}function a(e,t){if(D!==T)if(D===b){var n=L.player.get(k);s({data:L.player.get(A)},n)}else{var r=P.currentProgram;if(L.player.set(A,r),L.player.set(R,r.endTimestamp-r.startTimestamp),D===_||D===E){var i=void 0;t?(M=0,p(b),i=Math.round(L.player.get(S))):(p(E),M=void 0),L.player.get("src")!==C.src&&c(C.src,i)}}}function o(e){var t=L.player.get(S);e.data<t&&L.player.set(k,e.data);var n=Math.round(L.player.get(S)-e.data);M=e.data,L.player.set("wss:ignore:stopEvent",!0),L.player.set("wss:ignore:videoInfoEvent",!0);var r=2==L.player.get("state");D===E?e.data<t&&(c(C.src,n,r),p(b)):D===b&&(e.data<t?c(C.src,n,r):(M=void 0,c(C.src,void 0,void 0),p(E)))}function s(e,t){L.player.config&&"function"==typeof L.player.config.getVirtualStream&&(L.player.set(A,e.data),L.player.set(R,e.data-e.data),L.player.config.getVirtualStream(C.video_id,e.data.virtualObjectId,function(n){var r=L.player.config.getStreamFromData(n);r?(r.title=e.data.title,r.bitrates=C.bitrates,r.audio_tracks=C.audio_tracks,r.audio_tracks=C.audio_tracks,r.share_link=C.share_link,r.start_session_url=C.start_session_url,r.messages=C.messages,L.player.set(O,r.air_time_description),d(r,t,e.data.clickedFromProgramsPanel)):L.player.emit("mediaError",{name:L.constructor.name,type:"streamError",code:"loadingError",message:"Cannot load virtual stream. Channel video id:"+C.video_id+" virtual object id:"+e.data.virtualObjectId,fatal:!0})}))}function l(e,t){P&&(M=void 0,e&&e.data&&e.data.startFromZero===!0&&(t=!0),p(E),a({data:P},t))}function u(){if(D!==y&&P&&P.currentProgram)if(D===E){var e=L.player.get(S);L.player.set(k,e)}else if(D===b&&1===L.player.get("state")&&v(N)){var t=(new Date).getTime()/1e3;M+=t-x,L.player.set(k,M),x=t}}function c(e,t,n){L.player.set(O,null);var r=t>0?f(t,e):e,i={defaultAudioTrack:g(L.player.get("audioTrack")),defaultSubtitles:L.player.get("subtitles"),defaultQuality:L.player.get("quality")};n&&(i.autoplay=!1),L.player.stop(),C=Object.assign({},C),L.player.load(r,C,i)}function d(e,t,n){var r={defaultSubtitles:L.player.get("subtitles"),defaultQuality:L.player.get("quality"),autoplay:n||2!==L.player.get("state")};t&&(r.startSeconds=t),p(T),L.player.stop(),L.player.load(e.src,e,r)}function f(e,t){t=t.replace("meta","vs7");var n,r,i=/\/ts\/\d+/;return r=t.search(i),r==-1?(n=t.lastIndexOf("/type.live"),t=t.substring(0,n)+"/ts/"+e.toString()+t.substring(n)):t=t.replace(i,"/ts/"+e.toString()),t}function p(e){D=e,L.player.set(w,e)}function h(){L.player.set("vendor:dismissSeekToLiveAfterPause",!1),L.player.off("property:epg:currentChannel",r),L.player.off("epg:currentProgramChanged",a),L.player.off("dvrchannel:playProgram",s),L.player.off("dvrchannel:backOnAir",l),L.player.off("player:timeUpdate",u),L.player.off("dvrchannel:dvrSeek",o),L.player.off("property:state",n),L.player.set(O,null)}function g(e){var t="",n=L.player.get("audioTrackList");if(n&&n.length>0)for(var r=0,i=n.length;r<i;++r)if(n[r].index===e){t=n[r].lang;break}return t}function m(e){var t="",n=e.match(/\/o\/\d+/);return n&&n.length>0&&(t=n[0].replace("/o/","")),t}function v(e){return e.indexOf("/vs/")!==-1||e.indexOf("/vo/")!==-1||e.indexOf("/ts/")!==-1}i.apply(this,arguments);var y="disabled",_="available",E="onAir",b="timeshift",T="catchup",w="interactiveChannel:channelState",A="interactiveChannel:currentPlayingProgram",R="interactiveChannel:currentProgramDuration",S="epg:currentProgramTime",k="interactiveChannel:currentPlayingTime",O="dvrChannel:catchupDescription",L=this,C=null,D=y,P=null,I="",N="",M=void 0,x=0,F=0;L.player.registerProperty(w,y,!0),L.player.registerProperty(A,null,!0),L.player.registerProperty(R,null,!0),L.player.registerProperty(k,null,!0),L.player.registerProperty(S,null,!0),L.player.registerProperty(O,null,!0),this.dispose=function(){h()},this.load=function(e,t,i){if(N=e?e:t&&t.src?t.src:"",!C||t&&C.video_id!==t.video_id)if(C=t)if(C.is_dvr_channel||"tv_dvr"===C.content_type){L.player.set("vendor:dismissSeekToLiveAfterPause",!0),L.player.on("epg:currentProgramChanged",a),L.player.on("dvrChannel:playProgram",s),L.player.on("dvrChannel:backOnAir",l),L.player.on("dvrChannel:seek",o),L.player.on("property:state",n),L.player.on("player:timeUpdate",u),e?I=m(e):t&&t.src&&(I=m(t.src));var c=L.player.get("epg:currentChannel");c?r({data:c}):L.player.on("property:epg:currentChannel",r)}else h();else h()}}var i=e("mggp-player").Plugin;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"mggp-player":21}],29:[function(e,t,n){function r(e,t){function n(e){if(2===e.data)I===b?(F=D.player.get(L),B=!0,p(T)):I===T&&(B=!0);else if(0===e.data){if(I===w){var t=N.getNextProgram(D.player.get(R));t&&t.endTimestamp<=N.currentProgram.startTimestamp?(D.player.set(R,t),s({data:t})):(D.player.set(R,N.currentProgram),l(null,!0))}}else if(1===e.data){var n=(new Date).getTime()/1e3;if(I===T&&B){B=!1;var r=Math.round(D.player.get(L)-F);c(x,r)}void 0!==F&&(U=n)}}function r(e){N=e.data,N&&D.player.off("property:epg:currentChannel",r),N&&"dvrChannel"===N.type?(p(E),N.currentProgram&&(D.player.set(R,N.currentProgram),m(N.currentProgram),a({data:N}))):h()}function a(e,t){if(I!==w)if(I===T){var n=D.player.get(C);s({data:D.player.get(R)},n)}else{var r=N.currentProgram;if(D.player.set(R,r),m(r),I===E||I===b){var i=void 0;t?(F=0,p(T),i=Math.round(D.player.get(L))):(p(b),F=void 0),D.player.get("src")!==P.src&&c(P.src,i)}}}function o(e){var t=D.player.get(L);e.data<t&&D.player.set(C,e.data);var n=Math.round(D.player.get(L)-e.data);F=e.data,D.player.set("wss:ignore:stopEvent",!0),D.player.set("wss:ignore:videoInfoEvent",!0);var r=2==D.player.get("state");I===b?e.data<t&&(c(P.src,n,r),p(T)):I===T&&(e.data<t?c(P.src,n,r):(F=void 0,c(P.src,void 0,void 0),p(b)))}function s(e,t){if(D.player.config){D.player.set(R,e.data);var n=e.data.title,r="//megogo.net/b/epg_info/"+M+"/"+e.data.virtualObjectId,i=D.player.config.getDefaultLoader();i.load(r,function(r){var i=D.player.config.getStreamFromData(r);i.title=n,i.bitrates=P.bitrates,i.audio_tracks=P.audio_tracks,i.audio_tracks=P.audio_tracks,i.share_link=P.share_link,i.start_session_url=P.start_session_url,i.messages=P.messages,d(i,t,e.data.clickedFromProgramsPanel)},function(e){D.player.emit("mediaError",{name:_this.constructor.name,type:"streamError",code:"loadingError",message:"Cannot load stream from "+r,fatal:!0})})}}function l(e,t){N&&(F=void 0,p(b),a({data:N},t))}function u(){if(I!==_&&N&&N.currentProgram){var e=Math.floor((new Date).getTime())/1e3-N.currentProgram.startTimestamp+D.player.get("epg:timeOffset");if(D.player.set(L,e),I===b)D.player.set(C,e);else if(I===T&&1===D.player.get("state")&&y(x)){var t=(new Date).getTime()/1e3;F+=t-U,D.player.set(C,F),U=t}}}function c(e,t,n){var r=t>0?f(t,e):e,i={defaultAudioTrack:g(D.player.get("audioTrack")),defaultSubtitles:D.player.get("subtitles"),defaultQuality:D.player.get("quality")};n&&(i.autoplay=!1),D.player.stop(),P=Object.assign({},P),D.player.load(r,P,i)}function d(e,t,n){var r={defaultSubtitles:D.player.get("subtitles"),defaultQuality:D.player.get("quality"),autoplay:n||2!==D.player.get("state")};t&&(r.startSeconds=t),p(w),D.player.stop(),D.player.load(e.src,e,r)}function f(e,t){t=t.replace("meta","vs7");var n,r,i=/\/ts\/\d+/;return r=t.search(i),r==-1?(n=t.lastIndexOf("/type.live"),t=t.substring(0,n)+"/ts/"+e.toString()+t.substring(n)):t=t.replace(i,"/ts/"+e.toString()),t}function p(e){I=e,D.player.set(A,e)}function h(){D.player.set("vendor:dismissSeekToLiveAfterPause",!1),p(_),D.player.off("property:epg:currentChannel",r),D.player.off("epg:activeChannelCurrentProgramChanged",a),D.player.off("dvrchannel:playProgram",s),D.player.off("dvrchannel:backOnAir",l),D.player.off("player:timeUpdate",u),D.player.off("dvrchannel:dvrSeek",o),D.player.off("property:state",n)}function g(e){var t="",n=D.player.get("audioTrackList");if(n&&n.length>0)for(var r=0,i=n.length;r<i;++r)if(n[r].index===e){t=n[r].lang;break}return t}function m(e){e&&(D.player.set(S,e.startTimestamp),D.player.set(k,e.endTimestamp),D.player.set(O,e.endTimestamp-e.startTimestamp))}function v(e){var t="",n=e.match(/\/o\/\d+/);return n&&n.length>0&&(t=n[0].replace("/o/","")),t}function y(e){return e.indexOf("/vs/")!==-1||e.indexOf("/vo/")!==-1||e.indexOf("/ts/")!==-1}i.apply(this,arguments);var _="disabled",E="available",b="onAir",T="timeshift",w="catchup",A="dvrchannel:channelState",R="dvrchannel:currentDvrProgram",S="dvrchannel:currentProgramStart",k="dvrchannel:currentProgramEnd",O="dvrchannel:currentProgramDuration",L="dvrchannel:currentProgramTime",C="dvrchannel:currentPosition",D=this,P=null,I=_,N=null,M="",x="",F=void 0,U=0,B=0;D.player.registerProperty(A,_,!0),D.player.registerProperty(R,null,!0),D.player.registerProperty(S,null,!0),D.player.registerProperty(k,null,!0),D.player.registerProperty(O,null,!0),D.player.registerProperty(C,null,!0),D.player.registerProperty(L,null,!0),this.dispose=function(){h()},this.load=function(e,t,i){if(x=e?e:t&&t.src?t.src:"",!P||t&&P.video_id!==t.video_id)if(P=t)if(P.is_dvr_channel){D.player.set("vendor:dismissSeekToLiveAfterPause",!0),D.player.on("epg:activeChannelCurrentProgramChanged",a),D.player.on("dvrchannel:playProgram",s),D.player.on("dvrchannel:backOnAir",l),D.player.on("dvrchannel:dvrSeek",o),D.player.on("property:state",n),D.player.on("player:timeUpdate",u),e?M=v(e):t&&t.src&&(M=v(t.src));var c=D.player.get("epg:currentChannel");c?r({data:c}):D.player.on("property:epg:currentChannel",r)}else h();else h()}}var i=e("mggp-player").Plugin;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"mggp-player":21}],30:[function(e,t,n){function r(e,t,n,r,i,o,l,c){function d(e,t){var n=!1;return e&&t&&(n=e.startTimestamp===t.startTimestamp&&e.endTimestamp===t.endTimestamp&&e.title===t.title),n}function f(e,t){var n;if(e){var r,i;for(r=t>0?t:0,i=R.length;r<i;++r)if(R[r].startTimestamp<=e&&R[r].endTimestamp>=e){n=R[r];break}!n&&r>=i&&s.emit(u.EVENT_NEED_TO_LOAD_NEW_PROGRAM,g)}return n}function p(e){for(var t,n=[],r=0,i=e.length;r<i;++r)t=new a,t.setData(e[r]),n.push(t);return n}var h,g=this,m=e,v=t,y=n,_=r,E=i,b=o,T=l,w=c,A=null,R=null,S=null,k=!1;this._setProgramData=function(e){A=e,A&&(R=p(A),s.emit(u.EVENT_PROGRAMS_UPDATED,g))},this._setType=function(e){h=e},this.update=function(e){if(e&&R&&R.length>0){var t;S?S.endTimestamp<e?t=f(e,R.indexOf(S)):S.startTimestamp>e&&(t=f(e)):t=f(e),t&&!d(t,S)&&(S=t,s.emit(u.EVENT_CURRENT_PROGRAM_CHANGED,g),k&&s.emit(u.EVENT_ACTIVE_CHANNEL_CURRENT_PROGRAM_CHANGED,g))}},this.getNextProgram=function(e){var t=null;if(e)for(var n=0,r=R.length;n<r;++n)if(R[n].startTimestamp===e.startTimestamp&&n+1<r){t=R[n+1];break}return t},Object.defineProperties(this,{title:{enumerable:!0,configurable:!1,get:function(){return m}},pictureUrlsArray:{enumerable:!0,configurable:!1,get:function(){return v}},isActive:{enumerable:!0,configurable:!1,get:function(){return k},set:function(e){e!=k&&(k=e,e?s.emit(u.EVENT_NEED_TO_LOAD_EXTENDED_PROGRAM,g):s.emit(u.EVENT_NEED_TO_LOAD_NEW_PROGRAM,g))}},currentProgram:{enumerable:!0,configurable:!1,get:function(){return S}},epgId:{enumerable:!0,configurable:!1,
get:function(){return y}},megogoId:{enumerable:!0,configurable:!1,get:function(){return _}},originalCategoryTitle:{enumerable:!0,configurable:!1,get:function(){return E}},categoryIndex:{enumerable:!0,configurable:!1,get:function(){return b}},isFavorite:{enumerable:!0,configurable:!1,get:function(){return T}},isInteractive:{enumerable:!0,configurable:!1,get:function(){return w}},programs:{enumerable:!0,configurable:!1,get:function(){return R}},type:{enumerable:!0,configurable:!1,get:function(){return h}}})}function i(){function e(e,r,i){try{n=!1,t=new XMLHttpRequest,t.open("GET",e,!0),t.onreadystatechange=function(){4==t.readyState&&(n||(200==t.status?(r(t.responseText),t=null):(i("Error loading "+e),t=null)))},t.send(null)}catch(a){i("Error loading "+e),t=null}}var t,n=!1;this.loadTime=function(t,n){if(t){var r=t+"/time";e(r,function(e){n(e,null)},function(e){n(null,e)})}else n&&n(null,"You didn't provide epgUrl")},this.loadChannels=function(t,n,r,i){if(void 0!==i&&null!==i||(i=0),t&&n&&n.length>0&&"function"==typeof r){for(var a=t+"/channel?external_id=",o=0,s=n.length;o<s;++o)a+=n[o]+",";","===a[a.length-1]&&(a=a.substr(0,a.length-1));var l=Math.round((new Date).getTime()/1e3);a+="&from="+(l+i)+"&to="+(l+i),e(a,function(e){r(e,null)},function(e){r(null,e)})}else n&&r?r(null,"channelsIds array is empty or not an array object"):r&&r(null,"You didn't provide epgUrl or channelsIds array")},this.loadExtendedProgram=function(t,n,r,i){if(void 0!==i&&null!==i||(i=0),t&&void 0!==n&&null!==n&&"function"==typeof r){var a=t+"/channel?external_id="+n,o=864e5,s=new Date,l=36e5*s.getHours()+6e4*s.getMinutes()+1e3*s.getSeconds()+s.getMilliseconds(),u=s.getTime()-l;a+="&from="+(new Date(u-7*o).getTime()/1e3+i)+"&to="+(new Date(u+7*o).getTime()/1e3+i),e(a,function(e){r(e,null)},function(e){r(null,e)})}else void 0!==n&&null!==n||!r?r&&r(null,"You didn't provide epgUrl or channelId"):r(null,"Bad channelId")},this.abort=function(){t&&(t.abort(),n=!0)}}function a(){var e="",t=0,n=0,r=null,i=null,a="",o=null;this.setData=function(s){"description"in s&&(e=s.description),"start_timestamp"in s&&(t=s.start_timestamp),"end_timestamp"in s&&(n=s.end_timestamp),"object_id"in s&&(r=s.object_id),"pictures"in s&&(i=s.pictures),"title"in s&&(a=s.title),"virtual_object_id"in s&&(o=s.virtual_object_id)},Object.defineProperties(this,{title:{enumerable:!0,configurable:!1,get:function(){return a}},description:{enumerable:!0,configurable:!1,get:function(){return e}},startTimestamp:{enumerable:!0,configurable:!1,get:function(){return t}},endTimestamp:{enumerable:!0,configurable:!1,get:function(){return n}},objectId:{enumerable:!0,configurable:!1,get:function(){return r}},virtualObjectId:{enumerable:!0,configurable:!1,get:function(){return o}},duration:{enumerable:!0,configurable:!1,get:function(){return n-t}}})}function o(e,t,n,a){function o(e){var t=[];b={};for(var n=0,r=e.length;n<r;++n)t.push(e[n].epgId),b[e[n].epgId]={megogoId:e[n].id,originalCategoryTitle:e[n].originalCategoryTitle,categoryIndex:e[n].categoryIndex,isFavorite:e[n].isFavorite,isInteractive:e[n].isInteractive};var a=new i;a.loadChannels(w,t,function(e,t){if(!T)if(e){var n=f(e);n?(c(n),l(u.MESSAGE_CHANNELS_LOADED)):l(u.MESSAGE_CHANNELS_LOADING_ERROR)}else t&&l(u.MESSAGE_CHANNELS_LOADING_ERROR)},E)}function l(e,t){"function"==typeof v&&v(e,t)}function c(e){var t;y=[];for(var n=0,i=e.length;n<i;++n)t=new r(e[n].title,e[n].pictures,e[n].external_id,b[e[n].external_id].megogoId,b[e[n].external_id].originalCategoryTitle,b[e[n].external_id].categoryIndex,b[e[n].external_id].isFavorite,b[e[n].external_id].isInteractive),t.megogoId===A&&(t.isActive=!0,t._setType(k),S=t,s.set(u.PROPERTY_CURRENT_CHANNEL,t)),t._setProgramData(e[n].programs),y.push(t);g(y),s.set(u.PROPERTY_CHANNELS,y),h()}function d(e){var t,n=e.data;switch(e.name){case u.EVENT_NEED_TO_LOAD_NEW_PROGRAM:t=new i,t.loadChannels(w,[n.epgId],function(e,t){p(e,n)},E);break;case u.EVENT_NEED_TO_LOAD_EXTENDED_PROGRAM:t=new i,t.loadExtendedProgram(w,n.epgId,function(e,t){p(e,n)},E)}}function f(e){var t=null;if(e)try{var n=JSON.parse(e);n&&"ok"==n.result&&n.data&&(t=n.data)}catch(r){}return t}function p(e,t){if(t)if(e){var n=f(e);n.length>0&&n[0]?t._setProgramData(n[0].programs):t._setProgramData(null)}else t._setProgramData(null)}function h(){var e=[];for(var t in _)e.push(t);var n=m();if(n){var r,i=n.category,a=n.index;a>0?s.set(u.PROPERTY_PREV_CHANNEL,_[i].channels[a-1]):(r=e.indexOf(i),0===r?r=e.length-1:--r,s.set(u.PROPERTY_PREV_CHANNEL,_[e[r]].channels[_[e[r]].channels.length-1])),a<_[i].channels.length-1?s.set(u.PROPERTY_NEXT_CHANNEL,_[i].channels[a+1]):(r=e.indexOf(i),r===e.length-1?r=0:++r,s.set(u.PROPERTY_NEXT_CHANNEL,_[e[r]].channels[0]))}}function g(e){var t,n,r=[],i="favoriteChannels";i=i.toUpperCase(),_={},r.push({index:0,title:i,channels:[]});for(var a=0,o=e.length;a<o;++a)e[a].isFavorite?r[0].channels.push(e[a]):(t=e[a].originalCategoryTitle.toUpperCase(),n=e[a].categoryIndex,r[n]||(r[n]={index:n,title:t,channels:[]}),r[n].channels.push(e[a]));for(r.sort(function(e,t){return e.index-t.index}),a=0,o=r.length;a<o;++a)_[r[a].title]={channels:r[a].channels};s.set(u.PROPERTY_CHANNEL_BY_CATEGORIES,_)}function m(){var e=null;e:for(var t in _)for(var n=0,r=_[t].channels.length;n<r;++n)if(_[t].channels[n].isActive){e={category:t,index:n};break e}return e}var v=e,y=null,_=null,E=0,b=null,T=!1,w=t,A=n,R=0,S=null,k=a;s.on([u.EVENT_NEED_TO_LOAD_EXTENDED_PROGRAM,u.EVENT_NEED_TO_LOAD_NEW_PROGRAM],d),s.registerProperty(u.PROPERTY_CURRENT_CHANNEL,null,!0),s.registerProperty(u.PROPERTY_TIME_OFFSET,0,!0),this.dispose=function(){T=!0,S=null,A=null,E=0,R=0,s.off([u.EVENT_NEED_TO_LOAD_EXTENDED_PROGRAM,u.EVENT_NEED_TO_LOAD_NEW_PROGRAM],d),s.set(u.PROPERTY_CHANNELS,null),s.set(u.PROPERTY_CURRENT_CHANNEL,null),s.set(u.PROPERTY_NEXT_CHANNEL,null),s.set(u.PROPERTY_PREV_CHANNEL,null),s.set(u.PROPERTY_STATE,null)},this.start=function(e){var t=new i;t.loadTime(w,function(t,n){if(!T){if(t){var r=f(t);r&&r.timestamp&&(E=Math.round((new Date).getTime()/1e3)-r.timestamp,s.set(u.PROPERTY_TIME_OFFSET,E))}o(e)}})},this.update=function(){if(y&&0!==y.length){var e=Math.round((new Date).getTime()/1e3);if(e-R>=1){for(var t=0,n=y.length;t<n;++t)y[t].update(e+E);R=e}}},this.setCurrentId=function(e,t){A=e,S.megogoId!==e&&(S.isActive=!1,S=null);for(var n=0,r=y.length;n<r;++n)if(y[n].megogoId===e){y[n].isActive=!0,S=y[n],S._setType(t),k=t,s.set(u.PROPERTY_CURRENT_CHANNEL,S),h(n);break}}}function s(){}function l(e,t){function n(e){var t=e.data;if(p!=t)if(t&&t.channels&&t.epg_url){p=t,g=p.video_id||2118461,f=t.epg_url;var n=u.CHANNEL_TYPE_REGULAR;p.is_vod_channel?n=u.CHANNEL_TYPE_VOD:p.is_dvr_channel&&(n=u.CHANNEL_TYPE_DVR),h?h.setCurrentId(g,n):(d=a(t.channels),h=new o(r,f,g,n),l.player.set(u.PROPERTY_STATE,u.STATE_LOADING),h.start(d))}else l.player.get(u.PROPERTY_CURRENT_CHANNEL)||(h&&h.dispose(),h=null)}function r(e,t){switch(e){case u.MESSAGE_CHANNELS_LOADING_ERROR:l.player.set(u.PROPERTY_STATE,u.STATE_IDLE),l.player.off("player:timeUpdate",i);break;case u.MESSAGE_CHANNELS_LOADED:l.player.set(u.PROPERTY_STATE,u.STATE_READY),l.player.on("player:timeUpdate",i)}}function i(e){h&&h.update()}function a(e){for(var t,n,r,i,a=[],o=-1,s=0,l=e.length;s<l;++s)if(e[s].channels&&e[s].channels.length>0)for(var u=0,c=e[s].channels.length;u<c;++u)n="true"===e[s].channels[u].isFavorite,r="true"===e[s].channels[u].vodChannel,i="true"===e[s].channels[u].dvrChannel,t={epgId:e[s].channels[u].epgId,id:e[s].channels[u].id,isFavorite:n,isInteractive:r||i,originalCategoryTitle:e[s].title,categoryIndex:s+1,originalIndexInCategory:u,indexInFavorites:n?o++:-1},a.push(t);return a}c.apply(this,arguments),this.namespace="epg:",s.initialize(e);var l=this,d=null,f="",p=null,h=null,g=null;this.player.registerProperty(u.PROPERTY_CHANNELS,null,!0),this.player.registerProperty(u.PROPERTY_PREV_CHANNEL,null,!0),this.player.registerProperty(u.PROPERTY_NEXT_CHANNEL,null,!0),this.player.set(u.PROPERTY_STATE,u.STATE_IDLE),this.player.on("property:videoInfo",n),this.dispose=function(){p=null,d=null,g=null,h&&h.dispose(),h=null,l.player.set(u.PROPERTY_STATE,u.STATE_IDLE),l.player.off("player:timeUpdate",i)}}var u={PROPERTY_STATE:"epg:state",PROPERTY_CHANNELS:"epg:channels",PROPERTY_CURRENT_CHANNEL:"epg:currentChannel",PROPERTY_NEXT_CHANNEL:"epg:nextChannel",PROPERTY_PREV_CHANNEL:"epg:prevChannel",PROPERTY_CHANNEL_BY_CATEGORIES:"epg:channelsByCategories",PROPERTY_TIME_OFFSET:"epg:timeOffset",STATE_IDLE:"stateIdle",STATE_LOADING:"stateLoading",STATE_READY:"stateReady",MESSAGE_CHANNELS_LOADING_ERROR:"message:channelsLoadingError",MESSAGE_CHANNELS_LOADED:"message:channelsLoaded",EVENT_NEED_TO_LOAD_NEW_PROGRAM:"epg:internal:needToLoadNewProgram",EVENT_NEED_TO_LOAD_EXTENDED_PROGRAM:"epg:internal:needToLoadExtendedProgram",EVENT_CURRENT_PROGRAM_CHANGED:"epg:currentProgramChanged",EVENT_ACTIVE_CHANNEL_CURRENT_PROGRAM_CHANGED:"epg:activeChannelCurrentProgramChanged",EVENT_PROGRAMS_UPDATED:"epg:programsUpdated",CHANNEL_TYPE_REGULAR:"regularChannel",CHANNEL_TYPE_VOD:"vodChannel",CHANNEL_TYPE_DVR:"dvrChannel"};s.initialize=function(e){e&&(s._player=e,s._initialized=!0)},s.emit=function(e,t){s._initialized&&s._player.emit(e,t)},s.on=function(e,t){s._initialized&&(Array.isArray(e)?s._onEventsFromArray(e,t):s._player.on(e,t))},s.off=function(e,t){s._initialized&&(Array.isArray(e)?s._offEventsFromArray(e,t):s._player.off(e,t))},s.set=function(e,t){s._initialized&&s._player.set(e,t)},s.get=function(e){var t=void 0;return s._initialized&&(t=s._player.get(e)),t},s.registerProperty=function(e,t,n){s._initialized&&s._player.registerProperty(e,t,n)},s.getConfig=function(){if(s._initialized)return s._player.config},s._onEventsFromArray=function(e,t){for(var n=0,r=e.length;n<r;++n)s.on(e[n],t)},s._offEventsFromArray=function(e,t){for(var n=0,r=e.length;n<r;++n)s.off(e[n],t)},s._initialized=!1,s._player=null;var c=e("mggp-player").Plugin;l.prototype=Object.create(c.prototype),l.prototype.constructor=l,t.exports=l},{"mggp-player":21}],31:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginGa=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("mggp-player");window._gaq=window._gaq||null;var l=function(e){function t(e,n){r(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.config||a.player||(a.player=arguments[0],a.config=arguments[1]),a.namespace="ga:",a._timeTrackInterval=null,a._timeTrackDelay=1e3,a._playedSeconds=0,a._isStarted=!1,a._audioTrack=null,a._quality=null,a._prevState=void 0,a._bindPlayer(),a._bindAdt(),a._bindOther(),a}return a(t,e),o(t,[{key:"_bindPlayer",value:function(){var e=this,t=this.player;t.on("property:videoInfo",function(){e._isStarted=!1,e._playedSeconds=0}),t.on("property:audioTrack",function(n){var r=t.get("videoInfo").audio_tracks[n.data];r&&(e._audioTrack?e._trackPlayer("changeAudioTrack",null,e._audioTrack.display_name+"_"+r.display_name):e._trackPlayer("startAudioTrack",null,r.display_name),e._audioTrack=r)}),t.on("property:quality",function(t){var n=t.data;e._quality&&e._trackPlayer("changeQuality",null,n+"_"+e._quality),e._quality=n}),t.on("player:stateChange",function(t){switch(t.data){case 0:e._trackPlayer("end");break;case 1:e._isStarted||(e._isStarted=!0,e._trackPlayer("start"));break;case 2:e._trackPlayer("pause");break;case 3:1===e._prevState&&e._trackPlayer("buffering")}e._prevState=t.data}),t.on("player:mediaError",function(t){e._trackPlayer("error",t.data.message||"")}),this._timeTrackInterval=setInterval(function(){1===t.get("state")&&++e._playedSeconds>=60&&(e._playedSeconds=0,e._trackPlayer("playtime"))},this._timeTrackDelay)}},{key:"_bindAdt",value:function(){var e=this;!1!==this.config.advertising&&(this.player.on("ad:external:startedLoadingNewURL",function(t){e._trackAdt("askAdt",t.data.xmlURL,t.data.type,t.data.analyticsTag)}),this.player.on("ad:external:vastEvent",function(t){e._trackAdt(t.data.vastEvent,window.location.href,t.data.type,t.data.analyticsTag)}),this.player.on("ad:external:nobanner",function(t){e._trackAdt("nobanner",t.data.mediaURL,t.data.type,t.data.analyticsTag)}),this.player.on("ad:external:vastXMLInvalid",function(t){e._trackAdt("vastDocumentNull",t.data.xmlURL,t.data.type,t.data.analyticsTag)}),this.player.on("ad:external:blockStarted",function(t){e._trackAdt("askRollblock",t.data.type,"",t.data.analyticsTag)}),this.player.on("ad:external:mediaBeginLoading",function(t){e._trackAdt("load",t.data.mediaURL,t.data.type,t.data.analyticsTag)}),this.player.on("ad:external:mediaLoadingTimeout",function(t){e._trackAdt("timeOut",t.data.xmlURL,t.data.type,t.data.analyticsTag)}),this.player.on("ad:external:xmlLoadingTimeout",function(t){e._trackAdt("xmlTimeout",t.data.xmlURL,10,t.data.analyticsTag)}),this.player.on("ad:external:closingOnRunningAd",function(t){e._trackAdt("forceSkip",t.data.xmlURL,t.data.type,t.data.analyticsTag)}))}},{key:"_bindOther",value:function(){var e=this;this.player.on("vclicks:hour",function(t){e._trackPlayer("VClicks2",window.location.href,t.data,0)}),this.player.on("apay:notify",function(t){e._trackPlayer("ActionPay",window.location.href,e.player.get("quality"),1)}),this.player.on("loader:rebinfo",function(t){e._trackPlayer("rebinfo",window.location.href,t.data,1)}),this.player.on("ga:customEvent",function(t){e._push.apply(e,["_trackEvent",t.data[0],t.data[1],t.data[2]])})}},{key:"_trackPlayer",value:function(e,t,n){e=e+(this.player.get("videoInfo").is_wvdrm?"DRM":"")+"_html5";var r=-1==this.player.get("quality")?"Auto":this.player.get("quality");this._push.apply(this,["_trackEvent",e,this._getURL(),r])}},{key:"_trackAdt",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";e="adt_"+e+(this.player.get("videoInfo").is_wvdrm?"DRM":"")+"_html5",e+=r,t&&"string"!=typeof t&&t.hasOwnProperty("url")&&(t=t.url),this._push.apply(this,["_trackEvent",e,t,n])}},{key:"_push",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.player.utils.log("MggpPluginGA.push(): "+n[0]+", "+n[1]+", "+n[2]),this.config.name&&(e=this.config.name+"."+e),this.config.onGaEvent&&"function"==typeof this.config.onGaEvent?void this.config.onGaEvent(n):void(window._gaq&&window._gaq.hasOwnProperty("push")?window._gaq.push([e].concat(n)):window.ga&&"function"==typeof window.ga&&window.ga("send",{hitType:"event",eventCategory:n[0],eventAction:n[1],eventLabel:n[2]}))}},{key:"_getURL",value:function(){return this.config.host||window.location.href}},{key:"dispose",value:function(){clearInterval(this._timeTrackInterval),this._trackPlayer("close")}}]),t}(s.Plugin);n["default"]=l},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],32:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginGemius=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("mggp-player"),l="http"+("https:"==location.protocol?"s":""),u=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));if(!s.config.gemius||!s.config.gemius.prefix||!s.config.gemius.identifier)return i(s);if(s.namespace="gemius:",s._playerId="player_"+Math.round(1e7*Math.random()),s._hitCollector=l+"://"+s.config.gemius.prefix+".hit.gemius.pl",s._videoId=null,s._customPackage=[],s._additionalPackage=[],s._treeId=[100],window.gemiusStream)s._listen();else{var u=document.createElement("script");u.onload=s._listen.bind(s),u.async=u.defer=!0,u.src=s._hitCollector+"/gstream.js",document.body.appendChild(u)}return s}return a(t,e),o(t,[{key:"_listen",value:function(){var e=this;this.player.on("player:mediaCanPlay",function(){var t=e.player.get("videoInfo");e._videoId&&e._closeStream(),e._videoId=t.video_id,e._customPackage=[{name:"CNAME",value:t.title}],e._createStream()}),this.player.on("player:stateChange",function(){switch(e.player.get("state")){case 0:e._hit("complete");break;case 1:e._hit("playing");break;case 2:e._hit("paused")}}),this.player.on("player:mediaSeekStart",function(){return e._hit("seekingStarted")}),this.player.on("player:bufferingStart",function(){return e._hit("buffering")}),this.player.on("player:mediaSeekEnd",function(){1===e.player.get("state")&&e._hit("playing")}),this.player.on("player:bufferingEnd",function(){1===e.player.get("state")&&e._hit("playing")})}},{key:"_createStream",value:function(){window.gemiusStream.newStream(this._playerId,this._videoId,this.player.get("duration"),this._customPackage,this._additionalPackage,this.config.gemius.identifier,this._hitCollector,this._treeId)}},{key:"_hit",value:function(e){window.gemiusStream.event(this._playerId,this._videoId,this.player.get("position"),e)}},{key:"_closeStream",value:function(){window.gemiusStream.closeStream(this._playerId,this._videoId,this.player.get("position"))}},{key:"dispose",value:function(){this._closeStream()}}]),t}(s.Plugin);n["default"]=u},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],33:[function(e,t,n){"use strict";var r=e("mggp-player").Plugin,i=function(){function e(e){var t=Math.floor((new Date).getTime()/1e3);d&&1===o.get("state")&&(u+=t-c),c=t}function t(e){c=void 0,u=0,s=0,l=0}function n(){var e=-1,t=a.player.getPlayableElement();if(t&&t.buffered&&t.buffered.length>0)for(var n=t.buffered.length,r=a.player.get("position");n--;)t.buffered.start(n)<=r&&t.buffered.end(n)>=r&&(e=Math.floor(1e3*(t.buffered.end(n)-r)));return e}r.apply(this,arguments);var i="buff_v2",a=this,o=a.player,s=null,l=0,u=0,c=void 0,d=!1,f=0;this.dispose=function(){d=!1,o.off("player:buffering",p),o.off("player:timeUpdate",e),o.off("property:videoInfo",t),o=null};var p=function(e){var t=e.data.isBuffering,r=e.data.timestamp,a=e.data.isSeeking;t&&!a?(s=r,d=!1,f=n()):t||0==s||(l=r-s,h(i),s=0,d=!0,u=0)},h=function(e){var t=o.get("videoInfo")||{},r=a.config.version||a.config.appVersion||"",i=a.player.get("position");if("number"!=typeof i)try{i=parseInt(i)}catch(s){i=-1}if(!(i<=0)){i=Math.floor(1e3*i);var c=a.config.device||a.config.deviceInfo||null;c=!c&&a.config.deviceID?{id:a.config.deviceID}:{};var d,p={cdn_host:m(),src:o.get("src")||t.src,platform:a.config.deviceType.toUpperCase(),device:c,os:a.config.deviceOS||"",app_version:r.toString(),video_id:t.video_id.toString(),user_id:a.config.userID?a.config.userID.toString():"",auto_quality:o.get("quality")==-1,video_quality:o.get("quality")==-1?"Auto":o.get("quality")+"p",buffering_time:l,drm_type:"",stream_type:"",buffer_time:n(),primary_buffer_time:f,play_time:u,position:i,content_type:t.content_type||"",is_embed:!!t.is_embed&&t.is_embed};if(t.src&&(d=o.utils.getExtension(t.src)),"m3u8"==d&&(p.stream_type="hls"),"mpd"==d&&(p.stream_type="dash"),"mp4"==d&&(p.stream_type="mp4"),"wvm"==d&&(p.stream_type="download"),t.is_wvdrm&&("wvm"==d&&(p.drm_type="widevine"),"m3u8"==d&&(p.drm_type="fairplay"),"web"==o.config.deviceType&&"mpd"==d)){var h=o.config.device.browser;p.drm_type="Edge"==h.name||"IE"==h.name?"playready":"modular"}p.type=e,p.buffering_time=l+(100-l%100),p=g(p),o.emit("kibana:player_warnings",p),l=0}},g=function(e){var t={};for(var n in e)""!==e[n]&&e[n]!==-1&&(t[n]=e[n]);return t},m=function(){var e="",t=o.get("qualityList");if(t)for(var n=/vs.+\.vcdn.biz/,r=0;r<t.length;r++)if(t[r]&&t[r].src&&n.test(t[r].src)){var i=t[r].src.match(n)[0];e=i.split(".")[0];break}return e};o.on("player:buffering",p),o.on("player:timeUpdate",e),o.on("property:videoInfo",t)};i.prototype=Object.create(r.prototype),i.prototype.constructor=i,t.exports=i},{"mggp-player":21}],34:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginKibana=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e("mggp-player"),u=["DEBUG","WARNING","ERROR","PLAYER_WARNINGS","P2P"],c=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s.config.kibana&&s.config.kibana.events?(s.namespace="kibana:",s.player.on(s.namespace+"*",function(e){var t=e.name.split(":").splice(1),n=t[0].toUpperCase(),r=t.join(":"),i=s.config.protocol.replace(":",""),a=s.config.kibana.events[i][r];u.indexOf(n)!==-1&&a&&s._send(a,n,{text:e.data.type||e.data.name,data:JSON.stringify(e.data)})}),s):i(s)}return a(t,e),s(t,[{key:"_send",value:function(e,t,n){var r=this;if(!this._wait){this._wait=!0,setTimeout(function(){return r._wait=!1},this.config.delay||0);var i=new XMLHttpRequest;i.onreadystatechange=function(){4===r.readyState&&r.emit("debug",{message:i.statusText})},i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),i.send(this._encode(n))}}},{key:"_encode",value:function(e){var t,n,r=[];if(e&&"object"===("undefined"==typeof e?"undefined":o(e))){for(n=Object.keys(e),t=0;t<n.length;t++)r.push(encodeURIComponent(n[t])+"="+encodeURIComponent(e[n[t]]));if(r.length>0)return r.join("&")}return null}}]),t}(l.Plugin);n["default"]=c},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],35:[function(e,t,n){"use strict";var r=e("mggp-player").Plugin,i=(e("mggp-player").AddonError,function(){function e(){f.player.emit("mns:connect",f),v.subscribe(a,{qos:0})}function t(e){f.player.emit("mns:disconnect",e)}function n(e){var t=e.destinationName,e=e.payloadString;switch(t){case a:try{var n=JSON.parse(e.toString())}catch(r){}n&&h(n.data);break;default:var o=t.split("/");if(o.length){var s=o.shift();f.hasOwnProperty(s)&&"function"==typeof f[s]&&f[s](o,t,e)}}i("Recieved Message:= "+e.toString()+"\nOn topic:= "+t)}function i(e){f.player&&f.player.config&&f.player.config.debug&&console.log("mggp-plugin-mns:",e)}r.apply(this,arguments);var a="config/default",o={management_topic:null,user_topic:null,object_topic:null},s="mggp_"+Math.random().toString(16).substr(2,8),l="connect.megogo.net";if(window.Paho){var u=null,c=[],d={},f=this,p={useSSL:!0,userName:"html5@:3xP<9>7FXD(Y",password:"Cv4>C%Y,Z85T.-",onSuccess:e},h=function(e){for(var t in e.topics)if(o.hasOwnProperty(t)&&(o[t]=e.topics[t],o[t].server&&(g(o[t].server),o[t].leafs)))for(var n in o[t].leafs)g(o[t].client+o[t].leafs[n])},g=function(e){var t=m(e);t?f.subscribe(t):c.push(e)},m=function(e){var t=e;return u||(u=f.player.get("videoInfo")),t.indexOf("{uid}")!=-1&&f.config.deviceID&&(t=t.replace("{uid}",f.config.deviceID)),t.indexOf("{object_id}")!=-1&&f.config&&f.config.videoID&&(t=t.replace("{object_id}",f.config.videoID)),t.indexOf("{device_type}")!=-1&&f.player&&f.player.config&&(t=t.replace("{device_type}",f.player.config.deviceType)),/\{.+\}/.test(t)&&(t=null),i("topic modified "+t),t},v=new Paho.MQTT.Client(l,443,s);v.onConnectionLost=t,v.onMessageArrived=n,v.connect(p),this.subscribe=function(e){d[e]||(v.subscribe(e,{qos:0}),d[e]=!0)},this.unsubscribe=function(e){d[e]&&(v.unsubscribe(e),delete d[e])},this.publish=function(e,t,n,r){var i=new Paho.MQTT.Message(t);i.destinationName=e,void 0===n&&(n=!0),void 0===r?r=0:r>2?r=2:r<0&&(r=0),i.retained=n,i.qos=r,v.send(i)},this.v1=this.client=function(e,t,n){var r=e.shift();f.hasOwnProperty(r)&&"function"==typeof f[r]&&f[r](e,t,n)},this.management=function(e,t,n){},this.user=function(e,t,n){},this.vod_object=function(e,t,n){e.indexOf("advert")!==-1&&f.advert(e,t,n)},this.p2p=function(e,t,n){f.player.emit("mns:p2p",n)},this.advert=function(e,t,n){try{var r=JSON.parse(n.toString())}catch(i){}r&&r.data&&r.data.adlist&&r.data.adlist.length>0&&f.player.set("mns:adlist",r.data.adlist)}}});i.prototype=Object.create(r.prototype),i.prototype.constructor=i,t.exports=i},{"mggp-player":21}],36:[function(e,t,n){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r.mggpPluginP2p=e()}}(function(){var t;return function n(t,r,i){function a(s,l){if(!r[s]){if(!t[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return a(n?n:e)},d,d.exports,n,t,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};t.exports=r},{}],2:[function(e,t,n){"use strict";!function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(t){for(var n=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],a=0;a<4;a++)8*r+6*a<=8*t.length?n.push(e.charAt(i>>>6*(3-a)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&n.push((e.indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|e.indexOf(t.charAt(r))>>>6-2*i);return n}};t.exports=n}()},{}],3:[function(e,t,n){"use strict";function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function i(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||i(e)||!!e._isBuffer)}},{}],4:[function(e,t,n){(function(e){"use strict";function r(e,t){return e.set(t[0],t[1]),e}function i(e,t){return e.add(t),e}function a(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););return e}function o(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function s(e,t,n,r){var i=-1,a=e?e.length:0;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n}function l(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function u(e,t){return null==e?void 0:e[t]}function c(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function d(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function f(e,t){
return function(n){return e(t(n))}}function p(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function h(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function g(){this.__data__=jt?jt(null):{}}function m(e){return this.has(e)&&delete this.__data__[e]}function v(e){var t=this.__data__;if(jt){var n=t[e];return n===Ce?void 0:n}return Tt.call(t,e)?t[e]:void 0}function y(e){var t=this.__data__;return jt?void 0!==t[e]:Tt.call(t,e)}function _(e,t){return this.__data__[e]=jt&&void 0===t?Ce:t,this}function E(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function b(){this.__data__=[]}function T(e){var t=this.__data__,n=j(t,e);return!(n<0||(n==t.length-1?t.pop():Dt.call(t,n,1),0))}function w(e){var t=this.__data__,n=j(t,e);return n<0?void 0:t[n][1]}function A(e){return j(this.__data__,e)>-1}function R(e,t){var n=this.__data__,r=j(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}function S(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function k(){this.__data__={hash:new h,map:new(xt||E),string:new h}}function O(e){return oe(this,e)["delete"](e)}function L(e){return oe(this,e).get(e)}function C(e){return oe(this,e).has(e)}function D(e,t){return oe(this,e).set(e,t),this}function P(e){this.__data__=new E(e)}function I(){this.__data__=new E}function N(e){return this.__data__["delete"](e)}function M(e){return this.__data__.get(e)}function x(e){return this.__data__.has(e)}function F(e,t){var n=this.__data__;if(n instanceof E){var r=n.__data__;if(!xt||r.length<Le-1)return r.push([e,t]),this;n=this.__data__=new S(r)}return n.set(e,t),this}function U(e,t){var n=Qt(e)||ye(e)?l(e.length,String):[],r=n.length,i=!!r;for(var a in e)!t&&!Tt.call(e,a)||i&&("length"==a||de(a,r))||n.push(a);return n}function B(e,t,n){var r=e[t];Tt.call(e,t)&&ve(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function j(e,t){for(var n=e.length;n--;)if(ve(e[n][0],t))return n;return-1}function G(e,t){return e&&re(t,Re(t),e)}function V(e,t,n,r,i,o,s){var l;if(r&&(l=o?r(e,i,o,s):r(e)),void 0!==l)return l;if(!we(e))return e;var u=Qt(e);if(u){if(l=le(e),!t)return ne(e,l)}else{var d=Xt(e),f=d==Fe||d==Ue;if(Jt(e))return z(e,t);if(d==Ge||d==Pe||f&&!o){if(c(e))return o?e:{};if(l=ue(f?{}:e),!t)return ie(e,G(l,e))}else{if(!ut[d])return o?e:{};l=ce(e,d,V,t)}}s||(s=new P);var p=s.get(e);if(p)return p;if(s.set(e,l),!u)var h=n?ae(e):Re(e);return a(h||e,function(i,a){h&&(a=i,i=e[a]),B(l,a,V(i,t,n,r,a,e,s))}),l}function H(e){return we(e)?Lt(e):{}}function W(e,t,n){var r=t(e);return Qt(e)?r:o(r,n(e))}function Y(e){return wt.call(e)}function q(e){return!(!we(e)||pe(e))&&(be(e)||c(e)?At:st).test(ge(e))}function K(e){if(!he(e))return Nt(e);var t=[];for(var n in Object(e))Tt.call(e,n)&&"constructor"!=n&&t.push(n);return t}function z(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}function X(e){var t=new e.constructor(e.byteLength);return new kt(t).set(new kt(e)),t}function Q(e,t){var n=t?X(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function J(e,t,n){return s(t?n(d(e),!0):d(e),r,new e.constructor)}function $(e){var t=new e.constructor(e.source,ot.exec(e));return t.lastIndex=e.lastIndex,t}function Z(e,t,n){return s(t?n(p(e),!0):p(e),i,new e.constructor)}function ee(e){return Kt?Object(Kt.call(e)):{}}function te(e,t){var n=t?X(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ne(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function re(e,t,n,r){n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],s=r?r(n[o],e[o],o,n,e):void 0;B(n,o,void 0===s?e[o]:s)}return n}function ie(e,t){return re(e,zt(e),t)}function ae(e){return W(e,Re,zt)}function oe(e,t){var n=e.__data__;return fe(t)?n["string"==typeof t?"string":"hash"]:n.map}function se(e,t){var n=u(e,t);return q(n)?n:void 0}function le(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&Tt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function ue(e){return"function"!=typeof e.constructor||he(e)?{}:H(Ot(e))}function ce(e,t,n,r){var i=e.constructor;switch(t){case ze:return X(e);case Ne:case Me:return new i((+e));case Xe:return Q(e,r);case Qe:case Je:case $e:case Ze:case et:case tt:case nt:case rt:case it:return te(e,r);case Be:return J(e,r,n);case je:case Ye:return new i(e);case He:return $(e);case We:return Z(e,r,n);case qe:return ee(e)}}function de(e,t){return!!(t=null==t?De:t)&&("number"==typeof e||lt.test(e))&&e>-1&&e%1==0&&e<t}function fe(e){var t=void 0===e?"undefined":Oe(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function pe(e){return!!Et&&Et in e}function he(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||yt)}function ge(e){if(null!=e){try{return bt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function me(e){return V(e,!0,!0)}function ve(e,t){return e===t||e!==e&&t!==t}function ye(e){return Ee(e)&&Tt.call(e,"callee")&&(!Ct.call(e,"callee")||wt.call(e)==Pe)}function _e(e){return null!=e&&Te(e.length)&&!be(e)}function Ee(e){return Ae(e)&&_e(e)}function be(e){var t=we(e)?wt.call(e):"";return t==Fe||t==Ue}function Te(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=De}function we(e){var t=void 0===e?"undefined":Oe(e);return!!e&&("object"==t||"function"==t)}function Ae(e){return!!e&&"object"==(void 0===e?"undefined":Oe(e))}function Re(e){return _e(e)?U(e):K(e)}function Se(){return[]}function ke(){return!1}var Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le=200,Ce="__lodash_hash_undefined__",De=9007199254740991,Pe="[object Arguments]",Ie="[object Array]",Ne="[object Boolean]",Me="[object Date]",xe="[object Error]",Fe="[object Function]",Ue="[object GeneratorFunction]",Be="[object Map]",je="[object Number]",Ge="[object Object]",Ve="[object Promise]",He="[object RegExp]",We="[object Set]",Ye="[object String]",qe="[object Symbol]",Ke="[object WeakMap]",ze="[object ArrayBuffer]",Xe="[object DataView]",Qe="[object Float32Array]",Je="[object Float64Array]",$e="[object Int8Array]",Ze="[object Int16Array]",et="[object Int32Array]",tt="[object Uint8Array]",nt="[object Uint8ClampedArray]",rt="[object Uint16Array]",it="[object Uint32Array]",at=/[\\^$.*+?()[\]{}|]/g,ot=/\w*$/,st=/^\[object .+?Constructor\]$/,lt=/^(?:0|[1-9]\d*)$/,ut={};ut[Pe]=ut[Ie]=ut[ze]=ut[Xe]=ut[Ne]=ut[Me]=ut[Qe]=ut[Je]=ut[$e]=ut[Ze]=ut[et]=ut[Be]=ut[je]=ut[Ge]=ut[He]=ut[We]=ut[Ye]=ut[qe]=ut[tt]=ut[nt]=ut[rt]=ut[it]=!0,ut[xe]=ut[Fe]=ut[Ke]=!1;var ct="object"==("undefined"==typeof e?"undefined":Oe(e))&&e&&e.Object===Object&&e,dt="object"==("undefined"==typeof self?"undefined":Oe(self))&&self&&self.Object===Object&&self,ft=ct||dt||Function("return this")(),pt="object"==("undefined"==typeof n?"undefined":Oe(n))&&n&&!n.nodeType&&n,ht=pt&&"object"==("undefined"==typeof t?"undefined":Oe(t))&&t&&!t.nodeType&&t,gt=ht&&ht.exports===pt,mt=Array.prototype,vt=Function.prototype,yt=Object.prototype,_t=ft["__core-js_shared__"],Et=function(){var e=/[^.]+$/.exec(_t&&_t.keys&&_t.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),bt=vt.toString,Tt=yt.hasOwnProperty,wt=yt.toString,At=RegExp("^"+bt.call(Tt).replace(at,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rt=gt?ft.Buffer:void 0,St=ft.Symbol,kt=ft.Uint8Array,Ot=f(Object.getPrototypeOf,Object),Lt=Object.create,Ct=yt.propertyIsEnumerable,Dt=mt.splice,Pt=Object.getOwnPropertySymbols,It=Rt?Rt.isBuffer:void 0,Nt=f(Object.keys,Object),Mt=se(ft,"DataView"),xt=se(ft,"Map"),Ft=se(ft,"Promise"),Ut=se(ft,"Set"),Bt=se(ft,"WeakMap"),jt=se(Object,"create"),Gt=ge(Mt),Vt=ge(xt),Ht=ge(Ft),Wt=ge(Ut),Yt=ge(Bt),qt=St?St.prototype:void 0,Kt=qt?qt.valueOf:void 0;h.prototype.clear=g,h.prototype["delete"]=m,h.prototype.get=v,h.prototype.has=y,h.prototype.set=_,E.prototype.clear=b,E.prototype["delete"]=T,E.prototype.get=w,E.prototype.has=A,E.prototype.set=R,S.prototype.clear=k,S.prototype["delete"]=O,S.prototype.get=L,S.prototype.has=C,S.prototype.set=D,P.prototype.clear=I,P.prototype["delete"]=N,P.prototype.get=M,P.prototype.has=x,P.prototype.set=F;var zt=Pt?f(Pt,Object):Se,Xt=Y;(Mt&&Xt(new Mt(new ArrayBuffer(1)))!=Xe||xt&&Xt(new xt)!=Be||Ft&&Xt(Ft.resolve())!=Ve||Ut&&Xt(new Ut)!=We||Bt&&Xt(new Bt)!=Ke)&&(Xt=function(e){var t=wt.call(e),n=t==Ge?e.constructor:void 0,r=n?ge(n):void 0;if(r)switch(r){case Gt:return Xe;case Vt:return Be;case Ht:return Ve;case Wt:return We;case Yt:return Ke}return t});var Qt=Array.isArray,Jt=It||ke;t.exports=me}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){"use strict";!function(){var n=e("crypt"),r=e("charenc").utf8,i=e("is-buffer"),a=e("charenc").bin,o=function s(e,t){e.constructor==String?e=t&&"binary"===t.encoding?a.stringToBytes(e):r.stringToBytes(e):i(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var o=n.bytesToWords(e),l=8*e.length,u=1732584193,c=-271733879,d=-1732584194,f=271733878,p=0;p<o.length;p++)o[p]=16711935&(o[p]<<8|o[p]>>>24)|4278255360&(o[p]<<24|o[p]>>>8);o[l>>>5]|=128<<l%32,o[14+(l+64>>>9<<4)]=l;for(var h=s._ff,g=s._gg,m=s._hh,v=s._ii,p=0;p<o.length;p+=16){var y=u,_=c,E=d,b=f;u=h(u,c,d,f,o[p+0],7,-680876936),f=h(f,u,c,d,o[p+1],12,-389564586),d=h(d,f,u,c,o[p+2],17,606105819),c=h(c,d,f,u,o[p+3],22,-1044525330),u=h(u,c,d,f,o[p+4],7,-176418897),f=h(f,u,c,d,o[p+5],12,1200080426),d=h(d,f,u,c,o[p+6],17,-1473231341),c=h(c,d,f,u,o[p+7],22,-45705983),u=h(u,c,d,f,o[p+8],7,1770035416),f=h(f,u,c,d,o[p+9],12,-1958414417),d=h(d,f,u,c,o[p+10],17,-42063),c=h(c,d,f,u,o[p+11],22,-1990404162),u=h(u,c,d,f,o[p+12],7,1804603682),f=h(f,u,c,d,o[p+13],12,-40341101),d=h(d,f,u,c,o[p+14],17,-1502002290),c=h(c,d,f,u,o[p+15],22,1236535329),u=g(u,c,d,f,o[p+1],5,-165796510),f=g(f,u,c,d,o[p+6],9,-1069501632),d=g(d,f,u,c,o[p+11],14,643717713),c=g(c,d,f,u,o[p+0],20,-373897302),u=g(u,c,d,f,o[p+5],5,-701558691),f=g(f,u,c,d,o[p+10],9,38016083),d=g(d,f,u,c,o[p+15],14,-660478335),c=g(c,d,f,u,o[p+4],20,-405537848),u=g(u,c,d,f,o[p+9],5,568446438),f=g(f,u,c,d,o[p+14],9,-1019803690),d=g(d,f,u,c,o[p+3],14,-187363961),c=g(c,d,f,u,o[p+8],20,1163531501),u=g(u,c,d,f,o[p+13],5,-1444681467),f=g(f,u,c,d,o[p+2],9,-51403784),d=g(d,f,u,c,o[p+7],14,1735328473),c=g(c,d,f,u,o[p+12],20,-1926607734),u=m(u,c,d,f,o[p+5],4,-378558),f=m(f,u,c,d,o[p+8],11,-2022574463),d=m(d,f,u,c,o[p+11],16,1839030562),c=m(c,d,f,u,o[p+14],23,-35309556),u=m(u,c,d,f,o[p+1],4,-1530992060),f=m(f,u,c,d,o[p+4],11,1272893353),d=m(d,f,u,c,o[p+7],16,-155497632),c=m(c,d,f,u,o[p+10],23,-1094730640),u=m(u,c,d,f,o[p+13],4,681279174),f=m(f,u,c,d,o[p+0],11,-358537222),d=m(d,f,u,c,o[p+3],16,-722521979),c=m(c,d,f,u,o[p+6],23,76029189),u=m(u,c,d,f,o[p+9],4,-640364487),f=m(f,u,c,d,o[p+12],11,-421815835),d=m(d,f,u,c,o[p+15],16,530742520),c=m(c,d,f,u,o[p+2],23,-995338651),u=v(u,c,d,f,o[p+0],6,-198630844),f=v(f,u,c,d,o[p+7],10,1126891415),d=v(d,f,u,c,o[p+14],15,-1416354905),c=v(c,d,f,u,o[p+5],21,-57434055),u=v(u,c,d,f,o[p+12],6,1700485571),f=v(f,u,c,d,o[p+3],10,-1894986606),d=v(d,f,u,c,o[p+10],15,-1051523),c=v(c,d,f,u,o[p+1],21,-2054922799),u=v(u,c,d,f,o[p+8],6,1873313359),f=v(f,u,c,d,o[p+15],10,-30611744),d=v(d,f,u,c,o[p+6],15,-1560198380),c=v(c,d,f,u,o[p+13],21,1309151649),u=v(u,c,d,f,o[p+4],6,-145523070),f=v(f,u,c,d,o[p+11],10,-1120210379),d=v(d,f,u,c,o[p+2],15,718787259),c=v(c,d,f,u,o[p+9],21,-343485551),u=u+y>>>0,c=c+_>>>0,d=d+E>>>0,f=f+b>>>0}return n.endian([u,c,d,f])};o._ff=function(e,t,n,r,i,a,o){var s=e+(t&n|~t&r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._gg=function(e,t,n,r,i,a,o){var s=e+(t&r|n&~r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._hh=function(e,t,n,r,i,a,o){var s=e+(t^n^r)+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._ii=function(e,t,n,r,i,a,o){var s=e+(n^(t|~r))+(i>>>0)+o;return(s<<a|s>>>32-a)+t},o._blocksize=16,o._digestsize=16,t.exports=function(e,t){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(o(e,t));return t&&t.asBytes?r:t&&t.asString?a.bytesToString(r):n.bytesToHex(r)}}()},{charenc:1,crypt:2,"is-buffer":3}],6:[function(e,n,r){(function(i){!function(e){if("object"==typeof r&&"undefined"!=typeof n)n.exports=e();else if("function"==typeof t&&t.amd)t([],e);else{var a;a="undefined"!=typeof window?window:"undefined"!=typeof i?i:"undefined"!=typeof self?self:this,a.mggpPlayer=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t||e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";var r=t.exports=function(){var e={},t=[],n=[],r=new i,o=null,s=null,l={},u=["play","pause","togglePlayPause","seekTo","mute","unMute","setVolume","setQuality","setAudioTrack","setSubtitles"];e.on=e.addEventListener=r.on,e.off=e.removeEventListener=r.off,e.emit=e.dispatchEvent=r.emit,e.init=function(t,n,r,i){e.id=t,e.parentContainer=n,e.config=r,e.use(i),e.emit("player:ready")},e.use=function(r){r.forEach(function(r){r.hasOwnProperty("default")&&(r=r["default"]),r.hasOwnProperty("mimeTypes")?t.push(r):n.push(new r(e,e.config))})},u.forEach(function(t){e[t]=function(){o&&o[t]&&o[t].apply(o,arguments)}}),e.canPlay=function(t){return null!=e.getVendor(t)},e.load=function(t,r,i){if(e.utils.log("MggpPlayer.load():"),e.set("vendorOptions",i||{}),e.set("src",t||null),e.set("videoInfo",r||null),s||(e.utils.log("MggpPlayer.load:Create timer"),s=setInterval(c,e.config&&e.config.hasOwnProperty("timeInterval")?e.config.timeInterval:1e3/3)),n.forEach(function(e){"function"==typeof e.load&&e.load(t,r,i)}),1==(e.get("preroll")||!1))return void e.emit("ads:load");var l,u,d;if(!t&&!r.src)return l=a.errorTypes.INTERNAL_ERROR,u=a.errorCodes[l].SRC_IS_NOT_FOUND,d=a.errorMessages[u],void new a(e,l,u,d,(!0));var f=e.utils.getExtension(t||r.src);if(!e.canPlay(f))return l=a.errorTypes.PLAYBACK_ERROR,u=a.errorCodes[l].MEDIA_FILE_IS_NOT_SUPPORTED,d=a.errorMessages[u],void new a(e,l,u,d,(!0));if(o&&-1==o.constructor.mimeTypes.indexOf(f)&&(o.stop(),o=null),!o){var p=e.getVendor(f);if(!p)return l=a.errorTypes.PLAYBACK_ERROR,u=a.errorCodes[l].MEDIA_FILE_IS_NOT_SUPPORTED,d=a.errorMessages[u],void new a(e,l,u,d,(!0));o=new p(e,e.config)}o.load(t,r,i)},e.showAnotherAd=function(t,n){s||(e.utils.log("MggpPlayer.showAnotherAd:Create timer"),s=setInterval(c,e.config&&e.config.hasOwnProperty("timeInterval")?e.config.timeInterval:1e3/3)),e.emit("ad:showAnotherAd",{url:t,type:n})},e.get=function(t){return l.hasOwnProperty(t)?l[t].value:(e.utils.log("MggpPlayer:get: Property "+t+" not found"),null)},e.set=function(t,n){l[t]||e.registerProperty(t),l[t]&&l[t].value!=n&&(l[t].value=n,e.emit("property:"+t,n))},e.registerProperty=function(t,n,r){return l.hasOwnProperty(t)?void e.utils.log("MggpPlayer:registerProperty: Property "+t+" already registered"):(l[t]={},l[t].resetable=!0!==r,l[t].value=l[t]["default"]=n,void 0)},e.reset=function(){for(var e in l)l[e].resetable&&(l[e].value=l[e]["default"])},e.stop=function(){e.emit("player:stop"),window.clearInterval(s),o&&(o.stop(),o=null),e.reset(),s=null},e.dispose=function(){e.stop(),n.forEach(function(e){e.dispose()}),r.dispose(),t=null,n=null,r=null,o=null,s=null,l=null},e.getVendor=function(n){if("mp4"==n&&o&&1==e.config.maxVendorInstances)return null;if(1==t.length)return t[0];for(var r=null,i=0;i<t.length;i++)t[i]&&t[i].mimeTypes.indexOf(n)>=0&&t[i].canPlay(n,e.config)&&(!r||t[i].priority<r.priority)&&(r=t[i]);return r},e.getPlayableElement=function(){var e=null;return o&&(e=o.getPlayableElement()),e},e.utils={},e.utils.getExtension=function(e){var t="",n=e.lastIndexOf("?");-1!=n&&(e=e.slice(0,n));var r=e.lastIndexOf(".");return-1!=r&&(t=e.slice(r+1)),t},e.utils.merge=function(e,t){e=Object.create(e);for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},e.utils.log=function(t){if(e.config&&e.config.hasOwnProperty("debug")&&!0===e.config.debug){var n=new Date;console.log(n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()+":"+n.getMilliseconds()+" -> ",t)}};var c=function(){e.emit("player:timeUpdate")};return e.registerProperty("volume",60,!0),e.registerProperty("position",0),e.registerProperty("duration",0),e.registerProperty("state",-1),e.registerProperty("loadedFraction",0),e.registerProperty("muted",!1,!0),e.registerProperty("videoInfo",{},!0),e.registerProperty("src",null),e.registerProperty("vendorOptions",{}),e.registerProperty("advertisement",!1),e.registerProperty("quality",-1),e.registerProperty("qualityList",[]),e.registerProperty("audioTrack",0),e.registerProperty("audioTrackList",[]),e.registerProperty("subtitles","off"),e.registerProperty("subtitlesList",[]),e.on("property:state",function(t){0==t.data&&(1==(e.get("postroll")||!1)?(o&&(o.stop(),o=null),e.emit("ad:playerEnded")):e.emit("player:completed"))}),e},i=function(){var e=this;e.listeners={};var t=!1,n=[],r=[],i=function(){};this.dispose=function(){e.listeners=null,n=null,r=null},this.on=function(t,n){if(e.listeners.hasOwnProperty(t)){if(e.listeners[t].indexOf(n)>=0)return}else e.listeners[t]=[];e.listeners[t].push(n)},this.off=function(r,a){if(e.listeners.hasOwnProperty(r)){var o,s;for(o=0,s=e.listeners[r].length;o<s;o+=1)e.listeners[r][o]===a&&(t?(e.listeners[r][o]=i,n.push(r)):(e.listeners[r].splice(o,1),0==e.listeners[r].length&&delete e.listeners[r]))}},this.emit=function(a,o){if(a&&"undefined"!=a){if(t)return void r.push({evt:a,data:o});t=!0;var s;if(e.listeners.hasOwnProperty(a))for(s=0;s<e.listeners[a].length;s++)e.listeners[a][s]({name:a,data:o});if(e.listeners.hasOwnProperty(a.slice(0,a.lastIndexOf(":"))+":*")){var l=a.slice(0,a.lastIndexOf(":"))+":*";for(s=0;s<e.listeners[l].length;s++)e.listeners[l][s]({name:a,data:o})}for(t=!1;n.length>0;){var u=n.shift();e.off(u,i)}if(r.length>0){var c=r.shift();e.emit(c.evt,c.data)}}},this.isExist=function(t,n){return"function"==typeof n?e.listeners[t]&&-1!=e.listeners[t].indexOf:e.listeners[t]&&e.listeners.length>0}},a=r.AddonError=function(e,t,n,r,i){var a=new Date,o=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()+":"+a.getMilliseconds()+" -> "+t+"->"+n+"->"+r;i?console.error(o):console.warn(o),e&&e.emit("mediaError",{name:this.constructor.name,type:t,code:n,message:r||"Player Addon Error",fatal:i||!1})};a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.errorTypes={NETWORK_ERROR:"networkError",PLAYBACK_ERROR:"playbackError",INTERNAL_ERROR:"internalError",PARSING_ERROR:"parsingError"},a.errorCodes={networkError:{PLAYLIST_LOADING_ERROR:"playlistLoadingError",CHUNKLIST_LOADING_ERROR:"chunklistLoadingError",CHUNK_LOADING_ERROR:"chunkLoadingError",KEY_LOADING_ERROR:"keyLoadingError",MEDIA_FILE_LOADING_ERROR:"mediaFileLoadingError",FILE_LOADING_ERROR:"fileLoadingError"},playbackError:{MEDIA_FILE_IS_NOT_SUPPORTED:"mediaFileIsNotSupported",PARSING_ERROR:"parsingError",DECODING_ERROR:"decodingError",LEVEL_SWITCH_ERROR:"levelSwitchError"},internalError:{SRC_IS_NOT_FOUND:"srcIsNotFound",CANNOT_INJECT_PLAYABLE_ELEMENT:"cannotInjectPlayableElement",BUFFER_APPEND_ERROR:"bufferAppendError"},parsingError:{PARSING_ERROR:"parsingError"}},a.errorMessages={playlistLoadingError:"Cannot load playlist from url: ",chunklistLoadingError:"Cannot load chunklist from url: ",chunkLoadingError:"Cannot load chunk from url: ",mediaFileLoadingError:"Cannot load media file from url: ",fileLoadingError:"Cannot load file from url: ",mediaFileIsNotSupported:"Unable to play file. Format is not supported. Url: ",parsingError:"Error on playlist or chunklist parsing. Url: ",decodingError:"Error on video decoding. Url: ",levelSwitchError:"Error while trying to switch level",srcIsNotFound:"Src field is undefined or it is an empty string",cannotInjectPlayableElement:"Cannot inject playable element in DOM",bufferAppendError:"Cannot append data to source buffer",cannotParse:"Cannot parse data from url:"};var o=r.Plugin=function(e,t){this.config=t||{},this.player=e||{},this.container=this.player.parentContainer||document.body,this.namespace="plugin:"};o.prototype.dispose=function(){},o.prototype.emit=function(e,t){this.player.emit&&this.player.emit(this.namespace+e,t)},o.prototype.log=function(e){this.player.utils?this.player.utils.log(e):console.log(e)};var s=r.Vendor=function(e,t){this.DEFAULT_NAMESPACE="player:",this.config=t||{},this.player=e||{},this.container=this.player.parentContainer||document.body,this.namespace=this.DEFAULT_NAMESPACE,this.STREAM_ERROR="STREAM_ERROR"};s.prototype.canPlay=function(e){return!0},s.prototype.setQuality=function(e){this.emit("qualityNeedChange",e)},s.prototype.setAudioTrack=function(e){this.emit("audioTackNeedChange",e)},s.prototype.setSubtitles=function(e){this.emit("subtitlesNeedChange",e)},s.prototype.emit=function(e,t){this.player&&this.player.emit(this.namespace+e,t)},s.prototype.set=function(e,t){this.player&&this.player.set(this.namespace!=this.DEFAULT_NAMESPACE?this.namespace+e:e,t)},s.prototype.get=function(e){return this.player&&this.player.get?this.player.get(this.namespace!=this.DEFAULT_NAMESPACE?this.namespace+e:e):null},s.prototype.checkOptions=function(e){if(e.hasOwnProperty("container")&&(this.container=e.container),e.hasOwnProperty("namespace")&&(this.namespace=e.namespace,this.player&&this.namespace!=this.DEFAULT_NAMESPACE&&(this.player.registerProperty(this.namespace+"volume",60,!0),this.player.registerProperty(this.namespace+"position",0),this.player.registerProperty(this.namespace+"duration",0),this.player.registerProperty(this.namespace+"state",-1),this.player.registerProperty(this.namespace+"loadedFraction",0),this.player.registerProperty(this.namespace+"muted",!1,!0))),e.hasOwnProperty("defaultAudioTrack")){var t=parseInt(e.defaultAudioTrack);return isNaN(t)&&(t=String(e.defaultAudioTrack)),delete e.defaultAudioTrack,this.setAudioTrack(t),!1}if(e.hasOwnProperty("defaultQuality")){var n=parseInt(e.defaultQuality);if(delete e.defaultQuality,0!=n)return this.setQuality(n),!1}return e.hasOwnProperty("defaultSubtitles")&&(this.setSubtitles(e.defaultSubtitles),delete e.defaultSubtitles),!0},s.prototype.log=function(e){this.player&&this.player.utils?this.player.utils.log(e):console.log(e)},s.prototype.getPlayableElement=function(){return null}},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){"use strict";function r(e,t){return new Promise(function(n,r){var i={};i.type="CDN",i.stats={},i.bytes=null,i.id=e.substr(e.indexOf("/g/")),i.headers=t.headers,t.headers.Range&&(i.id+="/"+t.headers.Range.replace("bytes=","")),i.loadDefault=function(){console.log("load default "+i.id);var o=new XMLHttpRequest;o.open(t.method,e,!0),o.responseType="arraybuffer",o.timeout=t.retryParameters.timeout,o.withCredentials=t.allowCrossSiteCredentials,o.onload=function(e){var t=e.target;if(t.status>=200&&t.status<=299){var o=t.getAllResponseHeaders().split("\r\n").reduce(function(e,t){var n=t.split(": ");return e[n[0].toLowerCase()]=n.slice(1).join(": "),e},{});t.responseURL&&(u=t.responseURL),i.bytes=t.response.slice(0,t.response.byteLength),a("loadComplete",i);var s={uri:u,data:i.bytes,headers:o};n(s)}else{var l=null;try{l=shaka.util.StringUtils.fromBytesAutoDetect(t.response)}catch(u){}r(new shaka.util.Error(shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.BAD_HTTP_STATUS,u,t.status,l))}},o.onerror=function(t){r(new shaka.util.Error(shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.HTTP_ERROR,e))},o.ontimeout=function(t){r(new shaka.util.Error(shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,e))};for(var s in t.headers)o.setRequestHeader(s,t.headers[s]);o.send(t.body)},i.load=function(e,t){t(i)},i.loadExternal=function(t){t.load(i.id,function(t,r){if(r)return void i.loadDefault();var a={uri:e,data:t.bytes,headers:i.headers};n(a)})};var a=function(e,t){window.pluginP2P&&!window.pluginP2P.disposed&&window.pluginP2P.emit(window.pluginP2P.namespace+"loader:"+e,t||i)};"POST"==t.method?i.loadDefault():(a("set",i),a("load"))})}t.exports=r},{}],8:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this.emit("set"),this.config=t,this.type="CDN",this._stats={},this._bytes=null,this._id=null}return i(e,[{key:"load",value:function(e,t,n){this.loaderContext=e,this.loaderConfig=t,this.loaderCallbacs=n,this._id=this.trimURL(e.url),this.emit("load")}},{key:"loadDefault",value:function(){new this.config.loader(this.config).load(this.loaderContext,this.loaderConfig,{onError:this.loaderCallbacs.onError,onSuccess:this.onChunkLoaded.bind(this),ontimeout:this.loaderCallbacs.ontimeout})}},{key:"loadExternal",value:function(e){var t=this;e.load(this.id,function(e,n){n?t.loadDefault():(t.type=e.type,t.onChunkLoaded({data:e.bytes,url:t.loaderContext.url},e.stats,t.loaderCallbacs))})}},{key:"onChunkLoaded",value:function(e,t){this.loaderCallbacs&&(this._bytes=e.data,this._stats=t,this._id=this.trimURL(e.url),this.emit("loadComplete"),this.loaderCallbacs.onSuccess({url:this.loaderContext.url,data:this._bytes},t,this.loaderContext))}},{key:"abort",value:function(){this.emit("abort"),this.destroy()}},{key:"emit",value:function(e,t){window.pluginP2P&&!window.pluginP2P.disposed&&window.pluginP2P.emit(window.pluginP2P.namespace+"loader:"+e,t||this)}},{key:"destroy",value:function(){this.emit("destroy",this),this.url=null,this._stats=null,this.loaderContext=null,this.loaderCallbacs=null,this.loaderConfig=null}},{key:"trimURL",value:function(e){return-1!=e.indexOf("type.live")?e=e.substr(e.indexOf("type.live")):(e=e.substr(e.indexOf("/a/")),e=e.replace(new RegExp(/\-sid\d+\-/g),""),e=e.replace("type.amlst/",""),e=e.replace("media_",""),e=e.replace("Seg1-","")),e}},{key:"stats",get:function(){return this._stats}},{key:"bytes",get:function(){return this._bytes}},{key:"id",get:function(){return this._id}}]),e}();n["default"]=a},{}],9:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("../utils/Base64"),s=(r(o),e("md5"),function(){function e(t,n,r){i(this,e),this.CHUNK_SIZE=16e3,this.type="P2P",this._peer=t,this._peerController=r,this._incomingPeer=n,this._callback=null,this._loading=!1,this._uploadedChunk=null,this._loadedChunk=null,this._chunkMetadata=null,this._bytes=null,this._stats=null,this._id="",this._disposed=!1,this.toggleEvents(!0)}return a(e,[{key:"load",value:function(e,t){this._id=e,this._loading=!0,this._callback=t,this._incomingPeer.connection.sendMessage("get",this._incomingPeer.id,e),this._stats={trequest:performance.now(),retry:0}}},{key:"onPeerMessage",value:function(e){if(!this._disposed){var t=JSON.parse(e.data);switch(t.type){case"get":var n=this._peerController.plugin.storage,r=n.getChunk(t.data);if(r){var i=r.bytes,a=Math.ceil(i.length/this.CHUNK_SIZE);a*this.CHUNK_SIZE<i.length&&a++,this._uploadedChunk||(this._uploadedChunk=[]);for(var o=0;o<a;o++){var s=i.substr(o*this.CHUNK_SIZE,this.CHUNK_SIZE);this._uploadedChunk.push({id:r.id,size:r.size,length:a,position:o+1,data:s})}var l=this._peer.getConnectionFromID(t.from);if("open"!=l.state)return void(this._callback&&this._callback(null,"channel closed"));l.sendMessage("chunk",t.from,{id:r.id,size:r.size,length:a,hash:r.hash})}break;case"chunk":this._loadedChunk=[],this._stats={trequest:performance.now(),retry:0},this._stats.tfirst=0,this._stats.loaded=0,this._chunkMetadata=t.data,this._incomingPeer.connection.sendMessage("getNext",t.from);break;case"set":if(this.disposed)return;0===this._stats.tfirst&&(this._stats.tfirst=Math.max(performance.now(),this._stats.trequest)),this._loadedChunk.push(t.data),this._incomingPeer.connection.sendMessage("getNext",t.from);break;case"getNext":if(!this._incomingPeer||!this._incomingPeer.connection)return;if(this._uploadedChunk.length){var u=this._uploadedChunk.shift();this._incomingPeer.connection.sendMessage("set",this._incomingPeer.id,u)}else this._loading=!1,this._incomingPeer.connection.sendMessage("end",this._incomingPeer.id);break;case"end":if(!this._loadedChunk)return;this._loadedChunk.sort(this.compare);for(var c="",d=0;d<this._loadedChunk.length;d++)c+=this._loadedChunk[d].data;this._bytes=this._peerController.plugin.b64.decode(c).buffer,this._stats.loaded=this._stats.total=this._bytes.byteLength,this._callback&&this._callback({id:this.id,stats:this._stats,bytes:this._bytes,type:this.type}),console.log("load!"),this._loading=!1;break;case"cancel":this._callback&&this._callback(null,"peer cancel upload")}}}},{key:"onConnectionStateChange",value:function(e){}},{key:"toggleEvents",value:function(e){e?(this._peerController.plugin.on(this._peerController.plugin.namespace+"connection:message",this.onPeerMessage.bind(this)),this._peerController.plugin.on(this._peerController.plugin.namespace+"connection:state",this.onConnectionStateChange.bind(this))):(this._peerController.plugin.off(this._peerController.plugin.namespace+"connection:message",this.onPeerMessage),this._peerController.plugin.off(this._peerController.plugin.namespace+"connection:state",this.onConnectionStateChange))}},{key:"dispose",value:function(){this._disposed=!0,this.toggleEvents(!1),this._peer=null,this._peerController=null,this._incomingPeer=null,this._callback=null,this._loading=!1,this._uploadedChunk=null,this._loadedChunk=null,this._chunkInfo=null,this._bytes=null,this._stats=null,this._id=""}},{key:"compare",value:function(e,t){return e.position<t.position?-1:e.position>t.position?1:0}},{key:"disposed",get:function(){return this._disposed}},{key:"stats",get:function(){return this._stats}},{key:"bytes",get:function(){return this._bytes}},{key:"id",get:function(){return this._id}},{key:"loading",get:function(){return this._loading}}]),e}());n["default"]=s},{"../utils/Base64":17,md5:5}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=e("mggp-player"),u=e("./mns/mns-provider"),c=r(u),d=e("./loader/hls-fragment-loader"),f=r(d),p=e("./loader/dash-fragment-loader"),h=r(p),g=e("./storage/storage"),m=r(g),v=e("./p2p-controller"),y=r(v),_=e("./utils/Base64"),E=r(_),b=e("md5"),T=function(e){
function t(){var e;i(this,t);for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return s.namespace="p2p:",s.config||(s.config={}),window.pluginP2P=s,s.on=s.addEventListener=s.player.on,s.off=s.removeEventListener=s.player.off,s.emit=s.dispathEvent=s.player.emit,s.get=s.player.get,s.set=s.player.set,s._mns=new c["default"](s),s._storage=new m["default"](s),s._controller=new y["default"](s),s._md5=b,s._b64=new E["default"],s.config.fLoader=f["default"],window.shaka&&(shaka.net.NetworkingEngine.registerScheme("http",h["default"]),shaka.net.NetworkingEngine.registerScheme("https",h["default"])),s._disposed=!1,s.emit(s.namespace+"userId",s._mns.userID),s}return o(t,e),s(t,[{key:"dispose",value:function(){this._disposed=!0,this._controller.dispose(),this._storage.dispose(),this._mns.dispose(),this.on=this.addEventListener=null,this.off=this.removeEventListener=null,this.emit=this.dispathEvent=null,this.config.fLoader=null,window.pluginP2P=null,this._mns=null,this._storage=null,this._controller=null}},{key:"log",value:function(e){this.player?this.player.utils.log(e):console.log(e)}},{key:"controller",get:function(){return this._controller}},{key:"storage",get:function(){return this._storage}},{key:"md5",get:function(){return this._md5}},{key:"b64",get:function(){return this._b64}},{key:"mns",get:function(){return this._mns}},{key:"disposed",get:function(){return this._disposed}}]),t}(l.Plugin);n["default"]=T},{"./loader/dash-fragment-loader":7,"./loader/hls-fragment-loader":8,"./mns/mns-provider":11,"./p2p-controller":12,"./storage/storage":16,"./utils/Base64":17,md5:5,"mggp-player":6}],11:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("../utils/Base64"),s=(r(o),function(){function e(t){i(this,e),this.pluginP2P=t,this._connected=!1,this._userID="mggusr_"+parseInt(1e10*Math.random())+"_"+(new Date).getTime(),this._mns=null,this._topic=null,this.pluginP2P.on("mns:connect",this._onConnect.bind(this)),this.pluginP2P.on("mns:disconnect",this._onConnectionLost.bind(this)),this.pluginP2P.on("mns:p2p",this._onMessageArrived.bind(this))}return a(e,[{key:"disconnect",value:function(){this._mns&&this._mns.disconnect()}},{key:"send",value:function(e,t,n){console.log(this.createMessage(e,t,n)),this._mns&&this._mns.publish(this._topic,this.createMessage(e,t,n),!1)}},{key:"_onConnect",value:function(e){this._connected=!0,this._mns=e.data,this.emit("connect",this)}},{key:"_onConnectionLost",value:function(e){this._connected=!1,this._mns=null;var t=e.data,n=0!==t.errorCode?t.errorMessage:"undefined";this.emit("connectionLost",n)}},{key:"_onMessageArrived",value:function(e){var t=this.parseMessage(e.data);(t&&t.to==this._userID||t&&"all"==t.to&&t.from!=this._userID)&&this.emit("message",t)}},{key:"emit",value:function(e,t){this.pluginP2P.disposed||this.pluginP2P.emit(this.pluginP2P.namespace+"mns:"+e,t)}},{key:"dispose",value:function(){}},{key:"createMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n&&(n="string"==typeof n?n:JSON.stringify(n)),e+"/"+this.userID+"/"+t+"/"+n}},{key:"parseMessage",value:function(e){var t={},n=null;-1!=e.indexOf("{")&&(n=e.substr(e.indexOf("{")),e=e.substr(0,e.indexOf("{")));var r=e.split("/");return r.length<3?null:(t.command=r[0],t.from=r[1],t.to=r[2],t.data=n?JSON.parse(n):null,t.from!=this.userID?t:null)}},{key:"connected",get:function(){return this._connected}},{key:"userID",get:function(){return this._userID}},{key:"topic",get:function(){return this._topic},set:function(e){this._topic=e,this._connected&&this._mns.subscribe(this.topic)}}]),e}());n["default"]=s},{"../utils/Base64":17}],12:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./peer/peer"),s=r(o),l=e("./peer/peers-controller"),u=r(l),c=function(){function e(t){i(this,e),this.plugin=t,this.player=t.player,this.mns=t.mns,this.b64=t.b64,this.md5=t.md5,this.peer=new s["default"](this.mns.userID,this.plugin),this.peersController=new u["default"](this.plugin,this.peer),console.log(this.mns.userID),this.on=t.on,this.off=t.off,this.emit=t.emit,this.log=t.log,this.namespace=t.namespace+"p2p:",this._fragmentLoader=null,this._isStarted=!1,this._foundedNodes=[],this.toggleEvents(!0)}return a(e,[{key:"onPlayerStateChange",value:function(e){switch(e.data){case 1:if(!this._isStarted){this._isStarted=!0;var t=this.player.get("videoInfo");this.mns.topic="p2p/"+t.video_id+"/"+this.player.get("audioTrack"),this.mns.send("ping","all",{requestTime:(new Date).getTime().toString()})}}}},{key:"setLoader",value:function(e){this._fragmentLoader=e.data}},{key:"onLoaderLoad",value:function(e){var t=this.plugin.player.getPlayableElement();if(t&&t.buffered&&t.buffered.length>0)for(var n=t.buffered.length,r=this.plugin.player.get("position");n--;)if(t.buffered.start(n)<r&&t.buffered.end(n)>r&&t.buffered.end(n)-r>6)return void this._fragmentLoader.loadExternal(this.peersController);this._fragmentLoader.loadDefault()}},{key:"onLoaderComplete",value:function(e){this.plugin.storage.setChunk(e.data)}},{key:"onLoaderAbort",value:function(e){this.log("P2PController.onLoaderAbort")}},{key:"onLoaderDestroy",value:function(e){this.log("P2PController.onLoaderDestroy")}},{key:"onMQTTConnect",value:function(e){this.log("P2PController.onMQTTConnect")}},{key:"onMQTTConnectionLost",value:function(e){this.log("P2PController.onMQTTConnectionLost")}},{key:"onMQTTMessage",value:function(e){var t=e.data;switch(this.log("P2PController.onMQTTMessage: Command - "+t.command+" , from - "+t.from+" , to - "+t.to),t.command){case"ping":this.mns.send("pong",t.from,{requestTime:t.data.requestTime,peerInfo:this.peer.info});break;case"pong":this.peersController.parsePongMessage(t)}}},{key:"onStorageUpdated",value:function(e){this.peersController.sendMessage("updated",{peerInfo:this.peer.info})}},{key:"dispose",value:function(){}},{key:"toggleEvents",value:function(e){e?(this.on("player:stateChange",this.onPlayerStateChange.bind(this)),this.on(this.plugin.namespace+"loader:set",this.setLoader.bind(this)),this.on(this.plugin.namespace+"loader:load",this.onLoaderLoad.bind(this)),this.on(this.plugin.namespace+"loader:loadComplete",this.onLoaderComplete.bind(this)),this.on(this.plugin.namespace+"loader:abort",this.onLoaderAbort.bind(this)),this.on(this.plugin.namespace+"loader:destroy",this.onLoaderDestroy.bind(this)),this.on(this.plugin.namespace+"mns:connect",this.onMQTTConnect.bind(this)),this.on(this.plugin.namespace+"mns:connectionLost",this.onMQTTConnectionLost.bind(this)),this.on(this.plugin.namespace+"mns:message",this.onMQTTMessage.bind(this)),this.on(this.plugin.namespace+"storage:updated",this.onStorageUpdated.bind(this))):(this.off("player:stateChange",this.onPlayerStateChange),this.off(this.plugin.namespace+"loader:set",this.setLoader),this.off(this.plugin.namespace+"loader:load",this.onLoaderLoad),this.off(this.plugin.namespace+"loader:loadComplete",this.onLoaderComplete),this.off(this.plugin.namespace+"loader:abort",this.onLoaderAbort),this.off(this.plugin.namespace+"loader:destroy",this.onLoaderDestroy),this.off(this.plugin.namespace+"mns:connect",this.onMQTTConnect),this.off(this.plugin.namespace+"mns:connectionLost",this.onMQTTConnectionLost),this.off(this.plugin.namespace+"mns:message",this.onMQTTMessage),this.off(this.plugin.namespace+"storage:updated",this.onStorageUpdated.bind(this)))}}]),e}();n["default"]=c},{"./peer/peer":13,"./peer/peers-controller":14}],13:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("../webrtc/connection"),s=r(o),l=function(){function e(t,n){i(this,e),this._id=t,this.plugin=n,this._connections=[],this._info={},this.toggleEvents(!0)}return a(e,[{key:"createPeerConnection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.getConnection(e)){console.log("Peer.createPeerConnection "+e+", initiator "+t);var n=new s["default"](e,this.plugin);return this._connections.push(n),t&&n.createOffer(e),n}}},{key:"getConnectionFromID",value:function(e){var t=null;return this._connections.forEach(function(n){n.id==e&&(t=n)}),t}},{key:"onMQTTMessage",value:function(e){var t=e.data,n=null;switch(t.command){case"offer":(n=this.getConnection(t.from))?parseInt(t.from.split("_")[2])>parseInt(this._id.split("_")[2])&&(n.reset(),n.createAnswer(t.data)):(n=this.createPeerConnection(t.from),n.createAnswer(t.data));break;case"ice":n=this.getConnection(t.from),n&&n.addIce(t.data);break;case"answer":this.getConnection(t.from)&&(n=this.getConnection(t.from)||this.createPeerConnection(t.from),n.handshake(t.data))}}},{key:"onStorageUpdated",value:function(e){this._info.id=this.id,this._info.chunkList=e.data,this._info.connections=this.connectionsCount,this._info.position=this.plugin.get("position"),this._info.quality=this.plugin.get("quality"),this._info.audio=this.plugin.get("audioTrack")}},{key:"getConnection",value:function(e){for(var t=0;t<this._connections.length;t++)if(this._connections[t].id==e)return this._connections[t];return null}},{key:"toggleEvents",value:function(e){e?(this.plugin.on(this.plugin.namespace+"mns:message",this.onMQTTMessage.bind(this)),this.plugin.on(this.plugin.namespace+"storage:updated",this.onStorageUpdated.bind(this))):(this.plugin.off(this.plugin.namespace+"mns:message",this.onMQTTMessage),this.plugin.off(this.plugin.namespace+"storage:updated",this.onStorageUpdated))}},{key:"dispose",value:function(){this.toggleEvents(!1)}},{key:"id",get:function(){return this._id}},{key:"connectionsCount",get:function(){return this._connections.length}},{key:"info",get:function(){return this._info}}]),e}();n["default"]=l},{"../webrtc/connection":19}],14:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./../loader/webrtc-fragment-loader"),s=r(o),l=function(){function e(t,n){i(this,e),this.plugin=t,this._peer=n,this._book={},this.toggleEvents(!0)}return a(e,[{key:"parsePongMessage",value:function(e){if(console.log(e),!(this._peer.connectionsCount>=10)){var t=this,n=this._peer.info,r=this._book[e.from]||this.createNewPeer(e.data);n.audio==r.audio&&n.quality==r.quality&&r.connections<10&&(this._book[r.id]=r,r.connection=t._peer.createPeerConnection(r.id,!0))}}},{key:"sendMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all";for(var r in this._book)if("all"==n||r==n){var i=this._book[r];i.connection&&i.connection.state==i.connection.OPEN&&i.connection.sendMessage(e,n,t)}}},{key:"onPeerMessage",value:function(e){var t="string"!=typeof e.data?e.data:JSON.parse(e.data);if("update"==t.command){var n=this._book[t.data.peerInfo.id];t.data.requestTime=t.requestTime,n?n.update(t.data):this._book[t.data.peerInfo.id]=this.createNewPeer(t.data)}}},{key:"createNewPeer",value:function(e){var t=new u(e),n=new s["default"](this._peer,t,this);return t.loader=n,this._book[t.id]=t,t}},{key:"onConnectionStateChange",value:function(e){console.log("connection "+e.data.id+" change state to "+e.data.state);var t=e.data.state;if(this._book[e.data.id]){if(this._book[e.data.id].state=t,"open"!=this._book[e.data.id].state)return console.log("delete connection "+e.data.id),this._book[e.data.id].reset(),void delete this._book[e.data.id]}else if("open"==e.data.state){var n=this.createNewPeer({peerInfo:{id:e.data.id,state:e.data.state}});n.connection=e.data}}},{key:"load",value:function(e,t){for(var n in this._book){var r=this._book[n];for(var i in r.chunkList)if(i==e&&r.loader&&!r.loader.loading&&!r.loader.disposed&&r.connection&&"open"==r.connection.state)return void r.loader.load(e,t)}t(null,1)}},{key:"toggleEvents",value:function(e){e?(this.plugin.on(this.plugin.namespace+"connection:message",this.onPeerMessage.bind(this)),this.plugin.on(this.plugin.namespace+"connection:state",this.onConnectionStateChange.bind(this))):(this.plugin.off(this.plugin.namespace+"connection:message",this.onPeerMessage),this.plugin.off(this.plugin.namespace+"connection:state",this.onConnectionStateChange))}}]),e}();n["default"]=l;var u=function(){function e(t){i(this,e),this.parse(t),this._connection=null,this._state="idle",this._distance=[],this._loader=null}return a(e,[{key:"parse",value:function(e){this.reset(),this._id=e.peerInfo.id,this.update(e),console.log(this)}},{key:"update",value:function(e){this._position=e.peerInfo.position,this._quality=e.peerInfo.quality,this._audio=e.peerInfo.audio,this._distance.push((new Date).getTime()-e.requestTime),this._chunkList=e.peerInfo.chunkList,this._connections=e.peerInfo.connections}},{key:"reset",value:function(){this._connection&&this._connection.dispose(),this._loader&&this._loader.dispose(),this._id="",this._state="idle",this._distance=[],this._chunkList={},this._position=0,this._connections=0,this._quality=-1,this._audio=-1}},{key:"id",get:function(){return this._id}},{key:"state",get:function(){return this._state},set:function(e){this._state=e}},{key:"loader",get:function(){return this._loader},set:function(e){this._loader=e}},{key:"distance",get:function(){var e=-1;return this._distance.forEach(function(t){e+=t}),this._distance.length?e/this._distance.length:e}},{key:"position",get:function(){return this._position}},{key:"chunkList",get:function(){return this._chunkList}},{key:"connections",get:function(){return this._connections}},{key:"quality",get:function(){return this._quality}},{key:"audio",get:function(){return this._audio}},{key:"connection",get:function(){return this._connection},set:function(e){this._connection=e}}]),e}()},{"./../loader/webrtc-fragment-loader":9}],15:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("md5"),o=function(){function e(t,n,i,o){r(this,e),this._id=t,this._bytes=o.encode(n),this._size=n.byteLength,this._stats=i,this._hash=a(this._bytes),this._disposed=!1}return i(e,[{key:"dispose",value:function(){this._disposed=!0,this._id=null,this._bytes=null,this._stats=null,this._hash=null}},{key:"id",get:function(){return this._id}},{key:"size",get:function(){return this._size}},{key:"hash",get:function(){return this._hash}},{key:"bytes",get:function(){return this._bytes}},{key:"stats",get:function(){return this._stats}},{key:"disposed",get:function(){return this._disposed}}]),e}();n["default"]=o},{md5:5}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./chunk"),s=r(o),l=function(){function e(t){i(this,e),this.plugin=t,this._maxChunks=t.config.hasOwnProperty("p2pMaxChunkCount")?t.config.p2pMaxChunkCount:60,this._storage=[],this._chunkList={}}return a(e,[{key:"setChunk",value:function(e){if(this._storage.length>=this._maxChunks){var t=this._storage.pop();delete this._chunkList[t.id],t.dispose()}var n=new s["default"](e.id,e.bytes,e.stats,this.plugin.b64);this._chunkList[n.id]=n.size,this._storage.push(n),this.plugin.emit(this.plugin.namespace+"storage:updated",this._chunkList)}},{key:"getChunk",value:function(e){for(var t in this._storage)if(this._storage[t].id==e)return this._storage[t];return null}},{key:"dispose",value:function(){this._storage&&(this._storage.length=0,this._storage=null)}},{key:"size",get:function(){return this._storage.length}},{key:"chunkList",get:function(){return this._chunkList}}]),e}();n["default"]=l},{"./chunk":15}],17:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(){r(this,e),this.encodings="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/="}return i(e,[{key:"decode",value:function(e){var t=this.encodings.indexOf(e.charAt(e.length-1)),n=this.encodings.indexOf(e.charAt(e.length-2)),r=e.length/4*3;64==t&&r--,64==n&&r--;var i,a,o,s,l,u,c,d=0,f=0,p=new Uint8Array(r);for(d=0;d<r;d+=3)s=this.encodings.indexOf(e.charAt(f++)),l=this.encodings.indexOf(e.charAt(f++)),u=this.encodings.indexOf(e.charAt(f++)),c=this.encodings.indexOf(e.charAt(f++)),i=s<<2|l>>4,a=(15&l)<<4|u>>2,o=(3&u)<<6|c,p[d]=i,64!=u&&(p[d+1]=a),64!=c&&(p[d+2]=o);return p}},{key:"encode",value:function(e){for(var t,n,r,i,a,o="",s=new Uint8Array(e),l=s.byteLength,u=l%3,c=l-u,d=0;d<c;d+=3)a=s[d]<<16|s[d+1]<<8|s[d+2],t=(16515072&a)>>18,n=(258048&a)>>12,r=(4032&a)>>6,i=63&a,o+=this.encodings[t]+this.encodings[n]+this.encodings[r]+this.encodings[i];return 1==u?(a=s[c],t=(252&a)>>2,n=(3&a)<<4,o+=this.encodings[t]+this.encodings[n]+"=="):2==u&&(a=s[c]<<8|s[c+1],t=(64512&a)>>10,n=(1008&a)>>4,r=(15&a)<<2,o+=this.encodings[t]+this.encodings[n]+this.encodings[r]+"="),o}}]),e}();n["default"]=a},{}],18:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function a(){r(this,a),this.dataChannelOptions={ordered:!0,maxRetransmits:12};var e=[{RtpDataChannels:!0}],t=[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun.services.mozilla.com"},{url:"stun:stun.anyfirewall.com:3478"},{url:"turn:turn.bistri.com:80",credential:"homeo",username:"homeo"},{url:"turn:turn.anyfirewall.com:443?transport=tcp",credential:"webrtc",username:"webrtc"}];this.servers={iceServers:t,optional:e}};n["default"]=i},{}],19:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./connection-settings"),s=r(o),l=e("rtcpeerconnection"),u=r(l),c=function(){function e(t,n){i(this,e),this.IDLE="idle",this.OPEN="open",this.CONNECTING="connecting",this.CLOSING="closing",this.CLOSED="closed",this.settings=new s["default"],this.namespace=n.namespace+"connection:",this.plugin=n,this.log=n.log,this._id=t,this._mns=n.mns,this._channel=null,this._connection=new u["default"](this.settings),this._state=this.IDLE,this.answer=null,this.offer=null,this.incomingOffer=null,this.incomingAnswer=null,this._disposed=!1,this.toggleEvents(!0)}return a(e,[{key:"createOffer",value:function(){this._channel=this._connection.createDataChannel(this._id,this.settings.dataChannelOptions),this._channel.binaryType="arraybuffer",this.onAddChannel(this._channel),this._connection.offer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},function(e,t){})}},{key:"createAnswer",value:function(e){if(!this.incomingOffer){this.incomingOffer=e;var t=this;this._connection.handleOffer(e,function(e){e||t._connection.answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},function(e,t){})})}}},{key:"reset",value:function(){console.log("reset connection from "+this._id),this._connection.close(),this.toggleEvents(!1),this._connection=new u["default"](this.settings),this.toggleEvents(!0)}},{key:"addIce",value:function(e){this._connection.processIce(e)}},{key:"onOffer",value:function(e,t){this.offer||(this.offer=e,this._mns.send("offer",this._id,e))}},{key:"onAnswer",value:function(e,t){this.answer||(this.answer=e,this._mns.send("answer",this._id,e))}},{key:"handshake",value:function(e){this.incomingAnswer||(this.incomingAnswer=e,this._connection.handleAnswer(e))}},{key:"onIce",value:function(e){this._mns.send("ice",this._id,e)}},{key:"onAddChannel",value:function(e){console.log(e),this._channel=e,this._channel.onmessage=this.handleReceiveMessage.bind(this),this._channel.onopen=this.handleReceiveChannelStatusChange.bind(this),this._channel.onclose=this.handleReceiveChannelStatusChange.bind(this)}},{key:"onClose",value:function(){}},{key:"onIceConnectionStateChange",value:function(){"connected"===this._connection.iceConnectionState||this._connection.iceConnectionState}},{key:"handleReceiveChannelStatusChange",value:function(){this._state=this._channel?this._channel.readyState:this.CLOSED,this.emit("state",this)}},{key:"handleReceiveMessage",value:function(e){this.emit("message",e.data)}},{key:"onPageUnload",value:function(){console.log("ahahaha")}},{key:"sendMessage",value:function(e,t,n){if(this.state!=this.OPEN)return console.log("connection "+this.id+" closed!"),void this.handleReceiveChannelStatusChange();var r={type:e,from:this._mns.userID,to:this.id,data:n};JSON.stringify(r)||console.log(r);try{this._channel.send(JSON.stringify(r))}catch(e){return console.log("connection "+this.id+" closed!"),console.log(e),void this.handleReceiveChannelStatusChange()}}},{key:"send",value:function(e){return this.state!=this.OPEN?(console.log("connection "+this.id+" closed!"),void this.handleReceiveChannelStatusChange()):void this._channel.send(e)}},{key:"emit",value:function(e,t){this.disposed||this.plugin.emit(this.plugin.namespace+"connection:"+e,t)}},{key:"toggleEvents",value:function(e){e?(this._connection.on("ice",this.onIce.bind(this)),this._connection.on("answer",this.onAnswer.bind(this)),this._connection.on("offer",this.onOffer.bind(this)),this._connection.on("close",this.onClose.bind(this)),this._connection.on("addChannel",this.onAddChannel.bind(this)),this._connection.on("iceConnectionStateChange",this.onIceConnectionStateChange.bind(this))):(this._connection.off("ice",this.onIce),this._connection.off("answer",this.onAnswer),this._connection.off("offer",this.onOffer),this._connection.off("close",this.onClose),this._connection.off("addChannel",this.onAddChannel),this._connection.off("iceConnectionStateChange",this.onIceConnectionStateChange.bind(this)))}},{key:"dispose",value:function(){this._disposed=!0,this.toggleEvents(!1),this._connection.close(),this.settings=null,this.namespace=null,this.plugin=null,this.log=null,this._id="",this._mns=null,this._channel=null,this._connection=null,this._state="",this.answer=null,this.offer=null,this.incomingOffer=null,this.incomingAnswer=null}},{key:"id",get:function(){return this._id}},{key:"state",get:function(){return this._state}},{key:"channel",get:function(){return this._channel}},{key:"disposed",get:function(){return this._disposed}}]),e}();n["default"]=c},{"./connection-settings":18,rtcpeerconnection:21}],20:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(d===setTimeout)return setTimeout(e,0);if((d===r||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===i||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){m&&h&&(m=!1,h.length?g=h.concat(g):v=-1,g.length&&l())}function l(){if(!m){var e=a(s);m=!0;for(var t=g.length;t;){for(h=g,g=[];++v<t;)h&&h[v].run();v=-1,t=g.length}h=null,m=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var d,f,p=t.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:r}catch(e){d=r}try{f="function"==typeof clearTimeout?clearTimeout:i}catch(e){f=i}}();var h,g=[],m=!1,v=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new u(e,t)),1!==g.length||m||a(l)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}],21:[function(e,t,n){"use strict";function r(e,t){var n,r=this;o.call(this),e=e||{},e.iceServers=e.iceServers||[];var i=s.browserDetails.browser;this.enableChromeNativeSimulcast=!1,t&&t.optional&&"chrome"===i&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&"chrome"===i&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&"chrome"===i&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),"firefox"===i&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,r.wtFirefox>0&&(r.firefoxcandidatebuffer=[]))})),this.pc=new RTCPeerConnection(e,t),this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc),this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc),this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=function(e){"function"==typeof r.pc.removeStream?r.pc.removeStream.apply(r.pc,arguments):"function"==typeof r.pc.removeTrack&&e.getTracks().forEach(function(e){r.pc.removeTrack(e)})},"function"==typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc)),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onremovetrack=this.emit.bind(this,"removeTrack"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1},this.iceCredentials={local:{},remote:{}};for(n in e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){(e.logger||console).log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}var i=e("util"),a=e("sdp-jingle-json"),o=e("wildemitter"),s=e("webrtc-adapter"),l=e("lodash.clonedeep");i.inherits(r,o),Object.defineProperty(r.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(r.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),r.prototype._role=function(){return this.isInitiator?"initiator":"responder"},r.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},r.prototype._checkLocalCandidate=function(e){var t=a.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},r.prototype._checkRemoteCandidate=function(e){var t=a.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},r.prototype.processIce=function(e,t){t=t||function(){};var n=this;if("closed"===this.pc.signalingState)return t();if(e.contents||e.jingle&&e.jingle.contents){var r=this.remoteDescription.contents.map(function(e){return e.name});(e.contents||e.jingle.contents).forEach(function(e){var i=e.transport||{},o=i.candidates||[],s=r.indexOf(e.name),l=e.name,u=n.remoteDescription.contents.find(function(t){return t.name===e.name}),c=function(){o.forEach(function(e){var t=a.toCandidateSDP(e)+"\r\n";n.pc.addIceCandidate(new RTCIceCandidate({candidate:t,sdpMLineIndex:s,sdpMid:l}),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(t)}),t()};if(n.iceCredentials.remote[e.name]&&i.ufrag&&n.iceCredentials.remote[e.name].ufrag!==i.ufrag)if(u){u.transport.ufrag=i.ufrag,u.transport.pwd=i.pwd;var d={type:"offer",jingle:n.remoteDescription};d.sdp=a.toSessionSDP(d.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.pc.setRemoteDescription(new RTCSessionDescription(d),function(){c()},function(e){n.emit("error",e)})}else n.emit("error","ice restart failed to find matching content");else c()})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),t();n.pc.addIceCandidate(new RTCIceCandidate(e.candidate),function(){},function(e){
n.emit("error",e)}),n._checkRemoteCandidate(e.candidate.candidate),t()}},r.prototype.offer=function(e,t){var n=this,r=2===arguments.length,i=r&&e?e:{offerToReceiveAudio:1,offerToReceiveVideo:1};return t=r?t:e,t=t||function(){},"closed"===this.pc.signalingState?t("Already closed"):void this.pc.createOffer(function(e){var r={type:"offer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("offer",r),t(null,r)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){var i;n.config.useJingle&&(i=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),i.sid=n.config.sid,n.localDescription=i,i.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),r.jingle=i),r.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",r),t(null,r))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},i)},r.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.application.sources||[];0!==t.length&&"3735928559"===t[0].ssrc||(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.application.sources=t)}}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var r=e.jingle.contents[1];r.application&&r.application.bandwidth&&r.application.bandwidth.bandwidth||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)},r.prototype.answerAudioOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};this._answer(t,e)},r.prototype.answerBroadcastOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this._answer(t,e)},r.prototype.answer=function(e,t){var n=2===arguments.length,r=n?t:e,i=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(i,r)},r.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},r.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},r.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");return"closed"===this.pc.signalingState?t("Already closed"):void n.pc.createAnswer(function(e){var r=[];if(n.enableChromeNativeSimulcast&&(e.jingle=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var i=e.jingle.contents[1].application.sourceGroups||[],o=!1;if(i.forEach(function(e){"SIM"==e.semantics&&(o=!0)}),!o&&e.jingle.contents[1].application.sources.length){var s=JSON.parse(JSON.stringify(e.jingle.contents[1].application.sources[0]));s.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(s),r.push(e.jingle.contents[1].application.sources[0].ssrc),r.push(s.ssrc),i.push({semantics:"SIM",sources:r});var u=JSON.parse(JSON.stringify(s));u.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].application.sources.push(u),i.push({semantics:"FID",sources:[s.ssrc,u.ssrc]}),e.jingle.contents[1].application.sourceGroups=i,e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var c={type:"answer",sdp:e.sdp};if(n.assumeSetLocalSuccess){var d=l(c);n.emit("answer",d),t(null,d)}n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var r=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});r.sid=n.config.sid,n.localDescription=r,c.jingle=r}if(n.enableChromeNativeSimulcast&&(c.jingle||(c.jingle=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),c.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),c.sdp=a.toSessionSDP(c.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),c.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),!n.assumeSetLocalSuccess){var i=l(c);n.emit("answer",i),t(null,i)}},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e)},r.prototype._onIce=function(e){var t=this;if(e.candidate){if(this.dontSignalCandidates)return;var n=e.candidate,r={candidate:{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}};this._checkLocalCandidate(n.candidate);var i,o,s=a.toCandidateJSON(n.candidate);if(this.eliminateDuplicateCandidates&&"relay"===s.type&&(i=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component}),(o=i.indexOf(s.foundation+":"+s.component))>-1&&s.priority>>24>=i[o].priority>>24))return;if("max-bundle"===this.config.bundlePolicy&&(i=this._candidateBuffer.filter(function(e){return s.type===e.type}).map(function(e){return e.address+":"+e.port}),(o=i.indexOf(s.address+":"+s.port))>-1))return;if("require"===this.config.rtcpMuxPolicy&&"2"===s.component)return;if(this._candidateBuffer.push(s),t.config.useJingle&&(n.sdpMid||(t.pc.remoteDescription&&"offer"===t.pc.remoteDescription.type?n.sdpMid=t.remoteDescription.contents[n.sdpMLineIndex].name:n.sdpMid=t.localDescription.contents[n.sdpMLineIndex].name),t.iceCredentials.local[n.sdpMid]||a.toSessionJSON(t.pc.localDescription.sdp,{role:t._role(),direction:"outgoing"}).contents.forEach(function(e){var n=e.transport||{};n.ufrag&&(t.iceCredentials.local[e.name]={ufrag:n.ufrag,pwd:n.pwd})}),r.jingle={contents:[{name:n.sdpMid,creator:t._role(),transport:{transportType:"iceUdp",ufrag:t.iceCredentials.local[n.sdpMid].ufrag,pwd:t.iceCredentials.local[n.sdpMid].pwd,candidates:[s]}}]},t.batchIceCandidates>0))return 0===t.batchedIceCandidates.length&&window.setTimeout(function(){var e={};t.batchedIceCandidates.forEach(function(t){t=t.contents[0],e[t.name]||(e[t.name]=t),e[t.name].transport.candidates.push(t.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(e).forEach(function(t){n.jingle.contents.push(e[t])}),t.batchedIceCandidates=[],t.emit("ice",n)},t.batchIceCandidates),void t.batchedIceCandidates.push(r.jingle);this.emit("ice",r)}else this.emit("endOfCandidates")},r.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},r.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},r.prototype.getStats=function(e){this.pc.getStats(null,function(t){e(null,t)},function(t){e(t)})},t.exports=r},{"lodash.clonedeep":4,"sdp-jingle-json":22,util:30,"webrtc-adapter":31,wildemitter:40}],22:[function(e,t,n){"use strict";var r=e("./lib/tosdp"),i=e("./lib/tojson");n.toIncomingSDPOffer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=r.toCandidateSDP,n.toMediaSDP=r.toMediaSDP,n.toSessionSDP=r.toSessionSDP,n.toIncomingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"incoming",creators:t})},n.toOutgoingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:t})},n.toIncomingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:t})},n.toOutgoingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:t})},n.toIncomingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"incoming",creator:t})},n.toOutgoingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:t})},n.toIncomingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:t})},n.toOutgoingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:t})},n.toCandidateJSON=i.toCandidateJSON,n.toMediaJSON=i.toMediaJSON,n.toSessionJSON=i.toSessionJSON},{"./lib/tojson":25,"./lib/tosdp":26}],23:[function(e,t,n){"use strict";n.lines=function(e){return e.split("\r\n").filter(function(e){return e.length>0})},n.findLine=function(e,t,n){for(var r=e.length,i=0;i<t.length;i++)if(t[i].substr(0,r)===e)return t[i];if(!n)return!1;for(var a=0;a<n.length;a++)if(n[a].substr(0,r)===e)return n[a];return!1},n.findLines=function(e,t,n){for(var r=[],i=e.length,a=0;a<t.length;a++)t[a].substr(0,i)===e&&r.push(t[a]);if(r.length||!n)return r;for(var o=0;o<n.length;o++)n[o].substr(0,i)===e&&r.push(n[o]);return r},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},r=3;r<t.length;r++)t[r]&&n.formats.push(t[r]);return n},n.rtpmap=function(e){var t=e.substr(9).split(" "),n={id:t.shift()};return t=t[0].split("/"),n.name=t[0],n.clockrate=t[1],n.channels=3==t.length?t[2]:"1",n},n.sctpmap=function(e){var t=e.substr(10).split(" ");return{number:t.shift(),protocol:t.shift(),streams:t.shift()}},n.fmtp=function(e){for(var t,n,r,i=e.substr(e.indexOf(" ")+1).split(";"),a=[],o=0;o<i.length;o++)t=i[o].split("="),n=t[0].trim(),r=t[1],n&&r?a.push({key:n,value:r}):n&&a.push({key:"",value:n});return a},n.crypto=function(e){var t=e.substr(9).split(" ");return{tag:t[0],cipherSuite:t[1],keyParams:t[2],sessionParams:t.slice(3).join(" ")}},n.fingerprint=function(e){var t=e.substr(14).split(" ");return{hash:t[0],value:t[1]}},n.extmap=function(e){var t=e.substr(9).split(" "),n={},r=t.shift(),i=r.indexOf("/");return i>=0?(n.id=r.substr(0,i),n.senders=r.substr(i+1)):(n.id=r,n.senders="sendrecv"),n.uri=t.shift()||"",n},n.rtcpfb=function(e){var t=e.substr(10).split(" "),n={};return n.id=t.shift(),n.type=t.shift(),"trr-int"===n.type?n.value=t.shift():n.subtype=t.shift()||"",n.parameters=t,n},n.candidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7],generation:"0"},r=8;r<t.length;r+=2)"raddr"===t[r]?n.relAddr=t[r+1]:"rport"===t[r]?n.relPort=t[r+1]:"generation"===t[r]?n.generation=t[r+1]:"tcptype"===t[r]&&(n.tcpType=t[r+1]);return n.network="1",n},n.sourceGroups=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].substr(13).split(" ");t.push({semantics:r.shift(),sources:r})}return t},n.sources=function(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r].substr(7).split(" "),a=i.shift();if(!n[a]){var o={ssrc:a,parameters:[]};t.push(o),n[a]=o}i=i.join(" ").split(":");var s=i.shift(),l=i.join(":")||null;n[a].parameters.push({key:s,value:l})}return t},n.groups=function(e){for(var t,n=[],r=0;r<e.length;r++)t=e[r].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n},n.bandwidth=function(e){var t=e.substr(2).split(":"),n={};return n.type=t.shift(),n.bandwidth=t.shift(),n},n.msid=function(e){var t=e.substr(7),n=t.split(" ");return{msid:t,mslabel:n[0],label:n[1]}}},{}],24:[function(e,t,n){"use strict";t.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],25:[function(e,t,n){"use strict";var r=e("./senders"),i=e("./parsers"),a=Math.random();n._setIdCounter=function(e){a=e},n.toSessionJSON=function(e,t){var r,a=t.creators||[],o=t.role||"initiator",s=t.direction||"outgoing",l=e.split("\r\nm=");for(r=1;r<l.length;r++)l[r]="m="+l[r],r!==l.length-1&&(l[r]+="\r\n");var u=l.shift()+"\r\n",c=i.lines(u),d={},f=[];for(r=0;r<l.length;r++)f.push(n.toMediaJSON(l[r],u,{role:o,direction:s,creator:a[r]||"initiator"}));d.contents=f;var p=i.findLines("a=group:",c);return p.length&&(d.groups=i.groups(p)),d},n.toMediaJSON=function(e,t,a){var o=a.creator||"initiator",s=a.role||"initiator",l=a.direction||"outgoing",u=i.lines(e),c=i.lines(t),d=i.mline(u[0]),f={creator:o,name:d.media,application:{applicationType:"rtp",media:d.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==d.media&&(f.application={applicationType:"datachannel"},f.transport.sctp=[]);var p=f.application,h=f.transport,g=i.findLine("a=mid:",u);if(g&&(f.name=g.substr(6)),i.findLine("a=sendrecv",u,c)?f.senders="both":i.findLine("a=sendonly",u,c)?f.senders=r[s][l].sendonly:i.findLine("a=recvonly",u,c)?f.senders=r[s][l].recvonly:i.findLine("a=inactive",u,c)&&(f.senders="none"),"rtp"==p.applicationType){var m=i.findLine("b=",u);m&&(p.bandwidth=i.bandwidth(m));var v=i.findLine("a=ssrc:",u);v&&(p.ssrc=v.substr(7).split(" ")[0]),i.findLines("a=rtpmap:",u).forEach(function(e){var t=i.rtpmap(e);t.parameters=[],t.feedback=[],i.findLines("a=fmtp:"+t.id,u).forEach(function(e){t.parameters=i.fmtp(e)}),i.findLines("a=rtcp-fb:"+t.id,u).forEach(function(e){t.feedback.push(i.rtcpfb(e))}),p.payloads.push(t)}),i.findLines("a=crypto:",u,c).forEach(function(e){p.encryption.push(i.crypto(e))}),i.findLine("a=rtcp-mux",u)&&(p.mux=!0),i.findLines("a=rtcp-fb:*",u).forEach(function(e){p.feedback.push(i.rtcpfb(e))}),i.findLines("a=extmap:",u).forEach(function(e){var t=i.extmap(e);t.senders=r[s][l][t.senders],p.headerExtensions.push(t)});var y=i.findLines("a=ssrc-group:",u);p.sourceGroups=i.sourceGroups(y||[]);var _=i.findLines("a=ssrc:",u),E=p.sources=i.sources(_||[]),b=i.findLine("a=msid:",u);if(b){var T=i.msid(b);["msid","mslabel","label"].forEach(function(e){for(var t=0;t<E.length;t++){for(var n=!1,r=0;r<E[t].parameters.length;r++)E[t].parameters[r].key===e&&(n=!0);n||E[t].parameters.push({key:e,value:T[e]})}})}i.findLine("a=x-google-flag:conference",u,c)&&(p.googConferenceFlag=!0)}var w=i.findLines("a=fingerprint:",u,c),A=i.findLine("a=setup:",u,c);w.forEach(function(e){var t=i.fingerprint(e);A&&(t.setup=A.substr(8)),h.fingerprints.push(t)});var R=i.findLine("a=ice-ufrag:",u,c),S=i.findLine("a=ice-pwd:",u,c);return R&&S&&(h.ufrag=R.substr(12),h.pwd=S.substr(10),h.candidates=[],i.findLines("a=candidate:",u,c).forEach(function(e){h.candidates.push(n.toCandidateJSON(e))})),"datachannel"==p.applicationType&&i.findLines("a=sctpmap:",u).forEach(function(e){var t=i.sctpmap(e);h.sctp.push(t)}),f},n.toCandidateJSON=function(e){var t=i.candidate(e.split("\r\n")[0]);return t.id=(a++).toString(36).substr(0,12),t}},{"./parsers":23,"./senders":24}],26:[function(e,t,n){"use strict";var r=e("./senders");n.toSessionSDP=function(e,t){var r=(t.role,t.direction,t.sid||e.sid||Date.now()),i=t.time||Date.now(),a=["v=0","o=- "+r+" "+i+" IN IP4 0.0.0.0","s=-","t=0 0"],o=e.contents||[],s=!1;return o.forEach(function(e){e.application.sources&&e.application.sources.length&&(s=!0)}),s&&a.push("a=msid-semantic: WMS *"),(e.groups||[]).forEach(function(e){a.push("a=group:"+e.semantics+" "+e.contents.join(" "))}),o.forEach(function(e){a.push(n.toMediaSDP(e,t))}),a.join("\r\n")+"\r\n"},n.toMediaSDP=function(e,t){var i=[],a=t.role||"initiator",o=t.direction||"outgoing",s=e.application,l=e.transport,u=s.payloads||[],c=l&&l.fingerprints||[],d=[];return"datachannel"==s.applicationType?(d.push("application"),d.push("1"),d.push("DTLS/SCTP"),l.sctp&&l.sctp.forEach(function(e){d.push(e.number)})):(d.push(s.media),d.push("1"),c.length>0?d.push("UDP/TLS/RTP/SAVPF"):s.encryption&&s.encryption.length>0?d.push("RTP/SAVPF"):d.push("RTP/AVPF"),u.forEach(function(e){d.push(e.id)})),i.push("m="+d.join(" ")),i.push("c=IN IP4 0.0.0.0"),s.bandwidth&&s.bandwidth.type&&s.bandwidth.bandwidth&&i.push("b="+s.bandwidth.type+":"+s.bandwidth.bandwidth),"rtp"==s.applicationType&&i.push("a=rtcp:1 IN IP4 0.0.0.0"),l&&(l.ufrag&&i.push("a=ice-ufrag:"+l.ufrag),l.pwd&&i.push("a=ice-pwd:"+l.pwd),c.forEach(function(e){i.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&i.push("a=setup:"+e.setup)}),l.sctp&&l.sctp.forEach(function(e){i.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)})),"rtp"==s.applicationType&&i.push("a="+(r[a][o][e.senders]||"sendrecv")),i.push("a=mid:"+e.name),s.sources&&s.sources.length&&(s.sources[0].parameters||[]).forEach(function(e){"msid"===e.key&&i.push("a=msid:"+e.value)}),s.mux&&i.push("a=rtcp-mux"),(s.encryption||[]).forEach(function(e){i.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),s.googConferenceFlag&&i.push("a=x-google-flag:conference"),u.forEach(function(e){var t="a=rtpmap:"+e.id+" "+e.name+"/"+e.clockrate;if(e.channels&&"1"!=e.channels&&(t+="/"+e.channels),i.push(t),e.parameters&&e.parameters.length){var n=["a=fmtp:"+e.id],r=[];e.parameters.forEach(function(e){r.push((e.key?e.key+"=":"")+e.value)}),n.push(r.join(";")),i.push(n.join(" "))}e.feedback&&e.feedback.forEach(function(t){"trr-int"===t.type?i.push("a=rtcp-fb:"+e.id+" trr-int "+(t.value?t.value:"0")):i.push("a=rtcp-fb:"+e.id+" "+t.type+(t.subtype?" "+t.subtype:""))})}),s.feedback&&s.feedback.forEach(function(e){"trr-int"===e.type?i.push("a=rtcp-fb:* trr-int "+(e.value?e.value:"0")):i.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))}),(s.headerExtensions||[]).forEach(function(e){i.push("a=extmap:"+e.id+(e.senders?"/"+r[a][o][e.senders]:"")+" "+e.uri)}),(s.sourceGroups||[]).forEach(function(e){i.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))}),(s.sources||[]).forEach(function(e){for(var t=0;t<e.parameters.length;t++){var n=e.parameters[t];i.push("a=ssrc:"+(e.ssrc||s.ssrc)+" "+n.key+(n.value?":"+n.value:""))}}),(l.candidates||[]).forEach(function(e){i.push(n.toCandidateSDP(e))}),i.join("\r\n")},n.toCandidateSDP=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"srflx"!==n&&"prflx"!==n&&"relay"!==n||e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(t.push("tcptype"),t.push(e.tcpType)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{"./senders":24}],27:[function(e,t,n){"use strict";var r={};r.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},r.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)t=r[i].trim().split("="),n[t[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){r.push(t+"="+e.parameters[t])}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return n=n.concat(r.splitLines(t)),{usernameFragment:n.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e),i=n[0].split(" "),a=3;a<i.length;a++){var o=i[a],s=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var l=r.parseRtpMap(s),u=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(l.parameters=u.length?r.parseFmtp(u[0]):{},l.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(l),l.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(l.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),a=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),l=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===l&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:l,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{ssrc:t}};n.push(r),a&&(r=JSON.parse(JSON.stringify(r)),r.fec={ssrc:t,mechanism:o?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&l&&n.push({ssrc:l});var c=r.matchPrefix(e,"b=");return c.length&&(0===c[0].indexOf("b=TIAS:")?c=parseInt(c[0].substr(7),10):0===c[0].indexOf("b=AS:")&&(c=parseInt(c[0].substr(5),10)),n.forEach(function(e){e.maxBitrate=c})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var a=r.matchPrefix(e,"a=rtcp-mux");return t.mux=a.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return t=n[0].substr(7).split(" "),{stream:t[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?(t=i[0].value.split(" "),{stream:t[0],track:t[1]}):void 0},r.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",a+=e.direction?"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var o="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+o,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.exports=r},{}],28:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],29:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=function(e){return e&&"object"===(void 0===e?"undefined":r(e))&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],30:[function(e,t,n){(function(t,r){function i(e,t){var r={seen:[],stylize:o};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(t)?r.showHidden=t:t&&n._extend(r,t),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=a),l(r,e,r.depth)}function a(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function o(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function l(e,t,r){if(e.customInspect&&t&&S(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return _(i)||(i=l(e,i,r)),i}var a=u(e,t);if(a)return a;var o=Object.keys(t),g=s(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),R(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return c(t);if(0===o.length){if(S(t)){var m=t.name?": "+t.name:"";return e.stylize("[Function"+m+"]","special")}if(T(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(A(t))return e.stylize(Date.prototype.toString.call(t),"date");if(R(t))return c(t)}var v="",y=!1,E=["{","}"];if(h(t)&&(y=!0,E=["[","]"]),S(t)&&(v=" [Function"+(t.name?": "+t.name:"")+"]"),T(t)&&(v=" "+RegExp.prototype.toString.call(t)),A(t)&&(v=" "+Date.prototype.toUTCString.call(t)),R(t)&&(v=" "+c(t)),0===o.length&&(!y||0==t.length))return E[0]+v+E[1];if(r<0)return T(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var b;return b=y?d(e,t,r,g,o):o.map(function(n){return f(e,t,r,g,n,y)}),e.seen.pop(),p(b,v,E)}function u(e,t){if(b(t))return e.stylize("undefined","undefined");if(_(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return y(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i){for(var a=[],o=0,s=t.length;o<s;++o)D(t,String(o))?a.push(f(e,t,n,r,String(o),!0)):a.push("");return i.forEach(function(i){i.match(/^\d+$/)||a.push(f(e,t,n,r,i,!0))}),a}function f(e,t,n,r,i,a){var o,s,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},u.get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),
D(r,i)||(o="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=m(n)?l(e,u.value,null):l(e,u.value,n-1),s.indexOf("\n")>-1&&(s=a?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),b(o)){if(a&&i.match(/^\d+$/))return s;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function p(e,t,n){var r=0;return e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return null==e}function y(e){return"number"==typeof e}function _(e){return"string"==typeof e}function E(e){return"symbol"==typeof e}function b(e){return void 0===e}function T(e){return w(e)&&"[object RegExp]"===O(e)}function w(e){return"object"==typeof e&&null!==e}function A(e){return w(e)&&"[object Date]"===O(e)}function R(e){return w(e)&&("[object Error]"===O(e)||e instanceof Error)}function S(e){return"function"==typeof e}function k(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function O(e){return Object.prototype.toString.call(e)}function L(e){return e<10?"0"+e.toString(10):e.toString(10)}function C(){var e=new Date,t=[L(e.getHours()),L(e.getMinutes()),L(e.getSeconds())].join(":");return[e.getDate(),M[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var P=/%[sdj%]/g;n.format=function(e){if(!_(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,a=r.length,o=String(e).replace(P,function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),s=r[n];n<a;s=r[++n])o+=m(s)||!w(s)?" "+s:" "+i(s);return o},n.deprecate=function(e,i){function a(){if(!o){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}if(b(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var o=!1;return a};var I,N={};n.debuglog=function(e){if(b(I)&&(I=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!N[e])if(new RegExp("\\b"+e+"\\b","i").test(I)){var r=t.pid;N[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else N[e]=function(){};return N[e]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=h,n.isBoolean=g,n.isNull=m,n.isNullOrUndefined=v,n.isNumber=y,n.isString=_,n.isSymbol=E,n.isUndefined=b,n.isRegExp=T,n.isObject=w,n.isDate=A,n.isError=R,n.isFunction=S,n.isPrimitive=k,n.isBuffer=e("./support/isBuffer");var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",C(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":29,_process:20,inherits:28}],31:[function(e,t,n){"use strict";!function(){var n=e("./utils").log,r=e("./utils").browserDetails;t.exports.browserDetails=r,t.exports.extractVersion=e("./utils").extractVersion,t.exports.disableLog=e("./utils").disableLog;var i=e("./chrome/chrome_shim")||null,a=e("./edge/edge_shim")||null,o=e("./firefox/firefox_shim")||null,s=e("./safari/safari_shim")||null;switch(r.browser){case"opera":case"chrome":if(!i||!i.shimPeerConnection)return void n("Chrome shim is not included in this adapter release.");n("adapter.js shimming chrome."),t.exports.browserShim=i,i.shimGetUserMedia(),i.shimMediaStream(),i.shimSourceObject(),i.shimPeerConnection(),i.shimOnTrack();break;case"firefox":if(!o||!o.shimPeerConnection)return void n("Firefox shim is not included in this adapter release.");n("adapter.js shimming firefox."),t.exports.browserShim=o,o.shimGetUserMedia(),o.shimSourceObject(),o.shimPeerConnection(),o.shimOnTrack();break;case"edge":if(!a||!a.shimPeerConnection)return void n("MS edge shim is not included in this adapter release.");n("adapter.js shimming edge."),t.exports.browserShim=a,a.shimGetUserMedia(),a.shimPeerConnection();break;case"safari":if(!s)return void n("Safari shim is not included in this adapter release.");n("adapter.js shimming safari."),t.exports.browserShim=s,s.shimGetUserMedia();break;default:n("Unsupported browser!")}}()},{"./chrome/chrome_shim":32,"./edge/edge_shim":34,"./firefox/firefox_shim":36,"./safari/safari_shim":38,"./utils":39}],32:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("../utils.js").log,a=e("../utils.js").browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!==("undefined"==typeof window?"undefined":r(window))||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var t=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.addEventListener("addtrack",function(n){var r=new Event("track");r.track=n.track,r.receiver={track:n.track},r.streams=[e.stream],t.dispatchEvent(r)}),e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"===("undefined"==typeof window?"undefined":r(window))&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;return this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),void 0):void(this.src="")}}))},shimPeerConnection:function(){window.RTCPeerConnection=function(e,t){i("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),a=n.getStats.bind(n);return n.getStats=function(e,t,n){var i=this,o=arguments;if(arguments.length>0&&"function"==typeof e)return a(e,t);var s=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},l=function(e,t){var n=new Map(Object.keys(e).map(function(t){return[t,e[t]]}));return t=t||e,Object.keys(t).forEach(function(e){n[e]=t[e]}),n};if(arguments.length>=2){var u=function(e){o[1](l(s(e)))};return a.apply(this,[u,arguments[0]])}return new Promise(function(t,n){1===o.length&&"object"===(void 0===e?"undefined":r(e))?a.apply(i,[function(e){t(l(s(e)))},n]):a.apply(i,[function(e){t(l(s(e),e.result()))},n])}).then(t,n)},n},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"===r(arguments[0])){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(r,i){t.apply(e,[r,i,n])})}return t.apply(this,arguments)}}),a.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this,r=new Promise(function(r,i){t.apply(n,[e[0],r,i])});return e.length<2?r:r.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":39,"./getusermedia":33}],33:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("../utils.js").log;t.exports=function(){var e=function(e){if("object"!==(void 0===e?"undefined":r(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"===r(e[n])?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var a=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var o={};"number"==typeof i.ideal?(o[a("min",n)]=i.ideal,t.optional.push(o),o={},o[a("max",n)]=i.ideal,t.optional.push(o)):(o[a("",n)]=i.ideal,t.optional.push(o))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[a("",n)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[a(e,n)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},t=function(t,n){if(t=JSON.parse(JSON.stringify(t)),t&&t.audio&&(t.audio=e(t.audio)),t&&"object"===r(t.video)){var a=t.video.facingMode;if((a=a&&("object"===(void 0===a?"undefined":r(a))?a:{ideal:a}))&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete t.video.facingMode,"environment"===a.exact||"environment"===a.ideal))return navigator.mediaDevices.enumerateDevices().then(function(r){r=r.filter(function(e){return"videoinput"===e.kind});var o=r.find(function(e){return-1!==e.label.toLowerCase().indexOf("back")})||r.length&&r[r.length-1];return o&&(t.video.deviceId=a.exact?{exact:o.deviceId}:{ideal:o.deviceId}),t.video=e(t.video),i("chrome: "+JSON.stringify(t)),n(t)});t.video=e(t.video)}return i("chrome: "+JSON.stringify(t)),n(t)},n=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},a=function(e,r,i){t(e,function(e){navigator.webkitGetUserMedia(e,r,function(e){i(n(e))})})};navigator.getUserMedia=a;var o=function(e){return new Promise(function(t,n){navigator.getUserMedia(e,t,n)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:o,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var s=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e,function(e){return s(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(n(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return o(e)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){i("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){i("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":39}],34:[function(e,t,n){"use strict";var r=e("sdp"),i=e("../utils").browserDetails,a={shimPeerConnection:function(){if(window.RTCIceGatherer){window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e});var e=Object.getOwnPropertyDescriptor(MediaStreamTrack.prototype,"enabled");Object.defineProperty(MediaStreamTrack.prototype,"enabled",{set:function(t){e.set.call(this,t);var n=new Event("enabled");n.enabled=t,this.dispatchEvent(n)}})}window.RTCPeerConnection=function(e){var t=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=n[e].bind(n)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw new TypeError('iceTransportPolicy "none" not supported')}if(this.usingBundle=e&&"max-bundle"===e.bundlePolicy,e&&e.iceServers){var r=JSON.parse(JSON.stringify(e.iceServers));this.iceOptions.iceServers=r.filter(function(e){if(e&&e.urls){var t=e.urls;return"string"==typeof t&&(t=[t]),!!(t=t.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")||0===e.indexOf("stun:")&&i.version>=14393})[0])}return!1})}this._config=e,this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var e=this,t=r.splitSections(e.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(n){if(n.candidate&&0!==Object.keys(n.candidate).length)-1===n.candidate.candidate.indexOf("typ endOfCandidates")&&(t[n.candidate.sdpMLineIndex+1]+="a="+n.candidate.candidate+"\r\n");else for(var r=1;r<t.length;r++)-1===t[r].indexOf("\r\na=end-of-candidates\r\n")&&(t[r]+="a=end-of-candidates\r\n");e.localDescription.sdp=t.join(""),e.dispatchEvent(n),null!==e.onicecandidate&&e.onicecandidate(n),n.candidate||"complete"===e.iceGatheringState||e.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state})&&(e.iceGatheringState="complete")}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.getConfiguration=function(){return this._config},window.RTCPeerConnection.prototype.addStream=function(e){var t=e.clone();e.getTracks().forEach(function(e,n){var r=t.getTracks()[n];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),this.localStreams.push(t),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);t>-1&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(e){for(var r=0;r<t.codecs.length;r++){var i=t.codecs[r];if(e.name.toLowerCase()===i.name.toLowerCase()&&e.clockRate===i.clockRate){i.numChannels=Math.min(e.numChannels,i.numChannels),n.codecs.push(i),i.rtcpFeedback=i.rtcpFeedback.filter(function(t){for(var n=0;n<e.rtcpFeedback.length;n++)if(e.rtcpFeedback[n].type===t.type&&e.rtcpFeedback[n].parameter===t.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(e,t){var n=this,i=new RTCIceGatherer(n.iceOptions),a=new RTCIceTransport(i);i.onlocalcandidate=function(o){var s=new Event("icecandidate");s.candidate={sdpMid:e,sdpMLineIndex:t};var l=o.candidate,u=!l||0===Object.keys(l).length;u?(void 0===i.state&&(i.state="completed"),s.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(l.component="RTCP"===a.component?2:1,s.candidate.candidate=r.writeCandidate(l));var c=r.splitSections(n.localDescription.sdp);-1===s.candidate.candidate.indexOf("typ endOfCandidates")?c[s.candidate.sdpMLineIndex+1]+="a="+s.candidate.candidate+"\r\n":c[s.candidate.sdpMLineIndex+1]+="a=end-of-candidates\r\n",n.localDescription.sdp=c.join("");var d=n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(n.iceGatheringState){case"new":n._localIceCandidatesBuffer.push(s),u&&d&&n._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":n._emitBufferedCandidates(),n.dispatchEvent(s),null!==n.onicecandidate&&n.onicecandidate(s),d&&(n.dispatchEvent(new Event("icecandidate")),null!==n.onicecandidate&&n.onicecandidate(new Event("icecandidate")),n.iceGatheringState="complete")}},a.onicestatechange=function(){n._updateConnectionState()};var o=new RTCDtlsTransport(a);return o.ondtlsstatechange=function(){n._updateConnectionState()},o.onerror=function(){o.state="failed",n._updateConnectionState()},{iceGatherer:i,iceTransport:a,dtlsTransport:o}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var i=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:r.localCName},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),n&&e.rtpReceiver&&("video"===e.kind&&e.recvEncodingParameters&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),i.encodings=e.recvEncodingParameters,i.rtcp={cname:e.cname},e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t,n,i=this;if("offer"===e.type)this._pendingOffer&&(t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=r.splitSections(i.remoteDescription.sdp),n=t.shift();var a=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var o=i.transceivers[t],s=o.iceGatherer,l=o.iceTransport,u=o.dtlsTransport,c=o.localCapabilities,d=o.remoteCapabilities;if("0"!==e.split("\n",1)[0].split(" ",2)[1]&&!o.isDatachannel){var f=r.getIceParameters(e,n);if(a){var p=r.matchPrefix(e,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});p.length&&l.setRemoteCandidates(p)}var h=r.getDtlsParameters(e,n);a&&(h.role="server"),i.usingBundle&&0!==t||(l.start(s,f,a?"controlling":"controlled"),u.start(h));var g=i._getCommonCapabilities(c,d);i._transceive(o,g.codecs.length>0,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var o=arguments.length>1&&"function"==typeof arguments[1];if(o){var s=arguments[1];window.setTimeout(function(){s(),"new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),i._emitBufferedCandidates()},0)}var l=Promise.resolve();return l.then(function(){o||("new"===i.iceGatheringState&&(i.iceGatheringState="gathering"),window.setTimeout(i._emitBufferedCandidates.bind(i),500))}),l},window.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t=this,n=new MediaStream,i=[],a=r.splitSections(e.sdp),o=a.shift(),s=r.matchPrefix(o,"a=ice-lite").length>0;switch(this.usingBundle=r.matchPrefix(o,"a=group:BUNDLE ").length>0,a.forEach(function(a,l){var u=r.splitLines(a),c=u[0].substr(2).split(" "),d=c[0],f="0"===c[1],p=r.getDirection(a,o),h=r.matchPrefix(a,"a=mid:");if(h=h.length?h[0].substr(6):r.generateIdentifier(),"application"===d&&"DTLS/SCTP"===c[2])return void(t.transceivers[l]={mid:h,isDatachannel:!0});var g,m,v,y,_,E,b,T,w,A,R,S,k=r.parseRtpParameters(a);f||(R=r.getIceParameters(a,o),S=r.getDtlsParameters(a,o),S.role="client"),T=r.parseRtpEncodingParameters(a);var O,L=r.matchPrefix(a,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];L&&(O=L.value);var C=r.matchPrefix(a,"a=end-of-candidates",o).length>0,D=r.matchPrefix(a,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return"1"===e.component});if("offer"!==e.type||f)"answer"!==e.type||f||(g=t.transceivers[l],m=g.iceGatherer,v=g.iceTransport,y=g.dtlsTransport,_=g.rtpSender,E=g.rtpReceiver,b=g.sendEncodingParameters,w=g.localCapabilities,t.transceivers[l].recvEncodingParameters=T,t.transceivers[l].remoteCapabilities=k,t.transceivers[l].cname=O,(s||C)&&D.length&&v.setRemoteCandidates(D),t.usingBundle&&0!==l||(v.start(m,R,"controlling"),y.start(S)),t._transceive(g,"sendrecv"===p||"recvonly"===p,"sendrecv"===p||"sendonly"===p),!E||"sendrecv"!==p&&"sendonly"!==p?delete g.rtpReceiver:(A=E.track,i.push([A,E]),n.addTrack(A)));else{var P=t.usingBundle&&l>0?{iceGatherer:t.transceivers[0].iceGatherer,iceTransport:t.transceivers[0].iceTransport,dtlsTransport:t.transceivers[0].dtlsTransport}:t._createIceAndDtlsTransports(h,l);if(C&&P.iceTransport.setRemoteCandidates(D),w=RTCRtpReceiver.getCapabilities(d),w.codecs=w.codecs.filter(function(e){return"rtx"!==e.name}),b=[{ssrc:1001*(2*l+2)}],E=new RTCRtpReceiver(P.dtlsTransport,d),A=E.track,i.push([A,E]),n.addTrack(A),t.localStreams.length>0&&t.localStreams[0].getTracks().length>=l){var I;"audio"===d?I=t.localStreams[0].getAudioTracks()[0]:"video"===d&&(I=t.localStreams[0].getVideoTracks()[0]),I&&(_=new RTCRtpSender(I,P.dtlsTransport))}t.transceivers[l]={iceGatherer:P.iceGatherer,iceTransport:P.iceTransport,dtlsTransport:P.dtlsTransport,localCapabilities:w,remoteCapabilities:k,rtpSender:_,rtpReceiver:E,kind:d,mid:h,cname:O,sendEncodingParameters:b,recvEncodingParameters:T},t._transceive(t.transceivers[l],!1,"sendrecv"===p||"sendonly"===p)}}),this.remoteDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}return n.getTracks().length&&(t.remoteStreams.push(n),window.setTimeout(function(){var e=new Event("addstream");e.stream=n,t.dispatchEvent(e),null!==t.onaddstream&&window.setTimeout(function(){t.onaddstream(e)},0),i.forEach(function(r){var i=r[0],a=r[1],o=new Event("track");o.track=i,o.receiver=a,o.streams=[n],t.dispatchEvent(e),null!==t.ontrack&&window.setTimeout(function(){t.ontrack(o)},0)})},0)),arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var e=new Event("negotiationneeded");this.dispatchEvent(e),null!==this.onnegotiationneeded&&this.onnegotiationneeded(e)},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t=this,n={"new":0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){n[e.iceTransport.state]++,n[e.dtlsTransport.state]++}),n.connected+=n.completed,e="new",n.failed>0?e="failed":n.connecting>0||n.checking>0?e="connecting":n.disconnected>0?e="disconnected":n["new"]>0?e="new":(n.connected>0||n.completed>0)&&(e="connected"),e!==t.iceConnectionState){t.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this.dispatchEvent(r),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(r)}},window.RTCPeerConnection.prototype.createOffer=function(){var e=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");var t;1===arguments.length&&"function"!=typeof arguments[0]?t=arguments[0]:3===arguments.length&&(t=arguments[2]);var n=[],i=0,a=0;if(this.localStreams.length&&(i=this.localStreams[0].getAudioTracks().length,a=this.localStreams[0].getVideoTracks().length),t){if(t.mandatory||t.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==t.offerToReceiveAudio&&(i=t.offerToReceiveAudio),void 0!==t.offerToReceiveVideo&&(a=t.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){n.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?i>0:a>0}),"audio"===e.kind?i--:"video"===e.kind&&a--});i>0||a>0;)i>0&&(n.push({kind:"audio",wantReceive:!0}),i--),a>0&&(n.push({kind:"video",wantReceive:!0}),a--);var o=r.writeSessionBoilerplate(),s=[];n.forEach(function(t,n){var i=t.track,a=t.kind,o=r.generateIdentifier(),l=e.usingBundle&&n>0?{iceGatherer:s[0].iceGatherer,iceTransport:s[0].iceTransport,dtlsTransport:s[0].dtlsTransport}:e._createIceAndDtlsTransports(o,n),u=RTCRtpSender.getCapabilities(a);u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name}),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1")});var c,d,f=[{ssrc:1001*(2*n+1)}];i&&(c=new RTCRtpSender(i,l.dtlsTransport)),t.wantReceive&&(d=new RTCRtpReceiver(l.dtlsTransport,a)),s[n]={iceGatherer:l.iceGatherer,iceTransport:l.iceTransport,dtlsTransport:l.dtlsTransport,localCapabilities:u,remoteCapabilities:null,rtpSender:c,rtpReceiver:d,kind:a,mid:o,sendEncodingParameters:f,recvEncodingParameters:null}}),this.usingBundle&&(o+="a=group:BUNDLE "+s.map(function(e){return e.mid}).join(" ")+"\r\n"),n.forEach(function(t,n){var i=s[n];o+=r.writeMediaSection(i,i.localCapabilities,"offer",e.localStreams[0])}),this._pendingOffer=s;var l=new RTCSessionDescription({type:"offer",sdp:o});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,l),Promise.resolve(l)},window.RTCPeerConnection.prototype.createAnswer=function(){var e=this,t=r.writeSessionBoilerplate();this.usingBundle&&(t+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(n){if(n.isDatachannel)return void(t+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+n.mid+"\r\n");var i=e._getCommonCapabilities(n.localCapabilities,n.remoteCapabilities);t+=r.writeMediaSection(n,i,"answer",e.localStreams[0])});var n=new RTCSessionDescription({type:"answer",sdp:t});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,n),Promise.resolve(n)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){if(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var i=this.transceivers[t];if(i){var a=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===a.protocol&&(0===a.port||9===a.port))return;if("1"!==a.component)return;"endOfCandidates"===a.type&&(a={}),i.iceTransport.addRemoteCandidate(a);var o=r.splitSections(this.remoteDescription.sdp);o[t+1]+=(a.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=o.join("")}}else this.transceivers.forEach(function(e){e.iceTransport.addRemoteCandidate({})});return arguments.length>1&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var e=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(n){t[n]&&e.push(t[n].getStats())})});var t=arguments.length>1&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(n){var r=new Map;Promise.all(e).then(function(e){e.forEach(function(e){Object.keys(e).forEach(function(t){r.set(t,e[t]),r[t]=e[t]})}),t&&window.setTimeout(t,0,r),n(r)})})}}};t.exports={shimPeerConnection:a.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":39,"./getusermedia":35,sdp:27}],35:[function(e,t,n){"use strict";t.exports=function(){var e=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}},t=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(n){return t(n)["catch"](function(t){return Promise.reject(e(t))})}}},{}],36:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("../utils").browserDetails,a={shimOnTrack:function(){"object"!==("undefined"==typeof window?"undefined":r(window))||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={
track:t},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"===("undefined"==typeof window?"undefined":r(window))&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"===("undefined"==typeof window?"undefined":r(window))&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(i.version<38&&e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var a=e.iceServers[r];if(a.hasOwnProperty("urls"))for(var o=0;o<a.urls.length;o++){var s={url:a.urls[o]};0===a.urls[o].indexOf("turn")&&(s.username=a.username,s.credential=a.credential),n.push(s)}else n.push(e.iceServers[r])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;if(RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())},i.version<48){var t=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t},n=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,r,i){return n.apply(this,[e||null]).then(function(e){return t(e)}).then(r,i)}}}}};t.exports={shimOnTrack:a.shimOnTrack,shimSourceObject:a.shimSourceObject,shimPeerConnection:a.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":39,"./getusermedia":37}],37:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("../utils").log,a=e("../utils").browserDetails;t.exports=function(){var e=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},t=function(t,n,o){var s=function(e){if("object"!==(void 0===e?"undefined":r(e))||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i=e[n]="object"===r(e[n])?e[n]:{ideal:e[n]};if(void 0===i.min&&void 0===i.max&&void 0===i.exact||t.push(n),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:e[n]=i.exact,delete i.exact),void 0!==i.ideal){e.advanced=e.advanced||[];var a={};"number"==typeof i.ideal?a[n]={min:i.ideal,max:i.ideal}:a[n]=i.ideal,e.advanced.push(a),delete i.ideal,Object.keys(i).length||delete e[n]}}}),t.length&&(e.require=t),e};return t=JSON.parse(JSON.stringify(t)),a.version<38&&(i("spec: "+JSON.stringify(t)),t.audio&&(t.audio=s(t.audio)),t.video&&(t.video=s(t.video)),i("ff37: "+JSON.stringify(t))),navigator.mozGetUserMedia(t,n,function(t){o(e(t))})},n=function(e){return new Promise(function(n,r){t(e,n,r)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:n,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},a.version<41){var o=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return o().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(a.version<49){var s=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return s(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(t){return Promise.reject(e(t))})}}navigator.getUserMedia=function(e,n,r){return a.version<44?t(e,n,r):(console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),void navigator.mediaDevices.getUserMedia(e).then(n,r))}}},{"../utils":39}],38:[function(e,t,n){"use strict";var r={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};t.exports={shimGetUserMedia:r.shimGetUserMedia}},{}],39:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=!0,a={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+(void 0===e?"undefined":r(e))+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},log:function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={};if(e.browser=null,e.version=null,"undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1)}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2)}return e}};t.exports={log:a.log,disableLog:a.disableLog,browserDetails:a.detectBrowser(),extractVersion:a.extractVersion}},{}],40:[function(e,t,n){"use strict";function r(){}t.exports=r,r.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,i=r?arguments[1]:void 0,a=r?arguments[2]:arguments[1];return a._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(a),this},t.once=function(e,t,n){function r(){i.off(e,r),s.apply(this,arguments)}var i=this,a=3===arguments.length,o=a?arguments[1]:void 0,s=a?arguments[2]:arguments[1];return this.on(e,o,r),this},t.releaseGroup=function(e){this.callbacks=this.callbacks||{};var t,n,r,i;for(t in this.callbacks)for(i=this.callbacks[t],n=0,r=i.length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r?1===arguments.length?(delete this.callbacks[e],this):(n=r.indexOf(t),r.splice(n,1),0===r.length&&delete this.callbacks[e],this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),a=this.callbacks[e],o=this.getWildcardCallbacks(e);if(a)for(r=a.slice(),t=0,n=r.length;t<n&&r[t];++t)r[t].apply(this,i);if(o)for(n=o.length,r=o.slice(),t=0,n=r.length;t<n&&r[t];++t)r[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},r.mixin(r)},{}]},{},[10])(10)})},{}],37:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginQuality=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";var r=e("mggp-player").Plugin,i=function(){r.apply(this,arguments);var e=this,t=e.player,n=null,i=[],a=!1,o=!1,s=null;this.dispose=function(){f(!1),t=null,n=null,i=[]};var l=function(){a=!0,f(!1),t.on("property:videoInfo",u),t.on("player:qualityNeedChange",d),n=null,i=null},u=function(r){if(n=r.data,i=n.bitrates||[],0==i.length&&a)return void t.set("qualityList",[]);a&&(a=!1,f(!0)),n.src.indexOf("m3u8")!=-1&&("tv"==t.config.deviceType?1!=n.is_tv&&1!=n.is_live||(y(n.src),o=!0):(y(e.player.get("src")||n.src),o=!0));for(var s=!0,l=!1,u=0,c=i.length;u<c;++u)0===i[u].index?s=!1:1===i[u].index&&(l=!0);if(s&&l)for(u=0,c=i.length;u<c;++u)try{i[u].index=parseInt(i[u].index)-1}catch(d){}p(i)},c=function(){t.get("videoInfo")&&t.get("videoInfo")==n||p([])},d=function(e){if(o)return void(s=e);for(var n=t.get("qualityList"),r=0;r<n.length;r++){var i=n[r];if(i.bitrate==parseInt(e.data)){if(t.set("quality",i.bitrate),"function"==typeof i.src)return void i.src(i);var a=t.get("vendorOptions")||{};a.quality=i.index,a.startSeconds=a.startSeconds||t.get("position");t.get("videoInfo");a.hasOwnProperty("defaultAudioTrack")||0==t.get("audioTrack")||(a.defaultAudioTrack=t.get("audioTrack"));var l=i.src||t.get("src");return 1==t.get("chromecast")&&(l+=".cast"),t.load(l,t.get("videoInfo"),a),void(s=null)}}t.load(t.get("src"),t.get("videoInfo"),t.get("vendorOptions")),s=null},f=function(e){e?(t.on("property:src",c),t.on("property:videoInfo",u),t.on("player:qualityNeedChange",d),t.on("player:stop",l)):(t.off("property:src",c),t.off("property:videoInfo:",u),t.off("player:qualityNeedChange",d),t.off("player:stop",l))},p=function(r){var i=[];if(r.forEach(function(e){h(i,e.index,e.name,e.bitrate,e.src)}),r.length>1){var a=t.get("src");!a&&n&&(a=n.src),h(i,-1,e.config.i18nMgg&&"function"==typeof e.config.i18nMgg?e.config.i18nMgg("auto_quality"):"Auto",-1,a)}else r[0]&&t.set("quality",r[0].bitrate);t.set("qualityList",v(i)),s&&d(s)},h=function(e,t,n,r,i){isNaN(t)||!n||isNaN(r)||e.push({index:t,name:n,bitrate:r,src:i})},g=function(e){var t=e.bitrate/1e3,n=t;return t>300&&t<700&&(n=240),t>=700&&t<950&&(n=320),t>=950&&t<1350&&(n=m(360,404)),t>=1350&&t<1550&&(n=480),t>=1550&&t<3500&&(n=m(576,720)),t>=3500&&(n=1080),n},m=function(e,t){var n=0;return i.forEach(function(r){r.bitrate!=e&&r.bitrate!=t||(n=r.bitrate)}),n},v=function(e){for(var t=[],n=e.length-1;n>=0;n--)t.push(e[n]);return t},y=function(e){T(e,_,b)},_=function(e){if(!a){for(var t,n=[],r="#EXT-X-STREAM-INF:",i="#EXT-X-MEDIA:TYPE=AUDIO",s=e.split(r),l=!1,u=0;u<s.length;u++){var c=s[u];if(c.indexOf(i)!==-1)l=!0;else{var d=c.indexOf("http");if(d>0){var f={};if(l){if(window.Blob&&window.URL&&"function"==typeof window.URL.createObjectURL){t=s[0]+r+c;try{var p=new Blob([t],{type:"application/x-mpegURL"});f.src=URL.createObjectURL(p)+".m3u8"}catch(h){f.src=c.substr(d,c.indexOf("m3u8")-d+4)}}}else f.src=c.substr(d,c.indexOf("m3u8")-d+4);for(var g=c.substr(0,c.indexOf("http")).split(","),m=0;m<g.length;m++){var v=g[m],y=v.split("=");"BANDWIDTH"==y[0]&&(f.bitrate=parseInt(y[1])),"NAME"==y[0]&&(f.name=parseInt(y[1].replace('"',"")))}n.push(f)}}}o=!1,n.sort(function(e,t){return e.name-t.name}),E({data:{levels:n}})}},E=function(t){var r=[];i.forEach(function(i){function a(){r.indexOf(i)==-1&&(i.index=o,i.src=s.src||n.src||e.player.get("src"),r.push(i))}for(var o=0;o<t.data.levels.length;o++){var s=t.data.levels[o],l=s.name,u=g(s);l==i.bitrate?a():u==i.bitrate&&a()}}),p(r)},b=function(){s&&d(event),o=!1,s=null,d(-1)},T=function(e,t,n){try{var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n("Error loading "+e))},r.send(null)}catch(i){n("Error loading "+e)}};f(!0)};i.prototype=Object.create(r.prototype),i.prototype.constructor=i,t.exports=i},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],38:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginSubtitles=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){var r=e("mggp-player").Plugin,i=function(){r.apply(this,arguments);var e="off",t=this,n=t.player,i=null,a=!1,o=t.config.defaultSubtitles||e,s=null,l=[],u={},c=null,d=null;this.dispose=function(){t.log("MggpPluginSubtitles.dispose()"),v(!1),a&&y(!1),n=null,i=null,u=null,s=null,c=null};var f=function(r){t.log("MggpPluginSubtitles.onVideoInfoChange()"),i=r.data;var s=i.hasOwnProperty("subtitles")?i.subtitles:[];if(s){if(l=[],l.push({lang_original:t.config.i18nMgg&&"function"==typeof t.config.i18nMgg?t.config.i18nMgg("subtitles_off"):e,display_name:t.config.i18nMgg&&"function"==typeof t.config.i18nMgg?t.config.i18nMgg("subtitles_off"):e,lang:e,lang_tag:e,index:-1}),s.forEach(function(e){"srt"==e.type&&l.push(e)}),n.set("subtitlesList",l),1==l.length)return void y(!1);l.length&&o!=e&&!a?p({data:o}):y(!1)}},p=function(n){t.log("MggpPluginSubtitles.onSubtitlesNeedChange("+n.data+")");var r=n.data;return r==e?void y(!1):r==o?void t.log("MggpPluginSubtitles.onSubtitlesNeedChange(): needed == current, do nothing"):void l.forEach(function(e){if(e.lang_tag==r)return _(),void E(e)})},h=function(){t.log("MggpPluginSubtitles.onMediaSeekEnd()"),a&&(c=null,d="",n.set("subtitlesTextChange",d))},g=function(e){var t=e.data||0;return c&&c.startTime<=t&&c.endTime>=t&&c.text!=d?(d=c.text,void n.set("subtitlesTextChange",d)):c&&c.startTime>t&&""!=d?(d="",void n.set("subtitlesTextChange",d)):(c&&c.endTime<t&&(c=m(t,c),d="",n.set("subtitlesTextChange",d)),void(c||(c=m(t))))},m=function(e,t){if(t){var n=parseInt(t.id);return u[n+1]?u[n+1]:null}for(var r in u)if(u[r].startTime<=e&&u[r].endTime>e)return u[r];return null},v=function(e){t.log("MggpPluginSubtitles.tooggleEvents("+e+")"),e?(n.on("property:videoInfo",f),n.on("player:mediaSeekEnd",h),n.on("player:subtitlesNeedChange",p)):(n.off("property:videoInfo:",f),n.off("player:mediaSeekEnd",h),n.off("player:subtitlesNeedChange",p))},y=function(e){t.log("MggpPluginSubtitles.setEnable("+e+")"),e?(a=!0,n.on("property:position",g)):a&&(_(),a=!1,n.off("property:position",g)),n.set("subtitles",o)},_=function(){t.log("MggpPluginSubtitles.resetCurrentSubtitles()"),n.set("subtitlesTextChange",""),u={},o=e,c=null},E=function(e){t.log("MggpPluginSubtitles.load("+e+")");var n=new XMLHttpRequest;n.open("GET",e.url,!0),n.send(),n.onreadystatechange=function(){if(4==this.readyState){if(200!=this.status)return void t.log("MggpPluginSubtitles.load : "+(this.status?this.statusText:e.url+" load failed"));var n=b(this.responseText);n&&(o=e.lang_tag,s=e,u=n,y(!0))}}},b=function(e){t.log("MggpPluginSubtitles.parseSrt()");var n=e.replace(/\r/g,""),r=/(\d+)\n(\d{2}:\d{2}:\d{2},\d{3}) --> (\d{2}:\d{2}:\d{2},\d{3})/g;n=n.split(r),n.shift();for(var i,a={},o=0;o<n.length;o+=4)i=n[o].trim(),a[i]={id:i,startTime:T(n[o+1].trim()),endTime:T(n[o+2].trim()),text:n[o+3].trim()};return a},T=function(e){var t=e.replace(",",".").split(":");return 3600*parseInt(t[0])+60*parseInt(t[1])+Number(t[2])};v(!0)};i.prototype=Object.create(r.prototype),i.prototype.constructor=i,t.exports=i},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],39:[function(e,t,n){function r(){function e(e,t){e=e.substr(n.length);for(var u,c,d,f,p,h,g,m=e.split(l),v=0,y=m.length;v<y;++v)g=m[v],g.indexOf(r)!=-1?c=parseInt(g.substr(r.length)):g.indexOf(i)!=-1?d=parseInt(g.substr(i.length)):g.indexOf(a)!=-1?f=parseInt(g.substr(a.length)):g.indexOf(s)!=-1?h=parseInt(g.substr(s.length)):g.indexOf(o)!=-1&&(p=parseInt(g.substr(o.length)));return u={},u.start=c,u.finish=d,u.count=f,u.height=p,u.width=h,u.url=t,u}var t="#EXTM3U",n="#EXT-X-MEDIA:",r="START=",i="FINISH=",a="IMGCOUNT=",o="IMGHEIGHT=",s="IMGWIDTH=",l=",";this.parse=function(r){var i=[];if(r.indexOf(t)!=-1&&r.indexOf(n)!=-1)for(var a,o,s=r.split("\n"),l=1,u=s.length;l<u;++l)a=s[l],a.indexOf(n)!=-1&&(o=++l<u?s[l]:null,i.push(e(a,o)));return i}}var i=e("mggp-player").Plugin,a=function(){function e(n){if(f.off("player:hls:manifestParsed",e),n.data&&n.data.levels&&n.data.levels.length>0){var r=n.data.levels[0].url;if(r&&r.length>0){if(w=r[0],"catchup"!==u.player.get("dvrchannel:channelState")){var i=u.player.get("epg:currentChannel");i.currentProgram&&(w=l(i.currentProgram.startTimestamp,w))}t()}}}function t(){w.indexOf("/vs/")!==-1?(b=window.setInterval(n,c),n()):w.indexOf("/vo/")!==-1&&n()}function n(){var e,t=w.lastIndexOf("/");t>0&&(e=w.substring(0,t+1)+d),e&&I(e,a)}function a(e){T||(T=new r);var t=T.parse(e);if(t.length>0){m=t[0].width,v=t[0].height;for(var n=o(t),i=0,a=t.length;i<a;++i)g[i]={id:i,src:t[i].url,times:n[i]};R(!0)}}function o(e){var t,n=null;if(e&&e.length>0){n=[];for(var r=0,i=e.length;r<i;++r){n[r]=[],t=(e[r].finish-e[r].start)/e[r].count;for(var a=0,o=e[r].count;a<o;++a)n[r][a]=e[r].start+a*t}}return n}function s(){var e=u.player.get("epg:currentChannel");return!(!e||"dvrChannel"!==e.type)}function l(e,t){if(t&&e){var n,r,i=/\/vs\/\d+/;r=t.search(i),r==-1?(n=t.lastIndexOf("/type.live"),t=t.substring(0,n)+"/vs/"+e.toString()+t.substring(n)):t=t.replace(i,"/vs/"+e.toString())}return t}i.apply(this,arguments);var u=this,c=1e4,d="thumblist.m3u8",f=u.player,p=null,h=!1,g=[],m=0,v=0,y=0,_=null,E=null,b=null,T=null,w="";this.dispose=function(){T=null,w=""},this.load=function(n,r,i){if(w=n?n:r&&r.src?r.src:"",s()&&!b)if(A(),R(!1),f.config&&f.config.device&&f.config.device.browser&&f.config.device.browser.name&&"safari"===f.config.device.browser.name.toLowerCase()&&(w=""),w.indexOf("meta")!==-1)f.on("player:hls:manifestParsed",e);else{var a=u.player.get("epg:currentChannel");a.currentProgram&&(w=l(a.currentProgram.startTimestamp,w)),t()}};var A=function(){p=null,h=!1,g=[],m=0,v=0,y=0,_=null,E=null,b&&(window.clearInterval(b),b=null)},R=function(e){e?(f.on("property:thumbnailsTime",k),h=!0):(f.off("property:thumbnailsTime",k),h=!1)},S=function(e){A(),R(!1),e.data&&(p=e.data),p&&p.preview_images&&I(p.preview_images.thumbsline_xml,L)},k=function(e){if(_||(_=P(e.data)),!_)return void f.set("thumbnails",{src:"",offset:0,width:0,height:0});var t=e.data;if(_){for(var n=-1,r=0;r<_.times.length;r++)if(_.times[r]>t&&_.times[r-1]&&_.times[r-1]<t){n=r,O(_.src,r*-m);break}return void(n==-1&&(_=null))}},O=function(e,t){E==e&&t==y||(E=e,y=t,f.set("thumbnails",{src:E,offset:y,width:m,height:v}))},L=function(e){if(e){var t=e.getElementsByTagName("thumbsline")[0];m=t.getAttribute("thwidth"),v=t.getAttribute("thheight");for(var n=e.getElementsByTagName("line"),r=0;r<n.length;r++){var i=n[r],a=i.getAttribute("id");g[a]={id:a,times:C(i.childNodes[0].nodeValue.split(",")),src:D(a)}}0!=g.length&&R(!0)}},C=function(e){for(var t=0;t<e.length;t++)e[t]=parseInt(e[t]);return e},D=function(e){for(var t=p&&p.preview_images?p.preview_images.thumbsline_list:[],n=0;n<t.length;n++){var r=t[n].id||t[n].line;if(parseInt(r)==parseInt(e))return t[n].url}return null},P=function(e){for(var t=0;t<g.length;t++)if(g[t]){var n=g[t].times;if(n[0]<=e&&n[n.length-1]>=e)return g[t]}return null},I=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.send(),n.onreadystatechange=function(){if(4==this.readyState)return 200!=this.status?void u.log("MggpPluginThumbnails.load : "+(this.status?this.statusText:e+" load failed")):void t(e.indexOf("m3u8")!==-1?this.responseText:this.responseXML)}},N=function(e){e?(f.on("property:videoInfo",S),f.on("player:stop",A)):(f.off("property:videoInfo:",S),f.off("player:stop",A))};N(!0)};a.prototype=Object.create(i.prototype),a.prototype.constructor=a,t.exports=a},{"mggp-player":21}],40:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginTns=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("mggp-player"),l=(function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(s.AddonError),["player","playstart","playend"]),u=function(e){function t(){for(var e,n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];r(this,t);var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s.config||s.player||(s.player=arguments[0],s.config=arguments[1]),s.config.tns?(s.namespace="tns:",s.played=!1,s._send("player"),s.player.on("stop",function(){return s.played=!1}),s.player.on("property:state",function(e){0==e.data&&s._send("playend"),1!=e.data||s.played||(s.played=!0,s._send("playstart"))}),s):i(s)}return a(t,e),o(t,[{key:"_send",value:function(e){if(-1===l.indexOf(e))return this._error("Unknown event type '"+e+"'");var t=(new XMLHttpRequest,this.config.tns[e].replace("%timestamp%",(new Date).getTime()));document.createElement("img").src=t}},{key:"_error",value:function(e){e instanceof Error&&(e=e.message),this.log(e)}}]),t}(s.Plugin);n["default"]=u},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],41:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginVclicks=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=e("mggp-player"),s=6e4,l=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var l=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));l.namespace="vclicks:";var u=void 0,c=void 0,d=void 0;try{if(!(u=window.readVClicks()))return i(l)}catch(e){return i(l)}return c=parseInt(localStorage.getItem("vctime")||0),l.player.on("property:state",function(e){return 1!==e.data?clearInterval(d):void(d=setInterval(function(){60==++c&&(c=0,l.emit("hour",u),"function"==typeof window.vClickNotify&&window.vClickNotify()),localStorage.setItem("vctime",c)},s))}),l}return a(t,e),t}(o.Plugin);n["default"]=l},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],42:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginVigo=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("mggp-player"),l="https://api.vigo.ru/html5/Vigo.min.js",u={240:{value:45e4,code:2},320:{value:9e5,code:3},360:{value:9e5,code:3},480:{value:135e4,code:4},720:{value:2e6,code:5},1080:{value:5e6,code:6},"-1":{value:null,code:100}},c=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s.config.vigo&&(s.namespace="vigo:",s._onQualityChange=s._onQualityChange.bind(s),s._getMetricInfo=s._getMetricInfo.bind(s),s._startMetric=s._startMetric.bind(s),s._onAdStarted=s._onAdStarted.bind(s),s._onAdMemberComplete=s._onAdMemberComplete.bind(s),s._onStateChange=s._onStateChange.bind(s),s._load()),s}return a(t,e),o(t,[{key:"dispose",value:function(){this._toggleListeners(!1)}},{key:"_load",value:function(){if(window.V_VIGO_SCRIPT_LOADED)this._init();else{var e=document.createElement("script");e.addEventListener("error",this._error.bind(this)),e.addEventListener("load",this._init.bind(this)),e.src=l,e.setAttribute("async",""),document.head.appendChild(e)}}},{key:"_init",value:function(){this._toggleListeners(!0)}},{key:"_toggleListeners",value:function(e){e?(this.player.on("property:quality",this._onQualityChange),this.player.on("player:mediaCanPlay",this._startMetric),this.player.on("ad:external:memberStartedPlaying",this._onAdStarted),this.player.on("ad:blockMember:complete",this._onAdMemberComplete),this.player.on("property:state",this._onStateChange)):(this.player.off("property:quality",this._onQualityChange),this.player.off("player:mediaCanPlay",this._startMetric),this.player.off("ad:external:memberStartedPlaying",this._onAdStarted),this.player.off("ad:blockMember:complete",this._onAdMemberComplete),this.player.off("property:state",this._onStateChange))}},{key:"_onAdStarted",value:function(){this.vigo.suspendCollecting()}},{key:"_onAdMemberComplete",value:function(){this.vigo.resumeCollecting()}},{key:"_onStateChange",value:function(){var e=this.player.get("state");if(this.vigo)switch(e){case 1:this.vigo.resumeCollecting();break;default:this.vigo.suspendCollecting()}}},{key:"_getMetricInfo",value:function(){var e=this.player.get("qualityList"),t=this.player.get("quality"),n=e.filter(function(e){return e.bitrate==t})[0],r=n.src;/^(f|ht)tps?:\/\//i.test(r)||(r=this.player.config.protocol+r);var i=new URL(r).host,a=this.player.get("videoInfo").video_id;return{svcid:this.config.vigo.id||"11e0",cid:this.player.config.userID||0,wid:a||0,quality:n.index,host:i,player:"HTML5",getBytes:function(){return null},getBitrate:function(){return u[t].value||null}}}},{key:"_startMetric",value:function(){this.vigo=initVigo(this.player.config.videoContainer.getElementsByTagName("VIDEO")[0],this._getMetricInfo())}},{key:"_onQualityChange",value:function(){this.vigo.bitrateChange(u[this._getMetricInfo().quality].code)}},{key:"_error",value:function(e){e instanceof Error&&(e=e.message,this.vigo.error(e)),this.emit("error",new s.AddonError(this.player,"","","Cannot load Vigo script from url "+l))}}]),t}(s.Plugin);n["default"]=c},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],43:[function(e,t,n){function r(e,t){function n(e){C=e.data,C&&O.player.off("property:epg:currentChannel",n),C&&"vodChannel"===C.type?C.currentProgram?(O.player.set(R,C.currentProgram),O.player.set(k,C.currentProgram.duration),h(v),r({data:C.currentProgram})):O.player.on("epg:currentProgramChanged",r):h(m)}function r(e){var t=e.data;if(t&&t.channel&&t.channel.epgId===C.epgId)if(L!=E&&L!=b&&L!=T&&h(v),t){if(L!==b)if(L!==T)t.objectId&&t.objectId>0?(O.player.set(R,t),O.player.set(k,t.duration),
d(t.objectId,!0,void 0,!0)):h(_);else{var n=O.player.get(R);n&&h(b)}}else h(y)}function a(e){D=null}function o(e,t,n,r){if(e&&e.src){var i,a=O.player.config.checkDefaultOptions();if(t)if(C&&C.currentProgram){if(void 0!==n)o=n,h(T);else{var o=Math.round((new Date).getTime()/1e3-C.currentProgram.startTimestamp);o<0&&(o=0),h(E)}D.bitrates=e.bitrates,D.subtitles=e.subtitles,D.audio_tracks=e.audio_tracks,D.preview_images=e.preview_images,D.src=e.src,D=Object.assign({},D),O.player.set("src",e.src),i={autoplay:r,startSeconds:o,defaultAudioTrack:a?g(a.defaultAudioTrack,e):g(O.player.get("audioTrack"),e),defaultSubtitles:a?a.defaultSubtitles:O.player.get("subtitles"),defaultQuality:a?a.defaultQuality:O.player.get("quality")},c(e.src,D,i)}else h(y);else h(b),e.next="",e.prev="",i={autoplay:r,startSeconds:n||.1,defaultAudioTrack:a?g(a.defaultAudioTrack,e):g(O.player.get("audioTrack"),e),defaultSubtitles:a?a.defaultSubtitles:O.player.get("subtitles"),defaultQuality:a?a.defaultQuality:O.player.get("quality")},c(null,e,i)}else h(w)}function s(e){O.player.set(R,e.data),O.player.set(k,e.data.duration),d(e.data.objectId,!1,void 0,!0)}function l(e){C&&C.currentProgram&&(O.player.set(R,C.currentProgram),d(C.currentProgram.objectId,!0,void 0,!0))}function u(e){if((L===E||L===T)&&C&&C.currentProgram){var t,n=O.player.get("epg:currentProgramTime");e.data>=n?(h(E),Math.abs(O.player.get("position")-n)>=2&&(t=n,O.player.seekTo(n),O.player.play())):(h(T),t=e.data,O.player.seekTo(e.data)),O.player.set("position",t),O.player.set(S,t)}}function c(e,t,n){O.player.stop(),O.player.load(e,t,n)}function d(e,t,n,r){function i(e,t,n){O.player.emit("mediaError",{name:O.constructor.name,type:e,code:t,message:n,fatal:!0})}O.player.config&&"function"==typeof O.player.config.getStream&&O.player.config.getStream(e,function(e){var a=O.player.config.getStreamFromData(e);a?(a.advert_url="",a.advert_data="",a.src&&a.src.indexOf("//")!=-1&&(a.src=a.src.substring(a.src.indexOf("//"))),O.player.config.drm&&"fairplay"===O.player.config.supportedDrmType&&(a.src=a.src.replace(/\/a\/\d+/,"")),o(a,t,n,r)):i("internalError","internalError","self.player.config.getStreamFromData couldn't get the stream")})}function f(e){if(L===E||L===b||L===T){if(2==e.data&&L===E&&h(T),0===e.data){var t=C.getNextProgram(O.player.get(R));if(t&&t.objectId>0)O.player.set(R,t),d(t.objectId,!1,void 0,!0);else{var n=void 0,r=O.player.get(R);r.endTimestamp<=C.currentProgram.startTimestamp&&(n=0),O.player.set(R,C.currentProgram),d(C.currentProgram.objectId,!0,n,!0)}}P=e.data}}function p(){C&&C.currentProgram&&O.player.set(S,O.player.get("position"))}function h(e){L=e,O.player.set(A,L)}function g(e,t){var n="",r=t?t.audio_tracks:O.player.get("audioTrackList");try{"string"==typeof e&&(e=parseInt(e))}catch(i){e=0}if(r&&r.length>0)for(var a=0,o=r.length;a<o;++a)if(r[a].id==e){n=r[a].lang;break}return n}i.apply(this,arguments);var m="disabled",v="connecting",y="currentProgramAbsent",_="onjectIdAbsent",E="onAir",b="catchup",T="timeshift",w="error",A="interactiveChannel:channelState",R="interactiveChannel:currentPlayingProgram",S="interactiveChannel:currentPlayingTime",k="interactiveChannel:currentProgramDuration",O=this,L=m,C=null,D=null,P=void 0;O.player.registerProperty(A,m,!0),O.player.registerProperty(R,null,!0),O.player.registerProperty(S,null,!0),O.player.registerProperty(k,null,!0),this.dispose=function(){O.player.off("property:epg:currentChannel",n),O.player.off("epg:currentProgramChanged",r),O.player.off("vodChannel:playProgram",s),O.player.off("vodChannel:backOnAir",l),O.player.off("vodChannel:seek",u),O.player.off("property:state",f),O.player.off("epg:channelSwitch",a),O.player.off("player:timeUpdate",p),h(m),C=null},this.load=function(e,t,r){if(t){if((t.is_vod_channel||"m_ch"===t.content_type)&&(!D||D.video_id!=t.video_id)){t.src="",D=t,O.player.on("property:state",f),O.player.on("player:timeUpdate",p),O.player.on("vodChannel:playProgram",s),O.player.on("vodChannel:backOnAir",l),O.player.on("vodChannel:seek",u),O.player.on("epg:channelSwitch",a);var i=O.player.get("epg:currentChannel");i?n({data:i}):O.player.on("property:epg:currentChannel",n)}}else h(m),O.player.off("property:epg:currentChannel",n),O.player.off("property:state",f),O.player.off("player:timeUpdate",p)}}var i=e("mggp-player").Plugin;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"mggp-player":21}],44:[function(e,t,n){function r(e,t){function n(e){L=e.data,L&&"vodChannel"===L.type?L.currentProgram?(k.player.set(A,L.currentProgram),k.player.set(S,L.currentProgram.duration),p(m),r({data:L})):k.player.on("epg:currentProgramChanged",r):p(g)}function r(e){if(e.data.epgId===L.epgId&&L.currentProgram){var t=L.currentProgram;if(O!=_&&O!=E&&O!=b&&p(m),t){if(k.player.set(S,t.duration),O!==E)if(O!==b)t.objectId&&t.objectId>0?(k.player.set(A,t),c(t.objectId,!0,void 0,!0)):p(y);else{var n=k.player.get(A);n&&c(n.objectId,!1,k.player.get("position"),2!=k.player.get("state"))}}else p(v)}}function a(e,t,n,r){if(e&&e.src){var i,a=k.player.config.checkDefaultOptions();if(t)if(L&&L.currentProgram){if(void 0!==n)o=n,p(b);else{var o=Math.round((new Date).getTime()/1e3-L.currentProgram.startTimestamp);o<0&&(o=0),p(_)}C.bitrates=e.bitrates,C.subtitles=e.subtitles,C.audio_tracks=e.audio_tracks,C.preview_images=e.preview_images,C.src=e.src,C=Object.assign({},C),i={autoplay:r,startSeconds:o,defaultAudioTrack:a?h(a.defaultAudioTrack,e):h(k.player.get("audioTrack"),e),defaultSubtitles:a?a.defaultSubtitles:k.player.get("subtitles"),defaultQuality:a?a.defaultQuality:k.player.get("quality")},u(e.src,C,i)}else p(v);else p(E),e.next="",e.prev="",i={autoplay:r,startSeconds:n||.1,defaultAudioTrack:a?h(a.defaultAudioTrack,e):h(k.player.get("audioTrack"),e),defaultSubtitles:a?a.defaultSubtitles:k.player.get("subtitles"),defaultQuality:a?a.defaultQuality:k.player.get("quality")},u(null,e,i)}else p(T)}function o(e){k.player.set(A,e.data),c(e.data.objectId,!1,void 0,!0)}function s(e){L&&L.currentProgram&&(k.player.set(A,L.currentProgram),c(L.currentProgram.objectId,!0,void 0,!0))}function l(e){if((O===_||O===b)&&L&&L.currentProgram){var t=k.player.get(R);e.data>=t?(p(_),Math.abs(k.player.get("position")-t)>=2&&(k.player.seekTo(t),k.player.play())):(p(b),k.player.seekTo(e.data))}}function u(e,t,n){k.player.stop(),k.player.load(e,t,n)}function c(e,t,n,r){function i(e,t,n){k.player.emit("mediaError",{name:k.constructor.name,type:"streamError",code:"loadingError",message:"Cannot load stream from "+o,fatal:!0})}if(k.player.config){var o,s=k.player.config.videoURL;if(s){var l=s.indexOf("?");if(l!==-1){s=s.substring(l);var u=s.match(/i=\d+/);o=u&&u.length>0?"/b/info"+s.replace(u[0],"i="+e):"/b/info"+s+"&i="+e}}o||(o="/b/info/?i="+e);var c=k.player.config.getDefaultLoader();c.load(o,function(e){var o=k.player.config.getStreamFromData(e);o?(o.advert_url="",o.advert_data="",a(o,t,n,r)):i("internalError","internalError","self.player.config.getStreamFromData couldn't get the stream")},function(e){i("streamError","loadingError","Cannot load stream from "+o)})}}function d(e){if(O===_||O===E||O===b){if(2==e.data&&O===_&&p(b),0===e.data){var t=L.getNextProgram(k.player.get(A));if(t&&t.objectId>0&&t.endTimestamp<=L.currentProgram.startTimestamp)k.player.set(A,t),c(t.objectId,!1,void 0,!0);else{var n=void 0,r=k.player.get(A);r.endTimestamp<=L.currentProgram.startTimestamp&&(n=0),k.player.set(A,L.currentProgram),c(L.currentProgram.objectId,!0,n,!0)}}D=e.data}}function f(){if(L&&L.currentProgram){var e=Math.floor((new Date).getTime())/1e3-L.currentProgram.startTimestamp+k.player.get("epg:timeOffset");k.player.set(R,e)}}function p(e){O=e,k.player.set(w,O)}function h(e,t){var n="",r=t?t.audio_tracks:k.player.get("audioTrackList");try{"string"==typeof e&&(e=parseInt(e))}catch(i){e=0}if(r&&r.length>0)for(var a=0,o=r.length;a<o;++a)if(r[a].id==e){n=r[a].lang;break}return n}i.apply(this,arguments);var g="disabled",m="connecting",v="currentProgramAbsent",y="onjectIdAbsent",_="onAir",E="watchnow",b="timeshift",T="error",w="vodchannel:channelState",A="vodchannel:currentVodProgram",R="vodchannel:currentProgramTime",S="vodchannel:currentProgramDuration",k=this,O=g,L=null,C=null,D=void 0;k.player.registerProperty(w,g,!0),k.player.registerProperty(A,null,!0),k.player.registerProperty(R,null,!0),k.player.registerProperty(S,null,!0),this.dispose=function(){k.player.off("property:epg:currentChannel",n),k.player.off("epg:currentProgramChanged",r),k.player.off("vodchannel:playProgram",o),k.player.off("vodchannel:backOnAir",s),k.player.off("property:state",d),k.player.off("player:timeUpdate",f),k.player.off("vodchannel:seek",l),p(g),L=null},this.load=function(e,t,r){t?!t.is_vod_channel||C&&C.video_id==t.video_id||(t.src="",e="",C=t,n({data:k.player.get("epg:currentChannel")}),k.player.on("property:state",d),k.player.on("property:epg:currentChannel",n),k.player.on("vodchannel:playProgram",o),k.player.on("vodchannel:backOnAir",s),k.player.on("vodchannel:seek",l),k.player.on("player:timeUpdate",f)):(p(g),k.player.off("property:epg:currentChannel",n),k.player.off("property:state",d),k.player.off("player:timeUpdate",f))}}var i=e("mggp-player").Plugin;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,t.exports=r},{"mggp-player":21}],45:[function(e,t,n){function r(t,n){function r(e){e.data&&(d=e.data,o(d))}function i(e){h&&(c.player.pause(),window.open(h))}function a(e){switch(e.type){case"load":p.style.visibility="visible";var t=document.getElementById("playerContainer_skin"),n=!1;if(t){var r=t.getElementsByTagName("subtitlescontainer");r&&r.length>0&&(r=r[0],r&&(t.insertBefore(p,r),n=!0)),n||t.appendChild(p)}else if(t=document.getElementById("playerContainer")){for(var i=t.getElementsByTagName("div"),o=0,s=i.length;o<s;++o)if("mggp-ad-container"===i[o].id){t.insertBefore(p,i[o]),n=!0;break}n||t.appendChild(p)}break;case"error":l(),console.error("Cannot load watermark image. URL:"+f)}p.removeEventListener("load",a),p.removeEventListener("error",a)}function o(e){e&&e.watermarkURL&&(f=e.watermarkURL,s(f),e.watermarkIsClickable&&e.share_link&&(h=e.share_link,p.addEventListener("click",i),p.style.cursor="pointer"))}function s(e){p=document.createElement("img"),p.style.visibility="hidden",p.style.position="absolute",p.style.height="5%",p.style.right="2%",p.style.bottom="10%",p.style.transform="translateY(-100%)",p.addEventListener("load",a),p.addEventListener("error",a),p.src=e}function l(){p&&p.parentNode&&p.parentNode.removeChild(p),p.removeEventListener("click",i)}var u=e("mggp-player").Plugin,c=(e("mggp-player").AddonError,this),d=null,f=null,p=null,h=null;u.apply(this,arguments),o(c.player.get("videoInfo")),c.player.on("property:videoInfo",r),this.dispose=function(){l(),p=null,d=null,f=null,h=null,c.player.off("property:videoInfo",r)}}r.prototype.constructor=r,t.exports=r},{"mggp-player":21}],46:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpPluginWss=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("mggp-player"),l=function(e){function t(){for(var e,n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];r(this,t);var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s.IGNORE_STOP_EVENT="wss:ignore:stopEvent",s.IGNORE_VIDEOINFO_EVENT="wss:ignore:videoInfoEvent",s.config||s.player||(s.player=arguments[0],s.config=arguments[1]),s.session=null,s.interval=null,s.last_state=null,s.watchTimeAfterEvent=0,s.sessionPlayingTime=0,s.lastPosition=0,s.videoEndedSent=!1,s.lastTimestamp=0,s.needToSendInit=!1,s.url=null,s.videoInfo=null,s.p2pBytesReceived=0,s.cdnBytesReceived=0,s.player.registerProperty(s.IGNORE_STOP_EVENT,!1,!0),s.player.registerProperty(s.IGNORE_VIDEOINFO_EVENT,!1,!0),s.player.on("property:videoInfo",function(e){s._onVideoInfo(e)}),s.player.on("wss:p2pEvent",function(e){var t=e.data;if(t)switch(t.type){case"p2pReceived":s.p2pBytesReceived+=t.value;break;case"cdnReceived":s.cdnBytesReceived+=t.value}}),s.player.on("property:state",function(e){var t=e.data;1==t?s.needToSendInit?(s.needToSendInit=!1,s.isURLValid(s.url)&&s.startSession(s.url,function(e){s.session=e,s.interval=setInterval(function(){if(!s.session)return void clearInterval(s.interval);var e=Math.floor((new Date).getTime()/1e3);1===s.player.get("state")&&(s.sessionPlayingTime+=.1,s.lastTimestamp&&(s.watchTimeAfterEvent+=e-s.lastTimestamp),s.watchTimeAfterEvent>=s.session.call_interval&&(s.trackAction("play"),s.watchTimeAfterEvent=0)),s.lastTimestamp=e},100)})):(s.trackAction("start"),s.watchTimeAfterEvent=0):0!=t?1==s.last_state&&s.trackAction("stop"):0===t&&s._processStopEvent(),s.last_state=t}),s.player.on("property:position",function(e){e.data>0&&(s.lastPosition=e.data)}),s.player.on("player:stop",function(e){s._processStopEvent()}),s}return a(t,e),o(t,[{key:"_processStopEvent",value:function(){return this.player.get(this.IGNORE_STOP_EVENT)?void this.player.set(this.IGNORE_STOP_EVENT,!1):void(this.videoEndedSent||(this.videoEndedSent=!0,this.trackAction("stop"),clearInterval(this.interval),this.session=null,this._resetPlugin()))}},{key:"_resetPlugin",value:function(){this.videoEndedSent=!1,this.session=null,this.last_state=null,this.watchTimeAfterEvent=0,this.lastPosition=0,this.lastTimestamp=0,this.p2pBytesReceived=0,this.cdnBytesReceived=0,this.needToSendInit=!0}},{key:"_onVideoInfo",value:function(e){if(this.player.get(this.IGNORE_VIDEOINFO_EVENT))return void this.player.set(this.IGNORE_VIDEOINFO_EVENT,!1);this.sessionPlayingTime=0;var t=e.data;if(this.videoInfo=t,this.session&&!this.videoEndedSent&&this.trackAction("stop"),this.url=null,this._resetPlugin(),t&&t.start_session_url){var n="";if(t.start_session_url.indexOf("%user_id%")!==-1){if(!this.config.deviceID||this.config.deviceID.length<1)return;n=t.start_session_url.replace("%user_id%",this.config.deviceID)}else n=t.start_session_url;var r={};if(this.config.deviceOS&&(r.d_os=this.config.deviceOS),this.config.deviceType){r.d_type=this.config.deviceType;try{this.config.device&&this.config.device.device&&("mobile"===this.config.device.device.type||"tablet"===this.config.device.device.type)&&(r.d_type=this.config.deviceType+"mobile")}catch(i){}}this.config.deviceModel&&(r.d_model=this.config.deviceModel),this.config.version&&(r.d_app_version=this.config.version),n+=n.indexOf("?")===-1?"?":"&",n+=Object.keys(r).map(function(e){return e+"="+r[e]}).join("&"),this.url=n,clearInterval(this.interval),this.log("MggpPluginWss._onVideoInfo():InitURL="+n+", OS="+r.d_os+", Channel="+r.d_channel_id+", Type="+r.d_type+", Model="+r.d_model+", Version="+r.d_app_version)}}},{key:"trackAction",value:function(e){if(this.log("MggpPluginWss.trackAction(): "+e),this.session&&this.session[e]){var t={};this.videoInfo&&this.videoInfo.is_live?t.v_timeline=0:t.v_timeline=Math.round(this.lastPosition),t.w_time=parseInt(this.sessionPlayingTime),window.skinUtils&&(window.skinUtils.isFullScreen()?t.v_screen_mode="fullscreen ":"notfullscreen ");var n=this.session[e];if(n+=n.indexOf("?")===-1?"?":"&",n+=Object.keys(t).map(function(e){return e+"="+t[e]}).join("&"),"play"===e&&this.p2pBytesReceived>0){var r=Math.floor(this.cdnBytesReceived/1048576*100)/100,i=Math.floor(this.p2pBytesReceived/1048576*100)/100;n+="&p2p_rcv="+i+"&cdn_rcv="+r}n||(n="");var a=new XMLHttpRequest;a.open("GET",n,!0),a.send()}}},{key:"startSession",value:function(e,t){var n=this;e||(e=""),this.log("MggpPluginWss.startSession()");var r=new XMLHttpRequest;try{r.open("GET",e,!0),r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var i=null;try{i=JSON.parse(r.responseText)}catch(a){var o=s.AddonError.errorTypes.PARSING_ERROR,l=s.AddonError.errorCodes[o].PARSING_ERROR,u=s.AddonError.errorMessages.cannotParse+e;return new s.AddonError(n.player,o,l,u,(!1))}if("ERROR"===i.result)return n.log("MggpPluginWss.startSession():"+i.message);if("OK"===i.result)return t(i.data);n._error("Invalid response")}},r.send()}catch(i){this.log("MggpPluginWss.startSession():"+res.message)}}},{key:"isURLValid",value:function(e){var t=!1,n=/http[s]?:\/\//;return e&&"string"==typeof e&&(e=e.replace(n,""),t=e&&"?"!==e[0]&&"&"!==e[0]),t}}]),t}(s.Plugin);n["default"]=l},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],47:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&"undefined"!=typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:this,i.mggpVendorChromecast=e()}}(function(){return function t(n,r,i){function a(s,l){if(!r[s]){if(!n[s]){var u="function"==typeof e&&e;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return a(t?t:e)},d,d.exports,t,n,r,i)}return r[s].exports}for(var o="function"==typeof e&&e,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=e("mggp-player"),l=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s._lastVolume=s.player.get("volume")||60,s._media=null,s._onTimeUpdate=s._onTimeUpdate.bind(s),s}return a(t,e),o(t,null,[{key:"canPlay",value:function(){return chrome.cast}},{key:"priority",get:function(){return 0}},{key:"mimeTypes",get:function(){return["cast"]}}]),o(t,[{key:"load",value:function(e,t,n){this._media=this.player.get("chromecastMedia"),this._media?(this._media.addUpdateListener(this._onMediaStatus.bind(this)),this.player.on("player:timeUpdate",this._onTimeUpdate),this.player.set("duration",this._media.media.duration),this.player.set("position",this._media.currentTime),this.setVolume(this.player.get("volume"),this.player.get("muted"))):this._onMediaError()}},{key:"setQuality",value:function(e){if(-1==e){var t=this.player.get("src").replace(".cast","");this.player.emit("chromecastQualityChange",t),this.player.set("quality",-1)}else{var n=this.player.get("hlsBitrates");if(n&&n.length>1)for(var r,i=0,a=n.length;i<a;++i){try{r=parseInt(n[i].name)}catch(e){}if(e===r){this.player.emit("chromecastQualityChange",n[i].url[0]),this.player.set("quality",e);break}}}}},{key:"setAudioTrack",value:function(e){if(this._media&&this._media.media&&this._media.media.contentId){var t,n,r=(this._media.media.contentId,this.player.get("audioTrack")),i=this.player.get("hlsBitrates");if(i)for(t=0,n=i.length;t<n;++t)i[t].url[0]=this._modifySrc(i[t].url[0],r,e);this.player.set("src",this._modifySrc(this.player.get("src"),r,e)),this.player.set("audioTrack",e);var a=this.player.get("quality");this.setQuality(a)}}},{key:"_modifySrc",value:function(e,t,n){return e&&-1!=e.indexOf("/a/")&&(e=e.replace("/a/"+t,"/a/"+n)),e}},{key:"_setState",value:function(e){this.set("state",e),this.emit("stateChange",e)}},{key:"_onMediaStatus",value:function(e){if(this._media)switch(this._media.playerState){case"IDLE":"FINISHED"===this._media.idleReason&&this._setState(0);break;case"BUFFERING":this._isBuffering=!0,this.emit("bufferingStart");break;case"PAUSED":this._setState(2);break;case"PLAYING":this._isBuffering&&(this._isBuffering=!1,this.emit("bufferingEnd")),this._setState(1)}}},{key:"_onTimeUpdate",value:function(){this._media&&this.player.set("position",this._media.getEstimatedTime())}},{key:"_onError",value:function(e){this.emit("error",e)}},{key:"_onMediaError",value:function(e){this._setState(5),this.emit("mediaError")}},{key:"_command",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments[2],r=arguments[3];this._media&&this._media[e](t,n?n.bind(this):null,r?r.bind(this):this._onError.bind(this))}},{key:"play",value:function(){this._command("play")}},{key:"pause",value:function(){this._command("pause")}},{key:"togglePlayPause",value:function(){this._command(1===this.player.get("state")?"pause":"play")}},{key:"seekTo",value:function(e){var t=this,n=new chrome.cast.media.SeekRequest;n.currentTime=e,this._setState(4),this.emit("mediaSeekStart"),this._command("seek",n,function(){t.emit("mediaSeekEnd")})}},{key:"setVolume",value:function(e,t){var n=this;null!==e&&(this._lastVolume=e),void 0===t&&(t=!1),e/=100,this._command("setVolume",new chrome.cast.media.VolumeRequest(new chrome.cast.Volume(e,t)),function(){n.player.set("volume",100*n._media.volume.level),n.player.set("muted",n._media.volume.muted)})}},{key:"mute",value:function(){this.setVolume(null,!0)}},{key:"unMute",value:function(){this.setVolume(this._lastVolume,!1)}},{key:"stop",value:function(){this._command("stop"),this.dispose()}},{key:"dispose",value:function(){this.player.off("player:timeUpdate",this._onTimeUpdate),this._media=null}}]),t}(s.Vendor);n["default"]=l},{"mggp-player":"mggp-player"}]},{},[1])(1)})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mggp-player":21}],48:[function(e,t,n){"use strict";function r(e,t){function n(){function e(){Q=new Uint8Array(0),M.load(M.player.get("src"),M.player.get("videoInfo"),M.player.get("options"))}try{var t=new XMLHttpRequest;t.responseType="arraybuffer",t.open("GET",N,!0),t.onreadystatechange=function(){4===t.readyState&&(200===t.status&&t.response?(Q=new Uint8Array(t.response),M.load(M.player.get("src"),M.player.get("videoInfo"),M.player.get("vendorOptions"))):e())},t.send(null)}catch(n){e()}}function r(){1==M.player.config.singleVideoInstance&&(B=M.player.get(M.namespace+"video")),B||(B=document.createElement("video"),M.container.appendChild(B)),B.className=M.namespace+"video",B.style.width="100%",B.style.height="100%",shaka.polyfill.installAll(),shaka.Player.isBrowserSupported()?(q=new shaka.Player(B),q.configure({abr:{enabled:!0}})):M.emit("error"),D&&D.setVideo(B)}function s(e){M.set("state",e),M.emit("stateChange",e)}function l(e){e?(B&&(B.addEventListener("loadstart",c),B.addEventListener("canplay",d),B.addEventListener("pause",f),B.addEventListener("playing",p),B.addEventListener("seeked",h),B.addEventListener("seeking",g),B.addEventListener("volumechange",m),B.addEventListener("durationchange",v),B.addEventListener("ended",E),B.addEventListener("error",u)),q&&(q.addEventListener("error",R),q.addEventListener("adaptation",b),q.addEventListener("buffering",T),q.addEventListener("trackschanged",w)),M.player&&M.player.on&&(M.player.on("player:timeUpdate",y),M.player.on("property:qualityList",_))):(B&&(B.removeEventListener("loadstart",c),B.removeEventListener("canplaythrough",d),B.removeEventListener("pause",f),B.removeEventListener("playing",p),B.removeEventListener("seeked",h),B.removeEventListener("seeking",g),B.removeEventListener("volumechange",m),B.removeEventListener("durationchange",v),B.removeEventListener("ended",E)),q&&(q.removeEventListener("error",R),q.removeEventListener("adaptation",b),q.removeEventListener("buffering",T),q.removeEventListener("trackschanged",w)),M.player&&M.player.off&&(M.player.off("player:timeUpdate",y),M.player.off("property:qualityList",_)))}function u(){M.emit("mediaError",{fatal:!0}),s(5)}function c(){s(3)}function d(){G||(Y&&B.play(),M.emit("mediaCanPlay"))}function f(){V&&s(2)}function p(){if(!G){var e=B.textTracks;if(e&&e.length>0)for(var t=0,n=e.length;t<n;++t)"subtitles"===e[t].kind&&(e[t].mode="disabled")}M.player.set("vendorOptions",null),G=!0,V=!1,s(1)}function h(){M.emit("mediaSeekEnd")}function g(){M.emit("mediaSeekStart"),s(4)}function m(){M.set("volume",100*B.volume)}function v(){M.set("duration",B.duration)}function y(){B.currentTime!=M.get("position")&&M.set("position",B.currentTime),M.get("duration")>0&&M.get("duration")-M.get("position")<1&&!H&&(H=!0,M.emit("mediaBeforeComplete"));for(var e=0;e<B.buffered.length;e++)if(B.buffered.start(e)<=M.get("position")&&B.buffered.end(e)>M.get("position")){M.set("loadedFraction",B.buffered.end(e)/M.get("duration"));break}Math.abs(B.duration-B.currentTime)<=.001&&E()}function _(e){x=e.data}function E(){l(!1),s(0),G=!1}function b(e){var t=q.getConfiguration();if(t&&t.abr&&t.abr.enabled){for(var n,r=q.getVariantTracks().filter(function(e){return e.language===J}),i=0,a=r.length;i<a;++i)if(r[i].active){n=r[i];break}var o=M.player.get("qualityList");if(n&&o){var s=k(o,n);s&&M.emit("autoQualitySwitch",s.index)}}}function T(e){if(e.buffering){var t=C();!V&&t<=1&&B.currentTime>0&&(X=!0,M.emit("buffering",{isBuffering:!0,timestamp:(new Date).getTime(),isSeeking:B.seeking})),s(3)}else X&&(X=!1,M.emit("buffering",{isBuffering:!1,timestamp:(new Date).getTime(),isSeeking:B.seeking})),G&&s(V?2:1)}function w(e){void 0!==z&&(M.setAudioTrack(z),z=void 0),void 0!==K&&(M.setQuality(K),K=void 0)}function A(e){M.player.off("property:audioTrackList",A),e.data&&e.data.length>0&&M.setAudioTrack(e.data[0].id)}function R(e){var t,n="",r="";t=e.detail?"event.category: "+e.detail.category+"\nevent.code: "+e.detail.code+"\nevent.data: "+e.detail.data.toString():"event.category: "+e.category+"\nevent.code: "+e.code+"\nevent.data: "+e.data.toString();var i=!1;for(var o in shaka.util.Error.Category)shaka.util.Error.Category[o]===e.category&&(n=o);for(o in shaka.util.Error.Code)shaka.util.Error.Code[o]===e.code&&(r=o);switch(e.category){case 1:case 4:case 5:case 6:i=!0;break;case 2:case 3:case 8:case 9:i=!1}new a(M.player,n,r,t,i)}function S(e,t){for(var n,r=null,i=0,a=e.length;i<a;++i){if(e[i].representationVideoId)try{n=parseInt(e[i].representationVideoId)}catch(o){}if(n||(n=O(e[i].bandwidth)),t==n){r=e[i];break}}return r}function k(e,t){var n,r=null;if(t.representationVideoId)try{n=parseInt(t.representationVideoId)}catch(i){}n||(n=O(t.bandwidth));for(var a=0,o=e.length;a<o;++a)if(e[a].bitrate==n){r=e[a];break}return r}function O(e){var t=e/1e3;return t>300&&t<700&&(t=240),t>=700&&t<950&&(t=320),t>=950&&t<1350&&(t=L(360,404)),t>=1350&&t<1550&&(t=480),t>=1550&&t<3500&&(t=L(576,720)),t>=3500&&(t=1080),t}function L(e,t){var n=0;if(x)for(var r=0,i=x.length;r<i;++r)if(x[r].bitrate==e||x[r].bitrate==t){n=x[r].bitrate;break}return n}function C(){var e=-1,t=M.player.getPlayableElement();if(t&&t.buffered&&t.buffered.length>0)for(var n=t.buffered.length,r=M.player.get("position");n--;)t.buffered.start(n)<=r&&t.buffered.end(n)>=r&&(e=t.buffered.end(n)-r);return e}i.apply(this,arguments);var D,P="com.microsoft.playready",I="com.widevine.alpha",N="https://drm-ls.megogo.net/cenc/getlicense/cert.bin",M=this;M.player.get("player:usePluginBuffering")&&(D=new o(e,t));var x,F=null,U=null,B=null,j=0,G=!1,V=!1,H=!1,W=.6,Y=!0,q=null,K=void 0,z=void 0,X=!1,Q=null,J="";this.dispose=function(){l(!1),q&&(q.destroy(),q=null),B&&B.parentNode&&B.parentNode.removeChild(B),F=null,U=null,Q=null,B=null,K=void 0,z=void 0,G=!1,x=void 0,X=!1,M.player=null,M.namespase=null,M.config=null,D&&D.dispose()},this.load=function(e,t,i){if(!Q)return void n();if(i?(K="defaultQuality"in i?i.defaultQuality:-1,M.checkOptions(i)):i={},s(5),U=t||null,F=e||null,"defaultSubtitles"in i&&M.setSubtitles(i.defaultSubtitles),"autoplay"in i&&(Y=i.autoplay),!U&&!F)return void M.emit("player:mediaError",{message:"Src not found"});if(B||r(),l(!0),_({data:M.player.get("qualityList")}),U.is_wvdrm===!0){var a={},o={};if("license_server"in U)"modular"===M.player.config.supportedDrmType?(a[I]=U.license_server,o[I]={serverCertificate:Q}):"playready"===M.player.config.supportedDrmType&&(a[P]=U.license_server,o[P]={serverCertificate:Q});else if(U.wvls)for(var u in U.wvls)a[u]=U.wvls[u],o[u]={serverCertificate:Q};q.configure({drm:{servers:a,advanced:o}})}if(M.get("muted")?B.volume=0:(B.volume=M.get("volume")/100,0==B.volume&&M.set("muted",!0)),j=i.hasOwnProperty("startSeconds")?parseInt(i.startSeconds):0,void 0===z){var c=M.player.get("audioTrackList");c&&c.length>0?A({data:c}):M.player.on("property:audioTrackList",A)}q.load(F,j)["catch"](R)},this.play=function(){B.src&&B.play()},this.pause=function(){B&&!V&&(V=!0,B.pause())},this.stop=function(){B&&(B.src="",1==M.player.config.singleVideoInstance?B.style.display="none":M.container.removeChild(B)),this.dispose()},this.togglePlayPause=function(){B&&(1==M.get("state")?this.pause():this.play())},this.seekTo=function(e){s(5),B.currentTime=e},this.setVolume=function(e){e>100?e=100:e<0&&(e=0),B&&(B.volume=e/100),0==e?M.set("muted",!0):M.get("muted")&&(W=e/100,M.unMute()),M.get("muted")&&(W=e/100,M.unMute()),M.set("volume",e)},this.mute=function(){M.get("muted")||(W=B.volume,M.set("muted",!0),M.set("volume",0),B.volume=0)},this.unMute=function(){M.get("muted")&&(B.volume=W||.6,M.set("muted",!1),M.set("volume",parseInt(100*W)))},this.getPlayableElement=function(){return B},this.setQuality=function(e){try{e=parseInt(e)}catch(t){e=-1}if(!q)return void(K=e);if(e===-1)q.configure({abr:{enabled:!0}});else{var n=q.getAudioLanguages(),r=q.getVariantTracks().filter(function(e){var t=!1;return n&&n.length>0?(J||(J=n[0]),t=e.language===J):t=!0,t}),i=S(r,e);i?(q.configure({abr:{enabled:!1}}),q.selectVariantTrack(i,!0)):(q.configure({abr:{enabled:!0}}),e=-1)}M.player.set("quality",e)},this.setAudioTrack=function(e){if(!q)return void(z=e);var t,n=/\d+/,r=q.getAudioLanguages();if(0===r.length)z=e;else if(1===r.length)J=r[0];else for(var i=0,a=r.length;i<a;++i)if(t=r[i].match(n),t&&t.length>0)try{if(parseInt(t[0])===e){M.player.set("audioTrack",e);var o={preferredAudioLanguage:r[i]};q.configure(o),q.selectAudioLanguage(r[i]),J=r[i];break}}catch(s){}},M.log("MggpVendorDash:Created!")}var i=e("mggp-player").Vendor,a=e("mggp-player").AddonError,o=e("mggp-plugin-buffering");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.canPlay=function(e,t){
return!0},r.priority=0,r.mimeTypes=["mpd"],t.exports=r},{"mggp-player":21,"mggp-plugin-buffering":25}],49:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=a,n=o,r=!0,s=u=void 0}},s=e("mggp-player"),l=function(e){function t(e,n){r(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n);var i=window.location.protocol;this.SWFOBJECT_URL=i+"//s5.vcdn.biz/static/39253671/swfobject23.js",this.FLASH_VENDOR_URL=i+"//s6.vcdn.biz/static/39439361/flashVendor.swf",this._setState(-1),this.randomID=Math.round(1e3*Math.random()),window.flashVendorEventCallback=this._onFlashVendorEvent.bind(this),window.flashVendorIsAlive=this._onFlashAlive.bind(this),this._scriptListener=this._onScriptEvent.bind(this),this._timeoutListener=this._onTimeout.bind(this),this._onInjectListener=this._onInject.bind(this),this._onPingIntervalListener=this._onPingInterval.bind(this),this._flashIsAlive=!1,this._flashVendor=null,this._loadingTimeoutID=null,this._pingIntervalID=null,this._loadCalled=!1,this._swfReady=!1,this._src=null,this._options=null,this._beforeCompleteFired=!1,this._pingErrorCounter=0,this._volumeBeforeMute=.6,this.emit("vendorCreate"),window.swfobject?(this._createContainer(),this._injectSWF()):(this._scriptElement=document.createElement("script"),this._scriptElement.addEventListener("load",this._scriptListener),this._scriptElement.addEventListener("error",this._scriptListener),document.head.appendChild(this._scriptElement),this._scriptElement.src=this.SWFOBJECT_URL)}return i(t,e),a(t,[{key:"dispose",value:function(){window.swfobject.removeSWF("flashVendor"+this.randomID),this._scriptElement&&this._scriptElement.parentNode&&this._scriptElement.parentNode.removeChild(this._scriptElement),delete window.flashVendorEventCallback,delete window.flashVendorIsAlive,this.emit("vendorDestroy"),this._loadingTimeoutID&&(clearTimeout(this._loadingTimeoutID),this._loadingTimeoutID=null),this._pingIntervalID&&(clearInterval(this._pingIntervalID),this._pingIntervalID=null),this._tryToCallMethod("dispose"),this._loadCalled=!1,this._swfReady=!1,this._src=null,this._options=null,this._beforeCompleteFired=!1,this.pingErrorCounter=0}},{key:"load",value:function(e,t,n){if(this._loadCalled=!0,n){var r,i;if("defaultAudioTrack"in n){var a=this.get("audioTrackList"),o=-1;if(a&&a.length>0)for(r=0,i=a.length;r<i;++r)if(a[r].index==n.defaultAudioTrack){o=a[r].id,this._tryToCallMethod("setDefaultAudioTrack",o);break}}if("defaultQuality"in n){var s,l=this.get("qualityList");if(l)for(r=0,i=l.length;r<i;++r)if(l[r].bitrate==n.defaultQuality){s=l[r].index,this._tryToCallMethod("setDefaultQuality",s);break}}"defaultSubtitles"in n&&(this.setSubtitles(n.defaultSubtitles),delete n.defaultSubtitles),this.checkOptions(n)}if(this.container&&this.container.classList.contains("mggskin-hidden")&&this.container.classList.remove("mggskin-hidden"),this.container&&this.container.parentNode&&this.container.parentNode.classList.contains("mggskin-hidden")&&this.container.parentNode.classList.remove("mggskin-hidden"),this.container){var u=document.getElementById("flashVendorContainer"+this.randomID)||document.getElementById("flashVendor"+this.randomID);u&&u.parentNode!=this.container&&this.container.appendChild(u)}e?this._src=e:t&&t.src&&(this._src=t.src),this._options=n,0===this.get("volume")&&this.set("muted",!0),this._swfReady&&(this._tryToCallMethod("setVolume",this.get("volume")),this._tryToCallMethod("load",e))}},{key:"play",value:function(){this._tryToCallMethod("play")}},{key:"pause",value:function(){this._tryToCallMethod("pause")}},{key:"stop",value:function(){this._tryToCallMethod("stop"),this.dispose()}},{key:"togglePlayPause",value:function(){this._tryToCallMethod("togglePlayPause")}},{key:"seekTo",value:function(e){this._tryToCallMethod("seekTo",e)}},{key:"setVolume",value:function(e){e<0?e=0:e>100&&(e=100),0==e?this.set("muted",!0):this.get("muted")&&this.unMute(),this.set("volume",e),e/=100,this._tryToCallMethod("setVolume",e)}},{key:"mute",value:function(){this._volumeBeforeMute=this.get("volume"),this._tryToCallMethod("mute"),this.set("muted",!0),this.set("volume",0)}},{key:"unMute",value:function(){this._tryToCallMethod("unMute"),this.set("muted",!1),this.set("volume",this._volumeBeforeMute)}},{key:"setQuality",value:function(e){var t,n=this.get("qualityList");if(n){for(var r=0,i=n.length;r<i;++r)if(n[r].bitrate==e){t=n[r].index;break}this._tryToCallMethod("setQuality",t),this.set("quality",e)}}},{key:"setAudioTrack",value:function(e){var t=this.get("audioTrackList"),n=-1;if(t&&t.length>0)for(var r=0,i=t.length;r<i;++r)if(t[r].index==e){n=t[r].id;break}n!=-1&&this._tryToCallMethod("setAudioTrack",n)}},{key:"_onFlashVendorEvent",value:function(e,t){switch(e){case"ready":this._loadingTimeoutID&&(clearTimeout(this._loadingTimeoutID),this._loadingTimeoutID=null),this._flashVendor=document.getElementById("flashVendor"+this.randomID),this._swfReady=!0,this._loadCalled&&(this._tryToCallMethod("setVolume",this.get("volume")),this._tryToCallMethod("load",this._src));break;case"timeChanged":this.set("position",t),this.get("duration")>0&&this.get("duration")-t<1&&!this._beforeCompleteFired&&(this._beforeCompleteFired=!0,this.emit("mediaBeforeComplete"));break;case"durationChanged":this.set("duration",t);break;case"complete":this._setState(0);break;case"stateChanged":switch(t){case"playing":this._setState(1);break;case"paused":this._setState(2);break;case"buffering":this._setState(3)}break;case"loadedFraction":this.set("loadedFraction",t)}}},{key:"_onScriptEvent",value:function(e){"load"==e.type?(this._createContainer(),this._injectSWF()):"error"==e.type&&this.emit("error")}},{key:"_onTimeout",value:function(){if(this._loadingTimeoutID=null,this.emit("error"),s.AddonError){var e,t,n;e=s.AddonError.errorTypes.NETWORK_ERROR,t=s.AddonError.errorCodes[e].MEDIA_FILE_LOADING_ERROR,n=s.AddonError.errorMessages[t]+" Timeout 10 seconds",new s.AddonError(this.player,e,t,n,(!0))}}},{key:"_injectSWF",value:function(){var e=(window.getComputedStyle(this.container),"position:absolute;display:block;left:"),t={},n={};n.quality="high",n.bgcolor="0",n.AllowScriptAccess="always",n.allowfullscreen="true",n.wmode="opaque",n.salign="tl";var r={};r.id="flashVendor"+this.randomID,r.name="flashVendor"+this.randomID;var i=document.getElementById("flashVendorContainer"+this.randomID);if(i)window.swfobject.embedSWF(this.FLASH_VENDOR_URL,i,"100%","100%","10.3.0",null,t,n,r,this._onInjectListener),window.swfobject.createCSS("#vendor",e),this._loadingTimeoutID=setTimeout(this._timeoutListener,1e4);else if(this.emit("error"),s.AddonError){var a,o,l;a=s.AddonError.errorTypes.INTERNAL_ERROR,o=s.AddonError.errorCodes[a].CANNOT_INJECT_PLAYABLE_ELEMENT,l="Cannot find container for swf injecting",new s.AddonError(this.player,a,o,l,(!0))}}},{key:"_onInject",value:function(){this._pingIntervalID=setInterval(this._onPingIntervalListener,500)}},{key:"_onPingInterval",value:function(){this._flashIsAlive?this._pingErrorCounter>5?(this.player.emit("showSkins"),this._pingErrorCounter=0):(this._flashIsAlive=!1,this._pingErrorCounter=0):5==++this._pingErrorCounter&&this.player.emit("hideSkins")}},{key:"_onFlashAlive",value:function(){this._flashIsAlive=!0}},{key:"_setState",value:function(e){e=parseInt(e),this.set("state",e),this.emit("stateChange",e)}},{key:"_createContainer",value:function(){var e=document.createElement("div");e.id="flashVendorContainer"+this.randomID,e.style.position="absolute",e.style.width="100%",e.style.height="100%",this.container.appendChild(e)}},{key:"_tryToCallMethod",value:function(e,t){this._flashVendor&&"function"==typeof this._flashVendor[e]&&("undefined"!=t&&null!=t?this._flashVendor[e](t):this._flashVendor[e]())}}],[{key:"canPlay",value:function(e){return t.mimeTypes.indexOf(e)!=-1}}]),t}(s.Vendor);n["default"]=l,l.priority=3,l.mimeTypes=["f4m","m3u8","flv","mp4"],t.exports=n["default"]},{"mggp-player":21}],50:[function(e,t,n){function r(e,t,n){function r(){"function"==typeof w&&w()}function i(e){"function"==typeof w&&w(!0,e)}function a(){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.addEventListener("load",o,!1),e.addEventListener("error",s,!1),e.open("GET",S,!0),e.setRequestHeader("Pragma","Cache-Control: no-cache"),e.setRequestHeader("Cache-Control","max-age=0"),e.send()}function o(e){var t=e.target;T=new Uint8Array(t.response),d()}function s(e){i("Failed to retrieve the server certificate.")}function l(e){for(var t=new DataView(e.slice(0,4).buffer).getUint32(0,!0),n=String.fromCharCode.apply(null,new Uint16Array(e.slice(4,t+4).buffer)),r=new URL(n).hostname,i=[],a=0;a<r.length;a+=2)i.push(parseInt(r.substr(a,2),16));var o=Uint8Array.from(i);return E(o)}function u(e,t,n){"string"==typeof t&&(t=_(t));var r=0,i=new ArrayBuffer(e.byteLength+4+t.byteLength+4+n.byteLength),a=new DataView(i),o=new Uint8Array(i,r,e.byteLength);o.set(e),r+=e.byteLength,a.setUint32(r,t.byteLength,!0),r+=4;var s=new Uint16Array(i,r,t.length);s.set(t),r+=s.byteLength,a.setUint32(r,n.byteLength,!0),r+=4;var l=new Uint8Array(i,r,n.byteLength);return l.set(n),new Uint8Array(i,0,i.byteLength)}function c(){WebKitMediaKeys.isTypeSupported("com.apple.fps.1_0","video/mp4")?b="com.apple.fps.1_0":i("Key System not supported")}function d(){n.addEventListener("webkitneedkey",p,!1),n.addEventListener("error",f,!1),n.src=e}function f(e){i("A video playback error occurred")}function p(e){var t=e.target,n=e.initData,r=l(n);n=u(n,r,T),t.webkitKeys||(c(),t.webkitSetMediaKeys(new WebKitMediaKeys(b))),t.webkitKeys||i("Could not create MediaKeys");var a=t.webkitKeys.createSession("video/mp4",n);a||i("Could not create key session"),a.contentId=r,a.addEventListener("webkitkeymessage",h),a.addEventListener("webkitkeyadded",y),a.addEventListener("webkitkeyerror",v)}function h(e){e.currentTarget.removeEventListener(e.type,h);var t=e.target,n=e.message,r=new XMLHttpRequest;r.responseType="arraybuffer",r.session=t,r.addEventListener("load",g,!1),r.addEventListener("error",m,!1),r.open("POST",k,!0),r.setRequestHeader("Content-Type","application/octet-stream"),r.send(n)}function g(e){var t=e.target,n=t.session;n.update(new Uint8Array(t.response)),r()}function m(e){i("The license request failed.")}function v(e){e.currentTarget.removeEventListener(e.type,v),i("A decryption key error was encountered")}function y(e){e.currentTarget.removeEventListener(e.type,y)}function _(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n}function E(e){for(var t,n,r,i,a,o,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;c<e.length;)t=e[c++],n=c<e.length?e[c++]:Number.NaN,r=c<e.length?e[c++]:Number.NaN,i=t>>2,a=(3&t)<<4|n>>4,o=(15&n)<<2|r>>6,s=63&r,isNaN(n)?o=s=64:isNaN(r)&&(s=64),u+=l.charAt(i)+l.charAt(a)+l.charAt(o)+l.charAt(s);return u}var b,T,w,A="https://drm-ls.megogo.net/fairplay/cert.bin?ref=",R="https://drm-ls.megogo.net/fairplay?ref=",S=A+t,k=R+t;this.startProcessing=function(e){w=e,a()},this.dispose=function(){n.addEventListener("webkitneedkey",p,!1),n.addEventListener("error",f,!1)}}function i(e,t){function n(e,t,n){if(n){if(d.checkOptions(n),n.hasOwnProperty("defaultAudioTrack")&&(w=parseInt(n.defaultAudioTrack),delete n.defaultAudioTrack),n.hasOwnProperty("defaultQuality")){var r=i(parseInt(n.defaultQuality));r&&r.src&&(e=r.src,d.player.set("quality",r.bitrate)),delete n.defaultQuality}n.hasOwnProperty("defaultSubtitles")&&(d.setSubtitles(n.defaultSubtitles),delete n.defaultSubtitles)}else n={};return O(3),e=l(e),t&&(t.src=l(t.src)),h=t||null,p=e?e:t.src,h||p?(g.autoplay=!n.hasOwnProperty("autoplay")||n.autoplay,d.get("muted")?g.volume=0:(g.volume=d.get("volume")/100,0==g.volume&&d.set("muted",!0)),"startSeconds"in n?(m=n.startSeconds,delete n.startSeconds):m=void 0,void(g.src=e)):void d.emit("mediaError",{message:"Src not found"})}function i(e){void 0===e||null===e?e=-1:"string"==typeof e&&(e=parseInt(e));var t,n=d.player.get("qualityList");if(n&&n.length>0)for(var r=0,i=n.length;r<i;++r)if(n[r].bitrate==e&&n[r].src){t=n[r];break}return t}function l(e){return e&&e.indexOf("blob:")!==-1&&e.indexOf(".m3u8")!==-1&&(e=e.substring(0,e.indexOf(".m3u8"))),e}function u(e){var t="";if(e){var n=".biz",r=e.indexOf(n);r!==-1&&(t=e.substr(r+n.length))}return t}a.apply(this,arguments);var c,d=this;d.player.get("player:usePluginBuffering")&&(c=new s(e,t));var f,p=null,h=null,g=null,m=0,v=!1,y=!1,_=!1,E=!1,b=.6,T=0,w=void 0,A="",R=!1,S=!1;this.dispose=function(){L(!1),f&&f.dispose(),S=!1,p=null,h=null,g=null,w=void 0,A="",R=!1,d.player=null,d.namespase=null,d.config=null,c&&c.dispose()},this.checkOptions=function(e){e.hasOwnProperty("container")&&(this.container=e.container),e.hasOwnProperty("namespace")&&(this.namespace=e.namespace,this.player&&this.namespace!=this.DEFAULT_NAMESPACE&&(this.player.registerProperty(this.namespace+"volume",60,!0),this.player.registerProperty(this.namespace+"position",0),this.player.registerProperty(this.namespace+"duration",0),this.player.registerProperty(this.namespace+"state",-1),this.player.registerProperty(this.namespace+"loadedFraction",0),this.player.registerProperty(this.namespace+"muted",!1,!0)))},this.load=function(e,t,i){if(O(5),e.indexOf("blob:")===-1){var a=u(e);a!==A&&(R=!1,A=a),R?n(e,t,i):(g||(k(),L(!0)),f&&f.dispose(),f=new r(e,A,g),f.startProcessing(function(r,a){r?d.emit("error"):R||(R=!0,n(e,t,i))}))}else n(e,t,i)},this.play=function(){g.src&&g.play()},this.pause=function(){g&&!y&&(y=!0,g.pause())},this.stop=function(){g&&(1==d.player.config.singleVideoInstance?(g.style.display="none",g.src=""):d.container.removeChild(g)),this.dispose()},this.togglePlayPause=function(){g&&(1==d.get("state")?this.pause():this.play())},this.seekTo=function(e){g&&void 0!==e&&null!==e&&(O(5),g.currentTime=Math.min(Math.max(0,e),Math.min(d.get("duration")-10,e)))},this.setVolume=function(e){e>100?e=100:e<0&&(e=0),g&&(g.volume=e/100),0==e?d.set("muted",!0):d.get("muted")&&(b=e/100,d.unMute()),d.set("volume",e)},this.mute=function(){d.get("muted")||(b=g.volume,d.set("muted",!0),d.set("volume",0),g.volume=0)},this.unMute=function(){d.get("muted")&&(g.volume=b||.6,d.set("muted",!1),d.set("volume",parseInt(100*b)))},this.getPlayableElement=function(){return g},this.setQuality=function(e){S=!0,w=d.player.get("audioTrack"),d.emit("qualityNeedChange",e)},this.setAudioTrack=function(e){if(S=!0,g){var t=g.audioTracks;if(t&&t.length>0)for(var n,r=/\d+/,i=0,a=t.length;i<a;++i)if(n=t[i].language.match(r),n&&n.length>0)try{if(parseInt(n[0])===e){d.player.set("audioTrack",e),t[i].enabled=!0;break}}catch(o){}}else w=e};var k=function(){1==d.player.config.singleVideoInstance&&(g=d.player.get(d.namespace+"video")),g||(g=document.createElement("video"),d.container.appendChild(g)),g.className=d.namespace+"video",g.style.width="100%",g.style.height="100%",g.style.display="initial",c&&c.setVideo(g)},O=function(e){d.set("state",e),d.emit("stateChange",e)},L=function(e){e?(g&&(g.addEventListener("loadstart",D,!1),g.addEventListener("canplay",P,!1),g.addEventListener("pause",I,!1),g.addEventListener("playing",N,!1),g.addEventListener("seeked",M,!1),g.addEventListener("seeking",x,!1),g.addEventListener("volumechange",F,!1),g.addEventListener("durationchange",U,!1),g.addEventListener("ended",j,!1),g.addEventListener("error",C,!1)),d.player&&d.player.on&&d.player.on("player:timeUpdate",B)):(g&&(g.removeEventListener("loadstart",D,!1),g.removeEventListener("canplaythrough",P,!1),g.removeEventListener("pause",I,!1),g.removeEventListener("playing",N,!1),g.removeEventListener("seeked",M,!1),g.removeEventListener("seeking",x,!1),g.removeEventListener("volumechange",F,!1),g.removeEventListener("durationchange",U,!1),g.removeEventListener("ended",j,!1),g.removeEventListener("error",C,!1)),d.player&&d.player.off&&d.player.off("player:timeUpdate",B))},C=function(e){d.emit("mediaError",{"this":this}),O(5);var t,n,r;t=o.errorTypes.NETWORK_ERROR,n=o.errorCodes[t].MEDIA_FILE_LOADING_ERROR,r=o.errorMessages[n]+p,new o(d.player,t,n,r,(!0))},D=function(){O(3)},P=function(){v||(d.emit("mediaCanPlay"),g&&g.autoplay&&g.play()),void 0!==w&&(d.setAudioTrack(w),w=void 0),void 0!==m&&(d.seekTo(m),m=void 0)},I=function(){y&&O(2)},N=function(){if(S){S=!1;var e=g.textTracks;if(e&&e.length>0)for(var t=0,n=e.length;t<n;++t)"subtitles"===e[t].kind&&(e[t].mode="disabled")}v=!0,y=!1,O(1)},M=function(){d.emit("mediaSeekEnd")},x=function(){d.emit("mediaSeekStart"),O(4)},F=function(){d.set("volume",100*g.volume)},U=function(){d.set("duration",g.duration)},B=function(){var e=d.get("position"),t=d.get("duration");g.currentTime!=e&&d.set("position",g.currentTime),t>0&&t-e<1&&!_&&(_=!0,d.emit("mediaBeforeComplete"));for(var n=0;n<g.buffered.length;n++)if(g.buffered.start(n)<=e&&g.buffered.end(n)>e){d.set("loadedFraction",g.buffered.end(n)/t);break}var r=1/(d.config.hasOwnProperty("timeInterval")?d.config.timeInterval:1e3/3),i=parseInt(g.currentTime),a=parseInt(T+r);!E&&i<a&&!y&&v&&(E=!0,O(3)),E&&i>a&&!y&&(E=!1,O(1)),g.currentTime===T||y||1===d.player.get("state")||O(1),T=g.currentTime},j=function(){O(0),L(!1),v=!1};d.log("MggpVendorHlsFairplay:Created!")}var a=e("mggp-player").Vendor,o=e("mggp-player").AddonError,s=e("mggp-plugin-buffering");i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.canPlay=function(e,t){return i.mimeTypes.indexOf(e)!==-1&&t.drm},i.priority=0,i.mimeTypes=["m3u8"],t.exports=i},{"mggp-player":21,"mggp-plugin-buffering":25}],51:[function(e,t,n){"use strict";function r(e,t){function n(e){e?h&&(h.on(Hls.Events.MANIFEST_PARSED,J),h.on(Hls.Events.FRAG_LOADED,s),h.on(Hls.Events.ERROR,F),h.on(Hls.Events.LEVEL_SWITCH,U),h.on(Hls.Events.LEVEL_LOADED,l)):h&&(h.off(Hls.Events.MANIFEST_PARSED,J),h.off(Hls.Events.FRAG_LOADED,s),h.off(Hls.Events.ERROR,F),h.off(Hls.Events.LEVEL_SWITCH,U),h.off(Hls.Events.LEVEL_LOADED,l))}function r(e){var t=u();!E&&t<=1&&(L=!0,d.emit("buffering",{isBuffering:!0,timestamp:(new Date).getTime(),isSeeking:v.seeking}),M(3))}function s(e,t){d.emit("hls:chunkLoaded",t)}function l(e,t){t&&t.details&&(S=t.details.live)}function u(){var e=-1,t=d.player.getPlayableElement();if(t&&t.buffered&&t.buffered.length>0)for(var n=t.buffered.length,r=d.player.get("position");n--;)t.buffered.start(n)<=r&&t.buffered.end(n)>=r&&(e=t.buffered.end(n)-r);return e}i.apply(this,arguments);var c,d=this,f={};d.player.get("player:usePluginBuffering")&&(c=new o(e,t));for(var p in t)f[p]=t[p];f.debug=!(!f.hasOwnProperty("hlsDebug")||1!=f.hlsDebug);var h,g=null,m=null,v=null,y=0,_=!1,E=!1,b=0,T=!1,w=.6,A=0,R=-1,S=!1,k=void 0,O=0,L=!1,C=0,D=0,P=0;this.dispose=function(){x(!1),n(!1),h&&h.destroy(),k&&(clearInterval(k),k=void 0),R=-1,h=null,g=null,m=null,v=null,O=0,L=!1,d.player=null,d.namespase=null,d.config=null,c&&c.dispose()},this.load=function(e,t,r){if(k&&(clearInterval(k),k=void 0),r){if(!d.checkOptions(r))return}else r={};if(M(5),m=t?t:m||null,g=e||t.src,!(m||g&&""!=g))return void d.emit("player:mediaError",{message:"Src not found"});v||N(),x(!0),v.autoplay=!0,d.get("muted")?v.volume=0:(v.volume=d.get("volume")/100,0==v.volume&&d.set("muted",!0));var i=d.player.get("quality");null===i||void 0===i?i=-1:i!=-1&&(i=I(i)),h&&h.destroy(),h=new Hls(f),_=!1,n(!0),h.attachMedia(v),_?i!=-1?h.currentLevel=i:h.nextLevel=i:(R=i,h.loadSource(g)),r.hasOwnProperty("startSeconds")&&(y=parseInt(r.startSeconds))},this.play=function(){v.src&&v.play()},this.pause=function(){v&&!E&&(E=!0,v.pause())},this.stop=function(){v&&(1==d.player.config.singleVideoInstance?(v.style.display="none",v.src=""):d.container.removeChild(v)),this.dispose()},this.togglePlayPause=function(){v&&(1==d.get("state")?this.pause():this.play())},this.seekTo=function(e){v&&e&&(M(5),v.currentTime=Math.min(Math.max(0,e),Math.min(d.get("duration")-10,e)),A=v.currentTime)},this.setVolume=function(e){e>100?e=100:e<0&&(e=0),v&&(v.volume=e/100),0==e?d.set("muted",!0):d.get("muted")&&(w=e/100,d.unMute()),d.set("volume",e)},this.mute=function(){d.get("muted")||(w=v.volume,d.set("muted",!0),d.set("volume",0),v.volume=0)},this.unMute=function(){d.get("muted")&&(v.volume=w||.6,d.set("muted",!1),d.set("volume",parseInt(100*w)))},this.getPlayableElement=function(){return v},this.setQuality=function(e){var t,n;if(_)if(e==-1)h.nextLevel=e,d.player.set("quality",e);else{var r=d.player.get("qualityList");if(r&&r.length>1)for(t=0,n=r.length;t<n;++t)if(e===r[t].bitrate){h.currentLevel=r[t].index,d.player.set("quality",e);break}}else{var i=d.player.get("videoInfo");if(i&&i.bitrates&&i.bitrates.length>0)for(t=0,n=i.bitrates.length;t<n;++t)if(i.bitrates[t].bitrate===e){d.player.set("quality",e);break}d.load(d.player.get("src"),i,d.player.get("vendorOptions"))}};var I=function(e){var t,n,r=-1,i=d.player.get("qualityList");if(i&&i.length>0){for(t=0,n=i.length;t<n;++t)if(i[t].bitrate===e){r=i[t].index;break}}else if(!i||0===i.length){var a=d.player.get("videoInfo");if(a){i=a.bitrates;var o=!0,s=!1;for(t=0,n=i.length;t<n;++t)0===i[t].index?o=!1:1===i[t].index&&(s=!0),i[t].bitrate===e&&(r=i[t].index);o&&s&&r!=-1&&--r}}return r},N=function(){1==d.player.config.singleVideoInstance&&(v=d.player.get(d.namespace+"video")),v||(v=document.createElement("video"),d.container.appendChild(v)),v.className=d.namespace+"video",v.style.width="100%",v.style.height="100%",v.style.display="initial",c&&c.setVideo(v)},M=function(e){b=e,d.set("state",e),d.emit("stateChange",e)},x=function(e){e?(v&&(v.addEventListener("loadstart",G),v.addEventListener("canplay",V),v.addEventListener("pause",H),v.addEventListener("playing",W),v.addEventListener("seeked",Y),v.addEventListener("seeking",q),v.addEventListener("volumechange",K),v.addEventListener("durationchange",z),v.addEventListener("ended",Q),v.addEventListener("error",B),v.addEventListener("waiting",r)),d.player&&d.player.on&&d.player.on("player:timeUpdate",X),k&&clearInterval(k)):(v&&(v.removeEventListener("loadstart",G),v.removeEventListener("canplaythrough",V),v.removeEventListener("pause",H),v.removeEventListener("playing",W),v.removeEventListener("seeked",Y),v.removeEventListener("seeking",q),v.removeEventListener("volumechange",K),v.removeEventListener("durationchange",z),v.removeEventListener("ended",Q),v.removeEventListener("waiting",r)),d.player&&d.player.off&&d.player.off("player:timeUpdate",X),k&&(clearInterval(k),k=void 0))},F=function(e,t){var n,r,i,o;switch(t.details){case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:try{d.log('cannot Load <a href="'+t.url+'">'+t.url+"</a><br>HTTP response code:"+t.response.status+"<br>"+t.response.statusText),0===t.response.status&&$("#HlsStatus").append('this might be a CORS issue, consider installing <a href="https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi">Allow-Control-Allow-Origin</a> Chrome Extension')}catch(s){d.log('cannot Load <a href="'+t.url+'">'+t.url+"</a><br>Reason:Load "+(t.event&&t.event.type))}n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].PLAYLIST_LOADING_ERROR,i=a.errorMessages[r]+t.url,o=!0;break;case Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT:d.log("timeout while loading manifest"),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].PLAYLIST_LOADING_ERROR,i=a.errorMessages[r]+t.url+" TIMEOUT",o=!0;break;case Hls.ErrorDetails.MANIFEST_PARSING_ERROR:d.log("error while parsing manifest:"+t.reason),n=a.errorTypes.PLAYBACK_ERROR,r=a.errorCodes[n].PARSING_ERROR,i=a.errorMessages[r]+t.url,o=!0;break;case Hls.ErrorDetails.LEVEL_LOAD_ERROR:d.log("error while loading level playlist"),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].CHUNKLIST_LOADING_ERROR,i=a.errorMessages[r]+t.url,o=!0;break;case Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT:d.log("timeout while loading level playlist"),d.log("error while loading level playlist"),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].CHUNKLIST_LOADING_ERROR,i=a.errorMessages[r]+t.url+" TIMEOUT",o=!0;break;case Hls.ErrorDetails.LEVEL_SWITCH_ERROR:d.log("error while trying to switch to level "+t.level),j(),n=a.errorTypes.PLAYBACK_ERROR,r=a.errorCodes[n].LEVEL_SWITCH_ERROR,i=a.errorMessages[r]+t.url,o=!1;break;case Hls.ErrorDetails.FRAG_LOAD_ERROR:d.log("error while loading fragment "+t.frag.url),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].CHUNK_LOADING_ERROR,i=a.errorMessages[r]+t.url,o=!1;break;case Hls.ErrorDetails.FRAG_LOAD_TIMEOUT:d.log("timeout while loading fragment "+t.frag.url),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].CHUNK_LOADING_ERROR,i=a.errorMessages[r]+t.url+" TIMEOUT",o=!1;break;case Hls.ErrorDetails.FRAG_LOOP_LOADING_ERROR:d.log("Frag Loop Loading Error"),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].CHUNK_LOADING_ERROR,i=a.errorMessages[r]+t.url,o=!1;break;case Hls.ErrorDetails.FRAG_DECRYPT_ERROR:d.log("Decrypting Error:"+t.reason),n=a.errorTypes.PLAYBACK_ERROR,r=a.errorCodes[n].DECODING_ERROR,i=a.errorMessages[r]+t.url,o=!1;break;case Hls.ErrorDetails.FRAG_PARSING_ERROR:n=a.errorTypes.PLAYBACK_ERROR,r=a.errorCodes[n].DECODING_ERROR,i=a.errorMessages[r]+t.url,o=!1;break;case Hls.ErrorDetails.KEY_LOAD_ERROR:d.log("error while loading key "+t.frag.decryptdata.uri),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].KEY_LOADING_ERROR,i=a.errorMessages[r]+t.url,o=!1;break;case Hls.ErrorDetails.KEY_LOAD_TIMEOUT:d.log("timeout while loading key "+t.frag.decryptdata.uri),n=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[n].KEY_LOADING_ERROR,i=a.errorMessages[r]+t.url+" TIMEOUT",o=!1;break;case Hls.ErrorDetails.BUFFER_APPEND_ERROR:d.log("Buffer Append Error"),n=a.errorTypes.INTERNAL_ERROR,r=a.errorCodes[n].BUFFER_APPEND_ERROR,i=a.errorMessages[r],o=!1;break;case Hls.ErrorDetails.BUFFER_APPENDING_ERROR:d.log("Buffer Appending Error"),n=a.errorTypes.INTERNAL_ERROR,r=a.errorCodes[n].BUFFER_APPEND_ERROR,i=a.errorMessages[r],o=!1}if(n&&r&&i&&new a(d.player,n,r,i,o),t&&t.fatal)switch(M(5),t.type){case Hls.ErrorTypes.MEDIA_ERROR:j();break;case Hls.ErrorTypes.NETWORK_ERROR:d.log(",network error ..."),d.emit("mediaError",{"this":this,message:"Network connect error"});break;default:d.log(", unrecoverable error"),dispose(),d.emit("mediaError",{"this":this,message:"Fatal, unrecoverable error"})}},U=function(e,t){h.manualLevel==-1&&d.emit("autoQualitySwitch",t.level)},B=function(e){if(M(5),"error"===e.type){var t,n,r,i,o,s=e.currentTarget.error;switch(s.code){case s.MEDIA_ERR_ABORTED:o="You aborted the video playback";break;case s.MEDIA_ERR_DECODE:return o="The video playback was aborted due to a corruption problem or because the video used features your browser did not support",j(),t=a.errorTypes.PLAYBACK_ERROR,n=a.errorCodes[t].DECODING_ERROR,r=a.errorMessages[n],void(i=!1);case s.MEDIA_ERR_NETWORK:o="A network error caused the video download to fail part-way";break;case s.MEDIA_ERR_SRC_NOT_SUPPORTED:o="The video could not be loaded, either because the server or network failed or because the format is not supported"}d.log(o),d.emit("mediaError",{"this":this,message:o}),t&&n&&r&&new a(d.player,t,n,r,i)}},j=function(){if(1==d.config.autoRecoverError){var e=h.currentLevel,t=parseInt((new Date).getTime()/1e3);!D||t-D>3e3?(D=t,d.log(",try to recover media Error ..."),h.recoverMediaError(),d.get("position")<1&&(h.currentLevel=e)):!P||t-P>3e3?(P=t,d.log(",try to swap Audio Codec and recover media Error ..."),h.swapAudioCodec(),h.recoverMediaError()):d.emit("mediaError",{"this":this,message:" cannot recover, last media error recovery failed ..."})}},G=function(){M(3)},V=function(){_||(d.emit("mediaCanPlay"),d.player.get("ad:showing")||v.play(),y>0&&v.duration>0&&(y=Math.min(y,v.duration-15))),y>0&&(v.currentTime>=y?y=0:d.seekTo(y)),L&&(L=!1,d.emit("buffering",{isBuffering:!1,timestamp:(new Date).getTime(),isSeeking:v.seeking}))},H=function(){E&&M(2)},W=function(){if(!_){var e=!0,t=d.player.get("vendorOptions");if(t&&void 0!==t.autoplay&&null!==t.autoplay&&(e=t.autoplay),y>0&&d.seekTo(y),d.player.set("vendorOptions",null),e===!1)return M(2),v.pause(),E=!0,void(_=!0)}var n=d.player.get("vendor:dismissSeekToLiveAfterPause");if(S&&E&&n!==!0){var r=v.duration-3;r<0&&(r=0),v.currentTime=r}_=!0,E=!1,M(1)},Y=function(){v.currentTime>=.5&&(d.emit("mediaSeekEnd"),M(C))},q=function(){v.currentTime>=.5&&(4!==b&&(C=b),d.emit("mediaSeekStart"),M(4))},K=function(){d.set("volume",100*v.volume)},z=function(){d.set("duration",v.duration)},X=function(){v.currentTime!=d.get("position")&&d.set("position",v.currentTime),d.get("duration")>0&&d.get("duration")-d.get("position")<1&&!T&&(T=!0,d.emit("mediaBeforeComplete"));for(var e=0;e<v.buffered.length;e++)if(v.buffered.start(e)<=d.get("position")&&v.buffered.end(e)>d.get("position")){d.set("loadedFraction",v.buffered.end(e)/d.get("duration"));break}Math.abs(v.duration-v.currentTime)<=.001&&Q()},Q=function(){x(!1),M(0),_=!1},J=function(e,t){R>=0&&R<h.levels.length&&(h.currentLevel=R),d.emit("hls:manifestParsed",t)};d.log("MggpVendorHls:Created!")}var i=e("mggp-player").Vendor;window.Hls=e("hls.js");var a=e("mggp-player").AddonError,o=e("mggp-plugin-buffering");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.mimeTypes=["m3u8"],r.priority=0,r.canPlay=function(e,t){var n=!1;return t.drm||(n=Hls.isSupported()),n},t.exports=r},{"hls.js":16,"mggp-player":21,"mggp-plugin-buffering":25}],52:[function(e,t,n){function r(e,t){function n(e){s.set("state",e),s.emit("stateChange",e)}function r(){u=document.createElement("iframe"),u.style.border="none",u.frameborder="0",u.scrolling="no",u.style.overflow="hidden",u.allowtransparency=!0,u.style.backgroundColor="transparent",u.style.width="100%",u.style.height="100%",s.container.appendChild(u)}function a(e){switch(u.removeEventListener("load",a,!1),u.removeEventListener("error",a,!1),n(5),e.type){case"load":p=!0,s.emit("mediaCanPlay"),s.emit("loadedFraction",1),h&&s.play();break;case"error":s.emit("mediaError"),s.dispose()}}function o(){var e=(new Date).getTime()/1e3;f>0&&l&&(d+=e-f,c-d<=1&&!g&&(g=!0,s.emit("mediaBeforeComplete")),d>=c&&(n(0),l=!1),s.set("position",d)),f=e}i.apply(this,arguments);var s=this,l=!1,u=null,c=0,d=0,f=0,p=!1,h=!1,g=!1;this.dispose=function(){s.player.off("player:timeUpdate",o),u&&(u.removeEventListener("load",a,!1),u.removeEventListener("error",a,!1),u.parentNode&&u.parentNode.removeChild(u)),l=!1,p=!1,s.emit("vendorDestroy")},this.load=function(e,t,i){if(!e||!e&&!t||t&&!t.src||void 0===i.duration)return void s.emit("error");if(i){if(!s.checkOptions(i))return}else i={};n(5),h=i.autoplay,u||r(),c=i.duration,s.set("duration",c),s.set("position",0),u.addEventListener("load",a,!1),u.addEventListener("error",a,!1),n(3),e?u.src=e:t.src&&(u.src=e),s.player.on("player:timeUpdate",o)},this.play=function(){n(1),p&&(l=!0)},this.pause=function(){n(2),l=!1},this.stop=function(){this.dispose()},this.togglePlayPause=function(){l?s.pause():s.play()},this.seekTo=function(e){e>c?e=c:e<0&&(e=0),d=e,s.set("position",d)},this.setVolume=function(e){},this.mute=function(){},this.unMute=function(){},this.getPlayableElement=function(){return _video},s.emit("vendorCreate")}var i=e("mggp-player").Vendor;e("mggp-player").AddonError;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.canPlay=function(e,t){return!0;
},r.priority=0,r.mimeTypes=["html","htm"],t.exports=r},{"mggp-player":21}],53:[function(e,t,n){"use strict";function r(e,t){function n(e){var t=s();!m&&t<=1&&(E=!0,u.emit("buffering",{isBuffering:!0,timestamp:(new Date).getTime(),isSeeking:p.seeking}),R(3))}function r(e){return e&&e.indexOf("blob:")!==-1&&e.indexOf(".m3u8")!==-1&&(e=e.substring(0,e.indexOf(".m3u8"))),e}function s(){var e=-1,t=u.player.getPlayableElement();if(t&&t.buffered&&t.buffered.length>0)for(var n=t.buffered.length,r=u.player.get("position");n--;)t.buffered.start(n)<=r&&t.buffered.end(n)>=r&&(e=t.buffered.end(n)-r);return e}i.apply(this,arguments);var l,u=this;u.player.get("player:usePluginBuffering")&&(l=new o(e,t));var c,d=null,f=null,p=null,h=0,g=!1,m=!1,v=!1,y=.6,_=!1,E=!1,b=null,T=null,w=null;this.dispose=function(){S(!1),d=null,f=null,p=null,_=!1,E=!1,u.player=null,u.namespase=null,u.config=null,l&&l.dispose()},this.load=function(e,t,n){var i;try{i=u.player.config.device.browser.name.toLowerCase()}catch(a){}if(c="safari"===i,n){if(!u.checkOptions(n))return}else n={};return R(5),_=!0,e=r(e),t&&(t.src=r(t.src)),f=t||null,d=e||null,f||d?(p||A(),S(!0),p.autoplay=!0,p.src=d&&""!=d?d:t.src,u.get("muted")?p.volume=0:(p.volume=u.get("volume")/100,0==p.volume&&u.set("muted",!0)),void("startSeconds"in n?(h=n.startSeconds,delete n.startSeconds):h=0)):void u.emit("mediaError",{message:"Src not found"})},this.play=function(){p.src&&p.play()},this.pause=function(){p&&!m&&(m=!0,p.pause())},this.stop=function(){p&&(p.src="",1==u.player.config.singleVideoInstance?p.style.display="none":u.container.removeChild(p)),this.dispose()},this.togglePlayPause=function(){p&&(1==u.get("state")?this.pause():this.play())},this.seekTo=function(e){p&&e&&(R(5),p.currentTime=Math.min(Math.max(0,e),Math.min(u.get("duration")-10,e)))},this.setVolume=function(e){e>100?e=100:e<0&&(e=0),p&&(p.volume=e/100),0==e?u.set("muted",!0):u.get("muted")&&(y=e/100,u.unMute()),u.set("volume",e)},this.mute=function(){u.get("muted")||(y=p.volume,u.set("muted",!0),u.set("volume",0),p.volume=0)},this.unMute=function(){u.get("muted")&&(p.volume=y||.6,u.set("muted",!1),u.set("volume",parseInt(100*y)))},this.setQuality=function(e){_=!0,this.emit("qualityNeedChange",e)},this.setAudiotrack=function(e){_=!0,this.emit("audioTackNeedChange",e)},this.getPlayableElement=function(){return p};var A=function(){1==u.player.config.singleVideoInstance&&(p=u.player.get(u.namespace+"video")),p||(p=document.createElement("video"),u.container.appendChild(p)),window.safariVideo=p,p.className=u.namespace+"video",p.style.width="100%",p.style.height="100%",p.style.display="initial",l&&l.setVideo(p)},R=function(e){u.set("state",e),u.emit("stateChange",e)},S=function(e){e?(p&&(p.addEventListener("loadstart",O,!1),p.addEventListener("canplay",L,!1),p.addEventListener("pause",C,!1),p.addEventListener("playing",D,!1),p.addEventListener("seeked",P,!1),p.addEventListener("seeking",I,!1),p.addEventListener("volumechange",N,!1),p.addEventListener("durationchange",M,!1),p.addEventListener("ended",F,!1),p.addEventListener("error",k,!1),p.addEventListener("waiting",n)),u.player&&u.player.on&&u.player.on("player:timeUpdate",x)):(p&&(p.removeEventListener("loadstart",O,!1),p.removeEventListener("canplaythrough",L,!1),p.removeEventListener("pause",C,!1),p.removeEventListener("playing",D,!1),p.removeEventListener("seeked",P,!1),p.removeEventListener("seeking",I,!1),p.removeEventListener("volumechange",N,!1),p.removeEventListener("durationchange",M,!1),p.removeEventListener("ended",F,!1),p.removeEventListener("error",k,!1),p.removeEventListener("waiting",n)),u.player&&u.player.off&&u.player.off("player:timeUpdate",x))},k=function(){u.emit("mediaError",{"this":this}),R(5);var e,t,n;e=a.errorTypes.NETWORK_ERROR,t=a.errorCodes[e].MEDIA_FILE_LOADING_ERROR,n=a.errorMessages[t]+d,new a(u.player,e,t,n,(!0))},O=function(){R(3)},L=function(){b&&(clearTimeout(b),b=null),g||u.emit("mediaCanPlay"),E&&(E=!1,u.emit("buffering",{isBuffering:!1,timestamp:(new Date).getTime(),isSeeking:p.seeking})),h>0&&(u.seekTo(h),p&&Math.abs(p.currentTime-h)<10&&(h=0),h>p.duration&&0!==p.duration&&(h=0))},C=function(){m&&R(2)},D=function(){if(_){_=!1;var e=p.textTracks;if(e&&e.length>0)for(var t=0,n=e.length;t<n;++t)"subtitles"===e[t].kind&&(e[t].mode="disabled")}if(!g){var r=!0,i=u.player.get("vendorOptions");if(i&&void 0!==i.autoplay&&null!==i.autoplay&&(r=i.autoplay),r===!1)return R(2),p.pause(),m=!0,void(g=!0)}var a=u.player.get("vendor:dismissSeekToLiveAfterPause");if(m&&a!==!0){var o=u.player.get("videoInfo"),s=u.player.utils.getExtension(p.src);o&&("live"===o.contentType||"tv_linear"===o.contentType)&&"m3u8"===s&&c&&(p.src=p.src)}g=!0,m=!1,R(1)},P=function(){u.emit("mediaSeekEnd"),c&&(b&&clearTimeout(b),T&&clearTimeout(T),m||(b=setTimeout(function(){p.play(),L(),D(),b=null},500),w=p.currentTime,T=setTimeout(function(){Math.abs(w-p.currentTime)<1&&(p.currentTime=w+1),T=null},3e3)))},I=function(){u.emit("mediaSeekStart"),R(4)},N=function(){u.set("volume",100*p.volume)},M=function(){u.set("duration",p.duration)},x=function(){var e=u.get("position"),t=u.get("duration");p.currentTime!=e&&u.set("position",p.currentTime),t>0&&t-e<1&&!v&&(v=!0,u.emit("mediaBeforeComplete"));for(var n=0;n<p.buffered.length;n++)if(p.buffered.start(n)<=e&&p.buffered.end(n)>e){u.set("loadedFraction",p.buffered.end(n)/t);break}p.duration>0&&p.currentTime>0&&Math.abs(p.duration-p.currentTime)<=.001&&F()},F=function(){R(0),S(!1),g=!1};u.log("MggpVendorHtml5:Created!")}var i=e("mggp-player").Vendor,a=e("mggp-player").AddonError,o=e("mggp-plugin-buffering");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.mimeTypes=["mp4","webm","m3u8"],r.priority=0,r.canPlay=function(e,t){var n=!1;if(t.hasOwnProperty("m3u8NativSupported")&&1==t.m3u8NativSupported)n=!0;else if("m3u8"==e&&("MediaSource"in window||"WebKitMediaSource"in window))if(t.drm)n=!1;else{var r=window.MediaSource||window.WebKitMediaSource;r&&(n=r.isTypeSupported("application/x-mpegurl"))}return"m3u8"!=e&&(n=!0),n},t.exports=r},{"mggp-player":21,"mggp-plugin-buffering":25}],54:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){r(this,e),this._vendor=t,this._started=!1,this._playing=!1,this._adDisplayContainer=null,this._adLoader=null,this._adRequest=null,this._url=null,this._adManagerLoadedListener=this._onAdManagerLoaded.bind(this),this._adErrorListener=this._onAdError.bind(this),this._adEventListener=this._onAdEvent.bind(this)}return i(e,[{key:"dispose",value:function(){this._vendor=null,this._started=!1,this._playing=!1,this._adDisplayContainer=null,this._adLoader=null,this._adRequest=null,this._url=null,this._adManager&&(this._adManager.destroy(),this._adManager=null)}},{key:"setVastDocument",value:function(e){this._vastDocument=e}},{key:"load",value:function(e){this._url=e,this._adDisplayContainer=new google.ima.AdDisplayContainer(this._vendor._iframeContainer),this._adDisplayContainer.initialize(),this._adLoader=new google.ima.AdsLoader(this._adDisplayContainer),this._adLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._adManagerLoadedListener,!1),this._adLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._adErrorListener,!1),this._adRequest=new google.ima.AdsRequest,this._adRequest.adTagUrl=this._url;window.getComputedStyle(this._vendor.container);this._adRequest.linearAdSlotWidth=690,this._adRequest.linearAdSlotHeight=390,this._adRequest.nonLinearAdSlotWidth=690,this._adRequest.nonLinearAdSlotHeight=390,this._adLoader.requestAds(this._adRequest)}},{key:"start",value:function(){!this._started&&this._adManager&&(this._adManager.start(),this._started=!0)}},{key:"stop",value:function(){this._adManager&&this._adManager.getRemainingTime()>0&&(this._adManager.stop(),this._started=!1)}},{key:"pause",value:function(){this._playing&&this._adManager&&(this._adManager.pause(),this._playing=!1,this._vendor._setState(2))}},{key:"resume",value:function(){!this._playing&&this._adManager&&(this._adManager.resume(),this._playing=!0)}},{key:"_onAdManagerLoaded",value:function(e){var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.useStyledNonLinearAds=!0,this._adManager=e.getAdsManager({currentTime:1},t),this._adManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._adErrorListener),this._adManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this._onContentPauseRequested.bind(this)),this._adManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this._onContentResumeRequested.bind(this)),this._adManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.LOADED,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.IMPRESSION,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.STARTED,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.CLICK,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.FIRST_QUARTILE,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.MIDPOINT,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.THIRD_QUARTILE,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.RESUMED,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.USER_CLOSE,this._adEventListener),this._adManager.addEventListener(google.ima.AdEvent.Type.DURATION_CHANGE,this._adEventListener);try{var n=690,r=390,i=document.getElementById("playerContainer");i&&(n=i.offsetWidth,r=i.offsetHeight),this._adManager.init(n,r,google.ima.ViewMode.NORMAL)}catch(a){this._vendor.stop()}}},{key:"_onAdError",value:function(e){console.log("IMADisplayingElement error: "+e.getError().toString()),this._adManager&&this._adManager.destroy(),this._vendor.emit("mediaError")}},{key:"_onAdEvent",value:function(e){var t=e.getAd();switch(e.type){case google.ima.AdEvent.Type.LOADED:this._vendor.emit("imaIsLinear",t.isLinear()),this._vendor.emit("vendorCreate"),this._vendor.emit("mediaCanPlay"),this._vendor.emit("loadedFraction",1);break;case google.ima.AdEvent.Type.STARTED:this._vendor.player.off("globalUpdate",this._globalUpdateListener),this._playing=!0,this._vendor._setState(1);break;case google.ima.AdEvent.Type.COMPLETE:this._trackEvent("complete");break;case google.ima.AdEvent.Type.IMPRESSION:break;case google.ima.AdEvent.Type.FIRST_QUARTILE:this._trackEvent("firstQuartile");break;case google.ima.AdEvent.Type.MIDPOINT:this._trackEvent("midpoint");break;case google.ima.AdEvent.Type.THIRD_QUARTILE:this._trackEvent("thirdQuartile");break;case google.ima.AdEvent.Type.CLICK:this._vendor.player.emit("ad:skin:clickOnBg");break;case google.ima.AdEvent.Type.DURATION_CHANGE:this._vendor.updateDuration(this._adManager.getDuration());break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:case google.ima.AdEvent.Type.USER_CLOSE:this._vendor._setState(0)}}},{key:"_trackEvent",value:function(e){this._vastDocument&&"function"==typeof this._vastDocument[e]&&this._vastDocument[e]()}},{key:"_onContentResumeRequested",value:function(e){}},{key:"_onContentPauseRequested",value:function(e){}},{key:"volume",set:function(e){this._adManager&&this._adManager.setVolume(e)},get:function(){return this._adManager?this._adManager.getVolume():0}},{key:"playing",get:function(){return this._playing}}]),e}();n["default"]=a,t.exports=n["default"]},{}],55:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=a,n=o,r=!0,s=u=void 0}},l=e("mggp-player"),u=e("./IMAWrapper"),c=r(u),d=function(e){function t(e,n){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n),this.IMA_SDK_URL="//imasdk.googleapis.com/js/sdkloader/ima3.js",this._autoPlay=!0,this._iframeContainer=null,this._volumeBeforeMute=-1,this._wrapper=new c["default"](this),this._duration=-1,this._currentTime=0,this._startTime=0,this._scriptListener=this._onScriptEvent.bind(this),this._thisListener=this._onCreate.bind(this),this._globalUpdate=this._onGlobalUpdate.bind(this)}return a(t,e),o(t,[{key:"dispose",value:function(){this._scriptElement&&this._scriptElement.parentNode&&this._scriptElement.parentNode.removeChild(this._scriptElement),this._iframeContainer&&this._iframeContainer.parentNode&&this._iframeContainer.parentNode.removeChild(this._iframeContainer),this.player&&(this.player.off(this.namespace+"vendorCreate",this._thisListener),this.player.off("player:timeUpdate",this._globalUpdate)),this._wrapper.dispose(),this._scriptLoaded=!1,this._volumeBeforeMute=-1,this._loadCalled=!1,this._src=null,this._iframeContainer=null,this._scriptElement=null,this._playing=!1,this._beforeCompleteFired=!1,this.player=null,this.namespase=null,this.config=null,this.emit("vendorDestroy")}},{key:"load",value:function(e,t,n){this.checkOptions(n),this._src=e,this._options=n,this._wrapper.setVastDocument(n.vastDocument),window.google&&window.google.ima?this._load():(this._scriptElement=document.createElement("script"),this._scriptElement.type="text/javascript",this._scriptElement.addEventListener("load",this._scriptListener),this._scriptElement.addEventListener("error",this._scriptListener),document.head.appendChild(this._scriptElement),this._scriptElement.src=this.IMA_SDK_URL)}},{key:"play",value:function(){this._duration!==-1&&(this._startTime=(new Date).getTime()/1e3,this.player.on("player:timeUpdate",this._globalUpdate)),this._wrapper._started?this._wrapper.resume():this._wrapper.start(),this._setState(1)}},{key:"stop",value:function(){this._wrapper.stop(),this._setState(0),this.dispose()}},{key:"pause",value:function(){this._setState(2),this._wrapper.pause()}},{key:"togglePlayPause",value:function(){this._wrapper.playing?this._wrapper.pause():this._wrapper.resume()}},{key:"seekTo",value:function(){}},{key:"setVolume",value:function(e){e>100?e=100:e<0&&(e=0),this._wrapper.volume=e/100,this.set("volume",e)}},{key:"mute",value:function(){this._volumeBeforeMute=this._wrapper.volume,this._wrapper.volume=0,this.set("muted",!0)}},{key:"unMute",value:function(){this._wrapper.volume=this._volumeBeforeMute!=-1?this._volumeBeforeMute:.6,this._volumeBeforeMute=-1,this.set("muted",!1)}},{key:"_load",value:function(){this._options&&(this.checkOptions(this._options),"duration"in this._options&&(this._duration=this._options.duration)),this._setState(5),this.player&&this.player.on(this.namespace+"vendorCreate",this._thisListener),this._createDomElements(),this._wrapper.load(this._src)}},{key:"_onScriptEvent",value:function(e){switch(this._scriptElement&&(this._scriptElement.removeEventListener("load",this._scriptListener),this._scriptElement.removeEventListener("error",this._scriptListener)),e.type){case"load":this._load();break;case"error":this.emit("error"),this.dispose()}}},{key:"_onCreate",value:function(e){this._autoPlay&&this.play()}},{key:"_onGlobalUpdate",value:function(e){this._wrapper.playing&&(this._currentTime=(new Date).getTime()/1e3-this._startTime,this._currentTime>=this._duration&&this._setState(0))}},{key:"_setState",value:function(e){e=parseInt(e),this.set("state",e),this.emit("stateChange",e)}},{key:"_createDomElements",value:function(){this._iframeContainer=document.createElement("div"),this._iframeContainer.id="imaContainer",this.container.appendChild(this._iframeContainer)}},{key:"_updateDuration",value:function(e){this._duration=e}},{key:"autoPlay",get:function(){return this._autoPlay},set:function(e){this._autoPlay=Boolean(e)}}],[{key:"canPlay",value:function(e){return e===t.mimeTypes[0]}}]),t}(l.Vendor);n["default"]=d,d.priority=0,d.mimeTypes=["ima"],t.exports=n["default"]},{"./IMAWrapper":54,"mggp-player":21}],56:[function(e,t,n){t.exports=e("./MggpVendorIMA.js")},{"./MggpVendorIMA.js":55}],57:[function(e,t,n){"use strict";function r(e,t){i.apply(this,arguments);var n=this,r=null,o=null,s=0,l=null,u=!1,c=-1,d=0,f=!1,p=!0,h=!1;this.emit("vendorCreate"),this.player.utils.log("MggpVendorImg created"),this.dispose=function(){v(!1);var e=l?l.parentNode:null;e&&e.removeChild(l),r=null,o=null,s=0,l=null,u=!1,h=!1,c=-1,d=0,f=!1,p=!0,n.namespase=null,n.config=null,n.emit("vendorDestroy"),n.player.utils.log("MggpVendorImg.dispose")},this.load=function(e,t,i){s=0,u=!1,h=!1,c=-1,d=0,p=!0,f=!1,i&&(o=i,n.checkOptions(i),i.duration&&(d=i.duration,n.set("duration",d)),"autoplay"in i&&i.autoplay===!1&&(p=!1)),e&&(r=e),g(-1),m(),g(3),l.src=r},this.play=function(){!u&&h&&(c=(new Date).getTime()/1e3,u=!0,g(1))},this.pause=function(){u&&(u=!1,g(2))},this.stop=function(){n.dispose()},this.togglePlayPause=function(){u?n.pause():n.play()},this.seekTo=function(e){n.emit("mediaSeekStart"),e>d?e=d:e<0&&(e=0),s=e,n.emit("mediaSeekEnd")},this.setVolume=function(e){n.set("volume",e)},this.mute=function(){n.set("muted",!0)},this.unMute=function(){n.set("muted",!1)},this.getPlayableElement=function(){return l};var g=function(e){n.set("state",e),n.emit("stateChange",e)},m=function(){l||(l=document.createElement("img"),l.className=n.namespace+"img vendor",o.width&&(l.style.width=n.options.width),o.height&&(l.style.height=n.options.height),l.style.visibility="hidden",l.style.width="initial",l.style.height="100%",l.style.display="block",l.style.margin="auto",n.container.appendChild(l),v(!0))},v=function(e){e?(n.player.on("player:timeUpdate",y),l&&(l.addEventListener("error",_,!1),l.addEventListener("load",_,!1))):(n.player.off("player:timeUpdate",y),l&&(l.removeEventListener("error",_,!1),l.removeEventListener("load",_,!1)))},y=function(e){if(u){var t=(new Date).getTime()/1e3;s+=t-c,c=t,n.set("position",s),d-s<1&&!f&&(f=!0,n.emit("mediaBeforeComplete")),s>=d&&(s=d,g(0),v(!1))}},_=function(e){switch(e.type){case"error":if(n.emit("mediaError"),g(5),a){var t,r,i;t=a.errorTypes.NETWORK_ERROR,r=a.errorCodes[t].MEDIA_FILE_LOADING_ERROR;var o=l?l.src:"";i=a.errorMessages[r]+" "+o,new a(n.player,t,r,i,(!0))}break;case"load":h=!0,l.style.visibility="visible",n.emit("mediaCanPlay"),n.emit("loadedFraction",1),p?n.play():g(5)}}}var i=e("mggp-player").Vendor,a=e("mggp-player").AddonError;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.mimeTypes=["gif","jpeg","png","jpg"],r.priority=0,r.canPlay=function(e){return r.mimeTypes.indexOf(e)!=-1},t.exports=r},{"mggp-player":21}],58:[function(e,t,n){"use strict";function r(e,t){function n(e){"load"==e.type?h&&o(h):"error"==e.type&&p.emit("error")}function r(){var e=document.createElement("div");e.id="swfVendorContainer"+T,e.style.width="100%",e.style.height="100%",p.container.appendChild(e)}function o(e){r();var t="position:absolute;display:block;left:",n={},i={};i.quality="high",i.bgcolor="0",i.AllowScriptAccess="always",i.allowfullscreen="true",i.wmode="transparent",i.salign="tl";var o={};o.id="swfVendor"+T,o.name="swfVendor"+T;var u=document.getElementById("swfVendorContainer"+T);if(u)g=setTimeout(s,1e4),window.swfobject.embedSWF(e,u,"100%","100%","10.3.0",null,n,i,o,l),window.swfobject.createCSS("#vendor",t);else{p.emit("error");var c,d,f;c=a.errorTypes.INTERNAL_ERROR,d=a.errorCodes[c].CANNOT_INJECT_PLAYABLE_ELEMENT,f="Cannot find container for swf injecting",new a(p.player,c,d,f,(!0))}}function s(){g=null,p.emit("error");var e,t,n;e=a.errorTypes.NETWORK_ERROR,t=a.errorCodes[e].MEDIA_FILE_LOADING_ERROR,n=a.errorMessages[t]+" Timeout 10 seconds",new a(p.player,e,t,n,(!0))}function l(e){if(e.success)g&&clearTimeout(g),p.player.on("player:timeUpdate",c),u(5),_&&p.play();else{p.emit("error");var t,n,r;t=a.errorTypes.INTERNAL_ERROR,n=a.errorCodes[t].CANNOT_INJECT_PLAYABLE_ELEMENT,r="Cannot inject swf into the DOM. URL: "+h,new a(p.player,t,n,r,(!0))}}function u(e){p.set("state",e),p.emit("stateChange",e)}function c(){if(!b){var e=(new Date).getTime()/1e3;v+=e-E,E=e,p.set("position",v),v>=m&&(b=!0,u(0))}}i.apply(this,arguments);var d,f=window.location.protocol+"//s5.vcdn.biz/static/39253671/swfobject23.js",p=this,h=null,g=null,m=0,v=0,y=null,_=!0,E=null,b=!0,T=Math.round(1e3*Math.random());this.dispose=function(){p.player.off("player:timeUpdate",c),p.player=null,p.namespase=null,p.config=null,g&&clearTimeout(g);var e=document.getElementById("swfVendor"+T);e&&e.parentNode&&e.parentNode.removeChild(e)},this.load=function(e,t,n){if(n){if(!p.checkOptions(n))return;if(p.container){var r=document.getElementById("swfVendorContainer"+T)||document.getElementById("swfVendor"+T);r&&r.parentNode!=this.container&&this.container.appendChild(r)}n.vastDocument&&n.vastDocument.vastData&&(y=n.vastDocument.vastData,y.mediaFile&&y.mediaFile.length>0&&(m=y.mediaFile[0].duration||10,p.set("duration",m))),n.autoplay&&(_=n.autoplay)}else p.emit("error");e&&(h=e,u(3),window.swfobject&&"function"==typeof window.swfobject.embedSWF&&o(h))},this.play=function(){E=(new Date).getTime()/1e3,b=!1,u(1)},this.pause=function(){b=!0,u(2)},this.stop=function(){p.pause(),p.dispose()},this.togglePlayPause=function(){},this.seekTo=function(e){},this.setVolume=function(e){},this.mute=function(){},this.unMute=function(){},this.getPlayableElement=function(){},window.swfobject||(d=document.createElement("script"),d.addEventListener("load",n),d.addEventListener("error",n),document.head.appendChild(d),d.src=f)}var i=e("mggp-player").Vendor,a=e("mggp-player").AddonError;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.priority=0,r.mimeTypes=["swf"],r.canPlay=function(e){return r.mimeTypes.indexOf(e)!=-1},t.exports=r},{"mggp-player":21}],59:[function(e,t,n){function r(e,t){function n(e){l.set("state",e),l.emit("stateChange",e)}function r(e){switch(e.name){case o.WRAPPER_SCRIPT_LOADING_ERROR:case o.WRAPPER_VPAID_LOADING_ERROR:case o.WRAPPER_DOM_ERROR:l.emit("error");break;case o.WRAPPER_READY:l.emit("vendorCreate"),d&&l.play();break;case o.WRAPPER_VPAID_LOADED:break;case o.WRAPPER_VPAID_STARTED:l.player.emit("hideSkins"),n(1);break;case o.WRAPPER_VPAID_ENDED:n(0);break;case o.WRAPPER_VPAID_ERROR:l.emit("error");break;case o.WRAPPER_VPAID_CURRENT_TIME:l.player.set("position",e.data)}}function n(e){e=parseInt(e),l.set("state",e),l.emit("stateChange",e)}s.apply(this,arguments),i.initialize(this.player);var l=this,u=null,c=null,d=!0,f=.6,p=[o.WRAPPER_READY,o.WRAPPER_SCRIPT_LOADING_ERROR,o.WRAPPER_VPAID_ENDED,o.WRAPPER_VPAID_ERROR,o.WRAPPER_VPAID_LOADED,o.WRAPPER_VPAID_LOADING_ERROR,o.WRAPPER_DOM_ERROR,o.WRAPPER_VPAID_STARTED,o.WRAPPER_VPAID_CURRENT_TIME];i.on(p,r),this.dispose=function(){u&&u.dispose(),l.player.emit("showSkins"),i.off(p,r),l.emit("vendorDestroy")},this.load=function(e,t,n){var r;c=n,n&&(l.checkOptions(n),r=n.vastDocument,d=!("autoplay"in n)||n.autoplay);var i={};l.player.config?(i.advertisement_additional_part=l.player.config.i18n("advertisement_additional_part")||"Ролик %num% из %total%",i.advertisement_title=l.player.config.i18n("advertisement_title")||"Благодаря рекламе это видео для Вас бесплатно",i.skip_ads=l.player.config.i18n("skip_ads")||"Пропустить рекламу",i.through=l.player.config.i18n("through")||"через",i.second=l.player.config.i18n("second")||"сек",i.go_to_the_advertiser_website=l.player.config.i18n("go_to_the_advertiser_website")||"Перейти на сайт рекламодателя"):(i.advertisement_additional_part="Ролик %num% из %total%",i.advertisement_title="Благодаря рекламе это видео для Вас бесплатно",i.skip_ads="Пропустить рекламу",i.through="через",i.second="сек",i.go_to_the_advertiser_website="Перейти на сайт рекламодателя"),i.advertisement_additional_part=i.advertisement_additional_part.replace("%num%","_num_").replace("%total%","_total_"),l.container&&l.container.parentNode&&l.container.parentNode.classList.contains("mggskin-hidden")&&l.container.parentNode.classList.remove("mggskin-hidden"),u=new a(e,l.container,r,i,l.player),u.checkSwfObject()},this.play=function(){u.play()},this.pause=function(){u.pause()},this.stop=function(){u.stop(),l.dispose()},this.togglePlayPause=function(){u.playing?u.pause():u.play()},this.seekTo=function(){},this.setVolume=function(e){e>100?e=100:e<0&&(e=0),l.set("volume",e),e/=100,e>0?l.get("muted")&&l.set("muted",!1):l.set("muted",!0),u.setVolume(e)},this.mute=function(){f=l.get("volume")/100,u.setVolume(0),l.set("muted",!0),l.set("volume",0)},this.unMute=function(){f=f||.6,u.setVolume(f),l.set("volume",100*f),l.set("muted",!1)}}function i(){}function a(e,t,n,r,a){function s(e){switch(e.type){case"load":i.emit(o.WRAPPER_READY);break;case"error":i.emit(o.WRAPPER_SCRIPT_LOADING_ERROR)}}function u(){i.emit(o.WRAPPER_VPAID_LOADING_ERROR)}function c(){A&&(clearTimeout(A),A=null),w=document.getElementById("vpaid"),i.emit(o.WRAPPER_VPAID_LOADED);var e=(w.callVPAIDFunc("handshakeVersion","2.0"),window.getComputedStyle(w));_&&E&&w.setMembersCount(_,E),w.callVPAIDFunc("initAd",parseInt(e.width),parseInt(e.height),"normal",500,"","")}function d(e){switch(e){case l.AdLoaded:var t=a.get("muted")?0:a.get("volume")/100;(t||0===t)&&y.setVolume(t),w.callVPAIDFunc("startAd");break;case l.AdStarted:R=!0,k=w.callVPAIDFunc("adDuration"),(!k||k>0)&&(k=w.callVPAIDFunc("adRemainingTime")),n.creativeView(),i.emit(o.WRAPPER_VPAID_STARTED);break;case l.AdStopped:n.stop(),i.emit(o.WRAPPER_VPAID_ENDED);break;case l.AdSkipped:n.skip(),i.emit(o.WRAPPER_VPAID_ENDED);break;case l.AdLinearChange:break;case l.AdSizeChange:break;case l.AdExpandedChange:w.callVPAIDFunc("adExpanded")?n.expand():n.collapse();break;case l.AdSkippableStateChange:break;case l.AdRemainingTimeChange:O=k-w.callVPAIDFunc("adRemainingTime"),i.emit(o.WRAPPER_VPAID_CURRENT_TIME,O);break;case l.AdDurationChange:k=w.callVPAIDFunc("adDuration");break;case l.AdVolumeChange:a.set("volume",100*y.getVolume());break;case l.AdImpression:n.impression();break;case l.AdVideoStart:n.start();break;case l.AdVideoFirstQuartile:n.firstQuartile();break;case l.AdVideoMidpoint:n.midpoint();break;case l.AdVideoThirdQuartile:n.thirdQuartile();break;case l.AdVideoComplete:n.complete();break;case l.AdClickThru:n.click();break;case l.AdInteraction:break;case l.AdUserAcceptInvitation:n.acceptInvitation();break;case l.AdUserMinimize:break;case l.AdUserClose:n.close(),i.emit(o.WRAPPER_VPAID_ENDED);break;case l.AdPaused:R=!1,n.pause();break;case l.AdPlaying:R=!0,n.resume();break;case l.AdLog:break;case l.AdError:i.emit(o.WRAPPER_VPAID_ERROR)}}function f(e){var n="";try{n=JSON.stringify(r)}catch(a){}var s={url:encodeURIComponent(e),localization:n},l=window.getComputedStyle(t),c="position:absolute;display:block;left:",d={};d.quality="high",d.bgcolor="0",d.allowscriptaccess="always",d.allowfullscreen="true",d.wmode="opaque",d.salign="tl";var f={};f.id="vpaid",f.name="vpaid";var p=document.getElementById("vpaidContainer");p?(window.swfobject.embedSWF(v,p,parseInt(l.width),parseInt(l.height),"10.0.0",null,s,d,f,h),window.swfobject.createCSS("#vpaid",c),A=setTimeout(u,1e4)):i.emit(o.WRAPPER_DOM_ERROR)}function p(e){e.data&&e.data.number&&e.data.count&&(_=e.data.number,E=e.data.count,w&&w.setMembersCount(_,E))}function h(e){console.log()}var g=window.location.protocol,m=g+"//s5.vcdn.biz/static/39253671/swfobject23.js",v=g+"//s8.vcdn.biz/static/40117331/VPAIDProvider.swf",y=this,_=0,E=0;window.vpaidProviderLoadedCallback=c,window.vpaidEventListener=d,i.on("ad:external:mediaBeginsLoading",p);var b=null,T=document.createElement("div");T.id="vpaidContainer",T.style.position="absolute",T.style.width="100%",T.style.height="100%",t.appendChild(T);var w=null,A=null,R=!1,S=null,k=0,O=0;this.checkSwfObject=function(){window.swfobject?i.emit(o.WRAPPER_READY):(b=document.createElement("script"),b.addEventListener("load",s),b.addEventListener("error",s),document.head.appendChild(b),b.src=m)},this.dispose=function(){window.swfobject.removeSWF("vpaid"),b&&b.parentNode&&b.parentNode.removeChild(b),T&&T.parentNode&&T.parentNode.removeChild(T),delete window.vpaidProviderLoadedCallback,delete window.vpaidEventListener,i.off("ad:external:mediaBeginsLoading",p),R=!1,k=0,O=0},this.play=function(){w?w&&w.callVPAIDFunc("resumeAd"):f(e)},this.pause=function(){w&&w.callVPAIDFunc("pauseAd")},this.stop=function(){w&&w.callVPAIDFunc("stopAd")},this.getVolume=function(){if(w)return w.callVPAIDFunc("adVolume")},this.setVolume=function(e){w&&w.callVPAIDFunc("adVolume",e)},this.setMuted=function(e){e?(S=y.getVolume(),y.setVolume(0)):(y.setVolume(S),S=null)},this.getMuted=function(){return null!==S},this.getPlaying=function(){return R}}var o={WRAPPER_READY:"vpaid:internal:wrapperReady",WRAPPER_SCRIPT_LOADING_ERROR:"vpaid:internal:scriptLoadingError",WRAPPER_DOM_ERROR:"vpaid:internal:domError",WRAPPER_VPAID_LOADING_ERROR:"vpaid:internal:vpaidLoadingError",WRAPPER_VPAID_LOADED:"vpaid:internal:vpaidLoaded",WRAPPER_VPAID_ERROR:"vpaid:intenal:vpaidError",WRAPPER_VPAID_ENDED:"vpaid:internal:vpaidEnded",WRAPPER_VPAID_STARTED:"vpaid:internal:vpaidStarted",WRAPPER_VPAID_CURRENT_TIME:"vpiad:internal:vpaidCurrentTime"},s=e("mggp-player").Vendor;r.prototype=Object.create(s.prototype),r.priority=0,r.mimeTypes=["vpaid","swf"],r.prototype.constructor=r,r.canPlay=function(e){return r.mimeTypes.indexOf(e)!=-1},t.exports=r,i.initialize=function(e){e&&(i._observer=e,i._initialized=!0)},i.emit=function(e,t){i._initialized&&i._observer.emit(e,t)},i.on=function(e,t){i._initialized&&(Array.isArray(e)?i._onEventsFromArray(e,t):i._observer.on(e,t))},i.off=function(e,t){i._initialized&&(Array.isArray(e)?i._offEventsFromArray(e,t):i._observer.off(e,t))},i._onEventsFromArray=function(e,t){for(var n=0,r=e.length;n<r;++n)i.on(e[n],t)},i._offEventsFromArray=function(e,t){for(var n=0,r=e.length;n<r;++n)i.off(e[n],t)},i._initialized=!1,i._observer=null;var l={AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdLinearChange:"AdLinearChange",AdSizeChange:"AdSizeChange",AdExpandedChange:"AdExpandedChange",AdSkippableStateChange:"AdSkippableStateChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdDurationChange:"AdDurationChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError"}},{"mggp-player":21}],60:[function(e,t,n){function r(e,t){i.apply(this,arguments),this._src=null,
this._iframe=null,this._video=null,this._vpaidCreative=null,this._wrapper=null,this._adParameters="{}",this._vastDocument=null,this._paused=!1,this._started=!1,this._stopped=!1,this._volumeBeforeMute=.6,this._lastVolume=this._volumeBeforeMute,this.emit("vendorCreate")}var i=e("mggp-player").Vendor;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.dispose=function(){!this._stopped&&this._wrapper&&this.stop(),this._iframe&&this._iframe.parentNode&&this._iframe.parentNode.removeChild(this._iframe),this._video&&this._video.parentNode&&this._video.parentNode.removeChild(this._video),this.emit("vendorDestroy")},r.prototype.load=function(e,t,n){this._setState(-1),this._src=e,this.checkOptions(n),n.adParameters&&(this._adParameters=n.adParameters),n.vastDocument&&(this._vastDocument=n.vastDocument),this._createIframe()},r.prototype.play=function(){this._wrapper&&(this._paused=!1,this._started?this._wrapper.resumeAd():this._wrapper.startAd())},r.prototype.pause=function(){this._wrapper&&(this._paused=!0,this._wrapper.pauseAd())},r.prototype.stop=function(){this._wrapper&&(this._paused=!1,this._stopped=!0,this._wrapper.stopAd()),this.dispose()},r.prototype.togglePlayPause=function(){this._wrapper&&(this._paused?this._wrapper.resumeAd():this._wrapper.pauseAd(),this._paused=!this._paused)},r.prototype.setVolume=function(e){e>100?e=100:e<0&&(e=0),this._wrapper&&(this._volumeBeforeMute=e/100,e>0?this.get("muted")&&this.unMute():this.set("muted",!0),this._wrapper.setAdVolume(this._volumeBeforeMute),this.set("volume",e))},r.prototype.mute=function(){this._wrapper&&(this._wrapper.setAdVolume(0),this.set("volume",0),this.set("muted",!0))},r.prototype.unMute=function(){this._wrapper&&(this._volumeBeforeMute=this._volumeBeforeMute||.6,this._wrapper.setAdVolume(this._volumeBeforeMute),this.set("volume",100*this._volumeBeforeMute),this.set("muted",!1))},r.prototype._setState=function(e){this.set("state",e),this.emit("stateChange",e)},r.prototype._trackEvent=function(e){this._vastDocument&&"function"==typeof this._vastDocument[e]&&this._vastDocument[e]()},r.prototype._wrapperCallback=function(e,t){switch(e){case a.AdStarted:this._started=!0,this._setState(1),this._trackEvent("creativeView");break;case a.AdStopped:this._setState(0),this._trackEvent("stop");break;case a.AdSkipped:this._setState(0),this._trackEvent("skip");break;case a.AdLoaded:this._wrapper&&(this.setVolume(this.player.get("volume")),this._wrapper.startAd());break;case a.AdLinearChange:break;case a.AdSizeChange:break;case a.AdExpandedChange:break;case a.AdSkippableStateChange:break;case a.AdDurationChange:this.set("duration",t);break;case a.AdRemainingTimeChange:var n=this.get("duration");n||(n=t,this.set("duration",t)),this.set("position",n-t);break;case a.AdVolumeChange:var r=this._wrapper.getAdVolume();0==r&&this._lastVolume>0?this._trackEvent("mute"):r>0&&0==this._lastVolume&&this._trackEvent("unmute"),this._lastVolume=r,this.set("volume",r),this.set("muted",0==r);break;case a.AdImpression:this._trackEvent("impression");break;case a.AdClickThru:this._trackEvent("click");var i;if(t.playerHandles&&(i=t.url),i){var o=window.open(i,"_blank");o.focus()}this._wrapper.pauseAd(),this.player.emit("ad:skin:clickOnBg");break;case a.AdInteraction:break;case a.AdVideoStart:this._trackEvent("start");break;case a.AdVideoFirstQuartile:this._trackEvent("firstQuartile");break;case a.AdVideoMidpoint:this._trackEvent("midpoint");break;case a.AdVideoThirdQuartile:this._trackEvent("thirdQuartile");break;case a.AdVideoComplete:this._trackEvent("complete");break;case a.AdUserAcceptInvitation:this._trackEvent("acceptInvitation");break;case a.AdUserMinimize:this._trackEvent("collapse");break;case a.AdUserClose:this._setState(0),this._trackEvent("close");break;case a.AdPaused:this._setState(2),this._trackEvent("pause");break;case a.AdPlaying:this._setState(1),this._trackEvent("resume");break;case a.AdError:this._setState(0),self.emit("mediaError");break;case a.AdLog:break;case a.ERROR:this.dispose();break;case a.REMOVE_CREATIVE_AND_STAY_ON_PAUSE:this._stopped=!0,this.dispose()}},r.prototype._createIframe=function(){function e(r){var a=t();if(r.origin==a&&r.data){var o=JSON.parse(r.data);o&&o.iframeID==i._iframe.id&&(window.removeEventListener("message",e),n())}}function t(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function n(){var e=i._iframe.contentWindow.getVPAIDAd;e&&"function"==typeof e&&(i._vpaidCreative=e());var t,n;i.player.config&&i.player.config.container?(t=i.player.config.container.offsetWidth,n=i.player.config.container.offsetHeight):(t=690,n=390);var r={mainCallback:i._wrapperCallback.bind(i),logFunction:i.log.bind(i),player:i.player};i._wrapper=new VPAIDWrapper(i._vpaidCreative,r),i._wrapper.initAd(t,n,"normal",720,{AdParameters:i._adParameters},{slot:i._iframe.contentWindow.document.body,videoSlot:i._video,videoSlotCanAutoPlay:!0})}this._video=document.createElement("video"),this._video.style.position="absolute",this._video.style.width="100%",this._video.style.height="100%",this.container.appendChild(this._video);var r='<!DOCTYPE html><html><head><script type="text/javascript" src="%vpaidScript%"></script></head><body style="margin: 0px; padding: 0px"><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "iframeID": "%iframeID%"}\', "%origin%");</script></body></html>';this._iframe=document.createElement("iframe"),this._iframe.style.border="none",this._iframe.frameborder="0",this._iframe.scrolling="no",this._iframe.style.position="absolute",this._iframe.style.overflow="hidden",this._iframe.style.width="100%",this._iframe.style.height="100%",this._iframe.style.backgroundColor="initial",this._iframe.id="mggVPAIDIframe",this.container.appendChild(this._iframe);var i=this;window.addEventListener("message",e);var a=this._iframe.contentWindow&&this._iframe.contentWindow.document,o=t(),s=r.replace("%vpaidScript%",this._src).replace("%iframeID%",this._iframe.id).replace("%origin%",o);a.write(s)},r.mimeTypes=["js"],r.priority=0,r.canPlay=function(e){return r.mimeTypes.indexOf(e)!=-1},t.exports=r;var a={AdStarted:"adStarted",AdStopped:"adStopped",AdSkipped:"adSkipped",AdLoaded:"adLoaded",AdLinearChange:"adLinearChange",AdSizeChange:"adSizeChange",AdExpandedChange:"adExpandedChange",AdSkippableStateChange:"adSkippableStateChange",AdDurationChange:"adDurationChange",AdRemainingTimeChange:"adRemainingChange",AdVolumeChange:"adVolumeChange",AdImpression:"adImpression",AdClickThru:"adClickThru",AdInteraction:"adInteraction",AdVideoStart:"adVideoStart",AdVideoFirstQuartile:"adVideoFirstQuartile",AdVideoMidpoint:"adVideoMidpoint",AdVideoThirdQuartile:"adVideoThirdQuartile",AdVideoComplete:"adVideoComplete",AdUserAcceptInvitation:"adUserAcceptInvitation",AdUserMinimize:"adUserMinimize",AdUserClose:"adUserClose",AdPaused:"adPaused",AdPlaying:"adPlaying",AdError:"adError",AdLog:"adLog",ERROR:"error",REMOVE_CREATIVE_AND_STAY_ON_PAUSE:"removeCreativeAndStayOnPause"};VPAIDWrapper=function(e,t){return this._creative=e,this._paused=!1,this._stopped=!1,this._mainCallback=t.mainCallback,this._logFunc=t.logFunction,this._player=t.player,this.checkVPAIDInterface(e)?void this.setCallbacksForCreative():void this._mainCallback(a.AdError)},VPAIDWrapper.prototype.checkVPAIDInterface=function(e){var t=!1;return e.handshakeVersion&&"function"==typeof e.handshakeVersion&&e.initAd&&"function"==typeof e.initAd&&e.startAd&&"function"==typeof e.startAd&&e.stopAd&&"function"==typeof e.stopAd&&e.skipAd&&"function"==typeof e.skipAd&&e.resizeAd&&"function"==typeof e.resizeAd&&e.pauseAd&&"function"==typeof e.pauseAd&&e.resumeAd&&"function"==typeof e.resumeAd&&e.expandAd&&"function"==typeof e.expandAd&&e.collapseAd&&"function"==typeof e.collapseAd&&e.subscribe&&"function"==typeof e.subscribe&&e.unsubscribe&&"function"==typeof e.unsubscribe&&(t=!0),t},VPAIDWrapper.prototype.setCallbacksForCreative=function(){var e={AdStarted:this.onStartAd,AdStopped:this.onStopAd,AdSkipped:this.onSkipAd,AdLoaded:this.onAdLoaded,AdLinearChange:this.onAdLinearChange,AdSizeChange:this.onAdSizeChange,AdExpandedChange:this.onAdExpandedChange,AdSkippableStateChange:this.onAdSkippableStateChange,AdDurationChange:this.onAdDurationChange,AdRemainingTimeChange:this.onAdRemainingTimeChange,AdVolumeChange:this.onAdVolumeChange,AdImpression:this.onAdImpression,AdClickThru:this.onAdClickThru,AdInteraction:this.onAdInteraction,AdVideoStart:this.onAdVideoStart,AdVideoFirstQuartile:this.onAdVideoFirstQuartile,AdVideoMidpoint:this.onAdVideoMidpoint,AdVideoThirdQuartile:this.onAdVideoThirdQuartile,AdVideoComplete:this.onAdVideoComplete,AdUserAcceptInvitation:this.onAdUserAcceptInvitation,AdUserMinimize:this.onAdUserMinimize,AdUserClose:this.onAdUserClose,AdPaused:this.onAdPaused,AdPlaying:this.onAdPlaying,AdError:this.onAdError,AdLog:this.onAdLog};for(var t in e)this._creative.subscribe(e[t],t,this)},VPAIDWrapper.prototype.initAd=function(e,t,n,r,i,a){this._creative.initAd(e,t,n,r,i,a)},VPAIDWrapper.prototype.getAdLinear=function(){return this._logFunc("getAdLinear"),this._creative.getAdLinear()},VPAIDWrapper.prototype.startAd=function(){this._logFunc("startAd"),this._creative.startAd()},VPAIDWrapper.prototype.stopAd=function(){this._creative.stopAd()},VPAIDWrapper.prototype.setAdVolume=function(e){this._creative.setAdVolume(e)},VPAIDWrapper.prototype.getAdVolume=function(){return this._creative.getAdVolume()},VPAIDWrapper.prototype.resizeAd=function(e,t,n){this._creative.resizeAd()},VPAIDWrapper.prototype.pauseAd=function(){this._creative.pauseAd()},VPAIDWrapper.prototype.resumeAd=function(){this._stopped?this._mainCallback(a.AdStopped):this._creative.resumeAd()},VPAIDWrapper.prototype.expandAd=function(){this._creative.expandAd()},VPAIDWrapper.prototype.collapseAd=function(){this._creative.collapseAd()},VPAIDWrapper.prototype.getAdRemainingTime=function(){return this._logFunc("getAdRemainingTime"),this._creative.getAdRemainingTime()},VPAIDWrapper.prototype.getAdExpanded=function(){return this._logFunc("getAdExpanded"),this._creative.getAdExpanded()},VPAIDWrapper.prototype.getAdSkippableState=function(){return this._logFunc("getAdSkippableState"),this._creative.getAdSkippableState()},VPAIDWrapper.prototype.onAdLoaded=function(){this._logFunc("ad has been loaded");var e=this._player.get("muted")?0:this._player.get("volume")/100;(e||0===e)&&this.setAdVolume(e),this._mainCallback(a.AdLoaded)},VPAIDWrapper.prototype.onStartAd=function(){this._logFunc("Ad has started"),this._mainCallback(a.AdStarted)},VPAIDWrapper.prototype.onStopAd=function(){this._paused?(this._stopped=!0,this._mainCallback(a.REMOVE_CREATIVE_AND_STAY_ON_PAUSE)):(this._logFunc("Ad has stopped"),this._mainCallback(a.AdStopped))},VPAIDWrapper.prototype.onSkipAd=function(){this._logFunc("Ad was skipped"),this._mainCallback(a.AdSkipped)},VPAIDWrapper.prototype.onAdPaused=function(){this._paused=!0,this._logFunc("onAdPaused"),this._mainCallback(a.AdPaused)},VPAIDWrapper.prototype.onAdPlaying=function(){this._paused=!1,this._logFunc("onAdPlaying"),this._mainCallback(a.AdPlaying)},VPAIDWrapper.prototype.onAdError=function(e){this._logFunc("onAdError: "+e),this._mainCallback(a.AdError)},VPAIDWrapper.prototype.onAdLog=function(e){this._logFunc("onAdLog: "+e),this._mainCallback(a.AdLog)},VPAIDWrapper.prototype.onAdUserAcceptInvitation=function(){this._logFunc("onAdUserAcceptInvitation"),this._mainCallback(a.AdUserAcceptInvitation)},VPAIDWrapper.prototype.onAdUserMinimize=function(){this._logFunc("onAdUserMinimize"),this._mainCallback(a.AdUserMinimize)},VPAIDWrapper.prototype.onAdUserClose=function(){this._logFunc("onAdUserClose"),this._mainCallback(a.AdUserClose)},VPAIDWrapper.prototype.onAdSkippableStateChange=function(){this._logFunc("Ad Skippable State Changed to: "+this._creative.getAdSkippableState()),this._mainCallback(a.AdSkippableStateChange)},VPAIDWrapper.prototype.onAdExpandedChange=function(){this._logFunc("Ad Expanded Changed to: "+this._creative.getAdExpanded()),this._mainCallback(a.AdExpandedChange)},VPAIDWrapper.prototype.onAdSizeChange=function(){this._logFunc("Ad size changed to: w="+this._creative.getAdWidth()+" h="+this._creative.getAdHeight()),this._mainCallback(a.AdSizeChange)},VPAIDWrapper.prototype.onAdDurationChange=function(){var e=this._creative.getAdDuration();this._logFunc("Ad Duration Changed to: "+e),this._mainCallback(a.AdDurationChange,e)},VPAIDWrapper.prototype.onAdRemainingTimeChange=function(){var e=this._creative.getAdRemainingTime();this._logFunc("Ad Remaining Time Changed to: "+e),this._mainCallback(a.AdRemainingTimeChange,e)},VPAIDWrapper.prototype.onAdImpression=function(){this._logFunc("Ad Impression"),this._mainCallback(a.AdImpression)},VPAIDWrapper.prototype.onAdClickThru=function(e,t,n){this._logFunc("Clickthrough portion of the ad was clicked"),this._mainCallback(a.AdClickThru,{url:e,id:t,playerHandles:n})},VPAIDWrapper.prototype.onAdInteraction=function(e){this._logFunc("A non-clickthrough event has occured"),this._mainCallback(a.AdInteraction,{id:e})},VPAIDWrapper.prototype.onAdVideoStart=function(){this._logFunc("Video 0% completed"),this._mainCallback(a.AdVideoStart)},VPAIDWrapper.prototype.onAdVideoFirstQuartile=function(){this._logFunc("Video 25% completed"),this._mainCallback(a.AdVideoFirstQuartile)},VPAIDWrapper.prototype.onAdVideoMidpoint=function(){this._logFunc("Video 50% completed"),this._mainCallback(a.AdVideoMidpoint)},VPAIDWrapper.prototype.onAdVideoThirdQuartile=function(){this._logFunc("Video 75% completed"),this._mainCallback(a.AdVideoThirdQuartile)},VPAIDWrapper.prototype.onAdVideoComplete=function(){this._logFunc("Video 100% completed"),this._mainCallback(a.AdVideoComplete)},VPAIDWrapper.prototype.onAdLinearChange=function(){this._logFunc("Ad linear has changed: "+this._creative.getAdLinear()),this._mainCallback(a.AdLinearChange)},VPAIDWrapper.prototype.onAdVolumeChange=function(){this._logFunc("Ad Volume has changed to - "+this._creative.getAdVolume()),this._player.set("volume",100*this._creative.getAdVolume()),this._mainCallback(a.AdVolumeChange)}},{"mggp-player":21}],61:[function(e,t,n){"use strict";function r(e){return decodeURIComponent(e.replace(/\+/g," "))}function i(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,i={};t=n.exec(e);i[r(t[1])]=r(t[2]));return i}function a(e,t){t=t||"";var n=[];"string"!=typeof t&&(t="?");for(var r in e)o.call(e,r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n.length?t+n.join("&"):""}var o=Object.prototype.hasOwnProperty;n.stringify=a,n.parse=i},{}],62:[function(e,t,n){"use strict";t.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},{}],63:[function(e,t,n){(function(t){!function(n){function r(e,t){if(!(this instanceof r))return new r(e,t);var i=this;a(i),i.q=i.c="",i.bufferCheckPosition=n.MAX_BUFFER_LENGTH,i.opt=t||{},i.opt.lowercase=i.opt.lowercase||i.opt.lowercasetags,i.looseCase=i.opt.lowercase?"toLowerCase":"toUpperCase",i.tags=[],i.closed=i.closedRoot=i.sawRoot=!1,i.tag=i.error=null,i.strict=!!e,i.noscript=!(!e&&!i.opt.noscript),i.state=H.BEGIN,i.strictEntities=i.opt.strictEntities,i.ENTITIES=i.strictEntities?Object.create(n.XML_ENTITIES):Object.create(n.ENTITIES),i.attribList=[],i.opt.xmlns&&(i.ns=Object.create(U)),i.trackPosition=i.opt.position!==!1,i.trackPosition&&(i.position=i.line=i.column=0),h(i,"onready")}function i(e){for(var t=Math.max(n.MAX_BUFFER_LENGTH,10),r=0,i=0,a=C.length;i<a;i++){var o=e[C[i]].length;if(o>t)switch(C[i]){case"textNode":m(e);break;case"cdata":g(e,"oncdata",e.cdata),e.cdata="";break;case"script":g(e,"onscript",e.script),e.script="";break;default:y(e,"Max buffer length exceeded: "+C[i])}r=Math.max(r,o)}var s=n.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=s+e.position}function a(e){for(var t=0,n=C.length;t<n;t++)e[C[t]]=""}function o(e){m(e),""!==e.cdata&&(g(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(g(e,"onscript",e.script),e.script="")}function s(e,t){return new l(e,t)}function l(e,t){if(!(this instanceof l))return new l(e,t);D.apply(this),this._parser=new r(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,I.forEach(function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){return t?void n.on(e,t):(n.removeAllListeners(e),n._parser["on"+e]=t,t)},enumerable:!0,configurable:!1})})}function u(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function c(e){return'"'===e||"'"===e}function d(e){return">"===e||u(e)}function f(e,t){return e.test(t)}function p(e,t){return!f(e,t)}function h(e,t,n){e[t]&&e[t](n)}function g(e,t,n){e.textNode&&m(e),h(e,t,n)}function m(e){e.textNode=v(e.opt,e.textNode),e.textNode&&h(e,"ontext",e.textNode),e.textNode=""}function v(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function y(e,t){return m(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,h(e,"onerror",t),e}function _(e){return e.sawRoot&&!e.closedRoot&&E(e,"Unclosed root tag"),e.state!==H.BEGIN&&e.state!==H.BEGIN_WHITESPACE&&e.state!==H.TEXT&&y(e,"Unexpected end"),m(e),e.c="",e.closed=!0,h(e,"onend"),r.call(e,e.strict,e.opt),e}function E(e,t){if("object"!=typeof e||!(e instanceof r))throw new Error("bad call to strictFail");e.strict&&y(e,t)}function b(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,g(e,"onopentagstart",n)}function T(e,t){var n=e.indexOf(":"),r=n<0?["",e]:e.split(":"),i=r[0],a=r[1];return t&&"xmlns"===e&&(i="xmlns",a=""),{prefix:i,local:a}}function w(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),e.attribList.indexOf(e.attribName)!==-1||e.tag.attributes.hasOwnProperty(e.attribName))return void(e.attribName=e.attribValue="");if(e.opt.xmlns){var t=T(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==x)E(e,"xml: prefix must be bound to "+x+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==F)E(e,"xmlns: prefix must be bound to "+F+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,g(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}function A(e,t){if(e.opt.xmlns){var n=e.tag,r=T(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(E(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){g(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],l=s[0],u=s[1],c=T(l,!0),d=c.prefix,f=c.local,p=""===d?"":n.ns[d]||"",h={name:l,value:u,prefix:d,local:f,uri:p};d&&"xmlns"!==d&&!p&&(E(e,"Unbound namespace prefix: "+JSON.stringify(d)),h.uri=d),e.tag.attributes[l]=h,g(e,"onattribute",h)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),g(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=H.TEXT:e.state=H.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function R(e){if(!e.tagName)return E(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=H.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=H.SCRIPT);g(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--;){var i=e.tags[t];if(i.name===r)break;E(e,"Unexpected close tag")}if(t<0)return E(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=H.TEXT);e.tagName=n;for(var a=e.tags.length;a-- >t;){var o=e.tag=e.tags.pop();e.tagName=e.tag.name,g(e,"onclosetag",e.tagName);var s={};for(var l in o.ns)s[l]=o.ns[l];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach(function(t){var n=o.ns[t];g(e,"onclosenamespace",{prefix:t,uri:n})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=H.TEXT}function S(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:(n=r,"#"===n.charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),t=parseInt(n,16),i=t.toString(16)):(n=n.slice(1),t=parseInt(n,10),i=t.toString(10))),n=n.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==n?(E(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function k(e,t){"<"===t?(e.state=H.OPEN_WAKA,e.startTagPosition=e.position):u(t)||(E(e,"Non-whitespace before first tag."),e.textNode=t,e.state=H.TEXT)}function O(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}function L(e){var t=this;if(this.error)throw this.error;if(t.closed)return y(t,"Cannot write after close. Assign an onready handler.");if(null===e)return _(t);"object"==typeof e&&(e=e.toString());for(var n=0,r="";;){if(r=O(e,n++),t.c=r,!r)break;switch(t.trackPosition&&(t.position++,"\n"===r?(t.line++,t.column=0):t.column++),t.state){case H.BEGIN:if(t.state=H.BEGIN_WHITESPACE,"\ufeff"===r)continue;k(t,r);continue;case H.BEGIN_WHITESPACE:k(t,r);continue;case H.TEXT:if(t.sawRoot&&!t.closedRoot){for(var a=n-1;r&&"<"!==r&&"&"!==r;)r=O(e,n++),r&&t.trackPosition&&(t.position++,"\n"===r?(t.line++,t.column=0):t.column++);t.textNode+=e.substring(a,n-1)}"<"!==r||t.sawRoot&&t.closedRoot&&!t.strict?(u(r)||t.sawRoot&&!t.closedRoot||E(t,"Text data outside of root node."),"&"===r?t.state=H.TEXT_ENTITY:t.textNode+=r):(t.state=H.OPEN_WAKA,t.startTagPosition=t.position);continue;case H.SCRIPT:"<"===r?t.state=H.SCRIPT_ENDING:t.script+=r;continue;case H.SCRIPT_ENDING:"/"===r?t.state=H.CLOSE_TAG:(t.script+="<"+r,t.state=H.SCRIPT);continue;case H.OPEN_WAKA:if("!"===r)t.state=H.SGML_DECL,t.sgmlDecl="";else if(u(r));else if(f(B,r))t.state=H.OPEN_TAG,t.tagName=r;else if("/"===r)t.state=H.CLOSE_TAG,t.tagName="";else if("?"===r)t.state=H.PROC_INST,t.procInstName=t.procInstBody="";else{if(E(t,"Unencoded <"),t.startTagPosition+1<t.position){var o=t.position-t.startTagPosition;r=new Array(o).join(" ")+r}t.textNode+="<"+r,t.state=H.TEXT}continue;case H.SGML_DECL:(t.sgmlDecl+r).toUpperCase()===N?(g(t,"onopencdata"),t.state=H.CDATA,t.sgmlDecl="",t.cdata=""):t.sgmlDecl+r==="--"?(t.state=H.COMMENT,t.comment="",t.sgmlDecl=""):(t.sgmlDecl+r).toUpperCase()===M?(t.state=H.DOCTYPE,(t.doctype||t.sawRoot)&&E(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):">"===r?(g(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=H.TEXT):c(r)?(t.state=H.SGML_DECL_QUOTED,t.sgmlDecl+=r):t.sgmlDecl+=r;continue;case H.SGML_DECL_QUOTED:r===t.q&&(t.state=H.SGML_DECL,t.q=""),t.sgmlDecl+=r;continue;case H.DOCTYPE:">"===r?(t.state=H.TEXT,g(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=r,"["===r?t.state=H.DOCTYPE_DTD:c(r)&&(t.state=H.DOCTYPE_QUOTED,t.q=r));continue;case H.DOCTYPE_QUOTED:t.doctype+=r,r===t.q&&(t.q="",t.state=H.DOCTYPE);continue;case H.DOCTYPE_DTD:t.doctype+=r,"]"===r?t.state=H.DOCTYPE:c(r)&&(t.state=H.DOCTYPE_DTD_QUOTED,t.q=r);continue;case H.DOCTYPE_DTD_QUOTED:t.doctype+=r,r===t.q&&(t.state=H.DOCTYPE_DTD,t.q="");continue;case H.COMMENT:"-"===r?t.state=H.COMMENT_ENDING:t.comment+=r;continue;case H.COMMENT_ENDING:"-"===r?(t.state=H.COMMENT_ENDED,t.comment=v(t.opt,t.comment),t.comment&&g(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+r,t.state=H.COMMENT);continue;case H.COMMENT_ENDED:">"!==r?(E(t,"Malformed comment"),t.comment+="--"+r,t.state=H.COMMENT):t.state=H.TEXT;continue;case H.CDATA:"]"===r?t.state=H.CDATA_ENDING:t.cdata+=r;continue;case H.CDATA_ENDING:"]"===r?t.state=H.CDATA_ENDING_2:(t.cdata+="]"+r,t.state=H.CDATA);continue;case H.CDATA_ENDING_2:">"===r?(t.cdata&&g(t,"oncdata",t.cdata),g(t,"onclosecdata"),t.cdata="",t.state=H.TEXT):"]"===r?t.cdata+="]":(t.cdata+="]]"+r,t.state=H.CDATA);continue;case H.PROC_INST:"?"===r?t.state=H.PROC_INST_ENDING:u(r)?t.state=H.PROC_INST_BODY:t.procInstName+=r;continue;case H.PROC_INST_BODY:if(!t.procInstBody&&u(r))continue;"?"===r?t.state=H.PROC_INST_ENDING:t.procInstBody+=r;continue;case H.PROC_INST_ENDING:">"===r?(g(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=H.TEXT):(t.procInstBody+="?"+r,t.state=H.PROC_INST_BODY);continue;case H.OPEN_TAG:f(j,r)?t.tagName+=r:(b(t),">"===r?A(t):"/"===r?t.state=H.OPEN_TAG_SLASH:(u(r)||E(t,"Invalid character in tag name"),t.state=H.ATTRIB));continue;case H.OPEN_TAG_SLASH:">"===r?(A(t,!0),R(t)):(E(t,"Forward-slash in opening tag not followed by >"),t.state=H.ATTRIB);continue;case H.ATTRIB:if(u(r))continue;">"===r?A(t):"/"===r?t.state=H.OPEN_TAG_SLASH:f(B,r)?(t.attribName=r,t.attribValue="",t.state=H.ATTRIB_NAME):E(t,"Invalid attribute name");continue;case H.ATTRIB_NAME:"="===r?t.state=H.ATTRIB_VALUE:">"===r?(E(t,"Attribute without value"),t.attribValue=t.attribName,w(t),A(t)):u(r)?t.state=H.ATTRIB_NAME_SAW_WHITE:f(j,r)?t.attribName+=r:E(t,"Invalid attribute name");continue;case H.ATTRIB_NAME_SAW_WHITE:if("="===r)t.state=H.ATTRIB_VALUE;else{if(u(r))continue;E(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",g(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",">"===r?A(t):f(B,r)?(t.attribName=r,t.state=H.ATTRIB_NAME):(E(t,"Invalid attribute name"),t.state=H.ATTRIB)}continue;case H.ATTRIB_VALUE:if(u(r))continue;c(r)?(t.q=r,t.state=H.ATTRIB_VALUE_QUOTED):(E(t,"Unquoted attribute value"),t.state=H.ATTRIB_VALUE_UNQUOTED,t.attribValue=r);continue;case H.ATTRIB_VALUE_QUOTED:if(r!==t.q){"&"===r?t.state=H.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=r;continue}w(t),t.q="",t.state=H.ATTRIB_VALUE_CLOSED;continue;case H.ATTRIB_VALUE_CLOSED:u(r)?t.state=H.ATTRIB:">"===r?A(t):"/"===r?t.state=H.OPEN_TAG_SLASH:f(B,r)?(E(t,"No whitespace between attributes"),t.attribName=r,t.attribValue="",t.state=H.ATTRIB_NAME):E(t,"Invalid attribute name");continue;case H.ATTRIB_VALUE_UNQUOTED:if(!d(r)){"&"===r?t.state=H.ATTRIB_VALUE_ENTITY_U:t.attribValue+=r;continue}w(t),">"===r?A(t):t.state=H.ATTRIB;continue;case H.CLOSE_TAG:if(t.tagName)">"===r?R(t):f(j,r)?t.tagName+=r:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=H.SCRIPT):(u(r)||E(t,"Invalid tagname in closing tag"),t.state=H.CLOSE_TAG_SAW_WHITE);else{if(u(r))continue;p(B,r)?t.script?(t.script+="</"+r,t.state=H.SCRIPT):E(t,"Invalid tagname in closing tag."):t.tagName=r}continue;case H.CLOSE_TAG_SAW_WHITE:if(u(r))continue;">"===r?R(t):E(t,"Invalid characters in closing tag");continue;case H.TEXT_ENTITY:case H.ATTRIB_VALUE_ENTITY_Q:case H.ATTRIB_VALUE_ENTITY_U:var s,l;switch(t.state){case H.TEXT_ENTITY:s=H.TEXT,l="textNode";break;case H.ATTRIB_VALUE_ENTITY_Q:s=H.ATTRIB_VALUE_QUOTED,l="attribValue";break;case H.ATTRIB_VALUE_ENTITY_U:s=H.ATTRIB_VALUE_UNQUOTED,l="attribValue"}";"===r?(t[l]+=S(t),t.entity="",t.state=s):f(t.entity.length?V:G,r)?t.entity+=r:(E(t,"Invalid character in entity name"),t[l]+="&"+t.entity+r,t.entity="",t.state=s);continue;default:throw new Error(t,"Unknown state: "+t.state)}}return t.position>=t.bufferCheckPosition&&i(t),t}n.parser=function(e,t){return new r(e,t)},n.SAXParser=r,n.SAXStream=l,n.createStream=s,n.MAX_BUFFER_LENGTH=65536;var C=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];n.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}t.prototype=e;var n=new t;return n}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),r.prototype={end:function(){_(this)},write:L,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){o(this)}};var D;try{D=e("stream").Stream}catch(P){D=function(){}}var I=n.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});l.prototype=Object.create(D.prototype,{constructor:{value:l}}),l.prototype.write=function(n){if("function"==typeof t&&"function"==typeof t.isBuffer&&t.isBuffer(n)){if(!this._decoder){var r=e("string_decoder").StringDecoder;this._decoder=new r("utf8")}n=this._decoder.write(n)}return this._parser.write(n.toString()),this.emit("data",n),!0},l.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},l.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||I.indexOf(e)===-1||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),D.prototype.on.call(n,e,t)};var N="[CDATA[",M="DOCTYPE",x="http://www.w3.org/XML/1998/namespace",F="http://www.w3.org/2000/xmlns/",U={xml:x,xmlns:F},B=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,j=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,G=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,V=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,H=0;n.STATE={BEGIN:H++,BEGIN_WHITESPACE:H++,TEXT:H++,TEXT_ENTITY:H++,OPEN_WAKA:H++,SGML_DECL:H++,SGML_DECL_QUOTED:H++,DOCTYPE:H++,DOCTYPE_QUOTED:H++,DOCTYPE_DTD:H++,DOCTYPE_DTD_QUOTED:H++,COMMENT_STARTING:H++,COMMENT:H++,COMMENT_ENDING:H++,COMMENT_ENDED:H++,CDATA:H++,CDATA_ENDING:H++,CDATA_ENDING_2:H++,PROC_INST:H++,PROC_INST_BODY:H++,PROC_INST_ENDING:H++,OPEN_TAG:H++,OPEN_TAG_SLASH:H++,ATTRIB:H++,ATTRIB_NAME:H++,ATTRIB_NAME_SAW_WHITE:H++,ATTRIB_VALUE:H++,ATTRIB_VALUE_QUOTED:H++,ATTRIB_VALUE_CLOSED:H++,ATTRIB_VALUE_UNQUOTED:H++,ATTRIB_VALUE_ENTITY_Q:H++,ATTRIB_VALUE_ENTITY_U:H++,CLOSE_TAG:H++,CLOSE_TAG_SAW_WHITE:H++,SCRIPT:H++,SCRIPT_ENDING:H++},n.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},n.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,
Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(n.ENTITIES).forEach(function(e){var t=n.ENTITIES[e],r="number"==typeof t?String.fromCharCode(t):t;n.ENTITIES[e]=r});for(var W in n.STATE)n.STATE[n.STATE[W]]=W;H=n.STATE,String.fromCodePoint||!function(){var e=String.fromCharCode,t=Math.floor,n=function(){var n,r,i=16384,a=[],o=-1,s=arguments.length;if(!s)return"";for(var l="";++o<s;){var u=Number(arguments[o]);if(!isFinite(u)||u<0||u>1114111||t(u)!==u)throw RangeError("Invalid code point: "+u);u<=65535?a.push(u):(u-=65536,n=(u>>10)+55296,r=u%1024+56320,a.push(n,r)),(o+1===s||a.length>i)&&(l+=e.apply(null,a),a.length=0)}return l};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:n,configurable:!0,writable:!0}):String.fromCodePoint=n}()}("undefined"==typeof n?this.sax={}:n)}).call(this,e("buffer").Buffer)},{buffer:5,stream:9,string_decoder:15}],64:[function(e,t,n){!function(e,r){"function"==typeof define&&define.amd?define(r):"object"==typeof n?t.exports=r():e.Cookie=r()}(this,function(){"use strict";function e(t,n,r){return void 0===n?e.get(t):void(null===n?e.remove(t):e.set(t,n,r))}function t(e){return e.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")}function n(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){if("expires"===n){var i=e[n];"object"!=typeof i&&(i+="number"==typeof i?"D":"",i=r(i)),e[n]=i.toUTCString()}t+=";"+n+"="+e[n]}return e.hasOwnProperty("path")||(t+=";path=/"),t}function r(e){var t=new Date,n=e.charAt(e.length-1),r=parseInt(e,10);switch(n){case"Y":t.setFullYear(t.getFullYear()+r);break;case"M":t.setMonth(t.getMonth()+r);break;case"D":t.setDate(t.getDate()+r);break;case"h":t.setHours(t.getHours()+r);break;case"m":t.setMinutes(t.getMinutes()+r);break;case"s":t.setSeconds(t.getSeconds()+r);break;default:t=new Date(e)}return t}return e.enabled=function(){var t,n="__test_key";return document.cookie=n+"=1",t=!!document.cookie,t&&e.remove(n),t},e.get=function(e,n){if("string"!=typeof e||!e)return null;e="(?:^|; )"+t(e)+"(?:=([^;]*?))?(?:;|$)";var r=new RegExp(e),i=r.exec(document.cookie);return null!==i?n?i[1]:decodeURIComponent(i[1]):null},e.getRaw=function(t){return e.get(t,!0)},e.set=function(e,t,r,i){r!==!0&&(i=r,r=!1),i=n(i?i:{});var a=e+"="+(r?t:encodeURIComponent(t))+i;document.cookie=a},e.setRaw=function(t,n,r){e.set(t,n,!0,r)},e.remove=function(t){e.set(t,"a",{expires:new Date})},e})},{}],65:[function(e,t,n){!function(e,r){"use strict";var i="0.7.13",a="",o="?",s="function",l="undefined",u="object",c="string",d="major",f="model",p="name",h="type",g="vendor",m="version",v="architecture",y="console",_="mobile",E="tablet",b="smarttv",T="wearable",w="embedded",A={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2===0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&t.toLowerCase().indexOf(e.toLowerCase())!==-1},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===c?e.replace(/[^\d\.]/g,"").split(".")[0]:r},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},R={rgx:function(e,t){for(var n,i,a,o,l,c,d=0;d<t.length&&!l;){var f=t[d],p=t[d+1];for(n=i=0;n<f.length&&!l;)if(l=f[n++].exec(e))for(a=0;a<p.length;a++)c=l[++i],o=p[a],typeof o===u&&o.length>0?2==o.length?typeof o[1]==s?this[o[0]]=o[1].call(this,c):this[o[0]]=o[1]:3==o.length?typeof o[1]!==s||o[1].exec&&o[1].test?this[o[0]]=c?c.replace(o[1],o[2]):r:this[o[0]]=c?o[1].call(this,c,o[2]):r:4==o.length&&(this[o[0]]=c?o[3].call(this,c.replace(o[1],o[2])):r):this[o]=c?c:r;d+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===u&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(A.has(t[n][i],e))return n===o?r:n}else if(A.has(t[n],e))return n===o?r:n;return e}},S={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},k={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[p,m],[/(opios)[\/\s]+([\w\.]+)/i],[[p,"Opera Mini"],m],[/\s(opr)\/([\w\.]+)/i],[[p,"Opera"],m],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i],[p,m],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[p,"IE"],m],[/(edge)\/((\d+)?[\w\.]+)/i],[p,m],[/(yabrowser)\/([\w\.]+)/i],[[p,"Yandex"],m],[/(puffin)\/([\w\.]+)/i],[[p,"Puffin"],m],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i,/(ucbrowser)\/([\w\.]+)/i],[[p,"UCBrowser"],m],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/(micromessenger)\/([\w\.]+)/i],[[p,"WeChat"],m],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[p,m],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[m,[p,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[m,[p,"Facebook"]],[/(headlesschrome) ([\w\.]+)/i],[m,[p,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[p,/(.+)/,"$1 WebView"],m],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[m,[p,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[p,m],[/(dolfin)\/([\w\.]+)/i],[[p,"Dolphin"],m],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[p,"Chrome"],m],[/(coast)\/([\w\.]+)/i],[[p,"Opera Coast"],m],[/fxios\/([\w\.-]+)/i],[m,[p,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[m,p],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[p,[m,R.str,S.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape)\/([\w\.-]+)/i],[[p,"Netscape"],m],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[p,m]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[v,"amd64"]],[/(ia32(?=;))/i],[[v,A.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[v,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[v,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[v,/ower/,"",A.lowerize]],[/(sun4\w)[;\)]/i],[[v,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[v,A.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[f,g,[h,E]],[/applecoremedia\/[\w\.]+ \((ipad)/],[f,[g,"Apple"],[h,E]],[/(apple\s{0,1}tv)/i],[[f,"Apple TV"],[g,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[g,f,[h,E]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[f,[g,"Amazon"],[h,E]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[f,R.str,S.device.amazon.model],[g,"Amazon"],[h,_]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[f,g,[h,_]],[/\((ip[honed|\s\w*]+);/i],[f,[g,"Apple"],[h,_]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[g,f,[h,_]],[/\(bb10;\s(\w+)/i],[f,[g,"BlackBerry"],[h,_]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[f,[g,"Asus"],[h,E]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[g,"Sony"],[f,"Xperia Tablet"],[h,E]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[g,"Sony"],[f,"Xperia Phone"],[h,_]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[g,f,[h,y]],[/android.+;\s(shield)\sbuild/i],[f,[g,"Nvidia"],[h,y]],[/(playstation\s[34portablevi]+)/i],[f,[g,"Sony"],[h,y]],[/(sprint\s(\w+))/i],[[g,R.str,S.device.sprint.vendor],[f,R.str,S.device.sprint.model],[h,_]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[g,f,[h,E]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[g,[f,/_/g," "],[h,_]],[/(nexus\s9)/i],[f,[g,"HTC"],[h,E]],[/(nexus\s6p)/i],[f,[g,"Huawei"],[h,_]],[/(microsoft);\s(lumia[\s\w]+)/i],[g,f,[h,_]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[f,[g,"Microsoft"],[h,y]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[g,"Microsoft"],[h,_]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[f,[g,"Motorola"],[h,_]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[f,[g,"Motorola"],[h,E]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[g,A.trim],[f,A.trim],[h,b]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[g,"Samsung"],[h,b]],[/\(dtv[\);].+(aquos)/i],[f,[g,"Sharp"],[h,b]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[g,"Samsung"],f,[h,E]],[/smart-tv.+(samsung)/i],[g,[h,b],f],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[g,"Samsung"],f,[h,_]],[/sie-(\w+)*/i],[f,[g,"Siemens"],[h,_]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[g,"Nokia"],f,[h,_]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[f,[g,"Acer"],[h,E]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[g,"LG"],f,[h,E]],[/(lg) netcast\.tv/i],[g,f,[h,b]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[f,[g,"LG"],[h,_]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[f,[g,"Lenovo"],[h,E]],[/linux;.+((jolla));/i],[g,f,[h,_]],[/((pebble))app\/[\d\.]+\s/i],[g,f,[h,T]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[g,f,[h,_]],[/crkey/i],[[f,"Chromecast"],[g,"Google"]],[/android.+;\s(glass)\s\d/i],[f,[g,"Google"],[h,T]],[/android.+;\s(pixel c)\s/i],[f,[g,"Google"],[h,E]],[/android.+;\s(pixel xl|pixel)\s/i],[f,[g,"Google"],[h,_]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[f,/_/g," "],[g,"Xiaomi"],[h,_]],[/android.+a000(1)\s+build/i],[f,[g,"OnePlus"],[h,_]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[h,A.lowerize],g,f]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[p,m],[/rv\:([\w\.]+).*(gecko)/i],[m,p]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[p,m],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[p,[m,R.str,S.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[p,"Windows"],[m,R.str,S.os.windows.version]],[/\((bb)(10);/i],[[p,"BlackBerry"],m],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[p,m],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[p,"Symbian"],m],[/\((series40);/i],[p],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[p,"Firefox OS"],m],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[p,m],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[p,"Chromium OS"],m],[/(sunos)\s?([\w\.]+\d)*/i],[[p,"Solaris"],m],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[p,m],[/(haiku)\s(\w+)/i],[p,m],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[p,"iOS"],[m,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[p,"Mac OS"],[m,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[p,m]]},O=function(e,t){this[p]=e,this[m]=t},L=function(e){this[v]=e},C=function(e,t,n){this[g]=e,this[f]=t,this[h]=n},D=O,P=O,I=function(t,n){if(!(this instanceof I))return new I(t,n).getResult();var r=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:a),i=n?A.extend(k,n):k,o=new O,s=new L,l=new C,u=new D,c=new P;return this.getBrowser=function(){return R.rgx.call(o,r,i.browser),o.major=A.major(o.version),o},this.getCPU=function(){return R.rgx.call(s,r,i.cpu),s},this.getDevice=function(){return R.rgx.call(l,r,i.device),l},this.getEngine=function(){return R.rgx.call(u,r,i.engine),u},this.getOS=function(){return R.rgx.call(c,r,i.os),c},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=e,o=new O,s=new L,l=new C,u=new D,c=new P,this},this};I.VERSION=i,I.BROWSER={NAME:p,MAJOR:d,VERSION:m},I.CPU={ARCHITECTURE:v},I.DEVICE={MODEL:f,VENDOR:g,TYPE:h,CONSOLE:y,MOBILE:_,SMARTTV:b,TABLET:E,WEARABLE:T,EMBEDDED:w},I.ENGINE={NAME:p,VERSION:m},I.OS={NAME:p,VERSION:m},typeof n!==l?(typeof t!==l&&t.exports&&(n=t.exports=I),n.UAParser=I):typeof define===s&&define.amd?define(function(){return I}):e.UAParser=I;var N=e.jQuery||e.Zepto;if(typeof N!==l){var M=new I;N.ua=M.getResult(),N.ua.get=function(){return M.getUA()},N.ua.set=function(e){M.setUA(e);var t=M.getResult();for(var n in t)N.ua[n]=t[n]}}}("object"==typeof window?window:this)},{}],66:[function(e,t,n){(function(n){"use strict";function r(e){e=e||n.location||{};var t,r={},i=typeof e;if("blob:"===e.protocol)r=new o(unescape(e.pathname),{});else if("string"===i){r=new o(e,{});for(t in h)delete r[t]}else if("object"===i){for(t in e)t in h||(r[t]=e[t]);void 0===r.slashes&&(r.slashes=f.test(e.href))}return r}function i(e){var t=d.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function a(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,i=n[r-1],a=!1,o=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),o++):o&&(0===r&&(a=!0),n.splice(r,1),o--);return a&&n.unshift(""),"."!==i&&".."!==i||n.push(""),n.join("/")}function o(e,t,n){if(!(this instanceof o))return new o(e,t,n);var s,l,d,f,h,g,m=p.slice(),v=typeof t,y=this,_=0;for("object"!==v&&"string"!==v&&(n=t,t=null),n&&"function"!=typeof n&&(n=c.parse),t=r(t),l=i(e||""),s=!l.protocol&&!l.slashes,y.slashes=l.slashes||s&&t.slashes,y.protocol=l.protocol||t.protocol||"",e=l.rest,l.slashes||(m[2]=[/(.*)/,"pathname"]);_<m.length;_++)f=m[_],d=f[0],g=f[1],d!==d?y[g]=e:"string"==typeof d?~(h=e.indexOf(d))&&("number"==typeof f[2]?(y[g]=e.slice(0,h),e=e.slice(h+f[2])):(y[g]=e.slice(h),e=e.slice(0,h))):(h=d.exec(e))&&(y[g]=h[1],e=e.slice(0,h.index)),y[g]=y[g]||(s&&f[3]?t[g]||"":""),f[4]&&(y[g]=y[g].toLowerCase());n&&(y.query=n(y.query)),s&&t.slashes&&"/"!==y.pathname.charAt(0)&&(""!==y.pathname||""!==t.pathname)&&(y.pathname=a(y.pathname,t.pathname)),u(y.port,y.protocol)||(y.host=y.hostname,y.port=""),y.username=y.password="",y.auth&&(f=y.auth.split(":"),y.username=f[0]||"",y.password=f[1]||""),y.origin=y.protocol&&y.host&&"file:"!==y.protocol?y.protocol+"//"+y.host:"null",y.href=y.toString()}function s(e,t,n){var r=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||c.parse)(t)),r[e]=t;break;case"port":r[e]=t,u(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="");break;case"hostname":r[e]=t,r.port&&(t+=":"+r.port),r.host=t;break;case"host":r[e]=t,/:\d+$/.test(t)?(t=t.split(":"),r.port=t.pop(),r.hostname=t.join(":")):(r.hostname=t,r.port="");break;case"protocol":r.protocol=t.toLowerCase(),r.slashes=!n;break;case"pathname":r.pathname=t.length&&"/"!==t.charAt(0)?"/"+t:t;break;default:r[e]=t}for(var i=0;i<p.length;i++){var a=p[i];a[4]&&(r[a[1]]=r[a[1]].toLowerCase())}return r.origin=r.protocol&&r.host&&"file:"!==r.protocol?r.protocol+"//"+r.host:"null",r.href=r.toString(),r}function l(e){e&&"function"==typeof e||(e=c.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var i=r+(n.slashes?"//":"");return n.username&&(i+=n.username,n.password&&(i+=":"+n.password),i+="@"),i+=n.host+n.pathname,t="object"==typeof n.query?e(n.query):n.query,t&&(i+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(i+=n.hash),i}var u=e("requires-port"),c=e("querystringify"),d=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,f=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,p=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],h={hash:1,query:1};o.prototype={set:s,toString:l},o.extractProtocol=i,o.location=r,o.qs=c,t.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{querystringify:61,"requires-port":62}],67:[function(e,t,n){function r(e){for(var t in e)return!1;return!0}var i,a,o,s,l=e("sax"),u=!1;n.init=function(e,t){switch(arguments.length){case 0:t={strict:!1};break;case 1:t={strict:e};break;case 2:t.strict=e;break;default:console.error("Too many arguments.")}"undefined"==typeof t.trim&&(t.trim=!0),a=l.parser(t.strict,t),o=[],a.onopentag=function(e){s=e,s.children=[],o.push(s)},a.ontext=a.oncdata=function(e){if(!s)return void console.error("Warning: texts before the first tag.");if(t.trim&&(e=e.trim()),e&&s){var n=s.children.length;n&&"string"==typeof s.children[n-1]?s.children[n-1]+=e:s.children.push(e)}},a.onclosetag=function(){if(o.pop(),delete s.isSelfClosing,r(s.attributes)&&delete s.attributes,s.children.length||delete s.children,o.length){var e=o[o.length-1];e.children.push(s),s=e}else i=s},u=!0},n.convert=function(e,t){u||this.init(),a.onend=function(){t(null,i)},a.write(e).close()}},{sax:63}],68:[function(e,t,n){function r(t,n,r){function i(){var e=s.get("MGUSERHASH");return!e&&E.userIP&&(e=u(E.userIP+navigator.userAgent),s.set("MGUSERHASH",e,{expires:36500})),e}var a=e("ua-parser-js"),o=e("url-parse"),s=e("tiny-cookie"),l=e("flash-detect"),u=e("md5"),c=e("./modules/localization"),d=e("./links"),f=new a,p=new o(window.location.href,(!0)),h=new c(t),g={player:"//www.tns-counter.ru/V13b****megogo_net/ru/CP1251/tmsec=megogo_player/%timestamp%",playstart:"//www.tns-counter.ru/V13b****megogo_net/ru/CP1251/tmsec=megogo_playstart/%timestamp%",playend:"//www.tns-counter.ru/V13b****megogo_net/ru/CP1251/tmsec=megogo_playend/%timestamp%"},m={identifier:"B7abku_qQIt7f7VYje59IMVHXtGB9uNO0.r_cC0aiLX.Y7",prefix:"sua"},v={id:15273939},y={id:"11e0",timeout:null},_={events:{http:{error:"http://log.cnt.re:7080/log/html5",warning:"http://log.cnt.re:7080/log/html5",player_warnings:"http://log.cnt.re:7080/log/player_warnings",p2p:"http://log.cnt.re:7080/log/p2p"},https:{error:"https://log.cnt.re/track/log/html5",warning:"https://log.cnt.re/track/log/html5",player_warnings:"https://log.cnt.re/track/log/player_warnings",p2p:"https://log.cnt.re:7080/log/p2p"}}},E={host:p.hostname,href:window.location.href,referer:p.query.referer?p.query.referer.replace("http://","").replace("https://",""):"",protocol:window.location.protocol,device:f.getResult(),localization:h,loadExternalLocalization:!1,localizationUrl:null,skin:p.query.skin||"default",videoURL:null,videoID:p.query.video_id||null,autoPlay:p.query.autoplay||p.query.autoPlay||null,supportedDrmType:null,debug:"true"==p.query.debug,embed:!1,userIP:null,userID:null,appVersion:"Wed Jul 19 2017 16:28:37 GMT+0300 (EEST)",deviceOS:f.getOS().version?f.getOS().name+"_"+f.getOS().version:f.getOS().name,deviceModel:f.getDevice().vendor+f.getDevice().model,deviceType:"web",lang:p.query.lang||"ru",lite:!1,ad:!0,p2p:!1,id:null,container:document.body,showCloseButton:null,singleVideoInstance:!1,flash:new l,onReady:n,onError:r,onSeriesChange:null,onGaEvent:null,getUserDataWS:null,getURLParser:function(e){return new o(e,(!0))},i18n:h.getText,tns:g,gemius:m,comscore:v,vigo:y,kibana:_,links:d,playerOptions:{},externalModules:[],socials:["vk","fb","twitter","gplus","ok","livejournal"],drm:!1,espressoMode:!1,adSpeed:100,vpaidAllow:!0};if("false"!=E.autoPlay&&0!=E.autoPlay||(E.autoPlay=!1),"mobile"==E.device.device.type||"tablet"==E.device.device.type)E.m3u8NativSupported=!0,E.singleVideoInstance=!0,E.supportedDrmType="modular","Apple"==E.device.device.vendor&&(E.supportedDrmType="fairplay");else if("Safari"===E.device.browser.name&&"Mac OS"===E.device.os.name){var b=E.device.os.version.split(".");try{b&&b.length>=2&&parseInt(b[1])>=10&&(E.supportedDrmType="fairplay")}catch(T){}}if("as"in p.query)try{E.adSpeed=parseInt(p.query.as)}catch(T){}if("va"in p.query)try{E.vpaidAllow=Boolean(parseInt(p.query.va))}catch(T){}if("em"in p.query)try{E.espressoMode=Boolean(parseInt(p.query.em))}catch(T){}return console.log("Player version: "+E.appVersion),E.checkDefaultOptions=function(){var e={},t=s.get("quality"),n=s.get("subtitles"),r=s.get("audioId"),i=s.get("volume"),a=s.get("muted");return p.query.volume&&(i=parseInt(p.query.volume)),t&&(e.defaultQuality=t),n&&(e.defaultSubtitles=n),r&&(e.defaultAudioTrack=r),p.query.start&&(e.startSeconds=p.query.start),(isNaN(i)||i<0)&&(i=0),e.defaultVolume=0==i?0:parseInt(i)>0?parseInt(i):60,e.defaultMuted=a||0,e},E.checkCloseButton=function(){return E.showCloseButton&&p.query.closeButton&&(E.showCloseButton="true"==p.query.closeButton),E.showCloseButton},E.playerOptions=E.checkDefaultOptions(),E.getUserDataWS&&"function"==typeof E.getUserDataWS||(E.getUserDataWS=function(){var e=i(),t=s.get("adcnt_a"),n=s.get("adcnt_s");return{deviceId:e,params:"?age="+t+"&gender="+n}}),E}t.exports=r},{"./links":70,"./modules/localization":75,"flash-detect":3,md5:20,"tiny-cookie":64,"ua-parser-js":65,"url-parse":66}],69:[function(e,t,n){"use strict";window.MggpLoader=function(){var t,n,r=e("mggp-player"),i=e("./modules/xhr-loader"),a=e("./modules/hls-loader"),o=e("./modules/checker"),s=e("./config"),l=e("tiny-cookie"),u=e("./testStream"),c=e("./modules/flash-mode"),d=e("./modules/BinfoToStream"),f=(e("./modules/polyfills"),this),p=[],h=[],g=new r,m=new i,v=new o,y=(new c,new d),_=!1,E=null,b=-1,T="Обнаружены проблемы с воспроизведением данного фильма. Попробуйте проиграть его позже.",w=0,A=0,R=!1;this.videoURL=null,this.getDefaultLoader=function(){return new i},this.getStream=function(e,t){f.config.supportedDrmType&&e.indexOf&&(e=e.indexOf("?")!=-1?e+"&drm_type="+f.config.supportedDrmType:e+"?drm_type="+f.config.supportedDrmType),m.load(e,t?t:f.onVideoInfo.bind(f),function(e){if("localhost"==f.config.host||f.config.host.indexOf("10.10.")!==-1)return void t(u);var n={name:f.constructor.name,type:"networkError",code:"streamLoadingError",message:T,description:e,fatal:!0};_?g.emit("mediaError",n):f.onError(n)})},this.getVirtualStream=function(e,t,n){},this.getStreamFromData=function(e){var t;if("string"==typeof e)if(e.indexOf("<config>")==-1)try{e=JSON.parse(e)}catch(n){return t={name:f.constructor.name,type:"parsingError",code:"parsingError",message:T,description:n.message,fatal:!0},_?g.emit("mediaError",t):f.onError(t),null}else e=y.convert(e);return"ok"==e.result&&e.data?(E=e.data,f.config.drm=Boolean(e.data.is_wvdrm),!e.data.src||e.data.src.length<5?(t={name:f.constructor.name,type:"streamError",code:"srcIsNull",message:T,description:e.data.forbidden,fatal:!0},_?g.emit("mediaError",t):f.onError(t),g.set("videoInfo",E),null):e.data.is_wvdrm&&!f.config.supportedDrmType?(t={name:f.constructor.name,type:"drmError",code:"drmNotSupported",message:T,description:e.data.forbidden,fatal:!0},_?g.emit("mediaError",t):f.onError(t),null):e.data):(t={name:f.constructor.name,type:"streamError",code:"responseError",message:T,description:e.error,fatal:!0},_?g.emit("mediaError",t):f.onError(t),null)},this.onReady=function(){function e(){t.style.visibility="visible";var e,n=document.getElementsByTagName("adskin");n&&n.length>0&&(n=n[0],e=n.getElementsByClassName("mggskin-ad-video-container"),e&&e.length>0&&(e=e[0])),f.config.adContainer=e,f.config.videoContainer=i,f.videoURL?f.load(f.videoURL):f.config.onReady!=f.onReady&&f.config.onReady()}var r=k("mggp-player-wrapper",f.config.container),i=k("mggp-video-container",r);if(window.mggPlayersPool||(window.mggPlayersPool={}),window.mggPlayersPool[f.config.container.id+"_player"]=g,t=k(f.config.container.id+"_skin",r,"skin"),t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.visibility="hidden",n=k(f.config.container.id+"_adskin",r,"adskin"),i.style.width="100%",i.style.height="100%",i.style.position="absolute",i.style.backgroundColor="black",window.riot){window.riot.mount("adskin");var a=window.riot.mount("skin")[0];a.isMounted?e():a.one("mount",e)}else e();F()},this.stop=function(){_&&g.stop()},this.onError=function(e){f.stop(),g.emit("ga:customEvent",[e.type,e.code,f.config.href]),f.config.onError!=f.onError&&f.config.onError(e)},this.config=new s(g,this.onReady,this.onError),R=this.config.espressoMode,this.init=function(e){var t=!!f.config.debug;return D(e,f.config),f.config.debug=t,f.videoURL=f.config.videoURL,g.config=f.config,v.init(f.config),f.config.loadExternalLocalization&&(f.config.localizationUrl?f.config.localization.load(f.config.localizationUrl):f.config.localization.loadDefault(f.config.lang)),h=v.checkModules(f.config,f.config.links),v.needDashLib()&&p.push(f.config.links.libs["shaka-player.js"]),v.needChromecastScript()&&p.push(f.config.links.libs["chromecast.js"]),p.push(f.config.links.libs["riot.js"]),p.push(f.config.links.libs.paho),S(f.config.skin),f.loadScripts(f.onReady.bind(f)),"function"==typeof f.config.i18n&&(T=f.config.i18n("video_playback_trouble_cause_standard")||T),g},this.load=function(e){if(w=0,A=0,f.config.videoURL=f.videoURL=e,"number"==typeof f.videoURL&&f.config.is_embed){var t="http://embed.qa.megogo.net/aprx/stream?lang="+f.config.lang+"video_id="+f.videoURL;f.getStream(t,f.onVideoInfo.bind(f))}else f.getStream(f.videoURL,f.onVideoInfo.bind(f))};var S=function(e){var t=f.config.links.skin[e]||null;t&&(t.css&&""!=t.css&&p.push(t.css),t.libs&&""!=t.libs&&p.push(t.libs),t.js&&""!=t.js&&p.push(t.js))},k=function(e,t,n){var r=document.createElement(n||"div");return e&&(r.id=e),t.appendChild(r),r};this.loadScripts=function(e){function t(){f.loadScripts(e)}if(0==p.length)return void e();var n,r=p.shift(),i=r.indexOf(".css")!=-1;i?(n=document.createElement("link"),n.href=r,n.type="text/css",n.rel="stylesheet"):(n=document.createElement("script"),n.src=r),document.documentElement.appendChild(n),n.onload=n.onerror=function(){this.executed||(this.executed=!0,t())},n.onreadystatechange=function(){var e=this;"complete"!=this.readyState&&"loaded"!=this.readyState||setTimeout(function(){e.onload()},0)}};var O=function(){var r=f.config.getUserDataWS?f.config.getUserDataWS():null;f.config.deviceID=r?r.deviceId||r.userId:null,f.config.deviceID&&!f.config.userID&&(f.config.userID=f.config.deviceID);var i={};i.autoRecoverError=!0,i.forceKeyFrameOnDiscontinuity=!1,i.abrEwmaFastVoD=6,i.getStreamFromData=f.getStreamFromData,i.getDefaultLoader=f.getDefaultLoader,i.getStream=f.getStream,i.getVirtualStream=f.getVirtualStream,i.loader=a,D(f.config,i),x(f.config.playerOptions);var o=f.config.autoPlay;0!=o&&(o=E.hasOwnProperty("autoPlay")?E.autoPlay:o);var s=f.config.device.device;if(E.src=f.config.protocol+E.src.substr(E.src.indexOf("//")),"mobile"==s.type||"tablet"==s.type){"iphone"===g.config.device.device.model.toLowerCase()&&(o=!1);var u=e("./modules/mobile-utils"),c=f.config.device.os;"Android"==c.name&&4==parseInt(c.version)&&"https:"==f.config.protocol&&(o=!1),new u(g,o)}else g.set("isMobile",!1);o?g.on("player:ready",function(){g.load(E.src,E,f.config.checkDefaultOptions())}):g.set("autoplay",!1),g.on("property:autoplay",function(e){g.get("property:ignoreAutoplay")||1==e.data&&(E=D(E,{}),g.load(E.src,E,f.config.checkDefaultOptions()))}),g.on("property:quality",function(e){l.set("quality",e.data)}),g.on("property:audioTrack",function(e){l.set("audioId",e.data)}),g.on("property:subtitles",function(e){l.set("subtitles",e.data)}),g.on("property:volume",function(e){l.set("volume",e.data)}),g.on("property:muted",function(e){l.set("muted",e.data?1:0)}),g.on("ad:external:adComplete",function(e){"preroll"==e.data.type&&R&&(g.stop(),R=!1,f.load(f.config.videoURL))}),g.on("changeVideo",function(e){f.config.onSeriesChange&&"function"==typeof f.config.onSeriesChange&&1==f.config.onSeriesChange(e.data)||(1==f.config.is_embed?f.getStream("//embed.qa.megogo.net/aprx/stream?video_id="+e.data+"&lang="+f.config.lang+"&referer="+f.config.href,f.onVideoInfo.bind(f)):f.getStream(e.data,f.onVideoInfo.bind(f)))}),g.on("property:state",M),g.on("hideSkins",function(){n.style.visibility="hidden",t.style.visibility="hidden"}),g.on("showSkins",function(){n.style.visibility="visible",t.style.visibility="visible"}),g.on("adblock:detected",function(){g.stop();var e={name:f.constructor.name,type:"adBlock",code:"adBlockDetected",message:T,description:"",fatal:!0};setTimeout(function(){f.onError(e)},300)}),g.on("player:mediaError",L),g.on("mediaError",L),g.registerProperty("vendor:dismissSeekToLiveAfterPause",!1,!0),g.registerProperty("player:usePluginBuffering",!0,!0),g.init("player",i.videoContainer,i,h),_=!0},L=function(e){if(e.data.fatal){var t=g.get("videoInfo");if(!E.src||E.src.length<5||t.is_wvdrm&&"player:mediaError"==e.name||!C()){g.stop();var n=e.data;n.stream=E,n.description=n.message,n.message=T,f.onError(n)}}},C=function(){if(w>=5)return!1;w++;for(var e=g.get("vendorOptions")||{},t=0;t<g.get("qualityList").length;t++){var n=g.get("qualityList")[t];n.bitrate==parseInt(g.get("quality"))&&n.bitrate!=-1&&(e.defaultQuality=n.bitrate)}return e.startSeconds=e.startSeconds||g.get("position"),e.hasOwnProperty("defaultAudioTrack")||0==g.get("audioTrack")||(e.defaultAudioTrack=g.get("audioTrack")),g.emit("loader:rebinfo",w),setTimeout(function(){g.stop(),f.getStream(P(f.videoURL),function(t){if(E=f.getStreamFromData(t)){var n=g.get("videoInfo");n?n.src=E.src:n=E,n.rebinfo=!0,g.load(E.src,n,e)}else{g.stop();var r=pEvent.data;r.stream=f.videoURL,r.description="Cannot load or parse stream",r.message=T,f.onError(r)}})},A),A+=1e3,!0},D=function(e,t){for(var n in e)t[n]=e[n];return t},P=function(e){return"string"==typeof e&&e.indexOf("//")!=-1&&(e=e.substring(e.indexOf("//"))),e},I=function(e){var t="";if(e&&e.indexOf("%user_id%")==-1&&(e=e.replace(/.+start\/(\w|\d)*\//,""))){var n=e.indexOf("/");n>0&&(t=e.substring(0,n));
}return t},N=function(){window.ga&&window.ga("create","UA-27184289-5",{})};this.onVideoInfo=function(e){if(E=f.getStreamFromData(e)){if(E.start_session_url){var t=I(E.start_session_url);t&&(f.config.userID=t)}if(E.src=P(E.src),f.config.drm&&"fairplay"===f.config.supportedDrmType&&(E.src=E.src.replace(/\/a\/\d+/,"")),E.is_tv&&"Safari"===f.config.device.browser.name&&parseInt(f.config.device.browser.major)<10&&(E.bitrates=[]),E.is_embed){var n=f.config.getURLParser(window.location.href);"as"in n.query||(f.config.adSpeed=105),E.start_session_url="",f.config.embed=!0,N()}null!=f.config.showCloseButton&&(E.showCloseButton=f.config.checkCloseButton()),_?(g.stop(),g.load(E.src,E,f.config.checkDefaultOptions())):O()}};var M=function(e){if(0===e.data)E&&E.next&&E.next.toString().indexOf("i=0")==-1?g.emit("changeVideo",E.next):g.get("epg")?(g.stop(),g.set("state",3)):(g.set("autoplay",!1),g.stop());else if(1===e.data){w=0,A=0;var t=document.getElementById("playerContainer_skin"),n=document.getElementById("playerContainer_adskin");t&&"hidden"==t.style.visibility&&(t.style.visibility="visible"),n&&"hidden"==n.style.visibility&&(n.style.visibility="visible"),2==b&&1==g.get("videoInfo").is_tv&&g.emit("epg:playerResume")}b=e.data},x=function(e){e.hasOwnProperty("defaultVolume")&&(g.set("volume",parseInt(e.defaultVolume)),delete e.defaultVolume),e.hasOwnProperty("defaultMuted")&&(1==parseInt(e.defaultMuted)&&g.set("muted",!0),delete e.defaultMuted)},F=function(){if(self==top)return!1;for(var e=window,t=0;e!=window.top;)t++,e=e.parent;return window.setTimeout(function(){g.emit("ga:customEvent",["deepTrack_"+t,g.config.href,g.config.deviceOS])},500),!0}}},{"./config":68,"./modules/BinfoToStream":71,"./modules/checker":72,"./modules/flash-mode":73,"./modules/hls-loader":74,"./modules/mobile-utils":76,"./modules/polyfills":77,"./modules/xhr-loader":78,"./testStream":79,"mggp-player":21,"tiny-cookie":64}],70:[function(e,t,n){var r={skin:{"default":{js:"//s1.vcdn.biz/static/48948671/skin.js",css:"//s1.vcdn.biz/static/48948681/skin.css",libs:"//s1.vcdn.biz/static/48948691/lib.js"},default3:{js:"//s1.vcdn.biz/static/48948861/skin.js",css:"//s1.vcdn.biz/static/48948911/skin.css",libs:"//s1.vcdn.biz/static/48948921/lib.js"},kinomts:{js:"//s1.vcdn.biz/static/46286241/skin.js",css:"//s1.vcdn.biz/static/46286251/skin.css",libs:"//s1.vcdn.biz/static/46286261/lib.js"},moldcelltv:{js:"//s1.vcdn.biz/static/46281091/skin.js",css:"//s1.vcdn.biz/static/46281101/skin.css",libs:"//s1.vcdn.biz/static/46281111/lib.js"}},libs:{"ga.js":"//www.google-analytics.com/analytics.js","chromecast.js":"//www.gstatic.com/cv/js/sender/v1/cast_sender.js","riot.js":"//s8.vcdn.biz/static/41210291/riot.js",paho:"https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js","shaka-player.js":"//s5.vcdn.biz/static/47545891/shaka-player.compiled.js"},flashPlayer:"//s1.vcdn.biz/static/f/721041461"};t.exports=r},{}],71:[function(e,t,n){function r(){function e(e){var n={};if("CONFIG"===e.name&&e.children&&e.children.length>0){n={};for(var r,i,a,o,s,l=e.children,u=0,c=l.length;u<c;++u)if("SRC"===l[u].name)n.src=t(l[u]);else if("TITLE"===l[u].name)n.title=t(l[u]);else if("TYPE"===l[u].name)n.type=t(l[u]),n.is_tv="TV"===n.type;else if("SHARELINK"===l[u].name){if(r=t(l[u]),n.share_link=r,r=r.match(/\d+/),r&&r.length>0)try{n.video_id=parseInt(r[0])}catch(d){}}else if("SHOWCLOSEBUTTON"===l[u].name)n.showCloseButton="true"===t(l[u]);else if("WATERMARKURL"===l[u].name)n.watermarkURL=t(l[u]);else if("RESULTINGREFFERERHOST"===l[u].name)n.resultingrefererhost=t(l[u]);else if("WATERMARKISCLICKABLE"===l[u].name)n.watermarkIsClickable="true"===t(l[u]);else if("PLAYER_BG"===l[u].name)n.player_bg=t(l[u]);else if("AUTOPLAY"===l[u].name)n.autoplay="true"===t(l[u]),n.autoPlay="true"===t(l[u]);else if("VODCHANNEL"===l[u].name)n.is_vod_channel="true"===t(l[u]);else if("DVRCHANNEL"===l[u].name)n.is_dvr_channel="true"===t(l[u]);else if("PLAYSTARTTIME"===l[u].name)n.play_start_time=t(l[u]);else if("NEXT"===l[u].name)n.next=t(l[u]);else if("PREV"===l[u].name)n.prev=t(l[u]);else if("ADVERTURL"===l[u].name)n.advert_url=t(l[u]);else if("ADVERTDATA"===l[u].name)n.advert_data=t(l[u]);else if("CONTENTTYPE"===l[u].name)r=t(l[u]),n.contentType=n.content_type=r,n.is_live="live"===r||"tv_dvr"===r||"tv_linear"===r||"m_ch"===r||"live_dvr"===r;else if("VIDEOSTAT"===l[u].name)n.start_session_url=t(l[u]);else if("SHOWBESTQUALITYLINK"===l[u].name)n.showBestQualityLink="true"===t(l[u]);else if("SHARE"===l[u].name)n.player_share_code="true"===t(l[u]);else if("BITRATES"===l[u].name){if(r=[],l[u].children&&l[u].children.length>0){var f;for(i=0,a=l[u].children.length;i<a;++i){if(f={},s=l[u].children[i],s.attributes)for(o in s.attributes)try{"VALUE"==o?f.bitrate=parseInt(s.attributes[o]):f[o.toLowerCase()]=parseInt(s.attributes[o])}catch(d){}f.name=t(s),r.push(f)}}n.bitrates=r}else if("THUMBSXML"===l[u].name)n.preview_images||(n.preview_images={}),n.preview_images.thumbsline_xml=t(l[u]);else if("THUMBS"===l[u].name){if(n.preview_images||(n.preview_images={}),r=[],l[u].children&&l[u].children.length>0){var p;for(i=0,a=l[u].children.length;i<a;++i){if(p={},s=l[u].children[i],s.attributes)for(o in s.attributes)if("ID"===o)try{p.id=parseInt(s.attributes[o])}catch(d){}else p[o.toLowerCase()]=s.attributes[o];r.push(p)}}n.preview_images.thumbsline_list=r}else if("AUDIOTRACKS"===l[u].name){if(r=[],l[u].children&&l[u].children.length>0){var h;for(i=0,a=l[u].children.length;i<a;++i){if(h={},s=l[u].children[i],s.attributes)for(o in s.attributes)try{h[o.toLowerCase()]=parseInt(s.attributes[o])}catch(d){}h.lang_original=t(s),h.display_name=t(s),h.lang=t(s),r.push(h)}}n.audio_tracks=r}else if("SUBTITLES"===l[u].name){if(r=[],l[u].children&&l[u].children.length>0){var g;for(i=0,a=l[u].children.length;i<a;++i){if(g={},s=l[u].children[i],s.attributes){g.index=i;for(o in s.attributes)"NAME"===o?(g.lang_original=s.attributes[o],g.display_name=s.attributes[o],g.lang=s.attributes[o],g.lang_tag=s.attributes[o]):"TYPE"===o?g[o.toLowerCase()]=s.attributes[o].toLowerCase():g[o.toLowerCase()]=s.attributes[o]}g.url=t(s),r.push(g)}}n.subtitles=r}else if("EMBED"===l[u].name)n.is_embed="true"===t(l[u]);else if(35==u||"EPGURL"===l[u].name)n.epg_url=t(l[u]);else if("CHANNELS"===l[u].name){var m=[];if(l[u].children&&l[u].children.length>0){var v,y,_,E,b,T=l[u].children;for(i=0,a=T.length;i<a;++i)if(v=T[i],E={title:"",channels:[]},m.push(E),v.attributes&&v.attributes.TITLE&&(E.title=v.attributes.TITLE),v.children&&v.children.length>0){y=v.children;for(var w=0,A=y.length;w<A;++w){if(_=y[w],b={epgId:0,isFavorite:!1,id:0},E.channels.push(b),_.attributes){if(_.attributes.EPGID)try{b.epgId=parseInt(_.attributes.EPGID)}catch(d){}_.attributes.ISFAVORITE&&(b.isFavorite=_.attributes.ISFAVORITE),_.attributes.VODCHANNEL&&(b.vodChannel=_.attributes.VODCHANNEL),_.attributes.DVRCHANNEL&&(b.dvrChannel=_.attributes.DVRCHANNEL)}try{b.id=parseInt(t(_))}catch(d){}}}}n.channels=m}else if("MESSAGES"===l[u].name){if(r={},l[u].children&&l[u].children.length>0){var R,S=l[u].children;for(w=0,A=S.length;w<A;++w)if(R=S[w],"MONTHS"===R.name)for(r.months={},i=0,a=R.children.length;i<a;++i)r.months[R.children[i].name.toLowerCase()]=t(R.children[i]);else r[R.name.toLowerCase()]=t(R)}n.messages=r}else if("DRMDASH"===l[u].name){if(r={},l[u].children&&l[u].children.length>0){var k=l[u].children;for(i=0,a=k.length;i<a;++i)k[i].attributes&&k[i].attributes.NAME&&(r[k[i].attributes.NAME]=t(k[i]))}n.is_wvdrm=!0,n.wvls=r}else"SELFPROMO"===l[u].name?n.is_subscription="true"===t(l[u]):"DRM"===l[u].name&&(n.is_wvdrm="true"===t(l[u]))}return n.video_id||(n.video_id=-1),n}function t(e){var t="";return e&&e.children&&e.children.length>0&&(t=e.children[0]),t}this.convert=function(t){var n={};return i.convert(t,function(t,r){!t&&r&&(r=e(r),n=r?{result:"ok",data:r}:{result:"error"})}),n}}var i=e("xml2jsobj");t.exports=r},{xml2jsobj:67}],72:[function(e,t,n){function r(t){var n=e("mggp-vendor-img"),r=e("mggp-vendor-hls"),i=e("mggp-vendor-dash"),a=e("mggp-vendor-html5"),o=e("mggp-vendor-flash"),s=e("mggp-vendor-ima"),l=e("mggp-vendor-swf"),u=e("mggp-vendor-vpaid"),c=e("mggp-vendor-vpaidjs"),d=e("mggp-vendor-chromecast"),f=e("mggp-vendor-html"),p=e("mggp-vendor-hls-fairplay"),h=e("mggp-plugin-audio"),g=e("mggp-plugin-subtitles"),m=e("mggp-plugin-quality"),v=e("mggp-plugin-ga"),y=e("mggp-plugin-thumbnails"),_=e("mggp-plugin-ad"),E=e("mggp-plugin-kibana"),b=e("mggp-plugin-kibana-warnings"),T=e("mggp-plugin-wss"),w=e("mggp-plugin-tns"),A=e("mggp-plugin-vclicks"),R=e("mggp-plugin-comscore"),S=e("mggp-plugin-gemius"),k=e("mggp-plugin-watermark"),O=e("mggp-plugin-chromecast"),L=(e("mggp-plugin-mns"),e("mggp-plugin-p2p"),e("mggp-plugin-epg")),C=e("mggp-plugin-vod-channels"),D=e("mggp-plugin-vod-channels-cms"),P=e("mggp-plugin-dvr"),I=e("mggp-plugin-dvr-cms"),N=e("mggp-plugin-airplay");pluginVigo=e("mggp-plugin-vigo");var M=(e("flash-detect"),e("ua-parser-js")),x=(new M,[]),F=null,U=window.location.origin.indexOf("cms")!==-1||window.location.origin.indexOf("new")!==-1;this.init=function(e){F=e,F.supportedDrmType||V()},this.oldFlashMode=function(){var e=F.device,t=e.browser.name;return"IE"==t},this.needDashLib=function(){return x.indexOf(i)!=-1&&!window.shaka},this.needChromecastScript=function(){return"iOS"!=F.device.os.name&&(F.device.browser.name.indexOf("Chrome")!=-1&&chrome&&!chrome.cast)},this.checkModules=function(){var e=F.device.browser;return("Windows_XP"==F.deviceOS||"Windows_Vista"==F.deviceOS||e.name.indexOf("Chrome")!=-1&&parseInt(e.version)<45||e.name.indexOf("Opera")!=-1&&parseInt(e.version)<=12||e.name.indexOf("Firefox")!=-1&&parseInt(e.version)<=40)&&B(),x.push(a),x.push(f),x.push(v),x.push(T),x.push(k),F.lite||(x.push(h),x.push(m),x.push(y),x.push(g),x.push(E),x.push(b),x.push(w),x.push(S),x.push(R),x.push(A),x.push(O),x.push(d),x.push(L),x.push(i),x.push(N),U?(x.push(I),x.push(D)):(x.push(P),x.push(C))),!F.embed,F.ad&&(x.push(_),x.push(n),x.push(s),x.push(l),x.push(u),x.push(c)),j()&&x.push(r),G()&&x.push(o),"Safari"===e.name&&"Mac OS"===F.device.os.name&&parseFloat(F.device.os.version)>=10.1&&x.push(p),F.externalModules.forEach(function(e){x.push(e)}),x};var B=function(){o.mimeTypes.push("mp4"),o.priority=1,r.priority=2,a.priority=3},j=function(){var e;try{e=window.MediaSource&&"function"==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}catch(t){e=!1}return e},G=function(){var e=F.flash;return!!(e.installed&&e.major>=10)&&!(10==e.major&&e.minor<2)},V=function(){var e=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{contentType:'video/mp4;codecs="avc1.42E01E"'}]}];try{navigator.requestMediaKeySystemAccess("com.widevine.alpha",e).then(function(e){F.supportedDrmType="modular"})["catch"](function(e){})}catch(t){}try{navigator.requestMediaKeySystemAccess("com.microsoft.playready",e).then(function(e){F.supportedDrmType="playready"})["catch"](function(e){})}catch(t){}}}t.exports=r},{"flash-detect":3,"mggp-plugin-ad":22,"mggp-plugin-airplay":23,"mggp-plugin-audio":24,"mggp-plugin-chromecast":26,"mggp-plugin-comscore":27,"mggp-plugin-dvr":29,"mggp-plugin-dvr-cms":28,"mggp-plugin-epg":30,"mggp-plugin-ga":31,"mggp-plugin-gemius":32,"mggp-plugin-kibana":34,"mggp-plugin-kibana-warnings":33,"mggp-plugin-mns":35,"mggp-plugin-p2p":36,"mggp-plugin-quality":37,"mggp-plugin-subtitles":38,"mggp-plugin-thumbnails":39,"mggp-plugin-tns":40,"mggp-plugin-vclicks":41,"mggp-plugin-vigo":42,"mggp-plugin-vod-channels":44,"mggp-plugin-vod-channels-cms":43,"mggp-plugin-watermark":45,"mggp-plugin-wss":46,"mggp-vendor-chromecast":47,"mggp-vendor-dash":48,"mggp-vendor-flash":49,"mggp-vendor-hls":51,"mggp-vendor-hls-fairplay":50,"mggp-vendor-html":52,"mggp-vendor-html5":53,"mggp-vendor-ima":56,"mggp-vendor-img":57,"mggp-vendor-swf":58,"mggp-vendor-vpaid":59,"mggp-vendor-vpaidjs":60,"ua-parser-js":65}],73:[function(e,t,n){var r=function(){var e=e||[];this.load=function(t,n){var r=t.indexOf("http")==-1?"configurationJson=http://"+window.location.host+t:"configurationJson="+t;n.container.innerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="flashplayer" class="flashplayer" width="100%" height="100%"><param name="movie" value='+n.links.flashPlayer+'/><param name="allowFullScreen" value="true"/><param name="wmode" value="direct"/><param name="allowscriptaccess" value="always"/><param name="flashvars" value='+r+"><embed src="+n.links.flashPlayer+' type="application/x-shockwave-flash" width="100%" height="100%"allowscriptaccess="always" wmode="direct" allowfullscreen="true"flashvars='+r+"></embed></object>",window.flashGAEvent||(window.flashGAEvent=function(t,n,r,i){"undefined"!=typeof e&&(t||(t="empty"),n||(n="empty"),e.push(["_trackEvent",t,n,r,i]))})}};t.exports=r},{}],74:[function(e,t,n){function r(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup),this.destroy=function(){this.abort(),this.loader=null},this.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},this.load=function(e,t,n){this.context=e,this.config=t,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},this.loadInternal=function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",t.url,!0),t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.responseType=t.responseType;var n=this.stats;n.tfirst=0,n.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},this.readystatechange=function(e){var t=e.currentTarget,n=t.readyState,r=this.stats,i=this.context,a=this.config;if(!r.aborted&&(window.clearTimeout(this.requestTimeout),n>=2&&(0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),4e3)),4===n))){var o=t.status;if(o>=200&&o<300){r.tload=Math.max(r.tfirst,performance.now());var s,l;"arraybuffer"===i.responseType?(s=t.response,l=s.byteLength):(s=t.responseText,l=s.length),r.loaded=r.total=l;var u={url:t.responseURL,data:s};this.callbacks.onSuccess(u,r,i)}else r.retry>=a.maxRetry||o>=400&&o<499?this.callbacks.onError({code:o,text:t.statusText},i):(this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),r.retry++)}},this.loadtimeout=function(){this.callbacks.onTimeout(this.stats,this.context)},this.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var n=this.callbacks.onProgress;n&&n(t,this.context,null),window.clearTimeout(this.requestTimeout),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),4e3)}}t.exports=r},{}],75:[function(e,t,n){function r(t){var n=e("./xhr-loader"),r=new n,i=null;this.setMessages=function(e){console.log("Localization.setMessages",i),i=e};var a=function(e){try{var t=JSON.parse(e);"ok"==t.result&&(i=t.data)}catch(n){}},o=function(e){};this.getText=function(e){if(t){var n=t.get("videoInfo");if(n&&n.messages&&n.messages[e])return n.messages[e]}return i?i[e]:null},this.load=function(e){r.load(e,a,o)},this.loadDefault=function(e){r.load("//embed.qa.megogo.net/aprx/configuration/interface?place=STREAM&lang="+e,a,o)}}t.exports=r},{"./xhr-loader":78}],76:[function(e,t,n){function r(e,t){function n(t){if(y==c&&(y=t.type),!t.currentTarget.seeking&&t.currentTarget.currentTime>.5)switch(t.type){case"play":y==f&&(y=t.type,e.play(),s(1));break;case"pause":y==d&&(y=t.type,m?setTimeout(function(){e.pause(),s(2)},800):(e.pause(),s(2)))}}function r(e){switch(e.type){case"seeking":y!=p&&(_=y),y=p;break;case"seeked":_&&(y=_,_=null)}}function i(t){var n=e.get("videoInfo");n&&(n.next&&"string"==typeof n.next&&n.next.indexOf("i=0")==-1||u()&&l())}function a(e){m&&"fullscreen"===h.webkitPresentationMode&&(h.webkitExitFullscreen?h.webkitExitFullscreen():h.webkitExitFullScreen&&h.webkitExitFullScreen())}function o(e){g&&g.muted&&(g.muted=!1,document.removeEventListener("mousedown",o))}function s(t){e.set("state",t),e.emit("player:stateChange",t)}function l(){document.cancelFullScreen?document.cancelFullScreen():document.CancelFullScreen?document.msCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():g&&(g.webkitExitFullscreen?g.webkitExitFullscreen():g.webkitExitFullScreen&&g.webkitExitFullScreen())}function u(){var e=!1;return e=void 0===document.fullscreenElement&&void 0===document.msFullscreenElement&&void 0===document.mozFullScreenElement&&void 0===document.webkitFullscreenElement&&g?"fullscreen"===g.webkitPresentationMode:Boolean(document.fullscreenElement||document.msFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)}var c="idle",d="play",f="pause",p="seek",h=null,g=null,m="iphone"===e.config.device.device.model.toLowerCase(),v=null,y=c,_=c;e.setVolume(100),e.set("isMobile",!0),e.on("property:videoInstances",function(e){var s=e.data;s&&s.forEach(function(e){e.muted=!0,e.autoplay=t,e.className.indexOf("player:video")!=-1?(e.addEventListener("pause",n),e.addEventListener("play",n),e.addEventListener("ended",i),e.addEventListener("seeking",r),e.addEventListener("seeked",r),g=e,document.addEventListener("mousedown",o)):e.className.indexOf("ad:vendor:video")!=-1&&(h=e,h.addEventListener("ended",a))})}),e.on("property:videoInfo",function(t){e.set("isMobile",!0)}),e.on("ad:external:memberStartedPlaying",function(t){u()&&l(),v&&v.parentNode&&(v.parentNode.removeChild(v),v=null),h&&(["jpg","jpeg","png","gif"].indexOf(e.utils.getExtension(t.data.mediaURL))!=-1?h.style.display="none":h.style.display="initial")}),e.on("property:ad:vendor:muted",function(t){h&&h.muted&&!t.data&&e.set("ad:vendor:muted",!0)}),e.on("ad:skin:muteChanged",function(e){h&&h.muted&&(h.muted=!1)}),e.on("ad:external:adWillStartIn",function(t){function n(){if(e.config&&e.config.container){var t=document.createElement("topbar");return t.style.position="absolute",t.style.color="#fff",t.style.marginTop=t.style.marginLeft="20px",t.style.fontSize="20px",e.config.container.appendChild(t),t}}if(e.config){var r=e.config.i18n("beforeAdtTimerText")||"Реклама начнется через ";r+=t.data+" "+(e.config.i18n("second")||"сек"),v||(v=n()),v&&(v.innerHTML=r)}})}t.exports=r},{}],77:[function(e,t,n){!function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var a=Object.keys(Object(i)),o=0,s=a.length;o<s;o++){var l=a[o],u=Object.getOwnPropertyDescriptor(i,l);void 0!==u&&u.enumerable&&(n[l]=i[l])}}return n}})}()},{}],78:[function(e,t,n){function r(){this.load=function(e,t,n){try{var r=new XMLHttpRequest;r.open("GET",e,!0),r.onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n("Error loading "+e))},r.send(null)}catch(i){n("Error loading "+e)}}}t.exports=r},{}],79:[function(e,t,n){var r={data:{video_id:2384041,title:"Такси 4",is_wvdrm:!1,wvls:"http://wvls.drm.megogo.net/getlicense/megogo",prev:null,next:null,is_tv:!1,is_live:!1,is_embed:!1,is_uhd:!1,is3d:null,bitrates:[{index:1,name:"Низкое (240)",bitrate:240,src:null},{index:2,name:"Среднее (320)",bitrate:320,src:null},{index:3,name:"Обычное (360)",bitrate:360,src:null},{index:4,name:"Хорошее (480)",bitrate:480,src:null},{index:5,name:"Высокое (720)",bitrate:720,src:null},{index:6,name:"Наилучшее (1080)",bitrate:1080,src:null}],is_360:!0,src:"https://r.mradx.net/img/6F/6519F0.mp4",advert_url:"http://10.10.22.109:3012/player/plugins/mggp-plugin-ad/dev/adlist.json",audio_tracks:[{id:11,index:0,is_active:!0,lang:"ru",lang_original:"Русский",display_name:"Русский"},{id:14,index:1,is_active:!1,lang:"ua",lang_original:"Українська",display_name:"Украинский"},{id:3,index:2,is_active:!1,lang:"by",lang_original:"Беларуская",display_name:"Белорусский"},{id:8,index:3,is_active:!1,lang:"lt",lang_original:"Lietuvių",display_name:"Литовский"},{id:1,index:5,is_active:!1,lang:"am",lang_original:"հայերէն",display_name:"Армянский"},{id:5,index:6,is_active:!1,lang:"ge",lang_original:"ქართული ენა",display_name:"Грузинский"},{id:15,index:7,is_active:!1,lang:"uz",lang_original:"Ўзбек",display_name:"Узбекский"}],subtitles:[{url:"https://c2.mggcdn.net/28/5374461/original_ua_0.srt",lang:"ua",lang_original:"Українська",display_name:"Украинский",type:"srt",index:0},{url:"https://c2.mggcdn.net/28/5374461/original_ua_0.srt",lang:"ua",lang_original:"Українська",display_name:"Украинский",type:"srt",index:0}],showCloseButton:!0,autoPlay:!0,type:null,resultingrefererhost:null,player_share_code:!1,share_link:"http://o3.rc.megogo.net/ru/view/2384041",messages:{gpuOn:null,gpuOff:null,closeButtonName:null,shareButtonName:"",lowProductivityMessage:null,linkFromVideoText:"",shareFromSocialText:null,voteWindowTitle:null,like:null,NoLike:null,copyByttonName:null,htmlCodeText:null,otherNewsText:null,copied:null,advertising:null,advertisingPart:null,download:null,itRemains:null,second:null,hide:null,skipAds:null,goToTheAdvertisersWebsite:null,previewMessage:null,trailer:null,allPrograms:null,onTheAir:null,subtitles:"",on:"",off:"",audiotrack:"",format:null,quality:"",acceleration:"",through:null,watchNow:null,onAir:null,yesterday:null,today:null,tomorrow:null,interactiveMessage:null,watchFromTheStart:null,previousChannel:null,nextChannel:null,allChannels:null,programm:null,settings:"",fullScreen:null,minimize:null,favoriteChannels:null},preview_images:{thumbsline_list:[{id:1,url:"http://c2.mggcdn.net/28/2136339/original_thumbsline_1.jpg"},{id:2,url:"http://c1.mggcdn.net/23/2136340/original_thumbsline_2.jpg"},{id:3,url:"http://c2.mggcdn.net/23/2136343/original_thumbsline_3.jpg"},{id:4,url:"http://c1.mggcdn.net/24/2136344/original_thumbsline_4.jpg"},{id:5,url:"http://c2.mggcdn.net/23/2136341/original_thumbsline_5.jpg"},{id:6,url:"http://c1.mggcdn.net/23/2136346/original_thumbsline_6.jpg"},{id:7,url:"http://c1.mggcdn.net/23/2136342/original_thumbsline_7.jpg"},{id:8,url:"http://c1.mggcdn.net/23/2136338/original_thumbsline_8.jpg"}],thumbsline_xml:"http://c2.mggcdn.net/27/2136347/thumbsline.xml"}},result:"ok"};t.exports=r},{}]},{},[69]);

//Wed Jul 19 2017 16:28:38 GMT+0300 (EEST)
